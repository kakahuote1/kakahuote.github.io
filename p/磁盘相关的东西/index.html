<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="学RAID之前必须知道的和可以知道的">
<title>磁盘相关的东西</title>

<link rel='canonical' href='https://blog.928330.xyz/p/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%9C%E8%A5%BF/'>

<link rel="stylesheet" href="/scss/style.min.6eb8014a7c47067a823017bd97e0272008650fbf090fa26d21e955bb600446ce.css"><meta property='og:title' content="磁盘相关的东西">
<meta property='og:description' content="学RAID之前必须知道的和可以知道的">
<meta property='og:url' content='https://blog.928330.xyz/p/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%9C%E8%A5%BF/'>
<meta property='og:site_name' content='kakahuote'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='forensics' /><meta property='article:tag' content='windows' /><meta property='article:tag' content='linux' /><meta property='article:published_time' content='2025-10-18T22:56:41&#43;08:00'/><meta property='article:modified_time' content='2025-10-22T01:14:21&#43;08:00'/><meta property='og:image' content='http://picture.928330.xyz/typora/image-20251022010316720.png' />
<meta name="twitter:title" content="磁盘相关的东西">
<meta name="twitter:description" content="学RAID之前必须知道的和可以知道的"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://picture.928330.xyz/typora/image-20251022010316720.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>加载动画</title>
    <style>
        .loading {
            position: fixed;
            display: flex;
            flex-direction: column;  
            justify-content: center;
            align-items: center;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99;
            background-color: #f5f5fa;
            transition: transform 1.5s, opacity 1.5s;
            transform: scale(1);
            opacity: 1;
        }

        .loader-bars {
            display: flex;  
            align-items: flex-end;  
            gap: 3px;  
            margin-bottom: 20px;  
        }

        .bar {
            height: 5px;
            width: 12px;
            animation-duration: 0.45s;
            animation-name: changeHeight;
            animation-iteration-count: infinite;
            animation-direction: alternate;
        }

        .red {
            background-color: #E50000;
            box-shadow: 1px 1px 10px #E50000;
            animation-delay: 0.10s;
        }

        .orange {
            background-color: #FF8D00;
            box-shadow: 1px 1px 10px #FF8D00;
            animation-delay: 0.20s;
        }

        .yellow {
            background-color: #FFEE00;
            box-shadow: 1px 1px 10px #FFEE00;
            animation-delay: 0.25s;
        }

        .green {
            background-color: #008121;
            box-shadow: 1px 1px 10px #008121;
            animation-delay: 0.30s;
        }

        .blue {
            background-color: #004CFF;
            box-shadow: 1px 1px 10px #004CFF;
            animation-delay: 0.35s;
        }

        .violet {
            background-color: #760188;
            box-shadow: 1px 1px 10px #760188;
            animation-delay: 0.40s;
        }

        @keyframes changeHeight {
            from {
                height: 5px;
            }

            to {
                height: 40px;
            }
        }

        .scaleAndFadeout {
            transform: scale(1.5);
            opacity: 0;
        }

         
        .loading-text {
            color: #333;  
            font-size: 16px;  
        }
    </style>
</head>
<body>

    <div class="loading">
        <div class="loader-bars">
            <div class="red bar"></div>
            <div class="orange bar"></div>
            <div class="yellow bar"></div>
            <div class="green bar"></div>
            <div class="blue bar"></div>
            <div class="violet bar"></div>
        </div>
        <div class="loading-text">loading...</div>
    </div>

    <script>
        function initLoading() {
            let loading = document.querySelector(".loading");
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(() => {
                    loading.classList.add("scaleAndFadeout");
                    setTimeout(() => {
                        loading.style.display = "none";
                    }, 1500);
                }, 50);
            });
        }

        initLoading();
    </script>

</body>
</html>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/" id="avatar-link">
                
                    
                    
                    
                        
                        <img class="site-logo original-logo" src="/img/avatar_hu_4804467f7cda2058.png" width="300" height="300" loading="lazy" alt="原始头像">
                    
                    
                        
                        <img class="site-logo hover-logo" src="/img/avatar-hover_hu_f231304c77e946da.png" width="300" height="300" loading="lazy" alt="悬停头像">
                    
                
                </a>
                
                    <span class="emoji">🤝</span>
                
            </figure>
            
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/">kakahuote</a></h1>
            <h2 class="site-description">靡不有初，鲜克有终</h2>
        </div>
    </header>

    <ol class="menu-social">
                <li>
                    <a
                        href='https://bilibili.com'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a
                        href='https://github.com'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            </ol>

    <ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E9%93%BE/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友链</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#物理盘physical-diskpd">物理盘（Physical Disk，PD）</a></li>
    <li><a href="#虚拟盘virtual-disk-vd-">虚拟盘（Virtual Disk ，VD ）</a>
      <ol>
        <li><a href="#本地虚拟盘">本地虚拟盘</a></li>
        <li><a href="#网络存储虚拟盘">网络存储虚拟盘</a>
          <ol>
            <li><a href="#nasnetwork-attached-storage">NAS（Network Attached Storage）</a></li>
            <li><a href="#sanstorage-area-network">SAN（Storage Area Network）</a></li>
          </ol>
        </li>
        <li><a href="#云存储虚拟盘">云存储虚拟盘</a></li>
      </ol>
    </li>
    <li><a href="#磁盘组disk-group">磁盘组（Disk Group）</a></li>
    <li><a href="#扇区sector">扇区（Sector）</a>
      <ol>
        <li><a href="#物理扇区">物理扇区</a>
          <ol>
            <li><a href="#糟糕的问题">糟糕的问题</a></li>
          </ol>
        </li>
        <li><a href="#逻辑扇区">逻辑扇区</a></li>
        <li><a href="#硬盘扇区格式标准">硬盘扇区格式标准</a>
          <ol>
            <li><a href="#512n512-native512原生">512n（512 Native，512原生）</a></li>
            <li><a href="#512e512-emulation512模拟">512e（512 Emulation，512模拟）</a></li>
            <li><a href="#4kn4k-native4k原生">4Kn（4K Native，4K原生）</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#逻辑盘logical-disk-ld-分区-partition">逻辑盘（Logical Disk ，LD）/ 分区 （Partition）</a></li>
    <li><a href="#分区格式">分区格式</a>
      <ol>
        <li><a href="#mbr-master-boot-record主引导记录">MBR (Master Boot Record，主引导记录)</a></li>
        <li><a href="#gpt-guid-partition-tableguid分区表">GPT (GUID Partition Table，GUID分区表)</a></li>
        <li><a href="#apm-apple-partition-map苹果分区图">APM (Apple Partition Map，苹果分区图)</a></li>
      </ol>
    </li>
    <li><a href="#文件系统">文件系统</a>
      <ol>
        <li><a href="#分区的格式化">分区的格式化</a>
          <ol>
            <li><a href="#快速格式化">快速格式化</a></li>
            <li><a href="#完全格式化">完全格式化</a></li>
          </ol>
        </li>
        <li><a href="#常见的文件系统类型">常见的文件系统类型</a>
          <ol>
            <li><a href="#fat">FAT</a>
              <ol>
                <li><a href="#fat16">FAT16</a></li>
                <li><a href="#fat32">FAT32</a></li>
                <li><a href="#exfat-extended-file-allocation-table">exFAT (Extended File Allocation Table)</a></li>
              </ol>
            </li>
            <li><a href="#ntfs">NTFS</a></li>
            <li><a href="#refs">ReFS</a></li>
            <li><a href="#ext">ext</a>
              <ol>
                <li><a href="#ext2">ext2</a></li>
                <li><a href="#ext3">ext3</a></li>
                <li><a href="#ext4">ext4</a></li>
              </ol>
            </li>
            <li><a href="#btrfs">Btrfs</a></li>
            <li><a href="#xfs">XFS</a></li>
            <li><a href="#tmpfs">tmpfs</a></li>
            <li><a href="#devtmpfs">devtmpfs</a></li>
            <li><a href="#hfs-与-apfs">HFS+ 与 APFS</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#卷volume">卷（Volume）</a></li>
    <li><a href="#windows物理磁盘的管理模式">Windows物理磁盘的管理模式</a>
      <ol>
        <li><a href="#基础磁盘-basic-disk">基础磁盘 (Basic Disk)</a></li>
        <li><a href="#动态磁盘-dynamic-disk">动态磁盘 (Dynamic Disk)</a></li>
      </ol>
    </li>
    <li><a href="#驱动器drive">驱动器（Drive）</a>
      <ol>
        <li><a href="#windows驱动器">Windows驱动器</a></li>
        <li><a href="#linux驱动器">Linux驱动器</a></li>
      </ol>
    </li>
    <li><a href="#挂载mount">挂载（Mount）</a>
      <ol>
        <li><a href="#挂载点">挂载点</a></li>
        <li><a href="#windows挂载">windows挂载</a></li>
        <li><a href="#linux挂载">Linux挂载</a></li>
      </ol>
    </li>
    <li><a href="#windows系统的物理盘与逻辑盘表示">Windows系统的物理盘与逻辑盘表示</a>
      <ol>
        <li><a href="#设备命名规则">设备命名规则</a>
          <ol>
            <li><a href="#物理磁盘层">物理磁盘层</a></li>
            <li><a href="#分区卷层">分区/卷层</a></li>
            <li><a href="#驱动器号层">驱动器号层</a></li>
            <li><a href="#guid卷路径">GUID卷路径</a></li>
          </ol>
        </li>
        <li><a href="#实例">实例</a></li>
      </ol>
    </li>
    <li><a href="#linux系统的物理盘与逻辑盘表示">Linux系统的物理盘与逻辑盘表示</a>
      <ol>
        <li><a href="#设备命名规则-1">设备命名规则</a>
          <ol>
            <li><a href="#sd-通用硬盘">sd (通用硬盘)</a></li>
            <li><a href="#hdide硬盘">hd（IDE硬盘）</a></li>
            <li><a href="#vd虚拟化硬盘">vd（虚拟化硬盘）</a></li>
            <li><a href="#nvmenvme固态硬盘">nvme（NVMe固态硬盘）</a></li>
            <li><a href="#mmcblkemmc--sd卡">mmcblk（eMMC / SD卡）</a></li>
          </ol>
        </li>
        <li><a href="#实例-1">实例</a></li>
      </ol>
    </li>
    <li><a href="#lvmlogical-volume-manager">LVM（Logical Volume Manager）</a>
      <ol>
        <li><a href="#lvm的核心组件">LVM的核心组件</a>
          <ol>
            <li><a href="#物理卷-physical-volume-pv">物理卷 (Physical Volume, PV)</a></li>
            <li><a href="#卷组-volume-group-vg">卷组 (Volume Group, VG)</a></li>
            <li><a href="#逻辑卷-logical-volume-lv">逻辑卷 (Logical Volume, LV)</a></li>
            <li><a href="#物理扩展块-physical-extent-pe">物理扩展块 (Physical Extent, PE)</a></li>
            <li><a href="#逻辑扩展块-logical-extent-le">逻辑扩展块 (Logical Extent, LE)</a></li>
          </ol>
        </li>
        <li><a href="#lvm设备命名">LVM设备命名</a></li>
        <li><a href="#lvm信息查看">LVM信息查看</a>
          <ol>
            <li><a href="#查看磁盘类型">查看磁盘类型</a></li>
            <li><a href="#总览lvm各层">总览lvm各层</a></li>
            <li><a href="#查看pv信息">查看PV信息</a></li>
            <li><a href="#查看vg信息">查看VG信息</a></li>
            <li><a href="#查看lv信息">查看LV信息</a></li>
          </ol>
        </li>
        <li><a href="#lvm元数据的存储位置">LVM元数据的存储位置</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%9C%E8%A5%BF/">
                
                    <img src="http://picture.928330.xyz/typora/image-20251022010316720.png" loading="lazy" alt="Featured image of post 磁盘相关的东西" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/" >
                技术随笔
            </a>
        
    </header>
    

    <div class="article-title-wrapper">


        <h2 class="article-title">
            <a href="/p/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3%E7%9A%84%E4%B8%9C%E8%A5%BF/">磁盘相关的东西</a>
        </h2>
        
        <h3 class="article-subtitle">
            学RAID之前必须知道的和可以知道的
        </h3>
        

    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">
                    发布时间：2025-10-18</time>
            </div>
        

        

        <div class="article-lastmod">
               <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



               <time>
                   更新时间：2025-10-22
               </time>
           </div>
        <div>
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-eye"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
            <time class="article-time--published">
                浏览量：<span class="waline-pageview-count" data-waline-pageview-count="0">0</span>
            </time>
        </div>
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>嗯对就是一些磁盘相关的东西</p>
<h1 id="物理盘physical-diskpd">物理盘（Physical Disk，PD）
</h1><p>是实际存在的硬件存储设备，如HDD（Hard Disk Drive，机械硬盘）、SSD（Solid State Drive，固态硬盘）</p>
<p><strong>HDD是依靠旋转的磁盘和机械磁头读写数据的传统硬盘</strong>，有真实的机械运动，因此读写速度受机械臂移动和盘片旋转限制，随机访问慢，并且不耐摔，但大容量成本低，所以通常用作大容量备份或冷存储</p>
<p><strong>SSD则完全没有机械部件，数据存储在电子闪存中</strong>，读写几乎即时，随机访问和顺序访问速度都很快，是耐摔王，但价格高，写入次数有限，需要通过固件和控制器管理寿命，通常作系统盘和高速应用</p>
<h1 id="虚拟盘virtual-disk-vd-">虚拟盘（Virtual Disk ，VD ）
</h1><p>是通过软件技术模拟出来的磁盘存储设备，没有物理结构，但在系统层面像真实磁盘</p>
<p>常见以下几类：</p>
<h2 id="本地虚拟盘">本地虚拟盘
</h2><p>在单台计算机上由操作系统或软件创建的虚拟盘，例如VHD、VMDK之类的，用于虚拟机</p>
<h2 id="网络存储虚拟盘">网络存储虚拟盘
</h2><p>通过网络提供的虚拟盘，可以被多台设备访问，比如：</p>
<h3 id="nasnetwork-attached-storage">NAS（Network Attached Storage）
</h3><p>文件级存储，通过网络共享文件，常用于家庭或企业文件共享</p>
<h3 id="sanstorage-area-network">SAN（Storage Area Network）
</h3><p>块级存储，通过高速网络提供虚拟磁盘给服务器使用，多用于企业数据库或虚拟机存储</p>
<h2 id="云存储虚拟盘">云存储虚拟盘
</h2><p>云服务商提供的块存储或对象存储虚拟盘，把我们的文件放在远程服务器上，这些服务器内部可能是HDD 或SSD，经过虚拟化后提供我们一个虚拟盘，通过网络访问就像访问本地盘一样，例如百度网盘</p>
<p><strong>网络存储虚拟盘更像企业内部自建硬盘，使用局域网（LAN）</strong></p>
<p><strong>而云存储虚拟盘是互联网远程虚拟盘，使用互联网（WAN），用户只是远程使用而已</strong></p>
<h1 id="磁盘组disk-group">磁盘组（Disk Group）
</h1><p>是将多块物理盘组合成一个组，比如RAID阵列就是磁盘组</p>
<h1 id="扇区sector">扇区（Sector）
</h1><h2 id="物理扇区">物理扇区
</h2><p><strong>是硬盘硬件上可以独立寻址和进行读写操作的最小物理区域</strong></p>
<p>由于物理层面的原因，没有硬盘能做到一个bit一个bit对数据进行操作</p>
<p>对于<strong>机械硬盘</strong>，它指的是盘片上磁道的一个特定弧段，硬盘的磁头在执行一次读写命令时，至少要处理这么大一块物理区域</p>
<p>对于<strong>固态硬盘</strong>，它对应于NAND闪存芯片中的一个物理页或块的一部分，是SSD主控能够操作的最小数据单元</p>
<p><strong>一个物理扇区并不完全用来存储用户数据，它还包含了其余内容，用于确保数据能被准确定位和可靠读写：</strong></p>
<ul>
<li><strong>间隙</strong>：用于分隔不同的扇区</li>
<li><strong>同步标记</strong>：帮助磁头在高速旋转中同步数据读取的时机</li>
<li><strong>地址标记</strong>：记录这个扇区的唯一物理地址（哪个磁头、哪个柱面、哪个扇区）</li>
<li><strong>纠错码（ECC）</strong>：这是一段根据数据内容计算出来的校验码，在读取数据时，硬盘会重新计算ECC并与存储的ECC进行比对，以发现并纠位错误</li>
</ul>
<p>这样方便了管理，也产生了空间开销</p>
<p>随着硬盘容量的急剧增大，使用512字节的物理扇区变得越来越低效，现在很多硬盘物理扇区扩大到了4096字节（4KB），被称为先进格式化（Advanced Format，AF），相当于把8个小扇区的管理开销合并为1个大扇区的开销，空间利用率显著提高，并且更大的扇区意味着可以分配更多的空间给ECC码，从而设计出更好的纠错算法</p>
<h3 id="糟糕的问题">糟糕的问题
</h3><p>当我们要写入HDD的数据不足512B的时候，硬盘也会先把包含目标字节的整个扇区512B读入缓存，在缓存中修改要写入的那些字节，之后重新计算ECC，最后把整个512B扇区写回磁盘</p>
<p>也就是说，硬盘把所有<strong>不是512B整数倍</strong>的<strong>写</strong>过程，都变成了<strong>读-改-写</strong>的过程！这会造成性能的浪费！</p>
<p>而对于SSD，这个情况更加严重：</p>
<p>SSD最小写单元是页，通常是4KB，但它最小的可擦除单元却是按照块计算，通常是128KB</p>
<div class="alert alert-tip">
    <div class="alert-header">
        <span class="alert-icon">
            💡
        </span>
        <span class="alert-title">
            Tip
        </span>
    </div>
    <div class="alert-content">
        <p>NAND闪存写入页之前页必须是干净的，也就是所有位都是1，不能直接覆盖，而擦除必须整块擦除</p>
<p>如果把块设置成和页一样大，可擦除最小单位变成4KB，坏块产生概率更高，还会加速磨损</p>
<p>如果把页设置成和块一样大，写入最小单位变成128KB，小文件写入会严重浪费，性能下降</p>
<p>所以现在的设置是理论最优喔</p></div>
</div>
<p>当写入数据不是4KB的整数倍的时候会变成读-改-写，这还好，如果要写的页已经写过，无法覆盖，那就必须擦除，而擦除所带来的改就是整个块的改动，有几百KB，甚至达到MB的级别！</p>
<p>这就是所谓的“<strong>写放大</strong>”问题，而它几乎是不可避免的</p>
<h2 id="逻辑扇区">逻辑扇区
</h2><p><strong>类似逻辑地址，逻辑扇区是一个抽象概念，是硬盘让操作系统和用户看到的假设出来的东西</strong></p>
<p>操作系统使用一种名为<strong>逻辑块地址 (Logical Block Addressing, LBA)</strong> 的方式来访问硬盘</p>
<p>在这种模式下，整个硬盘被看作一个从0开始编号的、连续线性的逻辑扇区数组，操作系统无需关心数据具体存放在哪个盘片、哪个磁头、哪个柱面上，只需要关心线性的LBA地址就可以了，这极大地简化了软件开发</p>
<p>比如，当操作系统需要读取数据时，它只用发出简单的指令：给我LBA地址为12345的数据，就会自动取出第12346个扇区（注意扇区编号从0开始的）</p>
<p>并且，这还保证了新硬件能够兼容旧的操作系统，比如从HDD变为SSD，或改变内部存储结构，只要硬盘的固件能够正确地将操作系统发来的LBA地址请求翻译成对内部物理存储单元的操作即可</p>
<p><strong>逻辑扇区大小可以与物理扇区不同</strong>，接着往下看</p>
<h2 id="硬盘扇区格式标准">硬盘扇区格式标准
</h2><h3 id="512n512-native512原生">512n（512 Native，512原生）
</h3><p>最传统的标准，即硬盘的物理扇区大小和逻辑扇区大小都是512字节</p>
<p>所见即所得，操作系统看到的逻辑结构与硬盘的物理结构完全一致，不存在转换和模拟</p>
<h3 id="512e512-emulation512模拟">512e（512 Emulation，512模拟）
</h3><p>这是当前最主流的标准，硬盘的物理扇区大小是4096字节 (4KB)，但它对外伪装成512字节的逻辑扇区与操作系统沟通，来保证对旧软件和操作系统的向后兼容性</p>
<p>在windows的cmd，使用下面的命令可以查看C盘扇区大小：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>fsutil fsinfo ntfsinfo C:
</span></span></code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20250930163549065" href="http://picture.928330.xyz/typora/image-20250930163549065.png">
<img src="http://picture.928330.xyz/typora/image-20250930163549065.png" alt="image-20250930163549065"  />
</a>
</div>
</p>
<p>但这样也会导致问题：当操作系统尝试写入一个未与底层4KB物理扇区边界对齐的512字节逻辑扇区时，就会触发一次之前说过的读-改-写操作，这被称为<strong>未对齐写入</strong>，也会导致性能下降</p>
<h3 id="4kn4k-native4k原生">4Kn（4K Native，4K原生）
</h3><p>最现代的标准，硬盘的物理扇区大小和逻辑扇区大小都是4096字节</p>
<h1 id="逻辑盘logical-disk-ld-分区-partition">逻辑盘（Logical Disk ，LD）/ 分区 （Partition）
</h1><p>逻辑盘是在物理盘上通过软件划分出来的具有逻辑结构的存储区域，依赖物理盘，也叫做分区</p>
<p>一个物理盘可划分为多个逻辑盘，如Windows的C、D盘，Linux的/dev/sda1、/dev/sda2分区</p>
<p><strong>为什么要分区？</strong></p>
<ul>
<li>
<p><strong>隔离数据</strong></p>
<p>可以将操作系统文件与用户数据分开放置。如果系统分区损坏需要重装，用户数据分区可以不受影响</p>
</li>
<li>
<p><strong>使用不同文件系统</strong></p>
<p>可以在同一块硬盘上为不同的分区创建不同的文件系统，以满足不同需求</p>
<p>例如，一个ext4分区给Linux用，一个NTFS分区用于和Windows共享数据</p>
</li>
<li>
<p><strong>专用空间</strong></p>
<p>创建专门的分区用作交换空间，作为物理内存的补充</p>
<p>将频繁读写的文件（如日志）放在独立分区，可以减少磁盘碎片，方便备份和管理</p>
</li>
</ul>
<h1 id="分区格式">分区格式
</h1><p><strong>分区格式</strong>又叫做<strong>分区表格式</strong>、<strong>分区方案</strong>，定义了整块硬盘如何被分割</p>
<p>分区格式总被存储在硬盘的开头，决定着以下内容：</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>功能</th>
          <th>说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>分区数量与位置</strong></td>
          <td>告诉操作系统磁盘上有哪些分区、每个分区从哪开始到哪结束</td>
      </tr>
      <tr>
          <td><strong>启动信息</strong></td>
          <td>存放系统启动代码（例如 MBR 的引导加载器）</td>
      </tr>
      <tr>
          <td><strong>磁盘寻址方式</strong></td>
          <td>定义用扇区号还是 LBA 地址来访问磁盘数据</td>
      </tr>
      <tr>
          <td><strong>兼容性与容量上限</strong></td>
          <td>决定磁盘支持的最大容量、最大分区数、支持哪些系统</td>
      </tr>
      <tr>
          <td><strong>冗余与校验机制</strong></td>
          <td>GPT 具备备份表与 CRC 校验，MBR 则没有</td>
      </tr>
  </tbody>
</table></div>
<p>如果没有分区格式，一般就被称作RAW，下面是一些常见的分区格式：</p>
<h2 id="mbr-master-boot-record主引导记录">MBR (Master Boot Record，主引导记录)
</h2><p>这是一种较老的分区方案，限制一块MBR硬盘最多只能有4个主分区</p>
<p>为了突破4个分区的限制，可以将其中一个主分区设置为<strong>扩展分区</strong>，然后在扩展分区内部可以创建多个<strong>逻辑分区</strong></p>
<p>因此，分区编号<code>1</code>到<code>4</code>总是留给主分区或扩展分区，逻辑分区的编号则从<code>5</code>开始</p>
<p>所以，如果我们看到一块硬盘的分区是<code>/dev/sda1</code>、<code>/dev/sda2</code>、<code>/dev/sda5</code>，这通常意味着<code>sda1</code>和<code>sda2</code>是主分区，而<code>sda5</code>是扩展分区里的第一个逻辑分区：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e06c75">MBR分区表</span> (<span style="color:#e06c75">最多4个条目</span>)
</span></span><span style="display:flex;"><span>+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">----------</span>-+
</span></span><span style="display:flex;"><span>|  <span style="color:#e06c75">主分区1</span>  |  <span style="color:#e06c75">主分区2</span> | <span style="color:#e06c75">主分区3</span> | <span style="color:#e06c75">扩展分区</span>   |
</span></span><span style="display:flex;"><span>+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">--------</span>-+<span style="color:#56b6c2">----------</span>-+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">扩展分区内部</span> (<span style="color:#e06c75">逻辑分区链表</span>)
</span></span><span style="display:flex;"><span>+<span style="color:#56b6c2">----------</span>-+<span style="color:#56b6c2">----------</span>-+<span style="color:#56b6c2">----------</span>-+
</span></span><span style="display:flex;"><span>| <span style="color:#e06c75">逻辑分区5</span> | <span style="color:#e06c75">逻辑分区6</span> | <span style="color:#e06c75">逻辑分区7</span>  |
</span></span><span style="display:flex;"><span>+<span style="color:#56b6c2">----------</span>-+<span style="color:#56b6c2">----------</span>-+<span style="color:#56b6c2">----------</span>-+
</span></span></code></pre></div><p>扩展分区不是独立的分区，它是一个链表容器，存储在磁盘上的EBR（Extended Boot Record）</p>
<p>每个逻辑分区都有自己的EBR，用来指向下一个逻辑分区 ，操作系统通过EBR链表来识别逻辑分区</p>
<h2 id="gpt-guid-partition-tableguid分区表">GPT (GUID Partition Table，GUID分区表)
</h2><p>这是一种更现代、更灵活的分区方案，是当前的主流标准，理论上支持无限个分区（但操作系统通常限制为128个）</p>
<p>没有主分区、扩展分区、逻辑分区的复杂概念，所有分区地位平等</p>
<p>分区编号就是简单地从<code>1</code>开始连续递增，如<code>/dev/sda1</code>、<code>/dev/sda2</code>、<code>/dev/sda3</code>&hellip;</p>
<h2 id="apm-apple-partition-map苹果分区图">APM (Apple Partition Map，苹果分区图)
</h2><p>这是一种较老的分区方案，是苹果公司在从PowerPC架构迁移到Intel架构（约2006年）之前，为其PowerPC 架构的Mac电脑所使用的默认分区方案</p>
<p>它同样会记录磁盘上的分区信息，包括为当时的Mac OS（现macOS）存储特定的启动信息和驱动程序</p>
<p>在现代的Intel和Apple Silicon Mac上，已经全面被GPT取代</p>
<h1 id="文件系统">文件系统
</h1><p>当我们有了一个分区后，它还只是一片空白的存储空间，我们还需要一种规则来组织和管理将要存入其中的数据，这种规则就是文件系统，<strong>文件系统本质上是操作系统的一部分</strong></p>
<p>在windows的cmd下，可以使用下面命令查看所有卷的文件系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wmic logicaldisk get name,filesystem
</span></span></code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251001235258602" href="http://picture.928330.xyz/typora/image-20251001235258602.png">
<img src="http://picture.928330.xyz/typora/image-20251001235258602.png" alt="image-20251001235258602"  />
</a>
</div>
</p>
<p>在linux则可以使用下面的命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>df -T
</span></span></code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251001235356981" href="http://picture.928330.xyz/typora/image-20251001235356981.png">
<img src="http://picture.928330.xyz/typora/image-20251001235356981.png" alt="image-20251001235356981"  />
</a>
</div>
</p>
<h2 id="分区的格式化">分区的格式化
</h2><p>在一个分区上创建文件系统的过程，就叫做<strong>格式化（Format）</strong></p>
<p><strong>从技术上讲，格式化的核心就是在指定的分区上创建一套全新空白的文件系统</strong>，就像拿到一本空白的笔记本，在第一页画好目录的表格，为之后写内容做好组织规划</p>
<p>不过为什么我们日常的体验是“格式化=擦除数据”呢？</p>
<p>这完全取决于我们执行的是哪一种格式化，格式化主要分为两种：<strong>快速格式化</strong>和<strong>完全格式化</strong></p>
<h3 id="快速格式化">快速格式化
</h3><p><strong>操作系统只会擦除文件系统的索引区域，然后写入一套新的空白的索引，不会处理真正存储内容的数据区域</strong></p>
<p>对操作系统来说，既然目录已经是空白的了，那它就认为这个分区上没有任何文件，因此硬盘看起来是空的</p>
<p>但实际上，之前的所有数据都还原封不动地在磁盘上，只是失去了能够找到它们的索引信息</p>
<p>也正因如此，数据恢复可能性非常高，数据恢复软件会跳过被删除的目录，直接扫描整个硬盘的数据区域，根据文件头信息和数据结构来重建出原始文件</p>
<h3 id="完全格式化">完全格式化
</h3><p><strong>既删除目录，也擦除所有内容</strong></p>
<p>执行完全格式化，操作系统会做两件事：</p>
<ol>
<li>执行一次快速格式化，创建新的空白文件系统。</li>
<li>从头到尾扫描整个分区，并向每一个扇区的每一个bit写入0</li>
</ol>
<p>这样一来，所有旧数据都会被毫无意义的0数据彻底覆盖掉。硬盘被真正地清空了，完全不能恢复</p>
<h2 id="常见的文件系统类型">常见的文件系统类型
</h2><h3 id="fat">FAT
</h3><p><strong>全称File Allocation Table，文件分配表</strong></p>
<p>结构简单，兼容性极佳，几乎所有主流操作系统和电子设备都支持，常用于U盘、SD卡、移动硬盘，作为跨平台数据交换的媒介</p>
<p>FAT文件系统关键结构就是FAT，即文件分配表，作用就是记录磁盘上每个簇的使用情况和文件存储位置，簇是磁盘上最小的数据分配单位，由若干扇区组成</p>
<p>FAT的分区大小=最大簇数×每簇大小，最大簇数由每个簇编号占用的位数决定，通常写在名字里，比如FAT12就是每个簇用12位表示，最大簇数2¹²=4096个，而每簇大小不太固定</p>
<h4 id="fat16">FAT16
</h4><p>非常早期的版本，在DOS和Windows 95时代流行，已经基本被淘汰</p>
<p>最大仅支持2GB的分区（在某些系统中可达4GB）</p>
<h4 id="fat32">FAT32
</h4><p>是FAT16的改进版本，但它依旧无法管理大于4GB的单个文件，并且最大分区支持也有限（Windows上限制为32GB，理论上可达2TB）</p>
<h4 id="exfat-extended-file-allocation-table">exFAT (Extended File Allocation Table)
</h4><p>由微软推出，专为解决FAT32的缺点</p>
<p>它打破了4GB单文件和分区大小的限制，同时针对闪存介质的特性进行了优化，减少了不必要的写入操作</p>
<h3 id="ntfs">NTFS
</h3><p><strong>全称New Technology File System，新技术文件系统</strong></p>
<p>是Windows系统的标准文件系统，支持大文件和大分区，并提供文件权限管理、加密、日志、压缩等强大功能，可靠性和安全性高</p>
<p>感兴趣可以看看我的另一篇博客：<a class="link" href="https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/#ntfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"  target="_blank" rel="noopener"
    >NTFS系统
    
    <span style="white-space: nowrap;"><svg width=".7em"
        height=".7em" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg">
        <path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
        <path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
            fill="currentColor">
    </svg></span>
    
</a></p>
<h3 id="refs">ReFS
</h3><p><strong>全称Resilient File System，弹性文件系统</strong></p>
<p>是微软为Windows Server系统推出的、旨在替代NTFS的新一代文件系统，但它的核心设计目标不是替代桌面版的NTFS，而是为数据中心和大规模存储提供更高的数据完整性和可用性</p>
<p>它通过对元数据和可选的用户数据进行校验和来主动检测和修复数据损坏，其写入时复制（Copy-on-Write）机制确保了在写入过程中发生意外时，旧数据不会被破坏，极大地增强了数据恢复能力</p>
<p>常用于Windows Server的存储空间和Hyper-V虚拟化场景</p>
<h3 id="ext">ext
</h3><p><strong>全称Extended File System，扩展文件系统</strong></p>
<p>Linux系统的标准文件系统，用于几乎所有的Linux发行版，从桌面到服务器，<strong>以及安卓手机的内部存储</strong></p>
<h4 id="ext2">ext2
</h4><p>经典的早期版本，性能良好，但与FAT类似，缺少日志功能，在服务器等场景下可靠性不足</p>
<h4 id="ext3">ext3
</h4><p>它在ext2的基础上加入了日志功能，在不改变底层结构的情况下，极大地提升了文件系统的可靠性，成为了许多Linux发行版的长期默认选项</p>
<h4 id="ext4">ext4
</h4><p>当前的主流标准，它在前代基础上引入了多项重要改进，如Extents（优化大文件的存储方式，减少碎片并提升性能）、支持更大的文件和卷、更快的自检速度等，使其更现代化、性能更强</p>
<h3 id="btrfs">Btrfs
</h3><p><strong>全称B-tree File System</strong></p>
<p>是Linux的新一代文件系统，旨在替代ext系列文件系统，尤其适合企业级存储和虚拟化环境</p>
<p>Btrfs内置了快照、校验和、数据压缩、写时复制以及多磁盘管理等功能，它非常灵活，允许动态地添加、删除设备和调整卷大小，目前已成为一些Linux发行版（如Fedora, openSUSE）的默认文件系统</p>
<h3 id="xfs">XFS
</h3><p><strong>全称Extended Filesystem X，扩展文件系统X</strong></p>
<p>是一种高性能日志文件系统，最初由硅谷图形公司SGI为其IRIX操作系统开发，后来被Linux采用</p>
<p>XFS的结构设计使其在文件数量和大小增长时，性能下降幅度很小，特别适合处理大文件和高并发读写场景</p>
<p>因其稳定性和高吞吐量的特性，XFS成为了许多企业级Linux发行版（如Red Hat Enterprise Linux及其衍生版CentOS）的默认文件系统，尤其适用于数据库、媒体服务器和科学计算等场景</p>
<h3 id="tmpfs">tmpfs
</h3><p><strong>全称Temporary File System，临时文件系统</strong></p>
<p>是Linux下的一种虚拟文件系统，完全驻留在内存中，用于存放临时文件</p>
<p>数据不持久，重启后丢失，支持动态调整大小，常用于<code>/tmp</code>、<code>/run</code>等目录</p>
<h3 id="devtmpfs">devtmpfs
</h3><p><strong>全称Device Temporary File System，设备临时文件系统</strong></p>
<p>是Linux内核专门为<code>/dev</code>目录提供的虚拟文件系统，用于管理设备节点</p>
<p>在内存中动态生成，不占用硬盘，系统启动早期即可挂载，方便设备驱动初始化</p>
<h3 id="hfs-与-apfs">HFS+ 与 APFS
</h3><p><strong>HFS+全称Hierarchical File System Plus，分层文件系统增强版</strong></p>
<p><strong>APFS全称Apple File System，苹果文件系统</strong></p>
<p>他们都是苹果macOS系统的文件系统，HFS+是长期的标准，而APFS（Apple File System）是从2017年开始推出的新一代文件系统，专门为固态硬盘和闪存优化，性能和可靠性更强</p>
<h1 id="卷volume">卷（Volume）
</h1><p><strong>卷是将分区格式化后, 创建了文件系统, 能够被系统所识别和访问的存储区域</strong></p>
<p>在最简单的情况下，一个卷和一个分区是一一对应的，比如在一块硬盘上划分了C、D两个分区，那么就有两个对应的卷</p>
<p>但一个卷也可以跨越多个分区，甚至多块物理硬盘，例如RAID阵列，在操作系统看来就是一个跨越了多块物理盘的巨大逻辑卷</p>
<h1 id="windows物理磁盘的管理模式">Windows物理磁盘的管理模式
</h1><h2 id="基础磁盘-basic-disk">基础磁盘 (Basic Disk)
</h2><p>这是Windows系统默认的磁盘类型，当我们初始化一块新硬盘时，系统默认会将其设置为基础磁盘</p>
<p>它使用我们之前讨论过的传统分区表（MBR或GPT）来组织磁盘</p>
<p>基础磁盘上的一个分区（或简单卷）不能跨越到多个物理磁盘上，每个分区都完全包含在一块物理硬盘的内部</p>
<h2 id="动态磁盘-dynamic-disk">动态磁盘 (Dynamic Disk)
</h2><p>这是Windows提供的一种更高级的磁盘管理模式，它提供了基础磁盘所不具备的许多高级功能</p>
<p>动态磁盘不使用传统的分区表来定义卷，而是使用一个逻辑磁盘管理器（LDM，Logical Disk Manager）的数据库来跟踪所有动态卷的信息，这个数据库会被复制到系统中每一个动态磁盘上，以实现冗余</p>
<p><strong>动态磁盘允许创建跨越多个物理硬盘的卷（这实际上就是一种软件RAID的实现）</strong></p>
<ul>
<li>
<p><strong>简单卷</strong></p>
<p>功能上等同于基础磁盘上的一个分区，但它只能在动态磁盘上创建</p>
</li>
<li>
<p><strong>跨区卷</strong></p>
<p>将来自多个物理磁盘上的未分配空间合并成一个巨大的卷</p>
<p>数据会先写满第一块盘的空间，然后再接着写到下一块盘，类似JBOD（Just a Bunch of Disks）概念</p>
</li>
<li>
<p><strong>带区卷</strong></p>
<p>将数据条带化地同时写入到多个物理磁盘上，以提高读写性能，等同于软件RAID0</p>
</li>
<li>
<p><strong>镜像卷</strong></p>
<p>将数据完全一致地写入到两块物理磁盘上，实现数据冗余，等同于软件RAID1</p>
</li>
<li>
<p><strong>RAID-5 卷</strong></p>
<p>将数据和奇偶校验信息条带化地分布到三个或更多的物理磁盘上，等同于软件RAID5</p>
</li>
</ul>
<p>它无需昂贵的硬件RAID卡，就能在操作系统层面实现RAID功能，管理非常灵活</p>
<p>但不好的是兼容性差，因为这是微软的专有技术，Linux和macOS系统通常无法原生识别动态磁盘卷</p>
<p>此外，从动态磁盘转换回基础磁盘，需要删除磁盘上的所有卷，会导致数据丢失</p>
<h1 id="驱动器drive">驱动器（Drive）
</h1><p>驱动器是指可以存储和访问数据的存储单元，它可以是分区、卷或者磁盘</p>
<p><strong>物理驱动器</strong>：真实存在的硬盘或固态盘</p>
<p><strong>逻辑驱动器</strong>：操作系统识别后的分区或者卷</p>
<p><strong>虚拟驱动器</strong>：通过工具在内存中创建的模拟磁盘，操作系统可像对待真实磁盘一样访问</p>
<h2 id="windows驱动器">Windows驱动器
</h2><p><strong>每一个驱动器都会有一个驱动器号</strong>，是Windows系统为方便用户访问而给卷分配的标识符，例如<code>C:</code>、<code>D:</code></p>
<p>我们完整看到的驱动器号过程应该是这样的：</p>
<p><strong>物理硬盘 → 分区 → 文件系统  → 卷 → 挂载 → 驱动器</strong></p>
<p>比如我们插入U盘，系统会识别分区，然后作为卷挂载，它是实打实的新的硬盘空间</p>
<p>而当用FTKImager这样的工具挂载镜像时，软件会在内存中创建一个虚拟磁盘，Windows会识别其中的卷，并给它分配一个驱动器号，之后就能在“我的电脑”里看到一个新盘符，空间来源就是镜像文件</p>
<h2 id="linux驱动器">Linux驱动器
</h2><p>驱动器不会用盘符标识，<strong>而是通过设备文件和挂载点来管理</strong>，比如<code>/dev/sda1</code>挂载到<code>/home</code></p>
<h1 id="挂载mount">挂载（Mount）
</h1><p><strong>挂载是将存储设备（磁盘、分区、镜像、容器等）接入文件系统，从而让用户和程序能够访问其内容的过程</strong></p>
<p>挂载前，设备的内容是孤立的，操作系统无法通过普通路径访问</p>
<p>挂载后，就可以通过某个路径访问设备里的数据了</p>
<h2 id="挂载点">挂载点
</h2><p><strong>是操作系统用来访问挂载设备的路径或位置</strong></p>
<p>在Linux通常是一个空目录，比如 <code>/mnt/usb</code>、<code>/media/cdrom</code></p>
<p>而Windows默认挂载方式是分配驱动器号，也可以挂载到空目录</p>
<h2 id="windows挂载">windows挂载
</h2><p>插入U盘、使用软件挂载镜像应该都很熟悉了，这里正好借着我添加移动硬盘的过程来说一下：</p>
<p>首先win+x组合键调出功能栏，打开磁盘管理</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251002005926909" href="http://picture.928330.xyz/typora/image-20251002005926909.png">
<img src="http://picture.928330.xyz/typora/image-20251002005926909.png" alt="image-20251002005926909"  />
</a>
</div>
</p>
<p>新的硬盘会显示未分配空间，是灰色的（我的分配好了），在这上面右键，选择新建简单卷：</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251002012039643" href="http://picture.928330.xyz/typora/image-20251002012039643.png">
<img src="http://picture.928330.xyz/typora/image-20251002012039643.png" alt="image-20251002012039643"  />
</a>
</div>
</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251002012052615" href="http://picture.928330.xyz/typora/image-20251002012052615.png">
<img src="http://picture.928330.xyz/typora/image-20251002012052615.png" alt="image-20251002012052615"  />
</a>
</div>
</p>
<p>一直下一步默认，其中会让你选择驱动器符号和填写磁盘名称，按自己的喜好来就行</p>
<h2 id="linux挂载">Linux挂载
</h2><p><strong>命令行挂载</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mount /dev/sdb1 /mnt/usb
</span></span></code></pre></div><p><code>/dev/sdb1</code>是要挂载的目标，<code>/mnt/usb</code>是挂载点</p>
<p><strong>查看挂载信息</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mount        <span style="color:#7f848e"># 查看当前所有挂载</span>
</span></span><span style="display:flex;"><span>df -h        <span style="color:#7f848e"># 查看挂载的设备及占用空间</span>
</span></span></code></pre></div><p><strong>卸载设备</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>umount /mnt/usb   <span style="color:#7f848e"># 或 umount /dev/sdb1</span>
</span></span></code></pre></div><p>Linux的文件系统是树结构，所有挂载都是挂在这个树上</p>
<h1 id="windows系统的物理盘与逻辑盘表示">Windows系统的物理盘与逻辑盘表示
</h1><h2 id="设备命名规则">设备命名规则
</h2><p>Windows的设备命名体现在不同的管理层级中</p>
<h3 id="物理磁盘层">物理磁盘层
</h3><p>这是Windows磁盘管理工具对整块物理硬盘的标识，是系统能识别到的最底层的物理存储单元</p>
<p><strong>命名方式</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e06c75">磁盘</span> &lt;<span style="color:#e06c75">X</span>&gt;
</span></span></code></pre></div><p><code>&lt;X&gt;</code>表示物理磁盘的编号，从<code>0</code>开始，由系统按检测顺序（通常是主板接口顺序）分配</p>
<p><strong>eg：</strong></p>
<ul>
<li><code>磁盘 0</code>：通常是系统启动盘</li>
<li><code>磁盘 1</code>：表示第二块物理硬盘</li>
</ul>
<h3 id="分区卷层">分区/卷层
</h3><p>物理磁盘上的划分区域</p>
<p>在磁盘管理中，它们被显示为图形化的数据块，位于对应的磁盘X行上</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251020231156991" href="http://picture.928330.xyz/typora/image-20251020231156991.png">
<img src="http://picture.928330.xyz/typora/image-20251020231156991.png" alt="image-20251020231156991"  />
</a>
</div>
</p>
<h3 id="驱动器号层">驱动器号层
</h3><p>这是Windows为用户提供的访问方式，它是一个快捷方式或挂载点，指向一个已格式化并激活的卷</p>
<p><strong>命名方式</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>&lt;<span style="color:#e06c75">X</span>&gt;:
</span></span></code></pre></div><p><code>&lt;X&gt;</code>表示一个字母（从<code>A</code>到<code>Z</code>）</p>
<p><strong>eg：</strong></p>
<ul>
<li><code>C:</code>：通常指向操作系统所在的活动主分区</li>
<li><code>E:</code>：可能指向一个数据分区，也可能指向一个U盘或光驱</li>
</ul>
<h3 id="guid卷路径">GUID卷路径
</h3><p>这是系统在后台真正用来识别卷的方式，它不受26个字母的限制</p>
<p>一个卷可以没有驱动器号，而是被挂载到一个NTFS文件系统中的空目录上，此时系统就是通过这个GUID路径来访问它的</p>
<p><strong>命名方式</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>\\?\<span style="color:#e06c75">Volume</span>{<span style="color:#e06c75">xxxxxxxx</span>-<span style="color:#e06c75">xxxx</span>-<span style="color:#e06c75">xxxx</span>-<span style="color:#e06c75">xxxx</span>-<span style="color:#e06c75">xxxxxxxxxxxx</span>}\
</span></span></code></pre></div><p><strong>eg：</strong></p>
<ul>
<li><code>\\?\Volume{4d582b1a-0000-0000-0000-100000000000}\</code></li>
</ul>
<h2 id="实例">实例
</h2><p>在Windows中，<code>diskpart</code>是一个命令行工具，可以清晰地展示磁盘和分区的层级关系</p>
<p>以下操作都需要管理员模式</p>
<p>启动<code>diskpart</code>后，使用<code>list disk</code>查看所有物理磁盘，再使用<code>select disk &lt;X&gt;</code>选择一块磁盘，用<code>list partition</code>查看其上的分区：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>diskpart
</span></span><span style="display:flex;"><span>list disk
</span></span><span style="display:flex;"><span><span style="color:#c678dd">select</span> disk <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>list partition
</span></span></code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251020225456849" href="http://picture.928330.xyz/typora/image-20251020225456849.png">
<img src="http://picture.928330.xyz/typora/image-20251020225456849.png" alt="image-20251020225456849"  />
</a>
</div>
</p>
<p>使用<code>mountvol</code>命令能查看卷的GUID路径：</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251021165423895" href="http://picture.928330.xyz/typora/image-20251021165423895.png">
<img src="http://picture.928330.xyz/typora/image-20251021165423895.png" alt="image-20251021165423895"  />
</a>
</div>
</p>
<p>也可以使用<code>powershell</code>命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">Get-CimInstance</span> <span style="color:#e06c75">-ClassName</span> <span style="color:#e06c75">Win32_Volume</span> | <span style="color:#e5c07b">Select-Object</span> <span style="color:#e06c75">DeviceID</span>, <span style="color:#e06c75">DriveLetter</span>, <span style="color:#e06c75">Label</span>, <span style="color:#e06c75">Capacity</span> | <span style="color:#e5c07b">Format-Table</span> <span style="color:#e06c75">-AutoSize</span>
</span></span></code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="image-20251021165730069" href="http://picture.928330.xyz/typora/image-20251021165730069.png">
<img src="http://picture.928330.xyz/typora/image-20251021165730069.png" alt="image-20251021165730069"  />
</a>
</div>
</p>
<h1 id="linux系统的物理盘与逻辑盘表示">Linux系统的物理盘与逻辑盘表示
</h1><p>在Linux的设计哲学中，有一个核心思想是“一切皆文件”，这意味着硬件设备，如硬盘、键盘、鼠标等，都会在文件系统中以一个特殊文件的形式存在</p>
<p>这些设备文件都集中存放在<code>/dev</code>目录（也就是device的意思）下，通过读写这些文件，就可以与对应的硬件设备进行交互</p>
<h2 id="设备命名规则-1">设备命名规则
</h2><p>一般格式：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/[<span style="color:#e06c75">设备类型</span>][<span style="color:#e06c75">磁盘序号</span>][<span style="color:#e06c75">分区号</span>]
</span></span></code></pre></div><h3 id="sd-通用硬盘">sd (通用硬盘)
</h3><p>这是最常见的前缀，源于 &ldquo;SCSI disk&rdquo;</p>
<p>它被广泛用于表示几乎所有类型的现代硬盘，包括SATA硬盘、SAS硬盘，甚至U盘和通过USB连接的移动硬盘</p>
<p><strong>其命名方式为：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sd</span>&lt;<span style="color:#e06c75">X</span>&gt;&lt;<span style="color:#e06c75">N</span>&gt;
</span></span></code></pre></div><ul>
<li><code>&lt;X&gt;</code>：表示<strong>磁盘序号的字母</strong> (<code>a</code>，<code>b</code>，<code>c</code>…)，按内核检测到的顺序分配</li>
<li><code>&lt;N&gt;</code>：表示该磁盘上的<strong>分区号</strong> (<code>1</code>，<code>2</code>，<code>3</code>…)，此部分是可选的，没有则代表整块硬盘</li>
</ul>
<p><strong>eg：</strong></p>
<ul>
<li><code>/dev/sda</code>：表示系统中第一块被识别的<code>sd</code>类型物理硬盘</li>
<li><code>/dev/sdb2</code>：表示第二块<code>sd</code>类型硬盘上的第2个分区</li>
</ul>
<h3 id="hdide硬盘">hd（IDE硬盘）
</h3><p>是&quot;Hard disk&quot;的缩写，这是早期用于表示IDE/PATA接口硬盘的前缀，在现代系统中已非常少见</p>
<p><strong>其命名方式基本和sd相同：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">hd</span>&lt;<span style="color:#e06c75">X</span>&gt;&lt;<span style="color:#e06c75">N</span>&gt;
</span></span></code></pre></div><ul>
<li><code>&lt;X&gt;</code>：表示<strong>磁盘序号的字母</strong> (<code>a</code>，<code>b</code>，<code>c</code>…)，按内核检测到的顺序分配</li>
<li><code>&lt;N&gt;</code>：表示该磁盘上的<strong>分区号</strong> (<code>1</code>，<code>2</code>，<code>3</code>…)，此部分是可选的，没有则代表整块硬盘</li>
</ul>
<p><strong>eg：</strong></p>
<ul>
<li><code>/dev/hda</code>：表示第一块IDE硬盘</li>
<li><code>/dev/hdb2</code>：表示第二块IDE硬盘上的第2个分区</li>
</ul>
<h3 id="vd虚拟化硬盘">vd（虚拟化硬盘）
</h3><p>是&quot;Virtual disk&quot;的缩写，常见于KVM等虚拟化环境中，代表分配给虚拟机的虚拟硬盘</p>
<p><strong>其命名方式也和sd大差不差：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">vd</span>&lt;<span style="color:#e06c75">X</span>&gt;&lt;<span style="color:#e06c75">N</span>&gt;
</span></span></code></pre></div><ul>
<li><code>&lt;X&gt;</code>：表示<strong>磁盘序号的字母</strong> (<code>a</code>，<code>b</code>，<code>c</code>…)，按内核检测到的顺序分配</li>
<li><code>&lt;N&gt;</code>：表示该磁盘上的<strong>分区号</strong> (<code>1</code>，<code>2</code>，<code>3</code>…)，此部分是可选的，没有则代表整块硬盘</li>
</ul>
<p><strong>eg：</strong></p>
<ul>
<li><code>/dev/vda</code>：表示分配给当前虚拟机的第一块虚拟硬盘</li>
<li><code>/dev/vdb1</code>：表示第二块虚拟硬盘上的第1个分区</li>
</ul>
<h3 id="nvmenvme固态硬盘">nvme（NVMe固态硬盘）
</h3><p>表示通过**NVMe (Non-Volatile Memory Express，非易失性存储器快速通道）**协议连接的高速固态硬盘</p>
<p><strong>其命名方式有些特殊：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">nvme</span>&lt;<span style="color:#e06c75">X</span>&gt;<span style="color:#e06c75">n</span>&lt;<span style="color:#e06c75">Y</span>&gt;<span style="color:#e06c75">p</span>&lt;<span style="color:#e06c75">Z</span>&gt;
</span></span></code></pre></div><ul>
<li><code>&lt;X&gt;</code>：表示NVMe<strong>控制器</strong>的序号，从<code>0</code>开始</li>
<li><code>n&lt;Y&gt;</code>：表示控制器下的<strong>命名空间</strong>（可以理解为磁盘），从<code>1</code>开始</li>
<li><code>p&lt;Z&gt;</code>：表示该磁盘上的<strong>分区号</strong>，从<code>1</code>开始</li>
</ul>
<p><strong>eg：</strong></p>
<ul>
<li><code>/dev/nvme0n1</code>：表示第0个控制器上的第1块NVMe磁盘</li>
<li><code>/dev/nvme1n2p2</code>：表示第1个控制器上的第2块NVMe磁盘上的第2个分区</li>
</ul>
<h3 id="mmcblkemmc--sd卡">mmcblk（eMMC / SD卡）
</h3><p>用于表示嵌入式设备中的存储，如eMMC闪存或SD/TF卡</p>
<p><strong>其命名方式也有点不同：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">mmcblk</span>&lt;<span style="color:#e06c75">X</span>&gt;<span style="color:#e06c75">p</span>&lt;<span style="color:#e06c75">Y</span>&gt;
</span></span></code></pre></div><ul>
<li><code>&lt;X&gt;</code>：表示eMMC/SD卡<strong>设备</strong>的序号，从<code>0</code>开始</li>
<li><code>p&lt;Y&gt;</code>：表示该设备上的<strong>分区号</strong>，从<code>1</code>开始</li>
</ul>
<p><strong>示例：</strong></p>
<ul>
<li><code>/dev/mmcblk0</code>：表示系统中第一张被识别的SD卡或eMMC芯片</li>
<li><code>/dev/mmcblk1p1</code>：表第二张卡上的第1个分区</li>
</ul>
<h2 id="实例-1">实例
</h2><p>在linux里使用<code>lsblk</code> (list block devices，列出块设备) 命令可以清晰地看到系统中的磁盘和分区结构</p>
<p>假设一台Linux服务器有两块SATA硬盘，<code>lsblk</code>的输出如下（我现有的linux机分盘都很少，杜撰一个吧）：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e06c75">NAME</span>   <span style="color:#e06c75">MAJ</span>:<span style="color:#e06c75">MIN</span> <span style="color:#e06c75">RM</span>   <span style="color:#e06c75">SIZE</span>      <span style="color:#e06c75">RO</span>   <span style="color:#e06c75">TYPE</span>   <span style="color:#e06c75">MOUNTPOINT</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">sda</span>             <span style="color:#d19a66">8</span>:<span style="color:#d19a66">0</span>        <span style="color:#d19a66">0</span>    <span style="color:#d19a66">238.5</span><span style="color:#e06c75">G</span>    <span style="color:#d19a66">0</span>     <span style="color:#e06c75">disk</span>                             <span style="color:#7f848e">// 第一块物理硬盘，总容量为238.5G
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>├─<span style="color:#e06c75">sda1</span>      <span style="color:#d19a66">8</span>:<span style="color:#d19a66">1</span>        <span style="color:#d19a66">0</span>     <span style="color:#d19a66">512</span><span style="color:#e06c75">M</span>     <span style="color:#d19a66">0</span>      <span style="color:#e06c75">part</span>     /<span style="color:#e06c75">boot</span>/<span style="color:#e06c75">efi</span>         <span style="color:#7f848e">// sda上的第一个分区，512M，被挂载到了/boot/efi目录
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>└─<span style="color:#e06c75">sda2</span>      <span style="color:#d19a66">8</span>:<span style="color:#d19a66">2</span>        <span style="color:#d19a66">0</span>     <span style="color:#d19a66">238</span><span style="color:#e06c75">G</span>      <span style="color:#d19a66">0</span>     <span style="color:#e06c75">part</span>     /					   <span style="color:#7f848e">// sda上的第二个分区，大小为238G，被挂载为根目录/
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#e06c75">sdb</span>             <span style="color:#d19a66">8</span>:<span style="color:#d19a66">16</span>      <span style="color:#d19a66">0</span>    <span style="color:#d19a66">931.5</span><span style="color:#e06c75">G</span>    <span style="color:#d19a66">0</span>     <span style="color:#e06c75">disk</span> 				 	 	   <span style="color:#7f848e">// 第二块物理硬盘，总容量为931.5G
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>└─<span style="color:#e06c75">sdb1</span>      <span style="color:#d19a66">8</span>:<span style="color:#d19a66">17</span>      <span style="color:#d19a66">0</span>    <span style="color:#d19a66">931.5</span><span style="color:#e06c75">G</span>    <span style="color:#d19a66">0</span>     <span style="color:#e06c75">part</span>   /<span style="color:#c678dd">data</span>				    <span style="color:#7f848e">// sdb上的第一个分区，931.5G，被挂载到了/data目录
</span></span></span></code></pre></div><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>列名</th>
          <th>含义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>NAME</strong></td>
          <td>设备名，例如<code>sda</code>，<code>sda1</code>等</td>
      </tr>
      <tr>
          <td><strong>MAJ:MIN</strong></td>
          <td>主设备号:次设备号，用于Linux内核识别设备</td>
      </tr>
      <tr>
          <td><strong>RM</strong></td>
          <td>是否为可移动设备（1是可移动，如U盘或光驱，0是固定磁盘）</td>
      </tr>
      <tr>
          <td><strong>SIZE</strong></td>
          <td>设备或分区的大小</td>
      </tr>
      <tr>
          <td><strong>RO</strong></td>
          <td>是否为只读（1是只读，0是可读写）</td>
      </tr>
      <tr>
          <td><strong>TYPE</strong></td>
          <td>设备类型</td>
      </tr>
      <tr>
          <td><strong>MOUNTPOINT</strong></td>
          <td>当前挂载点路径，没有挂载则为空</td>
      </tr>
  </tbody>
</table></div>
<h1 id="lvmlogical-volume-manager">LVM（Logical Volume Manager）
</h1><p>在传统的磁盘管理中，一个分区的大小在创建时就已固定，如果未来空间不足，调整起来会非常麻烦</p>
<p>为了解决这个问题，Linux引入了新的磁盘管理机制——<strong>LVM（Logical Volume Manager，逻辑卷管理器）</strong></p>
<p>LVM的核心思想是引入一个抽象层，不再让操作系统直接使用固定的物理分区，而是通过LVM这个中间层来灵活地组织和分配存储空间，整个操作就像搭积木一样，可增可减</p>
<h2 id="lvm的核心组件">LVM的核心组件
</h2><p>要理解LVM，我们需要先了解它的三个基本概念，这三个概念是自底向上构建起来的</p>
<h3 id="物理卷-physical-volume-pv">物理卷 (Physical Volume, PV)
</h3><p><strong>这是LVM的最底层组件，是LVM用来构建存储池的原材料</strong></p>
<p>通常是一个完整的物理硬盘（如<code>/dev/sdb</code>）或一个物理分区（如<code>/dev/sdb1</code>）</p>
<p>需要使用<code>pvcreate</code>命令将一个分区初始化或标记为物理卷，才能让LVM识别它</p>
<p>**eg：**将<code>/dev/sdb1</code>和<code>/dev/sdc1</code>两个分区标记为PV：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pvcreate /dev/sdb1
</span></span><span style="display:flex;"><span>pvcreate /dev/sdc1
</span></span></code></pre></div><h3 id="卷组-volume-group-vg">卷组 (Volume Group, VG)
</h3><p><strong>这是一个巨大的存储池，由一个或多个PV组合而成</strong></p>
<p>使用<code>vgcreate</code>命令创建一个卷组，将多个PV捆绑在一起</p>
<p>例如，我们可以将两个1TB的PV合并成一个2TB的VG</p>
<p>**eg：**创建一个名为<code>my_vg</code>的卷组，它由<code>/dev/sdb1</code>和<code>/dev/sdc1</code>组成</p>
<pre tabindex="0"><code>vgcreate my_vg /dev/sdb1 /dev/sdc1
</code></pre><h3 id="逻辑卷-logical-volume-lv">逻辑卷 (Logical Volume, LV)
</h3><p><strong>这是最终交付给操作系统使用的分区，也就是我们最终会格式化并挂载的设备</strong></p>
<p>LVM从VG这个大存储池中切割出来的一块空间</p>
<p>使用<code>lvcreate</code>命令从VG中按需创建任意大小的逻辑卷</p>
<p>**eg：**从<code>my_vg</code>卷组中，创建一个名为<code>data_lv</code>、大小为50G的逻辑卷</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bash" data-lang="Bash"><span style="display:flex;"><span>lvcreate -n data_lv -L 50G my_vg
</span></span></code></pre></div><h3 id="物理扩展块-physical-extent-pe">物理扩展块 (Physical Extent, PE)
</h3><p><strong>PE是LVM中可以分配的最小存储单元，可以理解为LVM用来构建逻辑卷的积木</strong></p>
<p>当一个PV被添加到一个VG中时，这个PV就会在内部被分割成许多大小相等的PE块</p>
<p>PE的大小在创建卷组时确定，<strong>默认为4MB</strong>，并且同一个卷组中所有PE的大小都必须一致</p>
<p>这个机制就是LVM灵活性的来源！</p>
<p>一个VG的总容量，就是其下所有物理卷PV提供的PE的总和</p>
<p>一个LV的大小，就是分配给它的PE的数量</p>
<p>扩容一个LV，本质上就是从VG的空闲PE池中再拿几块拼上去，缩容就是把还几块回去</p>
<h3 id="逻辑扩展块-logical-extent-le">逻辑扩展块 (Logical Extent, LE)
</h3><p><strong>LE是构成LV的最小存储单元，是逻辑卷层面的积木</strong></p>
<p><strong>LE的大小与PE的大小在同一个VG中是完全相同的，如果一个VG的PE大小被设为4MB，那么该VG中所有LV的LE大小也必须是4MB</strong></p>
<p>LVM的本质工作，就是建立一个LE到PE的映射表</p>
<p>当创建一个逻辑卷时，LVM会分配给它一定数量的LE，然后LVM会在元数据中记录下这100个LE分别对应到哪个物理卷PV上的哪100个PE</p>
<p><strong>eg：</strong></p>
<ul>
<li><code>data_lv</code>的<code>LE 1</code>  -&gt; 映射到 -&gt; <code>sda2</code>的<code>PE 50</code></li>
<li><code>data_lv</code>的<code>LE 2</code>  -&gt; 映射到 -&gt; <code>sdb1</code>的<code>PE 108</code>（这就是跨盘的实现）</li>
</ul>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" data-caption="linux下进行lvm分区及扩容_lvm扩容-CSDN博客" href="http://picture.928330.xyz/typora/63b600b16df046dd86778e5db2c12a55.jpeg">
<img src="http://picture.928330.xyz/typora/63b600b16df046dd86778e5db2c12a55.jpeg" alt="linux下进行lvm分区及扩容_lvm扩容-CSDN博客"  />
</a>
</div>
</p>
<h2 id="lvm设备命名">LVM设备命名
</h2><p>传统的路径是：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e06c75">物理硬盘</span> → <span style="color:#e06c75">分区</span> (/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda1</span>) → <span style="color:#e06c75">格式化</span> → <span style="color:#e06c75">挂载</span>
</span></span></code></pre></div><p>而使用LVM后的路径是：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e06c75">物理硬盘</span> → <span style="color:#e06c75">分区</span> (/<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda1</span>) → <span style="color:#e06c75">PV</span> → <span style="color:#e06c75">VG</span> → <span style="color:#e06c75">LV</span> → <span style="color:#e06c75">格式化</span> → <span style="color:#e06c75">挂载</span>
</span></span></code></pre></div><p>LVM创建的LV设备名通常位于<code>/dev/</code>目录下，并以其所属的VG命名：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>/<span style="color:#e06c75">dev</span>/&lt;<span style="color:#e06c75">VG_Name</span>&gt;/&lt;<span style="color:#e06c75">LV_Name</span>&gt;
</span></span></code></pre></div><p><strong>eg：</strong></p>
<ul>
<li><code>/dev/my_vg/data_lv</code>：表示从<code>my_vg</code>卷组中切分出来的，名为<code>data_lv</code>的逻辑卷</li>
<li><code>/dev/ubuntu_vg/root</code>：这很可能是一个Ubuntu系统安装在LVM上的根分区</li>
</ul>
<p>这种路径实际上是一个方便访问的符号链接，它真正指向的设备路径位于<code>/dev/mapper/</code>下，例如<code>/dev/mapper/my_vg-data_lv</code></p>
<h2 id="lvm信息查看">LVM信息查看
</h2><h3 id="查看磁盘类型">查看磁盘类型
</h3><p>LVM结构同样可以在<code>lsblk</code>命令中清晰地看到，它会显示为一种<code>lvm</code>类型：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Kotlin" data-lang="Kotlin"><span style="display:flex;"><span><span style="color:#e06c75">NAME</span>                    <span style="color:#e06c75">MAJ</span>:<span style="color:#e06c75">MIN</span>     <span style="color:#e06c75">RM</span>    <span style="color:#e06c75">SIZE</span>     <span style="color:#e06c75">RO</span>     <span style="color:#e06c75">TYPE</span>     <span style="color:#e06c75">MOUNTPOINT</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">sda</span>                              <span style="color:#d19a66">8</span>:<span style="color:#d19a66">0</span>            <span style="color:#d19a66">0</span>     <span style="color:#d19a66">100</span><span style="color:#e06c75">G</span>      <span style="color:#d19a66">0</span>      <span style="color:#e06c75">disk</span> 
</span></span><span style="display:flex;"><span>├─<span style="color:#e06c75">sda1</span>                       <span style="color:#d19a66">8</span>:<span style="color:#d19a66">1</span>            <span style="color:#d19a66">0</span>       <span style="color:#d19a66">1</span><span style="color:#e06c75">G</span>        <span style="color:#d19a66">0</span>       <span style="color:#e06c75">part</span>       /<span style="color:#e06c75">boot</span>
</span></span><span style="display:flex;"><span>└─<span style="color:#e06c75">sda2</span>                       <span style="color:#d19a66">8</span>:<span style="color:#d19a66">2</span>            <span style="color:#d19a66">0</span>      <span style="color:#d19a66">99</span><span style="color:#e06c75">G</span>       <span style="color:#d19a66">0</span>       <span style="color:#e06c75">part</span>                              <span style="color:#7f848e">// sda2被标记为PV
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  └─<span style="color:#e06c75">my_vg</span>-<span style="color:#e06c75">data_lv</span>   <span style="color:#d19a66">253</span>:<span style="color:#d19a66">0</span>           <span style="color:#d19a66">0</span>      <span style="color:#d19a66">50</span><span style="color:#e06c75">G</span>       <span style="color:#d19a66">0</span>       <span style="color:#e06c75">lvm</span>        /<span style="color:#c678dd">data</span>              <span style="color:#7f848e">// 从my_vg中切分的data_lv
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  └─<span style="color:#e06c75">my_vg</span>-<span style="color:#e06c75">web_lv</span>    <span style="color:#d19a66">253</span>:<span style="color:#d19a66">1</span>          <span style="color:#d19a66">0</span>      <span style="color:#d19a66">49</span><span style="color:#e06c75">G</span>       <span style="color:#d19a66">0</span>       <span style="color:#e06c75">lvm</span>        /<span style="color:#c678dd">var</span>/<span style="color:#e06c75">www</span>       <span style="color:#7f848e">// 从my_vg中切分的web_lv
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#e06c75">sdb</span>                             <span style="color:#d19a66">8</span>:<span style="color:#d19a66">16</span>           <span style="color:#d19a66">0</span>     <span style="color:#d19a66">200</span><span style="color:#e06c75">G</span>      <span style="color:#d19a66">0</span>       <span style="color:#e06c75">disk</span>
</span></span><span style="display:flex;"><span>└─<span style="color:#e06c75">sdb1</span>                       <span style="color:#d19a66">8</span>:<span style="color:#d19a66">17</span>          <span style="color:#d19a66">0</span>     <span style="color:#d19a66">200</span><span style="color:#e06c75">G</span>      <span style="color:#d19a66">0</span>       <span style="color:#e06c75">part</span>                 		     <span style="color:#7f848e">// sdb1也被标记为PV
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  └─<span style="color:#e06c75">my_vg</span>-<span style="color:#e06c75">data_lv</span>    <span style="color:#d19a66">253</span>:<span style="color:#d19a66">0</span>          <span style="color:#d19a66">0</span>      <span style="color:#d19a66">50</span><span style="color:#e06c75">G</span>       <span style="color:#d19a66">0</span>       <span style="color:#e06c75">lvm</span>        /<span style="color:#c678dd">data</span>              <span style="color:#7f848e">// 注意：data_lv跨越了sda2和sdb1
</span></span></span></code></pre></div><h3 id="总览lvm各层">总览lvm各层
</h3><p>LVM还提供了一套专属命令来查看状态：</p>
<ul>
<li>
<p><strong><code>pvs</code>：列出所有物理卷</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span>                <span style="color:#e06c75">VG</span>           <span style="color:#e06c75">Fmt</span>            <span style="color:#e06c75">Attr</span>         <span style="color:#e06c75">PSize</span>          <span style="color:#e06c75">PFree</span> 
</span></span><span style="display:flex;"><span>  /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>  <span style="color:#e06c75">my_vg</span>       <span style="color:#e06c75">lvm2</span>           <span style="color:#e06c75">a</span><span style="color:#56b6c2">--</span>           <span style="color:#d19a66">99.00</span><span style="color:#e06c75">g</span>          <span style="color:#d19a66">0</span> 
</span></span><span style="display:flex;"><span>  /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sdb1</span>  <span style="color:#e06c75">my_vg</span>       <span style="color:#e06c75">lvm2</span>           <span style="color:#e06c75">a</span><span style="color:#56b6c2">--</span>          <span style="color:#d19a66">200.00</span><span style="color:#e06c75">g</span>     <span style="color:#d19a66">100.00</span><span style="color:#e06c75">g</span>
</span></span></code></pre></div></li>
<li>
<p><strong><code>vgs</code>：列出所有卷组</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span>       #<span style="color:#e06c75">PV</span>    #<span style="color:#e06c75">LV</span>     #<span style="color:#e06c75">SN</span>     <span style="color:#e06c75">Attr</span>         <span style="color:#e06c75">VSize</span>         <span style="color:#e06c75">VFree</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">my_vg</span>   <span style="color:#d19a66">2</span>         <span style="color:#d19a66">2</span>          <span style="color:#d19a66">0</span>      <span style="color:#e06c75">wz</span><span style="color:#56b6c2">--</span><span style="color:#e06c75">n</span>     <span style="color:#d19a66">299.00</span><span style="color:#e06c75">g</span>      <span style="color:#d19a66">100.00</span><span style="color:#e06c75">g</span>
</span></span></code></pre></div></li>
<li>
<p><strong><code>lvs</code>：列出所有逻辑卷</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span>              <span style="color:#e06c75">VG</span>           <span style="color:#e06c75">Attr</span>         <span style="color:#e06c75">LSize</span>  <span style="color:#e06c75">Pool</span> <span style="color:#e06c75">Origin</span> <span style="color:#e06c75">Data</span>%  <span style="color:#e06c75">Meta</span>%
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">data_lv</span>    <span style="color:#e06c75">my_vg</span>    -<span style="color:#e06c75">wi</span>-<span style="color:#e06c75">a</span><span style="color:#56b6c2">----</span>-   <span style="color:#d19a66">50.00</span><span style="color:#e06c75">g</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">web_lv</span>     <span style="color:#e06c75">my_vg</span>    -<span style="color:#e06c75">wi</span>-<span style="color:#e06c75">a</span><span style="color:#56b6c2">----</span>-  <span style="color:#d19a66">49.00</span><span style="color:#e06c75">g</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="查看pv信息">查看PV信息
</h3><p>此命令用于显示物理卷（PV）的详细属性</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pvdisplay /dev/sda2
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">volume</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span> <span style="color:#e06c75">Name</span>               /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>               <span style="color:#e06c75">my_vg</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">99.00</span> <span style="color:#e06c75">GiB</span> / <span style="color:#e06c75">not</span> <span style="color:#e06c75">usable</span> <span style="color:#d19a66">0</span>   
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Allocatable</span>           <span style="color:#e06c75">yes</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PE</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">4.00</span> <span style="color:#e06c75">MiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Total</span> <span style="color:#e06c75">PE</span>              <span style="color:#d19a66">25343</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Free</span> <span style="color:#e06c75">PE</span>               <span style="color:#d19a66">12543</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Allocated</span> <span style="color:#e06c75">PE</span>          <span style="color:#d19a66">12800</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span> <span style="color:#e06c75">UUID</span>               <span style="color:#d19a66">7</span><span style="color:#e06c75">AjK3x</span>-<span style="color:#e06c75">yB97</span>-<span style="color:#d19a66">6</span><span style="color:#e06c75">aZB</span>-<span style="color:#e06c75">v2i4</span>-<span style="color:#d19a66">3</span><span style="color:#e06c75">pzv</span>-<span style="color:#e06c75">vRSS</span>-<span style="color:#e06c75">kPFSv4</span>
</span></span></code></pre></div><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>字段</th>
          <th>含义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>PV Name</strong></td>
          <td>物理卷设备路径（如 <code>/dev/sda3</code>）</td>
      </tr>
      <tr>
          <td><strong>VG Name</strong></td>
          <td>该 PV 所属的卷组（如 <code>pve</code>）</td>
      </tr>
      <tr>
          <td><strong>PV Size</strong></td>
          <td>物理卷总大小</td>
      </tr>
      <tr>
          <td><strong>Allocatable</strong></td>
          <td>是否可用于分配给 LV</td>
      </tr>
      <tr>
          <td><strong>PE Size</strong></td>
          <td>每个物理扩展块（PE）的大小，通常是 4 MB</td>
      </tr>
      <tr>
          <td><strong>Total PE</strong></td>
          <td>总共有多少个 PE（相当于总块数）</td>
      </tr>
      <tr>
          <td><strong>Free PE</strong></td>
          <td>未分配的 PE 数</td>
      </tr>
      <tr>
          <td><strong>Allocated PE</strong></td>
          <td>已被 LV 使用的 PE 数</td>
      </tr>
      <tr>
          <td><strong>PV UUID</strong></td>
          <td>每个 PV 的唯一标识符</td>
      </tr>
  </tbody>
</table></div>
<p><strong>附带<code>-m</code>参数，可以查看一个PV所属VG、有多少PE、每个PE分配到了哪个LV，又对应哪个LE：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">volume</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span> <span style="color:#e06c75">Name</span>               /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>               <span style="color:#e06c75">pve</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PV</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">100.00</span> <span style="color:#e06c75">GiB</span> / <span style="color:#e06c75">not</span> <span style="color:#e06c75">usable</span> <span style="color:#d19a66">4.00</span> <span style="color:#e06c75">MiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Allocatable</span>           <span style="color:#e06c75">yes</span> (<span style="color:#e06c75">but</span> <span style="color:#e06c75">full</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PE</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">4.00</span> <span style="color:#e06c75">MiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Total</span> <span style="color:#e06c75">PE</span>              <span style="color:#d19a66">25599</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Free</span> <span style="color:#e06c75">PE</span>               <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Allocated</span> <span style="color:#e06c75">PE</span>          <span style="color:#d19a66">25599</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">Segments</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">extent</span> <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">5119</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span>      /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#e06c75">root</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">extents</span>     <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">5119</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">extent</span> <span style="color:#d19a66">5120</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">10239</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span>      /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#c678dd">data</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">extents</span>     <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">5119</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">extent</span> <span style="color:#d19a66">10240</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">25599</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span>      /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#e06c75">swap</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">extents</span>     <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">15359</span>
</span></span></code></pre></div><ul>
<li>
<p><strong><code>Physical extent 0 to 5119</code></strong></p>
<p>表示当前PV上的PE编号是0–5119</p>
</li>
<li>
<p><strong><code>Logical volume  /dev/pve/root</code></strong></p>
<p>这些PE目前被逻辑卷<code>/dev/pve/root</code>使用</p>
</li>
<li>
<p><strong><code>Logical extents 0 to 5119</code></strong></p>
<p>逻辑卷<code>/dev/pve/root</code>中的LE编号0–5119映射到的PE编号为0–5119</p>
</li>
</ul>
<h3 id="查看vg信息">查看VG信息
</h3><p><strong>显示卷组（VG）的详细属性：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vgdisplay my_vg
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Volume</span> <span style="color:#e06c75">group</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>               <span style="color:#e06c75">my_vg</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">System</span> <span style="color:#e06c75">ID</span>             
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Format</span>                <span style="color:#e06c75">lvm2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Metadata</span> <span style="color:#e06c75">Areas</span>        <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Metadata</span> <span style="color:#e06c75">Sectors</span>      <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Status</span>                <span style="color:#e06c75">resizable</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">MAX</span> <span style="color:#e06c75">LV</span>                <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Cur</span> <span style="color:#e06c75">LV</span>                <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Open</span> <span style="color:#e06c75">LV</span>               <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">MAX</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Cur</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Act</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">299.00</span> <span style="color:#e06c75">GiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PE</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">4.00</span> <span style="color:#e06c75">MiB</span>    <span style="color:#7f848e">// &lt;--- 核心：PE的大小
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  <span style="color:#e06c75">Total</span> <span style="color:#e06c75">PE</span>              <span style="color:#d19a66">76543</span>       <span style="color:#7f848e">// &lt;--- 核心：PE总数
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  <span style="color:#e06c75">Alloc</span> <span style="color:#e06c75">PE</span> / <span style="color:#e06c75">Size</span>       <span style="color:#d19a66">50943</span> / <span style="color:#d19a66">199.00</span> <span style="color:#e06c75">GiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Free</span>  <span style="color:#e06c75">PE</span> / <span style="color:#e06c75">Size</span>       <span style="color:#d19a66">25600</span> / <span style="color:#d19a66">100.00</span> <span style="color:#e06c75">GiB</span>  <span style="color:#7f848e">// &lt;--- 核心：整个VG的空闲PE
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">UUID</span>               <span style="color:#e06c75">cM893Z</span>-<span style="color:#e06c75">px8A</span>-<span style="color:#d19a66">2</span><span style="color:#e06c75">Cxq</span>-<span style="color:#e06c75">yq89</span>-<span style="color:#e06c75">v9yO</span>-<span style="color:#e06c75">TYIx</span>-<span style="color:#e06c75">pCcAhQ</span>
</span></span></code></pre></div><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>字段</th>
          <th>含义</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>VG Name</strong></td>
          <td>卷组名（如 <code>pve</code>）</td>
      </tr>
      <tr>
          <td><strong>Format</strong></td>
          <td>LVM 版本（通常是 <code>lvm2</code>）</td>
      </tr>
      <tr>
          <td><strong>Cur LV</strong></td>
          <td>当前卷组中包含的逻辑卷数量</td>
      </tr>
      <tr>
          <td><strong>Cur PV</strong></td>
          <td>卷组包含的物理卷数量</td>
      </tr>
      <tr>
          <td><strong>VG Size</strong></td>
          <td>卷组总大小</td>
      </tr>
      <tr>
          <td><strong>PE Size</strong></td>
          <td>每个 PE 的大小（与 PV 相同）</td>
      </tr>
      <tr>
          <td><strong>Total PE</strong></td>
          <td>卷组中 PE 总数</td>
      </tr>
      <tr>
          <td><strong>Alloc PE / Size</strong></td>
          <td>已分配给 LV 的 PE 数及其总大小</td>
      </tr>
      <tr>
          <td><strong>Free PE / Size</strong></td>
          <td>剩余可用 PE 数及其大小</td>
      </tr>
      <tr>
          <td><strong>VG UUID</strong></td>
          <td>卷组唯一标识符</td>
      </tr>
  </tbody>
</table></div>
<p><strong>附带<code>-m</code>参数，可以查看一个VG内部包含的PV和LV，以及他们之间的PE/LE映射：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span> <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Volume</span> <span style="color:#e06c75">group</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>               <span style="color:#e06c75">pve</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">System</span> <span style="color:#e06c75">ID</span>             
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Format</span>                <span style="color:#e06c75">lvm2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Metadata</span> <span style="color:#e06c75">Areas</span>        <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Metadata</span> <span style="color:#e06c75">Sequence</span> <span style="color:#e06c75">No</span>  <span style="color:#d19a66">12</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Access</span>             <span style="color:#e06c75">read</span>/<span style="color:#e06c75">write</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Status</span>             <span style="color:#e06c75">resizable</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">MAX</span> <span style="color:#e06c75">LV</span>                <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Cur</span> <span style="color:#e06c75">LV</span>                <span style="color:#d19a66">3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Open</span> <span style="color:#e06c75">LV</span>               <span style="color:#d19a66">3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Max</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Cur</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Act</span> <span style="color:#e06c75">PV</span>                <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">100.00</span> <span style="color:#e06c75">GiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">PE</span> <span style="color:#e06c75">Size</span>               <span style="color:#d19a66">4.00</span> <span style="color:#e06c75">MiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Total</span> <span style="color:#e06c75">PE</span>              <span style="color:#d19a66">25599</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Alloc</span> <span style="color:#e06c75">PE</span> / <span style="color:#e06c75">Size</span>       <span style="color:#d19a66">25599</span> / <span style="color:#d19a66">100.00</span> <span style="color:#e06c75">GiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Free</span>  <span style="color:#e06c75">PE</span> / <span style="color:#e06c75">Size</span>       <span style="color:#d19a66">0</span> / <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">UUID</span>               <span style="color:#d19a66">2F</span><span style="color:#e06c75">b4</span>-<span style="color:#e06c75">Xt4n</span>-<span style="color:#d19a66">7</span><span style="color:#e06c75">xjM</span>-<span style="color:#e06c75">J0b9</span>-<span style="color:#d19a66">5</span><span style="color:#e06c75">b11</span>-<span style="color:#d19a66">9</span><span style="color:#e06c75">n8m</span>-<span style="color:#d19a66">3</span><span style="color:#e06c75">cA8p1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span> <span style="color:#e06c75">mapping</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Name</span>                /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#e06c75">root</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">LE</span> <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">5119</span> <span style="color:#e06c75">mapped</span> <span style="color:#e06c75">to</span> /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>: <span style="color:#d19a66">0</span>-<span style="color:#d19a66">5119</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Name</span>                /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#c678dd">data</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">LE</span> <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">5119</span> <span style="color:#e06c75">mapped</span> <span style="color:#e06c75">to</span> /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>: <span style="color:#d19a66">5120</span>-<span style="color:#d19a66">10239</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Name</span>                /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">pve</span>/<span style="color:#e06c75">swap</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">LE</span> <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">15359</span> <span style="color:#e06c75">mapped</span> <span style="color:#e06c75">to</span> /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>: <span style="color:#d19a66">10240</span>-<span style="color:#d19a66">25599</span>
</span></span></code></pre></div><ul>
<li>
<p><strong><code>LV Name /dev/pve/root</code></strong></p>
<p>该LV的名字是<code>/dev/pve/root</code>，它属于卷组<code>pve</code>，通常挂载为系统根分区<code>/</code></p>
</li>
<li>
<p><strong><code>LE 0 to 5119 mapped to /dev/sda2: 0-5119</code></strong></p>
<p>这个LV的LE编号从0到5119，总共有5120个LE，映射到物理卷<code>/dev/sda2</code>上的PE编号为0到5119</p>
</li>
</ul>
<h3 id="查看lv信息">查看LV信息
</h3><p><strong>显示逻辑卷（LV）的详细属性：</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lvdisplay /dev/my_vg/data_lv
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Path</span>                /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">my_vg</span>/<span style="color:#e06c75">data_lv</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Name</span>                <span style="color:#e06c75">data_lv</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>                <span style="color:#e06c75">my_vg</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">UUID</span>                <span style="color:#e06c75">aBcDeF</span>-<span style="color:#56b6c2">....</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Write</span> <span style="color:#e06c75">Access</span>        <span style="color:#e06c75">read</span>/<span style="color:#e06c75">write</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Creation</span> <span style="color:#e06c75">host</span>, <span style="color:#e06c75">time</span> <span style="color:#e06c75">hostname</span>, <span style="color:#d19a66">2025</span>-<span style="color:#d19a66">10</span>-<span style="color:#d19a66">21</span> <span style="color:#56b6c2">..</span>.
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Status</span>              <span style="color:#e06c75">available</span>
</span></span><span style="display:flex;"><span>  # <span style="color:#c678dd">open</span>                 <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Size</span>                <span style="color:#d19a66">50.00</span> <span style="color:#e06c75">GiB</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Current</span> <span style="color:#e06c75">LE</span>             <span style="color:#d19a66">12800</span>       <span style="color:#7f848e">// &lt;--- 核心：这个LV由12800个LE组成
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  <span style="color:#e06c75">Segments</span>               <span style="color:#d19a66">2</span>           <span style="color:#7f848e">// &lt;--- 核心：这个LV由2个段落组成（跨盘了）
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>  <span style="color:#e06c75">Allocation</span>             <span style="color:#e06c75">inherit</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Read</span> <span style="color:#e06c75">ahead</span> <span style="color:#e06c75">sectors</span>     <span style="color:#e06c75">auto</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#e06c75">currently</span> <span style="color:#c678dd">set</span> <span style="color:#e06c75">to</span>     <span style="color:#d19a66">8192</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Block</span> <span style="color:#e06c75">device</span>           <span style="color:#d19a66">253</span>:<span style="color:#d19a66">0</span>
</span></span></code></pre></div><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th><strong>字段</strong></th>
          <th><strong>含义</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>LV Path</strong></td>
          <td>逻辑卷的设备路径</td>
      </tr>
      <tr>
          <td><strong>LV Name</strong></td>
          <td>逻辑卷的名称</td>
      </tr>
      <tr>
          <td><strong>VG Name</strong></td>
          <td>此逻辑卷所属的 VG</td>
      </tr>
      <tr>
          <td><strong>LV Status</strong></td>
          <td>状态（<code>available</code>表示可用）</td>
      </tr>
      <tr>
          <td><strong># open</strong></td>
          <td>当前被打开（挂载）的次数</td>
      </tr>
      <tr>
          <td><strong>LV Size</strong></td>
          <td>逻辑卷的总大小</td>
      </tr>
      <tr>
          <td><strong>Current LE</strong></td>
          <td>此逻辑卷由多少个LE组成</td>
      </tr>
      <tr>
          <td><strong>Segments</strong></td>
          <td>此逻辑卷由多少个物理段落组成<br />如果值&gt;1，通常意味着它跨越了多块物理硬盘</td>
      </tr>
  </tbody>
</table></div>
<p><strong>附带<code>-m</code>参数，可以查看一个LV是如何映射到LE和PE上的</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lvdisplay -m /dev/my_vg/data_lv
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Kotlin" data-lang="Kotlin"><span style="display:flex;"><span>  <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">volume</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">LV</span> <span style="color:#e06c75">Path</span>                /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">my_vg</span>/<span style="color:#e06c75">data_lv</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">VG</span> <span style="color:#e06c75">Name</span>                <span style="color:#e06c75">my_vg</span>
</span></span><span style="display:flex;"><span>  <span style="color:#56b6c2">..</span>. (<span style="color:#e06c75">其他信息</span>) <span style="color:#56b6c2">..</span>.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#56b6c2">--</span>- <span style="color:#e06c75">Segments</span> <span style="color:#56b6c2">--</span>-
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Segment</span> <span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">extent</span> <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">12799</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Type</span>                <span style="color:#e06c75">linear</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">volume</span>     /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sda2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">extents</span>    <span style="color:#d19a66">0</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">12799</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">Segment</span> <span style="color:#d19a66">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">Logical</span> <span style="color:#e06c75">extent</span> <span style="color:#d19a66">12800</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">25599</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Type</span>                <span style="color:#e06c75">linear</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">volume</span>     /<span style="color:#e06c75">dev</span>/<span style="color:#e06c75">sdb1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">Physical</span> <span style="color:#e06c75">extents</span>    <span style="color:#d19a66">10240</span> <span style="color:#e06c75">to</span> <span style="color:#d19a66">22039</span>
</span></span></code></pre></div><ul>
<li>
<p><strong><code>--- Segments ---</code></strong></p>
<p>这表示<code>data_lv</code>这个逻辑卷由两个段组成（因为它跨越了两块盘）</p>
</li>
<li>
<p><strong>Segment 1</strong>：</p>
<ul>
<li><code>Logical extent 0 to 12799</code>：表示这个LV的第0到12799号LE</li>
<li><code>Physical volume /dev/sda2</code>：这部分数据**存储在<code>/dev/sda2</code>**这个PV上</li>
<li><code>Physical extents 0 to 12799</code>：它对应着<code>/dev/sda2</code>上的第0到12799号PE</li>
</ul>
</li>
<li>
<p><strong>Segment 2</strong>：</p>
<ul>
<li>
<p><code>Logical extent 12800 to 25599</code>：表示这个LV的第12800到25599号LE</p>
</li>
<li>
<p><code>Physical volume /dev/sdb1</code>：这部分数据**存储在<code>/dev/sdb1</code>**这个PV上</p>
</li>
<li>
<p><code>Physical extents 10240 to 22039</code>：它对应着<code>/dev/sdb1</code>上的第10240到22039号PE</p>
<p><strong>注意，这里的PE编号是相对于PV的，不一定从0开始，取决于这个PV的PE使用情况</strong></p>
</li>
</ul>
</li>
</ul>
<h2 id="lvm元数据的存储位置">LVM元数据的存储位置
</h2><p><strong>LVM元数据绝大部分都是以人类可读的明文形式直接记录在磁盘上</strong></p>
<p>这些信息被存储在LVM的一个专属区域中，位于每一个PV的头部</p>
<p>一个PV的头部结构大致如下：</p>
<ol>
<li>
<p><strong>LVM 标签</strong></p>
<p>这是一个二进制的数据块，有魔数，也记录了元数据区的偏移量和大小</p>
</li>
<li>
<p>**LVM元数据区 **</p>
<p>它包含一个头部信息（描述元数据本身）和紧随其后纯文本配置块</p>
</li>
<li>
<p><strong>数据区</strong></p>
<p>紧跟在元数据区之后，是真正存储用户数据的区域，被划分成一个个PE</p>
</li>
</ol>
<p>具体位置在网上没找到统一的说法，如果无法使用命令查看，就磁盘搜索<code>metadata</code>、VG名称之类的标志性字段吧</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/forensics/">Forensics</a>
        
            <a href="/tags/windows/">Windows</a>
        
            <a href="/tags/linux/">Linux</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            最后更新于 2025-10-22
        </span>
    </section></footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E5%B8%B8%E8%A7%81%E6%A3%80%E6%9D%90%E7%B1%BB%E5%9E%8B/">
        
        
            <div class="article-image">
                
                    <img src="http://picture.928330.xyz/typora/2f56641afcc38e8ed63fa3beb6d312cc.jpg" loading="lazy" data-key="" data-hash="http://picture.928330.xyz/typora/2f56641afcc38e8ed63fa3beb6d312cc.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">常见检材类型</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/raid%E4%B8%8E%E5%AE%83%E7%9A%84%E9%87%8D%E7%BB%84/">
        
        
            <div class="article-image">
                
                    <img src="http://picture.928330.xyz/typora/56ab540a33f6eab79937c1187dd72855.jpg" loading="lazy" data-key="" data-hash="http://picture.928330.xyz/typora/56ab540a33f6eab79937c1187dd72855.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">RAID与它的重组</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E4%B8%80%E6%96%87%E5%BC%84%E6%87%82%E5%AD%97%E7%AC%A6%E9%9B%86%E4%B8%8E%E7%BC%96%E7%A0%81/">
        
        
            <div class="article-image">
                
                    <img src="http://picture.928330.xyz/typora/unicode-101-introduction.social.jpg" loading="lazy" data-key="" data-hash="http://picture.928330.xyz/typora/unicode-101-introduction.social.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">一文弄懂字符集与编码</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8B/">
        
        
            <div class="article-image">
                
                    <img src="http://picture.928330.xyz/typora/e9431f0af289cbee8312463acd321a66.jpg" loading="lazy" data-key="" data-hash="http://picture.928330.xyz/typora/e9431f0af289cbee8312463acd321a66.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">windows相关知识总结（下）</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/">
        
        
            <div class="article-image">
                
                    <img src="http://picture.928330.xyz/typora/4e5de5bb8148393ec0630865e61fb90f.jpg" loading="lazy" data-key="" data-hash="http://picture.928330.xyz/typora/4e5de5bb8148393ec0630865e61fb90f.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">windows相关知识总结（上）</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://npm.elemecdn.com/@waline/emojis@1.1.0/bilibili","https://npm.elemecdn.com/@waline/emojis@1.1.0/bmoji","https://npm.elemecdn.com/@waline/emojis@1.1.0/weibo"],"lang":"zh-cn","locale":{"admin":"Admin","placeholder":null},"pageview":true,"placeholder":"欢迎评论，不好的评论我会删🙄💅🏻","requiredMeta":["name","email","url"],"serverURL":"https://comment.928330.xyz/"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 2025 - 2025 kakahuote | 引用请注明文章链接
    </section>

    <section class="running-time">
        距离小站第一行代码被置下已经过去
        <span id="runningdays" class="running-days"></span>    
    </section>  

    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计 <br />

        
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
        <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
        

        <span>...当然还有kakahuote🤓👆</span>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >
    
    <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
   
   
   
  @font-face {
   font-family: 'yuan';
   src: url('https://blog.928330.xyz/font/round.ttf') format('truetype');
  }

   
   
   
  :root {
   --base-font-family: 'yuan';
   --code-font-family: 'yuan';
  }

   
   
   
   
   
  #backTopBtn {
   position: fixed;
   bottom: 30px;
   right: 450px;
   z-index: 99;
   cursor: pointer;
   width: 32px;
   height: 32px;
   background-image: url('/icons/backTop.svg');
   background-size: cover;
   background-color: rgba(255, 255, 255, 0.9);
   border-radius: 50%;
   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
   transform-origin: center center;
    
   animation: gentleFloat 3s ease-in-out infinite;
    
   overflow: visible;
  }

   
  [data-scheme="dark"] #backTopBtn {
   background-image: url('/icons/backTop-dark.svg') !important;
   background-color: rgba(0, 0, 0, 0.8) !important;
   box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
  }

   
  @media (prefers-color-scheme: dark) {
    #backTopBtn {
      background-image: url('/icons/backTop-dark.svg') !important;
      background-color: rgba(0, 0, 0, 0.8) !important;
      box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
    }
    
    .button-ripple {
      background-image: url('/icons/backTop-dark.svg') !important;
       
    }
  }

   
  html[data-scheme="dark"] #backTopBtn,
  body[data-scheme="dark"] #backTopBtn,
  .dark #backTopBtn,
  .dark-mode #backTopBtn {
    background-image: url('/icons/backTop-dark.svg') !important;
    background-color: rgba(0, 0, 0, 0.8) !important;
    box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
  }

  html[data-scheme="dark"] .button-ripple,
  body[data-scheme="dark"] .button-ripple,
  .dark .button-ripple,
  .dark-mode .button-ripple {
    background-image: url('/icons/backTop-dark.svg') !important;
     
  }

   
  [data-scheme="dark"] #backTopBtn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 10px solid #ffffff;
    transform: translate(-50%, -50%);
    z-index: 1;
     
    display: var(--show-css-arrow, none);
  }

   
  #backTopBtn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 10px solid #000000;
    transform: translate(-50%, -50%);
    z-index: 1;
     
    display: var(--show-css-arrow, none);
  }

   
  @keyframes gentleFloat {
   0%, 100% { transform: translateY(0px); }
   50% { transform: translateY(-6px); }
  }

   
  .button-ripple {
   position: absolute;
   top: 0;
   left: 0;
   width: 32px;
   height: 32px;
   border-radius: 50%;
   background-image: url('/icons/backTop.svg');
   background-size: cover;
   background-repeat: no-repeat;
   background-position: center;
   pointer-events: none;
   z-index: -1;
   animation: buttonRippleExpand 2.5s linear infinite;
   transform-origin: center center;
    
   will-change: transform, opacity;
   backface-visibility: hidden;
   perspective: 1000px;
   contain: layout style;
    
   transform: translateZ(0);
    
   transition: animation-duration 0.3s ease;
    
   --show-css-arrow: none !important;
    
   opacity: var(--ripple-opacity, 0.8) !important;
  }

   
  [data-scheme="dark"] .button-ripple {
   background-image: url('/icons/backTop-dark.svg') !important;
    
    
   --show-css-arrow: none !important;
  }

   
  @media (prefers-color-scheme: dark) {
    .button-ripple {
      background-image: url('/icons/backTop-dark.svg') !important;
       
       
      --show-css-arrow: none !important;
    }
  }

   
  .button-ripple.hover-mode {
   animation-duration: 1s;
  }

  @keyframes buttonRippleExpand {
   0% {
     --ripple-opacity: 0.8;
     transform: scale(1);
   }
   2% {
     --ripple-opacity: 0.78;
     transform: scale(1.02);
   }
   4% {
     --ripple-opacity: 0.76;
     transform: scale(1.04);
   }
   6% {
     --ripple-opacity: 0.74;
     transform: scale(1.06);
   }
   8% {
     --ripple-opacity: 0.72;
     transform: scale(1.08);
   }
   10% {
     --ripple-opacity: 0.7;
     transform: scale(1.1);
   }
   12% {
     --ripple-opacity: 0.68;
     transform: scale(1.12);
   }
   14% {
     --ripple-opacity: 0.66;
     transform: scale(1.14);
   }
   16% {
     --ripple-opacity: 0.64;
     transform: scale(1.16);
   }
   18% {
     --ripple-opacity: 0.62;
     transform: scale(1.18);
   }
   20% {
     --ripple-opacity: 0.6;
     transform: scale(1.2);
   }
   22% {
     --ripple-opacity: 0.58;
     transform: scale(1.22);
   }
   24% {
     --ripple-opacity: 0.56;
     transform: scale(1.24);
   }
   26% {
     --ripple-opacity: 0.54;
     transform: scale(1.26);
   }
   28% {
     --ripple-opacity: 0.52;
     transform: scale(1.28);
   }
   30% {
     --ripple-opacity: 0.5;
     transform: scale(1.3);
   }
   32% {
     --ripple-opacity: 0.48;
     transform: scale(1.32);
   }
   34% {
     --ripple-opacity: 0.46;
     transform: scale(1.34);
   }
   36% {
     --ripple-opacity: 0.44;
     transform: scale(1.36);
   }
   38% {
     --ripple-opacity: 0.42;
     transform: scale(1.38);
   }
   40% {
     --ripple-opacity: 0.4;
     transform: scale(1.4);
   }
   42% {
     --ripple-opacity: 0.38;
     transform: scale(1.42);
   }
   44% {
     --ripple-opacity: 0.36;
     transform: scale(1.44);
   }
   46% {
     --ripple-opacity: 0.34;
     transform: scale(1.46);
   }
   48% {
     --ripple-opacity: 0.32;
     transform: scale(1.48);
   }
   50% {
     --ripple-opacity: 0.3;
     transform: scale(1.5);
   }
   52% {
     --ripple-opacity: 0.28;
     transform: scale(1.52);
   }
   54% {
     --ripple-opacity: 0.26;
     transform: scale(1.54);
   }
   56% {
     --ripple-opacity: 0.24;
     transform: scale(1.56);
   }
   58% {
     --ripple-opacity: 0.22;
     transform: scale(1.58);
   }
   60% {
     --ripple-opacity: 0.2;
     transform: scale(1.6);
   }
   62% {
     --ripple-opacity: 0.18;
     transform: scale(1.62);
   }
   64% {
     --ripple-opacity: 0.16;
     transform: scale(1.64);
   }
   66% {
     --ripple-opacity: 0.14;
     transform: scale(1.66);
   }
   68% {
     --ripple-opacity: 0.12;
     transform: scale(1.68);
   }
   70% {
     --ripple-opacity: 0.1;
     transform: scale(1.7);
   }
   72% {
     --ripple-opacity: 0.08;
     transform: scale(1.72);
   }
   74% {
     --ripple-opacity: 0.07;
     transform: scale(1.74);
   }
   76% {
     --ripple-opacity: 0.06;
     transform: scale(1.76);
   }
   78% {
     --ripple-opacity: 0.05;
     transform: scale(1.78);
   }
   80% {
     --ripple-opacity: 0.04;
     transform: scale(1.8);
   }
   82% {
     --ripple-opacity: 0.035;
     transform: scale(1.82);
   }
   84% {
     --ripple-opacity: 0.03;
     transform: scale(1.84);
   }
   86% {
     --ripple-opacity: 0.025;
     transform: scale(1.86);
   }
   88% {
     --ripple-opacity: 0.02;
     transform: scale(1.88);
   }
   90% {
     --ripple-opacity: 0.015;
     transform: scale(1.9);
   }
   92% {
     --ripple-opacity: 0.01;
     transform: scale(1.92);
   }
   94% {
     --ripple-opacity: 0.008;
     transform: scale(1.94);
   }
   96% {
     --ripple-opacity: 0.005;
     transform: scale(1.96);
   }
   98% {
     --ripple-opacity: 0.002;
     transform: scale(1.98);
   }
   100% {
     --ripple-opacity: 0;
     transform: scale(2.0);
   }
  }

   
  .button-tooltip {
   position: absolute;
   bottom: 45px;
   right: 450px;
   background: rgba(0, 0, 0, 0.8);
   color: white;
   padding: 8px 12px;
   border-radius: 6px;
   font-size: 12px;
   white-space: nowrap;
   opacity: 0;
   transform: translateY(10px);
   transition: all 0.3s ease;
   pointer-events: none;
   z-index: 100;
  }

  .button-tooltip.show {
   opacity: 1;
   transform: translateY(0);
  }

  .button-tooltip::after {
   content: '';
   position: absolute;
   top: 100%;
   left: 50%;
   transform: translateX(-50%);
   border: 5px solid transparent;
   border-top-color: rgba(0, 0, 0, 0.8);
  }

   
  .hover-ripple-effect {
   display: none;
  }

   
  #backTopBtn:hover {
   transform: translateY(-8px) scale(1.1);
   box-shadow: 0 8px 30px rgba(0, 0, 0, 0.25);
   background-color: rgba(255, 255, 255, 1);
  }

   
  #backTopBtn.sprinting {
   animation: energyBurst 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  }

  @keyframes energyBurst {
   0% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(0deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
   15% {
     transform: scale(1.2) rotate(0deg);
     opacity: 1;
     filter: brightness(1.2) hue-rotate(0deg);
     box-shadow: 0 0 25px rgba(255, 215, 0, 0.8), 0 0 50px rgba(255, 107, 107, 0.6);
   }
   30% {
     transform: scale(1.4) rotate(0deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(60deg);
     box-shadow: 0 0 35px rgba(255, 182, 193, 0.8), 0 0 70px rgba(255, 215, 0, 0.6);
   }
   45% {
     transform: scale(1.6) rotate(0deg);
     opacity: 1;
     filter: brightness(1.6) hue-rotate(120deg);
     box-shadow: 0 0 45px rgba(173, 216, 230, 0.8), 0 0 90px rgba(255, 182, 193, 0.6);
   }
   60% {
     transform: scale(1.4) rotate(0deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(180deg);
     box-shadow: 0 0 35px rgba(144, 238, 144, 0.8), 0 0 70px rgba(173, 216, 230, 0.6);
   }
   75% {
     transform: scale(1.2) rotate(0deg);
     opacity: 1;
     filter: brightness(1.2) hue-rotate(240deg);
     box-shadow: 0 0 25px rgba(255, 215, 0, 0.8), 0 0 50px rgba(144, 238, 144, 0.6);
   }
   90% {
     transform: scale(1.05) rotate(0deg);
     opacity: 1;
     filter: brightness(1.05) hue-rotate(300deg);
     box-shadow: 0 0 15px rgba(255, 107, 107, 0.6), 0 0 30px rgba(255, 215, 0, 0.4);
   }
   100% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(360deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
  }

   
  #backTopBtn.reappearing {
   animation: reappear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  }

   
  #backTopBtn.exploding {
   animation: explosionTransition 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    
   z-index: 1000;
  }

   
  #backTopBtn.exploding .button-ripple {
   opacity: 0;
   animation-play-state: paused;
  }

  @keyframes explosionTransition {
   0% {
     transform: scale(1.6) rotate(0deg);
     opacity: 1;
     filter: brightness(1.6) hue-rotate(0deg);
     box-shadow: 0 0 50px rgba(255, 215, 0, 0.8), 0 0 100px rgba(255, 107, 107, 0.6);
   }
   30% {
     transform: scale(1.4) rotate(5deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(120deg);
     box-shadow: 0 0 40px rgba(255, 182, 193, 0.8), 0 0 80px rgba(255, 215, 0, 0.6);
   }

   100% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(360deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
  }

  @keyframes reappear {
   0% {
     transform: scale(0.85);
     opacity: 0.7;
   }
   50% {
     transform: scale(1.05);
     opacity: 1;
   }
   100% {
     transform: scale(1);
     opacity: 1;
   }
  }

  #backTopBtn.rotating {
   animation: rotate360 0.6s ease-in-out;
  }

  @keyframes rotate360 {
   0% { transform: rotate(0deg); }
   100% { transform: rotate(360deg); }
  }

   
  .particle {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 4px;
   height: 4px;
   background: radial-gradient(circle, #fff, #ffd700, #ff69b4, #87ceeb);
   border-radius: 50%;
   pointer-events: none;
   z-index: -2;
   animation: particleExplode 1s ease-out forwards;
  }

  @keyframes particleExplode {
   0% {
     transform: translate(-50%, -50%) scale(0);
     opacity: 1;
   }
   50% {
     opacity: 1;
   }
   100% {
     transform: translate(-50%, -50%) scale(1) translate(var(--x), var(--y));
     opacity: 0;
   }
  }

   
  .energy-wave {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 0;
   height: 0;
   border: 2px solid transparent;
   border-radius: 50%;
   pointer-events: none;
   z-index: -3;
   animation: energyWave 1.2s ease-out forwards;
  }

  @keyframes energyWave {
   0% {
     width: 0;
     height: 0;
     border-color: rgba(255, 215, 0, 0.8);
     opacity: 1;
   }
   100% {
     width: 120px;
     height: 120px;
     border-color: rgba(255, 215, 0, 0);
     opacity: 0;
   }
  }

   
  .hero-aura {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 100%;
   height: 100%;
   border-radius: 50%;
   background: conic-gradient(from 0deg, #ffd700, #ff69b4, #87ceeb, #98fb98, #ffa07a, #ffd700);
   background-size: 200% 200%;
   pointer-events: none;
   z-index: -4;
   animation: heroAura 2s linear infinite;
   opacity: 0;
   transition: opacity 0.3s ease;
  }

  #backTopBtn.sprinting .hero-aura {
   opacity: 0.6;
  }

  @keyframes heroAura {
   0% {
     background-position: 0% 0%;
     transform: translate(-50%, -50%) rotate(0deg);
   }
   100% {
     background-position: 100% 100%;
     transform: translate(-50%, -50%) rotate(360deg);
   }
  }

   
      @media (max-width: 768px) {
     #backTopBtn {
       left: 20px !important;  
       right: auto !important;
       bottom: 20px;
       width: 28px;
       height: 28px;
     }
     
     .button-tooltip {
       left: 20px !important;  
       right: auto !important;
       bottom: 35px;
     }
    }
  
    @media (max-width: 480px) {
     #backTopBtn {
       left: 15px !important;  
       right: auto !important;
       bottom: 15px;
       width: 26px;
       height: 26px;
     }
     
     .button-tooltip {
       left: 15px !important;
       right: auto !important;
       bottom: 31px;
     }
    }

   
   
   
  .no-text-selection {
    -webkit-user-select: none;  
    -moz-user-select: none;     
    -ms-user-select: none;      
    user-select: none;          
  }

   
   
   
  #rope-container {
    position: fixed;
    top: 0;
    left: 20px;
    z-index: 10000;
    width: 50px;
    height: 480px;
    pointer-events: none;
  }
  
   
  #rope-physics-container {
    pointer-events: auto !important;
  }
  
   
  #rope-svg-container svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }
  
  #rope-svg-container path {
    transition: all 0.1s ease-out;
  }
  
   
  #rope-svg-container path,
  #rope-path {
    stroke: #4b2b0f !important;
    stroke-width: 2.5 !important;
  }
  
   
  #rope-svg-container svg path {
    stroke: #4b2b0f !important;
    stroke-width: 2.5 !important;
  }
  


  #rope {
    position: absolute;
    top: -80px;
    left: 50%;
    width: 3px;
    height: 400px;
    background: linear-gradient(to bottom, #654321, #8B4513, #A0522D, #8B4513, #654321);
    border-radius: 1.5px;
    transform: translateX(-50%);
    pointer-events: auto;
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 1px 3px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
  }

  #pull-ring {
    position: absolute;
    top: 300px;
    left: 50%;
    font-size: 20px;
    color: #ffffff;
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
    transform: translateX(-50%);
    pointer-events: auto;
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }

  #rope:hover {
    box-shadow: 0 2px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
  }

  #pull-ring:hover {
    transform: translateX(-50%) scale(1.2);
    text-shadow: 0 0 12px rgba(255, 255, 255, 1);
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
  }

   
   
   
  .highlight {
   max-height: 400px;
   overflow: hidden;
   position: relative;
   transition: max-height 0.3s ease-out;
  }

  .code-show {
   max-height: none !important;
  }

  .code-more-box {
   width: 100%;
   padding-top: 20px;
   background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), #fff);
   position: absolute;
   left: 0;
   right: 0;
   bottom: 0;
   z-index: 1;
   text-align: center;
  }

  .code-more-btn {
   display: inline-block;
   padding: 5px 15px;
   background: #f0f0f5;
   border-radius: 5px;
   cursor: pointer;
   font-size: 0.9em;
  }

   
   
   
  #particles-js {
   position: fixed;
   top: 0;
   left: 0;
    width: 100vw;
    height: 100vh;
   z-index: -1;
    pointer-events: none;
  }
  
  #particles-js canvas {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
  }

   
   
   
  .toc-lock-btn {
    position: absolute;
    top: 32px;
    right: 5px;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    background: rgba(0, 0, 0, 0.05);
    color: rgba(0, 0, 0, 0.7);
    z-index: 100;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
  
  .toc-lock-btn:hover {
    background: rgba(0, 0, 0, 0.1);
    transform: scale(1.1);
    border-color: rgba(0, 0, 0, 0.2);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  }
  
  .toc-lock-btn:active {
    transform: scale(0.95);
  }
  
   
  .toc-lock-btn:focus {
    outline: none;
    border-color: rgba(0, 0, 0, 0.4);
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.1);
    background: rgba(0, 0, 0, 0.08);
  }
  
  .toc-lock-btn:focus-visible {
    outline: none;
    border-color: rgba(0, 0, 0, 0.4);
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.1);
    background: rgba(0, 0, 0, 0.08);
  }
  
  .toc-lock-btn.locked {
    color: rgba(0, 0, 0, 0.9);
    background: rgba(0, 0, 0, 0.1);
    border-color: rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }
  
  .toc-lock-btn.locked:hover {
    background: rgba(0, 0, 0, 0.15);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
  }
  
  .toc-lock-btn.locked .lock-icon.locked {
    display: block;
  }
  
  .toc-lock-btn.locked .lock-icon.unlocked {
    display: none;
  }
  
  .toc-lock-btn .lock-icon.locked {
    display: none;
  }
  
  .toc-lock-btn .lock-icon.unlocked {
    display: block;
  }
  
  .toc-lock-btn .lock-icon {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: all 0.3s ease;
  }
  
   
  .toc-lock-label {
    position: absolute;
    top: 38px;
    right: 28px;
    font-size: 16px;
    color: rgba(0, 0, 0, 0.6);
    font-weight: 700;
    z-index: 100;
    user-select: none;
    pointer-events: none;
    line-height: 1;
    display: flex;
    align-items: center;
  }

   
  [data-scheme="dark"] .toc-lock-btn {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
  }
  
  [data-scheme="dark"] .toc-lock-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 16px rgba(255, 255, 255, 0.15);
  }
  
   
  [data-scheme="dark"] .toc-lock-btn:focus,
  [data-scheme="dark"] .toc-lock-btn:focus-visible {
    outline: none;
    border-color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1), 0 2px 8px rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.08);
  }
  
  [data-scheme="dark"] .toc-lock-btn.locked {
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
  }
  
  [data-scheme="dark"] .toc-lock-btn.locked:hover {
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 4px 16px rgba(255, 255, 255, 0.25);
  }
  
   
  [data-scheme="dark"] .toc-lock-label {
    color: rgba(255, 255, 255, 0.6);
  }

   
  #TableOfContents[data-scrollspy-disabled="true"] {
    opacity: 0.8 !important;
  }
  
  #TableOfContents[data-scrollspy-disabled="true"] .active-class {
     
    display: block !important;
    opacity: 1 !important;
  }
  
  #TableOfContents[data-scrollspy-disabled="true"] a {
    cursor: pointer !important;
  }
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

<script>
   
   
   

  let s1 = '2025-5-8 15:00:00'; 
  s1 = new Date(s1.replace(/-/g, "/"));
  let s2 = new Date();
  let timeDifference = s2.getTime() - s1.getTime();

  let days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
  let hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  let minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));

  let result = days + "天" + hours + "小时" + minutes + "分钟";
  if (document.getElementById('runningdays')) {
      document.getElementById('runningdays').innerHTML = result;
  }
  
   
   
   
  
  

  function startContinuousRipple(button) {
   
   const buttonRipple = document.createElement('div');
   buttonRipple.className = 'button-ripple';
   button.appendChild(buttonRipple);
   
   
   button.buttonRipple = buttonRipple;
  }
  
  

  function createContinuousRipple(button) {
   
   if (button.querySelector('.continuous-ripple')) {
     return;
   }
   
   
   const rippleContainer = document.createElement('div');
   rippleContainer.className = 'ripple-container continuous-ripple';
   
   
   const ripple = document.createElement('div');
   ripple.className = 'ripple';
   ripple.style.background = 'radial-gradient(circle, rgba(255, 107, 107, 0.8) 0%, rgba(255, 255, 255, 0.9) 100%)';
   
   rippleContainer.appendChild(ripple);
   button.appendChild(rippleContainer);
   
   
   setTimeout(() => {
     if (rippleContainer.parentNode) {
       rippleContainer.parentNode.removeChild(rippleContainer);
     }
   }, 800);
  }
  
  

  function createHoverRipple(button) {
   
   if (button.buttonRipple) {
     
     button.buttonRipple.style.animationDuration = '1s';
     button.buttonRipple.classList.add('hover-mode');
   }
  }
  
  

  function showTooltip(button) {
   
   hideTooltip();
   
   
   const tooltip = document.createElement('div');
   tooltip.className = 'button-tooltip';
   tooltip.textContent = '返回顶部';
   document.body.appendChild(tooltip);
   
   
   setTimeout(() => {
     tooltip.classList.add('show');
   }, 10);
   
   
   button.tooltip = tooltip;
  }
  
  

  function hideTooltip() {
   const existingTooltip = document.querySelector('.button-tooltip');
   if (existingTooltip) {
     existingTooltip.classList.remove('show');
     setTimeout(() => {
       if (existingTooltip.parentNode) {
         existingTooltip.parentNode.removeChild(existingTooltip);
       }
     }, 300);
   }
  }
  
  

  function createRippleEffect(button) {
   
   
   
   const energyWave = document.createElement('div');
   energyWave.className = 'energy-wave';
   document.body.appendChild(energyWave);
   
   
   createParticleExplosion(button);
   
   
   setTimeout(() => {
     if (energyWave.parentNode) {
       energyWave.parentNode.removeChild(energyWave);
     }
   }, 1200);
  }

  

  function createParticleExplosion(button) {
   const particleCount = 16; 
   
   
   const particleColors = [
     'radial-gradient(circle, #ff6b6b, #ffd93d, #6bcf7f, #4d96ff)',
     'radial-gradient(circle, #ff8e8e, #ffed4e, #7ddb8f, #6ba6ff)',
     'radial-gradient(circle, #ffa1a1, #fff15f, #8ee79f, #89b6ff)',
     'radial-gradient(circle, #ffb4b4, #fff570, #9ff3af, #a7c6ff)'
   ];
   
   for (let i = 0; i < particleCount; i++) {
     const particle = document.createElement('div');
     particle.className = 'particle';
     
     
     const randomColor = particleColors[Math.floor(Math.random() * particleColors.length)];
     particle.style.background = randomColor;
     
     
     const angle = (i / particleCount) * 2 * Math.PI;
     const distance = 40 + Math.random() * 30; 
     const x = Math.cos(angle) * distance;
     const y = Math.sin(angle) * distance;
     
     particle.style.setProperty('--x', `${x}px`);
     particle.style.setProperty('--y', `${y}px`);
     
     
     particle.style.animationDelay = `${Math.random() * 0.4}s`;
     
     button.appendChild(particle);
     
     
     setTimeout(() => {
       if (particle.parentNode) {
         particle.parentNode.removeChild(particle);
       }
     }, 1000);
   }
  }

   
   
   
  

  function initScrollTop() {
   let rightSideBar = document.querySelector(".right-sidebar");
   if (!rightSideBar) {
    return;
   }

   
   let btn = document.createElement("div");
   btn.id = "backTopBtn";
   let isRotating = false; 

   
   const heroAura = document.createElement('div');
   heroAura.className = 'hero-aura';
   btn.appendChild(heroAura);

   
   btn.addEventListener('mouseenter', function() {
     createHoverRipple(this);
     showTooltip(this);
   });
   
   
   btn.addEventListener('mouseleave', function() {
     if (this.buttonRipple) {
       
       this.buttonRipple.style.animationDuration = '2s';
       this.buttonRipple.classList.remove('hover-mode');
     }
     hideTooltip();
   });

   btn.onclick = function() {
    if (!isRotating) {
     isRotating = true;
     backToTop(this, () => {
      isRotating = false; 
     });
    }
   };
   rightSideBar.appendChild(btn);

   
   btn.style.display = "block";
   
   
   startContinuousRipple(btn);
  }

  

  function backToTop(button, onComplete) {
   
   button.classList.add('sprinting');
   
   
   if (button.buttonRipple) {
     button.buttonRipple.style.display = 'none';
   }
   
   
   createRippleEffect(button);
   
   
   window.scrollTo({ top: 0, behavior: "smooth" });
   
   
   const checkScrollComplete = () => {
     if (window.scrollY === 0) {
       
       button.classList.remove('sprinting');
       
       
       button.classList.add('exploding');
       
       
       createParticleExplosion(button);
       
       
       if (button.buttonRipple) {
         button.buttonRipple.style.display = 'block';
       }
       
       
       setTimeout(() => {
         button.classList.remove('exploding');
         
         
         if (button.buttonRipple) {
           
           button.buttonRipple.style.animationPlayState = 'paused';
           
           button.buttonRipple.style.animation = 'none';
           button.buttonRipple.offsetHeight; 
           button.buttonRipple.style.animation = 'buttonRippleExpand 2s steps(25, end) infinite';
           button.buttonRipple.style.animationPlayState = 'running';
         }
         
         button.classList.add('reappearing');
         
         
         setTimeout(() => {
           button.classList.remove('reappearing');
           if (onComplete) {
             onComplete();
           }
         }, 600);
       }, 800); 
       
       return;
     }
     requestAnimationFrame(checkScrollComplete);
   };
   
   checkScrollComplete();
  }

  
  initScrollTop();
  
   
   
   
  

  function initRope() {


    if (typeof Matter === 'undefined') {
      console.error('Matter.js 库未加载，无法初始化物理绳索。');
      return;
    }
    if (document.getElementById('rope-physics-container')) {

      return;
    }

    let ropeContainer = document.getElementById('rope-container');
    if (!ropeContainer) {
      console.error('#rope-container 元素未在 HTML 或 CSS 中找到。');
      return;
    }
    
    ropeContainer.innerHTML = '';
    ropeContainer.style.height = '100vh';
    ropeContainer.style.pointerEvents = 'none';

    const monthlyEmojis = [
      { month: 1, name: "一月", ring: "❄️", falling: "❄️", description: "寒冬腊月，雪花飞舞" },
      { month: 2, name: "二月", ring: "🏮", falling: "🏮", description: "新春正月，灯笼高挂" },
      { month: 3, name: "三月", ring: "🌸", falling: "🌸", description: "春暖花开，樱花绽放" },
      { month: 4, name: "四月", ring: "🌧️", falling: "🌧️", description: "清明时节，春雨绵绵" },
      { month: 5, name: "五月", ring: "🌺", falling: "🌺", description: "立夏时节，牡丹盛开" },
      { month: 6, name: "六月", ring: "🌻", falling: "🌻", description: "芒种时节，向日葵开" },
      { month: 7, name: "七月", ring: "🌿", falling: "🌿", description: "小暑时节，绿意盎然" },
      { month: 8, name: "八月", ring: "🍉", falling: "🍉", description: "七夕时节，西瓜清甜" },
      { month: 9, name: "九月", ring: "🍁", falling: "🍁", description: "白露时节，秋葉飘落" },
      { month: 10, name: "十月", ring: "🍂", falling: "🍂", description: "寒露时节，落叶纷飞" },
      { month: 11, name: "十一月", ring: "🍊", falling: "🍊", description: "霜降时节，柑橘飘香" },
      { month: 12, name: "十二月", ring: "🌨️", falling: "🌨️", description: "大雪时节，雪花纷飞" }
    ];
    window.timeEmojis = [
      { period: "morning", name: "早晨", emojis: ["☀️", "🌤️", "🌱", "🌺", "🌿"], description: "晨曦初露，万物苏醒" },
      { period: "noon", name: "中午", emojis: ["🌞", "🌻", "🦋", "🦜", "🐝"], description: "烈日当空，生机勃勃" },
      { period: "evening", name: "傍晚", emojis: ["🌙", "⭐", "🦉"], description: "夕阳西下，夜幕降临" }
    ];
    const currentMonth = new Date().getMonth() + 1;
    const currentEmoji = monthlyEmojis.find(emoji => emoji.month === currentMonth);
    
    const ropeContainerLeft = 20;
    const ropeContainerWidth = 50;
    const ropeAnchorX = ropeContainerLeft + (ropeContainerWidth / 2);

    const { Engine, World, Bodies, Composite, Constraint, Runner, Mouse, MouseConstraint, Events, Body } = Matter;

    const engine = Engine.create();
    const world = engine.world;
    
    
    
    
    engine.world.gravity.y = 0;

    
    
    
    const ropeSegments = 80; 
    const segmentRadius = 1.5; 
    const segmentRenderHeight = 6; 
    const segmentRenderWidth = 4; 
    const constraintLength = 2.5; 

    const ropeGroup = Matter.Body.nextGroup(true);
    const ropeChain = Composite.create({ label: 'Rope' });

    
    for (let i = 0; i < ropeSegments - 1; i++) {
      const segment = Bodies.circle(ropeAnchorX, i * constraintLength, segmentRadius, {
          collisionFilter: { group: ropeGroup },
          density: 0.1, 
          friction: 0.4, 
          frictionAir: 0.08, 
          restitution: 0.02 
      });
      Composite.add(ropeChain, segment);
    }

    
    const pullRingBody = Bodies.circle(
      ropeAnchorX,
      (ropeSegments - 1) * constraintLength,
      15,
      {
        collisionFilter: { group: ropeGroup },
        density: 0.01, 
        friction: 0.5,  
        frictionAir: 0.1, 
        restitution: 0.02 
      }
    );
    Composite.add(ropeChain, pullRingBody);
    World.add(world, ropeChain);

    
    Composite.addConstraint(ropeChain, Constraint.create({
      bodyB: ropeChain.bodies[0],
      pointA: { x: ropeAnchorX, y: 0 },
      stiffness: 1 
    }));

    for (let i = 0; i < ropeSegments - 1; i++) {
      Composite.addConstraint(ropeChain, Constraint.create({
        bodyA: ropeChain.bodies[i],
        bodyB: ropeChain.bodies[i + 1],
        
        
        
        stiffness: 0.8, 
        damping: 0.8,   
        length: constraintLength * 0.6, 
        
        render: {
          visible: false
        }
      }));
    }
    
    const domContainer = document.createElement('div');
    domContainer.id = 'rope-physics-container';
    domContainer.style.position = 'fixed';
    domContainer.style.top = '0';
    domContainer.style.left = '0';
    domContainer.style.pointerEvents = 'auto'; 
    domContainer.style.zIndex = '10000';
    document.body.appendChild(domContainer);

    
    const svgContainer = document.createElement('div');
    svgContainer.id = 'rope-svg-container';
    svgContainer.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100vh;
      pointer-events: none;
      z-index: 1;
      overflow: visible;
    `;
    domContainer.appendChild(svgContainer);
    
    
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('width', '100');
    svg.setAttribute('height', '100vh');
    svg.setAttribute('viewBox', '0 0 100 100vh');
    svg.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100vh;
      overflow: visible;
    `;
    svgContainer.appendChild(svg);
    
    
    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
    const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
    gradient.setAttribute('id', 'ropeGradient');
    gradient.setAttribute('x1', '0%');
    gradient.setAttribute('y1', '0%');
    gradient.setAttribute('x2', '0%');
    gradient.setAttribute('y2', '100%');
    
    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop1.setAttribute('offset', '0%');
    stop1.setAttribute('stop-color', '#654321');
    
    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop2.setAttribute('offset', '25%');
    stop2.setAttribute('stop-color', '#8B4513');
    
    const stop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop3.setAttribute('offset', '50%');
    stop3.setAttribute('stop-color', '#A0522D');
    
    const stop4 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop4.setAttribute('offset', '75%');
    stop4.setAttribute('stop-color', '#8B4513');
    
    const stop5 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop5.setAttribute('offset', '100%');
    stop5.setAttribute('stop-color', '#654321');
    
    gradient.appendChild(stop1);
    gradient.appendChild(stop2);
    gradient.appendChild(stop3);
    gradient.appendChild(stop4);
    gradient.appendChild(stop5);
    defs.appendChild(gradient);
    svg.appendChild(defs);
    
    
    const ropePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    ropePath.setAttribute('fill', 'none');
    
    ropePath.setAttribute('stroke', '#4b2b0f');
    ropePath.setAttribute('stroke-width', '2.5');
    ropePath.setAttribute('stroke-linecap', 'round');
    ropePath.setAttribute('stroke-linejoin', 'round');
    ropePath.setAttribute('id', 'rope-path'); 
    svg.appendChild(ropePath);
    
    
    ropePath.setAttribute('d', `M 50 0 L 50 400`);
    
    
    
    
    
    const pullRingDiv = document.createElement('div');
    pullRingDiv.id = 'pull-ring-physics';
    pullRingDiv.innerHTML = currentEmoji.ring;
    pullRingDiv.title = `${currentEmoji.name}: ${currentEmoji.description}`;
    pullRingDiv.style.cssText = `
      font-size: 24px; cursor: grab; pointer-events: auto;
      width: 30px; height: 30px; text-align: center;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); position: absolute;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      z-index: 2;
      transform: translate(40px, 300px); /* 初始位置，向右移动5px */
    `;
    
    
    pullRingDiv.addEventListener('mousedown', () => {
      pullRingDiv.style.cursor = 'grabbing';
    });
    
    pullRingDiv.addEventListener('mouseup', () => {
      pullRingDiv.style.cursor = 'grab';
    });
    
    domContainer.appendChild(pullRingDiv);
    
    
    const ropeElements = {
      svg: svg,
      path: ropePath,
      pullRing: pullRingDiv
    };

    const mouse = Mouse.create(document.body);
    const mouseConstraint = MouseConstraint.create(engine, {
      mouse: mouse,
      constraint: { 
        stiffness: 0.8, 
        render: { visible: false },
        
        length: 0,
        damping: 0.05 
      }
    });
    World.add(world, mouseConstraint);
    
    
    mouseConstraint.constraint.bodyB = null;
    
    
    Events.on(mouseConstraint, 'mousedown', (event) => {

    });
    
    
    mouseConstraint.mouse.element = document.body;
    
    
    let dragStartPosition = null;
    
    Events.on(mouseConstraint, 'startdrag', () => {
      document.body.classList.add('no-text-selection');
      
      
      if (mouseConstraint.body && mouseConstraint.body === pullRingBody) {
        dragStartPosition = {
          x: mouseConstraint.body.position.x,
          y: mouseConstraint.body.position.y
        };
      }
    });
    
    Events.on(mouseConstraint, 'enddrag', () => {
      document.body.classList.remove('no-text-selection');
      
      
      
      if (dragStartPosition) {
        
        const currentPosition = pullRingBody.position;
        const dragDistance = Math.sqrt(
          Math.pow(currentPosition.x - dragStartPosition.x, 2) +
          Math.pow(currentPosition.y - dragStartPosition.y, 2)
        );
        
        
        if (dragDistance > 1) {
          createSeasonalFalling(currentEmoji);
          
          
          Matter.Body.applyForce(pullRingBody, pullRingBody.position, { x: 0, y: 0.5 });
          
          
          const targetX = ropeAnchorX;
          const targetY = (ropeSegments - 1) * constraintLength;
          
          
          const dx = targetX - currentPosition.x;
          const dy = targetY - currentPosition.y;
          
          
          Matter.Body.applyForce(pullRingBody, pullRingBody.position, { 
            x: dx * 0.001, 
            y: dy * 0.001 
          });
          
        }
        
        
        dragStartPosition = null;
      }
    });
    


    
    (function render() {
      
      let pathData = '';
      
      
      const topPoint = { x: 50, y: 0 }; 
      pathData += `M ${topPoint.x} ${topPoint.y}`;
      
      
      ropeChain.bodies.forEach((body, index) => {
        if (index < ropeSegments - 1) { 
          const relativeX = body.position.x - ropeAnchorX + 50; 
          const relativeY = body.position.y;
          pathData += ` L ${relativeX} ${relativeY}`;
        }
      });
      
      
      const pullRingBody = ropeChain.bodies[ropeSegments - 1];
      if (pullRingBody) {
        const relativeX = pullRingBody.position.x - ropeAnchorX + 50; 
        const relativeY = pullRingBody.position.y;
        pathData += ` L ${relativeX} ${relativeY}`;
      }
      
      
      ropeElements.path.setAttribute('d', pathData);
      
      
      if (pullRingBody) {
        
        
        const adjustedX = pullRingBody.position.x - 15 + 3.5; 
        const adjustedY = pullRingBody.position.y - 15;
        
        ropeElements.pullRing.style.transform = `translate(
          ${adjustedX}px,
          ${adjustedY}px
        )`;
        

      }
      
      setTimeout(() => requestAnimationFrame(render), 1000 / 240); 
    })();
    
    
    
    const runner = Runner.create();
    
    runner.delta = 1000 / 240; 
    Runner.run(runner, engine);

    
    
    
    setTimeout(() => {
      engine.world.gravity.y = 1.2;
    }, 100); 

    
    
    
    
    
    ropeChain.bodies.forEach((body, index) => {
      Matter.Body.set(body, 'sleeping', false);
      
      body.sleepThreshold = Infinity;
    });
    
    
    engine.enableSleeping = false;
    
    
    mouseConstraint.constraint.bodyB = null;
    mouseConstraint.mouse.element = document.body;


  }

  

  function createSeasonalFalling(emojiConfig) {

   
   
   const fallingContainer = document.createElement('div');
   fallingContainer.id = 'falling-container';
   fallingContainer.style.cssText = `
     position: fixed;
     top: 0;
     left: 0;
     width: 100vw;
     height: 100vh;
     pointer-events: none;
     z-index: 9999;
     overflow: hidden;
   `;
   document.body.appendChild(fallingContainer);

   
   
   const currentHour = new Date().getHours();
   let currentTimePeriod;
   if (currentHour >= 5 && currentHour < 11) {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "morning");
   } else if (currentHour >= 11 && currentHour < 17) {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "noon");
   } else {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "evening");
   }
   

   
   
   const totalElements = emojiConfig.month >= 11 || emojiConfig.month <= 2 ? 30 : 25; 
   let activeElements = 0;
   

   
   for (let i = 0; i < totalElements; i++) {
    setTimeout(() => {
     const element = document.createElement('div');
     
     
     let selectedEmoji, emojiType;
     if (Math.random() < 0.7) {
      selectedEmoji = emojiConfig.falling;
      emojiType = "monthly";
     } else {
      
      selectedEmoji = currentTimePeriod.emojis[Math.floor(Math.random() * currentTimePeriod.emojis.length)];
      emojiType = "time";
     }
     

     element.innerHTML = selectedEmoji;
     
     
     let fontSize, color, textShadow;
     if (emojiType === "time") {
      
      if (currentTimePeriod.period === "morning") {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FFD700';
       textShadow = '0 0 5px rgba(255, 215, 0, 0.7)';
      } else if (currentTimePeriod.period === "noon") {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FF8C00';
       textShadow = '0 0 5px rgba(255, 140, 0, 0.7)';
      } else {
       
       fontSize = Math.random() * 18 + 16;
       color = '#4B0082';
       textShadow = '0 0 5px rgba(75, 0, 130, 0.7)';
      }
     } else {
      
      if (emojiConfig.month >= 11 || emojiConfig.month <= 2) {
       
       fontSize = Math.random() * 20 + 15;
       color = 'white';
       textShadow = '0 0 5px rgba(255, 255, 255, 0.8)';
      } else if (emojiConfig.month >= 3 && emojiConfig.month <= 5) {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FF69B4';
       textShadow = '0 0 5px rgba(255, 105, 180, 0.6)';
      } else if (emojiConfig.month >= 6 && emojiConfig.month <= 8) {
       
       fontSize = Math.random() * 18 + 15;
       color = '#32CD32';
       textShadow = '0 0 5px rgba(50, 205, 50, 0.6)';
      } else {
       
       fontSize = Math.random() * 18 + 15;
       color = '#FF8C00';
       textShadow = '0 0 5px rgba(255, 140, 0, 0.6)';
      }
     }
     
     element.style.cssText = `
       position: absolute;
       font-size: ${fontSize}px;
       color: ${color};
       text-shadow: ${textShadow};
       left: ${Math.random() * window.innerWidth}px;
       top: -50px;
       user-select: none;
       pointer-events: none;
       z-index: 9999;
       transition: all 0.3s ease;
     `;
     
     fallingContainer.appendChild(element);
     activeElements++;
     
     
     const duration = 4000 + Math.random() * 2000;
     const endX = parseFloat(element.style.left) + (Math.random() - 0.5) * 400;
     const endY = window.innerHeight + 50;
     
     element.style.transition = `all ${duration}ms linear`;
     
     setTimeout(() => {
      element.style.left = endX + 'px';
      element.style.top = endY + 'px';
      element.style.opacity = '0';
     }, 50);
     
     
     setTimeout(() => {
      if (element.parentNode) {
       element.parentNode.removeChild(element);
      }
      activeElements--;
      
      
      if (activeElements === 0) {
       if (fallingContainer && fallingContainer.parentNode) {
        fallingContainer.parentNode.removeChild(fallingContainer);
       }
      }
     }, duration);
    }, i * 150);
   }
  }

   
   
   
  function initCodeMoreBox() {
   let codeBlocks = document.querySelectorAll(".highlight");
   if (!codeBlocks) {
    return;
   }
   codeBlocks.forEach(codeBlock => {
    
    if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
     return;
    }
    
    
    let codeMoreBox = document.createElement('div');
    codeMoreBox.classList.add('code-more-box');
    
    let codeMoreBtn = document.createElement('span');
    codeMoreBtn.classList.add('code-more-btn');
    codeMoreBtn.innerText = '显示更多'; 
    let isExpanded = false; 

    codeMoreBtn.addEventListener('click', () => {
     if (!isExpanded) {
      codeBlock.classList.add('code-show'); 
      codeMoreBtn.innerText = '折叠'; 
      isExpanded = true;
     } else {
      codeBlock.classList.remove('code-show'); 
      codeMoreBtn.innerText = '显示更多'; 
      isExpanded = false;
     }
     
     window.dispatchEvent(new Event('resize'));
    });
    
    codeMoreBox.appendChild(codeMoreBtn);
    codeBlock.appendChild(codeMoreBox);
   });
  }


  
   
   
   
  
  

  function captureScrollListeners() {
    
    setTimeout(() => {
      
      overrideScrollspy();
    }, 2000);
  }
  
  

  function overrideScrollspy() {
    
    window.tocScrollspyEnabled = true;
    
    
    setTimeout(() => {
      
      
      
      
      if (!window.originalScrollTo) {
        window.originalScrollTo = HTMLElement.prototype.scrollTo;
        
        HTMLElement.prototype.scrollTo = function(options) {
          
          if (this.id === 'TableOfContents' && window.tocScrollDisabled) {
            return;
          }
          
          
          return window.originalScrollTo.call(this, options);
        };
      }
      
      
      if (!window.originalScrollIntoView) {
        window.originalScrollIntoView = HTMLElement.prototype.scrollIntoView;
        
        HTMLElement.prototype.scrollIntoView = function(options) {
          
          if (this.closest('#TableOfContents') && window.tocScrollDisabled) {
            return;
          }
          
          
          return window.originalScrollIntoView.call(this, options);
        };
      }
    }, 3000); 
  }
  
  function initTocLock() {
    
    
    const articleToc = document.querySelector('#TableOfContents');
    if (!articleToc) {
      
      return;
    }
    
    
    const tocContainer = document.querySelector('.widget.archives');
    if (!tocContainer) {
      return;
    }
    
    
    tocContainer.style.position = 'relative';
    
    
    captureScrollListeners();
    
    
    const lockLabel = document.createElement('div');
    lockLabel.className = 'toc-lock-label';
    lockLabel.textContent = '锁定：';
    
    
    const lockBtn = document.createElement('div');
    lockBtn.className = 'toc-lock-btn';
    lockBtn.innerHTML = `
      <svg class="lock-icon unlocked" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2z"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
      </svg>
      <svg class="lock-icon locked" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="11" width="18" height="10" rx="2" ry="2"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        <path d="M9 12v3a3 3 0 0 0 6 0v-3"/>
      </svg>
    `;
    
    
    lockBtn.addEventListener('click', function() {
      const isLocked = this.classList.contains('locked');
      
      if (isLocked) {
        
        this.classList.remove('locked');
        localStorage.setItem('tocLocked', 'false');
        enableTocScroll();
      } else {
        
        this.classList.add('locked');
        localStorage.setItem('tocLocked', 'true');
        disableTocScroll();
      }
    });
    
    
    tocContainer.appendChild(lockLabel);
    tocContainer.appendChild(lockBtn);
    
    
    
    lockBtn.classList.remove('locked');
    localStorage.setItem('tocLocked', 'false');
    
    
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          const isLocked = lockBtn.classList.contains('locked');
          if (isLocked) {
            disableTocScroll();
          } else {
            enableTocScroll();
          }
        }
      });
    });
    
    observer.observe(lockBtn, { attributes: true });
  }

  

  function disableTocScroll() {
    
    window.tocScrollDisabled = true;
    
    
    const tocContainer = document.querySelector('#TableOfContents');
    if (tocContainer) {
      
      window.savedTocScrollTop = tocContainer.scrollTop;
      
      
      const currentActive = tocContainer.querySelector('.active-class');
      if (currentActive) {
        window.savedActiveElement = currentActive;
      }
    }
    
    
    if (tocContainer) {
      tocContainer.setAttribute('data-scrollspy-disabled', 'true');
      tocContainer.title = '目录已锁定，不会自动跟随滚动';
    }
    
    
    const archivesContainer = document.querySelector('.widget.archives');
    if (archivesContainer) {
      archivesContainer.style.opacity = '0.8';
      archivesContainer.title = '目录已锁定，不会自动跟随滚动';
    }
  }

  

  function enableTocScroll() {
    
    window.tocScrollDisabled = false;
    
    
    const tocContainer = document.querySelector('#TableOfContents');
    if (tocContainer) {
      
      tocContainer.removeAttribute('data-scrollspy-disabled');
      tocContainer.title = '';
    }
    
    
    const archivesContainer = document.querySelector('.widget.archives');
    if (archivesContainer) {
      archivesContainer.style.opacity = '1';
      archivesContainer.title = '';
    }
  }

  
  
  
  document.addEventListener('DOMContentLoaded', function() {
  

    
    initCodeMoreBox();
    initRope();

    
    setTimeout(initTocLock, 1000);
  });

</script>


<div id="rope-container"></div>


<div id="particles-js"></div>

<script>

particlesJS('particles-js', {
  "particles": {
    "number": {
      "value": 80,
      "density": {
        "enable": true,
        "value_area": 800
      }
    },
    "color": {
      "value": ["#888888", "#aaaaaa", "#cccccc", "#eeeeee"]
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      }
    },
    "opacity": {
      "value": 0.5,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 2,
      "random": true,
      "anim": {
        "enable": false,
        "speed": 40,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": true,
      "distance": 150,
      "color": "#888888",
      "opacity": 0.4,
      "width": 1
    },
    "move": {
      "enable": true,
      "speed": 2,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      "onhover": {
        "enable": true,
        "mode": "grab"
      },
      "onclick": {
        "enable": true,
        "mode": "push"
      },
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 140,
        "line_linked": {
          "opacity": 1
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
});
</script>


<script>
(function() {
  'use strict';
  
  
  const categoryColors = [
    '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57',
    '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43',
    '#10ac84', '#ff6348', '#a55eea', '#e17055', '#d63031',
    '#00b894', '#fdcb6e', '#6c5ce7', '#fd79a8', '#f39c12',
    '#e67e22', '#e74c3c', '#9b59b6', '#3498db', '#1abc9c',
    '#16a085', '#27ae60', '#2ecc71', '#f1c40f', '#e67e22'
  ];
  
  
  function hashString(str) {
    let hash = 0;
    if (str.length === 0) return hash;
    
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash = hash & hash; 
    }
    
    return Math.abs(hash);
  }
  
  
  function assignCategoryColors() {

    
    
    const isArchivesPage = document.body.classList.contains('template-archives') ||
                          window.location.pathname.includes('/archives/');
    const isArticlePage = document.querySelector('#TableOfContents') || 
                         document.querySelector('.article-category');
    
    
    
    
    if (isArticlePage && !isArchivesPage) {
      const categoryLinks = document.querySelectorAll('.article-category a');

      
      categoryLinks.forEach((link, index) => {
        
        const href = link.getAttribute('href');
        const categoryName = href.split('/').pop() || href.split('/').slice(-2, -1)[0] || 'default';
        
        
        const hash = hashString(categoryName);
        const colorIndex = hash % categoryColors.length;
        const backgroundColor = categoryColors[colorIndex];
        
        
        
        
        link.style.setProperty('background-color', backgroundColor, 'important');
        link.style.setProperty('color', '#fff', 'important');
        
        
        link.addEventListener('mouseenter', function() {
          this.style.opacity = '0.8';
          this.style.transform = 'scale(1.05)';
        });
        
        link.addEventListener('mouseleave', function() {
          this.style.opacity = '1';
          this.style.transform = 'scale(1)';
        });
      });
    }
    
    
    if (!isArchivesPage) {
      
      const sidebarCategories = document.querySelectorAll('.widget.categories a, .widget.tagCloud a');

      
      sidebarCategories.forEach((link, index) => {
        
        const href = link.getAttribute('href');
        const categoryName = href.split('/').pop() || href.split('/').slice(-2, -1)[0] || 'default';
        
        
        const hash = hashString(categoryName);
        const colorIndex = hash % categoryColors.length;
        const backgroundColor = categoryColors[colorIndex];
        
        
        
        
        link.style.setProperty('background-color', backgroundColor, 'important');
        link.style.setProperty('color', '#fff', 'important');
        link.style.setProperty('border-radius', '6px', 'important');
        link.style.setProperty('padding', '8px 12px', 'important');
        link.style.setProperty('margin', '4px 0', 'important');
        link.style.setProperty('display', 'inline-block', 'important');
        link.style.setProperty('text-decoration', 'none', 'important');
        link.style.setProperty('transition', 'all 0.3s ease', 'important');
        
        
        link.addEventListener('mouseenter', function() {
          this.style.opacity = '0.8';
          this.style.transform = 'scale(1.05)';
          this.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.2)';
        });
        
        link.addEventListener('mouseleave', function() {
          this.style.opacity = '1';
          this.style.transform = 'scale(1)';
          this.style.boxShadow = 'none';
        });
      });
    } else {
      

    }
    

  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', assignCategoryColors);
  } else {
    assignCategoryColors();
  }
  
  
  setTimeout(assignCategoryColors, 500);
  setTimeout(assignCategoryColors, 1000);
  setTimeout(assignCategoryColors, 2000);
  
  
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
        
        const hasNewCategories = Array.from(mutation.addedNodes).some(node => {
          return node.nodeType === 1 && (
            node.classList.contains('article-category') ||
            node.querySelector('.article-category') ||
            node.classList.contains('widget') ||
            node.querySelector('.widget')
          );
        });
        
        if (hasNewCategories) {
          
          setTimeout(assignCategoryColors, 100);
          setTimeout(assignCategoryColors, 500);
        }
      }
    });
  });
  
  
  observer.observe(document.body, {
    childList: true,
    subtree: true
  });
})();
</script>


<script>
(function() {
  'use strict';
  
  
  function fixDarkModeToggleText() {
    const toggleBtn = document.getElementById('dark-mode-toggle');
    if (!toggleBtn) {
      return;
    }
    
    
    toggleBtn.classList.add('dark-mode-toggle-fix');
    
    
    const span = toggleBtn.querySelector('span');
    if (!span) {
      return;
    }
    
    
    function updateText() {
      const isDark = document.documentElement.dataset.scheme === 'dark';
      span.textContent = isDark ? '亮色模式' : '暗色模式';

    }
    
    
    updateText();
    
    
    function handleThemeChange() {
      setTimeout(updateText, 100); 
    }
    
    
    window.addEventListener('onColorSchemeChange', handleThemeChange);
    
    
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-scheme') {
          handleThemeChange();
        }
      });
    });
    
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-scheme']
    });
    
    
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', handleThemeChange);
    
    
    toggleBtn.addEventListener('click', function() {
      
      setTimeout(updateText, 200);
    });
    

  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', fixDarkModeToggleText);
  } else {
    fixDarkModeToggleText();
  }
  
  
  setTimeout(fixDarkModeToggleText, 1000);
  setTimeout(fixDarkModeToggleText, 2000);
})();
</script>

  
  <script>
  
  if (!document.getElementById('new-theme-switch')) {
    document.write(`
      <div id="new-theme-switch" style="position: fixed; bottom: 50px; left: 50px; z-index: 1000; text-align: center;">
        <label class="theme-switch">
          <input type="checkbox" class="theme-switch__checkbox" id="theme-switch-checkbox">
          <div class="theme-switch__container">
            <div class="theme-switch__clouds"></div>
            <div class="theme-switch__stars-container">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 55" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M135.831 3.00688C135.055 3.85027 134.111 4.29946 133 4.35447C134.111 4.40947 135.055 4.85867 135.831 5.71123C136.607 6.55462 136.996 7.56303 136.996 8.72727C136.996 7.95722 137.172 7.25134 137.525 6.59129C137.886 5.93124 138.372 5.39954 138.98 5.00535C139.598 4.60199 140.268 4.39114 141 4.35447C139.88 4.2903 138.936 3.85027 138.16 3.00688C137.384 2.16348 136.996 1.16425 136.996 0C136.996 1.16425 136.607 2.16348 135.831 3.00688ZM31 23.3545C32.1114 23.2995 33.0551 22.8503 33.8313 22.0069C34.6075 21.1635 34.9956 20.1642 34.9956 19C34.9956 20.1642 35.3837 21.1635 36.1599 22.0069C36.9361 22.8503 37.8798 23.2903 39 23.3545C38.2679 23.3911 37.5976 23.602 36.9802 24.0053C36.3716 24.3995 35.8864 24.9312 35.5248 25.5913C35.172 26.2513 34.9956 26.9572 34.9956 27.7273C34.9956 26.563 34.6075 25.5546 33.8313 24.7112C33.0551 23.8587 32.1114 23.4095 31 23.3545ZM0 36.3545C1.11136 36.2995 2.05513 35.8503 2.83131 35.0069C3.6075 34.1635 3.99559 33.1642 3.99559 32C3.99559 33.1642 4.38368 34.1635 5.15987 35.0069C5.93605 35.8503 6.87982 36.2903 8 36.3545C7.26792 36.3911 6.59757 36.602 5.98015 37.0053C5.37155 37.3995 4.88644 37.9312 4.52481 38.5913C4.172 39.2513 3.99559 39.9572 3.99559 40.7273C3.99559 39.563 4.38368 38.5546 2.83131 37.7112C2.05513 36.8587 1.11136 36.4095 0 36.3545ZM56.8313 24.0069C56.0551 24.8503 55.1114 25.2995 54 25.3545C55.1114 25.4095 56.0551 25.8587 56.8313 26.7112C57.6075 27.5546 57.9956 28.563 57.9956 29.7273C57.9956 28.9572 58.172 28.2513 58.5248 27.5913C58.8864 26.9312 59.3716 26.3995 59.9802 26.0053C60.5976 25.602 61.2679 25.3911 62 25.3545C60.8798 25.2903 59.9361 24.8503 59.1599 24.0069C58.3837 23.1635 57.9956 22.1642 57.9956 21C57.9956 22.1642 57.6075 23.1635 56.8313 24.0069ZM81 25.3545C82.1114 25.2995 83.0551 24.8503 83.8313 24.0069C84.6075 23.1635 84.9956 22.1642 84.9956 21C84.9956 22.1642 85.3837 23.1635 86.1599 24.0069C86.9361 24.8503 87.8798 25.2903 89 25.3545C88.2679 25.3911 87.5976 25.602 86.9802 26.0053C86.3716 26.3995 85.8864 26.9312 85.5248 27.5913C85.172 28.2513 84.9956 28.9572 84.9956 29.7273C84.9956 28.563 84.6075 27.5546 83.8313 26.7112C83.0551 25.8587 82.1114 25.4095 81 25.3545ZM136 36.3545C137.111 36.2995 138.055 35.8503 138.831 35.0069C139.607 34.1635 139.996 33.1642 139.996 32C139.996 33.1642 140.384 34.1635 141.16 35.0069C141.936 35.8503 142.88 36.2903 144 36.3545C143.268 36.3911 142.598 36.602 141.98 37.0053C141.372 37.3995 140.886 37.9312 140.525 38.5913C140.172 39.2513 139.996 39.9572 139.996 40.7273C139.996 39.563 139.607 38.5546 138.831 37.7112C138.055 36.8587 137.111 36.4095 136 36.3545ZM101.831 49.0069C101.055 49.8503 100.111 50.2995 99 50.3545C100.111 50.4095 101.055 50.8587 101.831 51.7112C102.607 52.5546 102.996 53.563 102.996 54.7273C102.996 53.9572 103.172 53.2513 103.525 52.5913C103.886 51.9312 104.372 51.3995 104.98 51.0053C105.598 50.602 106.268 50.3911 107 50.3545C105.88 50.2903 104.936 49.8503 104.16 49.0069C103.384 48.1635 102.996 47.1642 102.996 46C102.996 47.1642 102.607 48.1635 101.831 49.0069Z" fill="currentColor"></path>
              </svg>
            </div>
            <div class="theme-switch__circle-container">
              <div class="theme-switch__sun-moon-container">
                <div class="theme-switch__moon">
                  <div class="theme-switch__spot"></div>
                  <div class="theme-switch__spot"></div>
                  <div class="theme-switch__spot"></div>
                </div>
              </div>
            </div>
          </div>
        </label>
        <div id="theme-switch-text" style="color: #fff; font-size: 14px; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.5); margin-top: 8px; text-align: center;">亮色模式</div>
      </div>
    `);
  }
  </script>


<style>
   
  .theme-switch {
    --toggle-size: 20px;  
    --container-width: 3.75em;
    --container-height: 1.7em;
    --container-radius: 4.2em;
    --container-light-bg: #3D7EAE;
    --container-night-bg: #1D1F2C;
    --circle-container-diameter: 2.25em;
    --sun-moon-diameter: 1.4em;
    --sun-bg: #ECCA2F;
    --moon-bg: #C4C9D1;
    --spot-color: #959DB1;
    --circle-container-offset: calc((var(--circle-container-diameter) - var(--container-height)) / 2 * -1);
    --stars-color: #fff;
    --clouds-color: #F3FDFF;
    --back-clouds-color: #AACADF;
    --transition: .5s cubic-bezier(0, -0.02, 0.4, 1.25);
    --circle-transition: .3s cubic-bezier(0, -0.02, 0.35, 1.17);
  }

  .theme-switch, .theme-switch *, .theme-switch *::before, .theme-switch *::after {
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-size: var(--toggle-size);
  }

  .theme-switch__container {
    width: var(--container-width);
    height: var(--container-height);
    background-color: var(--container-light-bg);
    border-radius: var(--container-radius);
    overflow: hidden;
    cursor: pointer;
    -webkit-box-shadow: 0em -0.062em 0.062em rgba(0, 0, 0, 0.25), 0em 0.062em 0.125em rgba(255, 255, 255, 0.94);
    box-shadow: 0em -0.062em 0.062em rgba(0, 0, 0, 0.25), 0em 0.062em 0.125em rgba(255, 255, 255, 0.94);
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
    position: relative;
  }

  .theme-switch__container::before {
    content: "";
    position: absolute;
    z-index: 1;
    inset: 0;
    -webkit-box-shadow: 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset, 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset;
    box-shadow: 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset, 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset;
    border-radius: var(--container-radius)
  }

  .theme-switch__checkbox {
    display: none;
  }

  .theme-switch__circle-container {
    width: var(--circle-container-diameter);
    height: var(--circle-container-diameter);
    background-color: rgba(255, 255, 255, 0.1);
    position: absolute;
    left: var(--circle-container-offset);
    top: var(--circle-container-offset);
    border-radius: var(--container-radius);
    -webkit-box-shadow: inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), 0 0 0 0.625em rgba(255, 255, 255, 0.1), 0 0 0 1.25em rgba(255, 255, 255, 0.1);
    box-shadow: inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), 0 0 0 0.625em rgba(255, 255, 255, 0.1), 0 0 0 1.25em rgba(255, 255, 255, 0.1);
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-transition: var(--circle-transition);
    -o-transition: var(--circle-transition);
    transition: var(--circle-transition);
    pointer-events: none;
  }

  .theme-switch__sun-moon-container {
    pointer-events: auto;
    position: relative;
    z-index: 2;
    width: var(--sun-moon-diameter);
    height: var(--sun-moon-diameter);
    margin: auto;
    border-radius: var(--container-radius);
    background-color: var(--sun-bg);
    -webkit-box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #a1872a inset;
    box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #a1872a inset;
    -webkit-filter: drop-shadow(0.062em 0.125em 0.125em rgba(0, 0, 0, 0.25)) drop-shadow(0em 0.062em 0.125em rgba(0, 0, 0, 0.25));
    filter: drop-shadow(0.062em 0.125em 0.125em rgba(0, 0, 0, 0.25)) drop-shadow(0em 0.062em 0.125em rgba(0, 0, 0, 0.25));
    overflow: hidden;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
  }

  .theme-switch__moon {
    -webkit-transform: translateX(100%);
    -ms-transform: translateX(100%);
    transform: translateX(100%);
    width: 100%;
    height: 100%;
    background-color: var(--moon-bg);
    border-radius: inherit;
    -webkit-box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #969696 inset;
    box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #969696 inset;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
    position: relative;
  }

  .theme-switch__spot {
    position: absolute;
    top: 0.75em;
    left: 0.312em;
    width: 0.75em;
    height: 0.75em;
    border-radius: var(--container-radius);
    background-color: var(--spot-color);
    -webkit-box-shadow: 0em 0.0312em 0.062em rgba(0, 0, 0, 0.25) inset;
    box-shadow: 0em 0.0312em 0.062em rgba(0, 0, 0, 0.25) inset;
  }

  .theme-switch__spot:nth-of-type(2) {
    width: 0.375em;
    height: 0.375em;
    top: 0.937em;
    left: 1.375em;
  }

  .theme-switch__spot:nth-last-of-type(3) {
    width: 0.25em;
    height: 0.25em;
    top: 0.312em;
    left: 0.812em;
  }

  .theme-switch__clouds {
    width: 1.25em;
    height: 1.25em;
    background-color: var(--clouds-color);
    border-radius: var(--container-radius);
    position: absolute;
    bottom: -0.625em;
    left: 0.312em;
    -webkit-box-shadow: 0.937em 0.312em var(--clouds-color), -0.312em -0.312em var(--back-clouds-color), 1.437em 0.375em var(--clouds-color), 0.5em -0.125em var(--back-clouds-color), 2.187em 0 var(--clouds-color), 1.25em -0.062em var(--back-clouds-color), 2.937em 0.312em var(--clouds-color), 2em -0.312em var(--back-clouds-color), 3.625em -0.062em var(--clouds-color), 2.625em 0em var(--back-clouds-color), 4.5em -0.312em var(--clouds-color), 3.375em -0.437em var(--back-clouds-color), 4.625em -1.75em 0 0.437em var(--clouds-color), 4em -0.625em var(--back-clouds-color), 4.125em -2.125em 0 0.437em var(--back-clouds-color);
    box-shadow: 0.937em 0.312em var(--clouds-color), -0.312em -0.312em var(--back-clouds-color), 1.437em 0.375em var(--clouds-color), 0.5em -0.125em var(--back-clouds-color), 2.187em 0 var(--clouds-color), 1.25em -0.062em var(--back-clouds-color), 2.937em 0.312em var(--clouds-color), 2em -0.312em var(--back-clouds-color), 3.625em -0.062em var(--clouds-color), 2.625em 0em var(--back-clouds-color), 4.5em -0.312em var(--clouds-color), 3.375em -0.437em var(--back-clouds-color), 4.625em -1.75em 0 0.437em var(--clouds-color), 4em -0.625em var(--back-clouds-color), 4.125em -2.125em 0 0.437em var(--back-clouds-color);
    -webkit-transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
    -o-transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
    transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
  }

  .theme-switch__stars-container {
    position: absolute;
    color: var(--stars-color);
    top: -100%;
    left: 0.312em;
    width: 2.75em;
    height: auto;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
  }

   
  .theme-switch__checkbox:checked + .theme-switch__container {
    background-color: var(--container-night-bg);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__circle-container {
    left: calc(100% - var(--circle-container-offset) - var(--circle-container-diameter));
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__circle-container:hover {
    left: calc(100% - var(--circle-container-offset) - var(--circle-container-diameter) - 0.187em)
  }

  .theme-switch__circle-container:hover {
    left: calc(var(--circle-container-offset) + 0.187em);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__moon {
    -webkit-transform: translate(0);
    -ms-transform: translate(0);
    transform: translate(0);
    transform: translate(0);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__clouds {
    bottom: -4.062em;
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__stars-container {
    top: 50%;
    -webkit-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
  }

   
  #dark-mode-toggle {
    display: none !important;
  }

   
  .dark-mode-toggle-fix span {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
</style>


<script>
(function() {
  'use strict';
  
  
  if (window.themeSwitchInitialized) {
    console.log('主题切换开关已经初始化，跳过重复执行');
    return;
  }
  
  let isInitialized = false;
  let observer = null;
  
  function initNewThemeSwitch() {
    
    if (isInitialized) {
      return;
    }
    
    const checkbox = document.getElementById('theme-switch-checkbox');
    if (!checkbox) {
      return;
    }
    
    
    function updateCheckboxState() {
      const isDark = document.documentElement.dataset.scheme === 'dark';
      checkbox.checked = isDark;
      
      
      const textElement = document.getElementById('theme-switch-text');
      if (textElement) {
        textElement.textContent = isDark ? '暗色模式' : '亮色模式';
        console.log('更新主题切换文字:', isDark ? '暗色模式' : '亮色模式');
      }
      
      console.log('当前主题状态:', isDark ? 'dark' : 'light', 'checkbox状态:', checkbox.checked);
    }
    
    
    function waitForThemeSystem() {
      
      const schemeFromData = document.documentElement.dataset.scheme;
      const schemeFromClass = document.documentElement.className.includes('dark') ? 'dark' : 
                             document.documentElement.className.includes('light') ? 'light' : null;
      const schemeFromLocalStorage = localStorage.getItem('StackColorScheme');
      
      if (schemeFromData || schemeFromClass || schemeFromLocalStorage) {
        
        let finalScheme = schemeFromData || schemeFromClass || schemeFromLocalStorage;
        
        
        if (schemeFromData) {
          finalScheme = schemeFromData;
        }
        
        
        document.documentElement.dataset.scheme = finalScheme;
        
        
        updateCheckboxState();
        isInitialized = true;
        window.themeSwitchInitialized = true;
        
        console.log('主题系统已初始化，当前主题:', finalScheme);
      } else {
        
        setTimeout(waitForThemeSystem, 100);
      }
    }
    
    
    waitForThemeSystem();
    
    
    checkbox.addEventListener('change', function() {
      const scheme = this.checked ? 'dark' : 'light';
      document.documentElement.dataset.scheme = scheme;
      
      
      localStorage.setItem('StackColorScheme', scheme);
      
      
      document.dispatchEvent(new CustomEvent('onColorSchemeChange'));
    });
    
    
    window.addEventListener('onColorSchemeChange', updateCheckboxState);
    
    
    observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-scheme') {
          updateCheckboxState();
        }
      });
    });
    
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-scheme']
    });
  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initNewThemeSwitch);
  } else {
    initNewThemeSwitch();
  }
  
  
  setTimeout(initNewThemeSwitch, 1500);
})();
</script>


<script>
(function() {
  'use strict';
  
  
  if (window.hoverEffectsInitialized) {
    console.log('悬浮效果已经初始化，跳过重复执行');
    return;
  }
  
  let isHoverEffectsInitialized = false;
  let hoverObserver = null;
  
  
  function forceCategoryHoverEffects() {
    
    if (isHoverEffectsInitialized) {
      return;
    }
    
    const articles = document.querySelectorAll('.article-list--compact article');
    if (articles.length > 0) {
      articles.forEach(article => {
        
        if (article.hasAttribute('data-hover-initialized')) {
          return;
        }
        
        
        article.style.setProperty('transition', 'all 0.3s ease', 'important');
        article.style.setProperty('will-change', 'transform, box-shadow', 'important');
        
        
        article.addEventListener('mouseenter', function() {
          this.style.setProperty('transform', 'translateY(-5px)', 'important');
          this.style.setProperty('box-shadow', '0 10px 30px rgba(0, 0, 0, 0.12)', 'important');
        });
        
        article.addEventListener('mouseleave', function() {
          this.style.setProperty('transform', 'translateY(0)', 'important');
          this.style.setProperty('box-shadow', 'none', 'important');
        });
        
        
        article.setAttribute('data-hover-initialized', 'true');
      });
      
      isHoverEffectsInitialized = true;
      window.hoverEffectsInitialized = true;
    }
  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', forceCategoryHoverEffects);
  } else {
    forceCategoryHoverEffects();
  }
  
  
  setTimeout(forceCategoryHoverEffects, 1000);
  
  
  hoverObserver = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
        
        setTimeout(forceCategoryHoverEffects, 100);
      }
    });
  });
  
  
  hoverObserver.observe(document.body, {
    childList: true,
    subtree: true
  });
})();
</script>


            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
   
   
   
  @font-face {
   font-family: 'yuan';
   src: url('https://blog.928330.xyz/font/round.ttf') format('truetype');
  }

   
   
   
  :root {
   --base-font-family: 'yuan';
   --code-font-family: 'yuan';
  }

   
   
   
   
   
  #backTopBtn {
   position: fixed;
   bottom: 30px;
   right: 450px;
   z-index: 99;
   cursor: pointer;
   width: 32px;
   height: 32px;
   background-image: url('/icons/backTop.svg');
   background-size: cover;
   background-color: rgba(255, 255, 255, 0.9);
   border-radius: 50%;
   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
   transform-origin: center center;
    
   animation: gentleFloat 3s ease-in-out infinite;
    
   overflow: visible;
  }

   
  [data-scheme="dark"] #backTopBtn {
   background-image: url('/icons/backTop-dark.svg') !important;
   background-color: rgba(0, 0, 0, 0.8) !important;
   box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
  }

   
  @media (prefers-color-scheme: dark) {
    #backTopBtn {
      background-image: url('/icons/backTop-dark.svg') !important;
      background-color: rgba(0, 0, 0, 0.8) !important;
      box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
    }
    
    .button-ripple {
      background-image: url('/icons/backTop-dark.svg') !important;
       
    }
  }

   
  html[data-scheme="dark"] #backTopBtn,
  body[data-scheme="dark"] #backTopBtn,
  .dark #backTopBtn,
  .dark-mode #backTopBtn {
    background-image: url('/icons/backTop-dark.svg') !important;
    background-color: rgba(0, 0, 0, 0.8) !important;
    box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1) !important;
  }

  html[data-scheme="dark"] .button-ripple,
  body[data-scheme="dark"] .button-ripple,
  .dark .button-ripple,
  .dark-mode .button-ripple {
    background-image: url('/icons/backTop-dark.svg') !important;
     
  }

   
  [data-scheme="dark"] #backTopBtn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 10px solid #ffffff;
    transform: translate(-50%, -50%);
    z-index: 1;
     
    display: var(--show-css-arrow, none);
  }

   
  #backTopBtn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 10px solid #000000;
    transform: translate(-50%, -50%);
    z-index: 1;
     
    display: var(--show-css-arrow, none);
  }

   
  @keyframes gentleFloat {
   0%, 100% { transform: translateY(0px); }
   50% { transform: translateY(-6px); }
  }

   
  .button-ripple {
   position: absolute;
   top: 0;
   left: 0;
   width: 32px;
   height: 32px;
   border-radius: 50%;
   background-image: url('/icons/backTop.svg');
   background-size: cover;
   background-repeat: no-repeat;
   background-position: center;
   pointer-events: none;
   z-index: -1;
   animation: buttonRippleExpand 2.5s linear infinite;
   transform-origin: center center;
    
   will-change: transform, opacity;
   backface-visibility: hidden;
   perspective: 1000px;
   contain: layout style;
    
   transform: translateZ(0);
    
   transition: animation-duration 0.3s ease;
    
   --show-css-arrow: none !important;
    
   opacity: var(--ripple-opacity, 0.8) !important;
  }

   
  [data-scheme="dark"] .button-ripple {
   background-image: url('/icons/backTop-dark.svg') !important;
    
    
   --show-css-arrow: none !important;
  }

   
  @media (prefers-color-scheme: dark) {
    .button-ripple {
      background-image: url('/icons/backTop-dark.svg') !important;
       
       
      --show-css-arrow: none !important;
    }
  }

   
  .button-ripple.hover-mode {
   animation-duration: 1s;
  }

  @keyframes buttonRippleExpand {
   0% {
     --ripple-opacity: 0.8;
     transform: scale(1);
   }
   2% {
     --ripple-opacity: 0.78;
     transform: scale(1.02);
   }
   4% {
     --ripple-opacity: 0.76;
     transform: scale(1.04);
   }
   6% {
     --ripple-opacity: 0.74;
     transform: scale(1.06);
   }
   8% {
     --ripple-opacity: 0.72;
     transform: scale(1.08);
   }
   10% {
     --ripple-opacity: 0.7;
     transform: scale(1.1);
   }
   12% {
     --ripple-opacity: 0.68;
     transform: scale(1.12);
   }
   14% {
     --ripple-opacity: 0.66;
     transform: scale(1.14);
   }
   16% {
     --ripple-opacity: 0.64;
     transform: scale(1.16);
   }
   18% {
     --ripple-opacity: 0.62;
     transform: scale(1.18);
   }
   20% {
     --ripple-opacity: 0.6;
     transform: scale(1.2);
   }
   22% {
     --ripple-opacity: 0.58;
     transform: scale(1.22);
   }
   24% {
     --ripple-opacity: 0.56;
     transform: scale(1.24);
   }
   26% {
     --ripple-opacity: 0.54;
     transform: scale(1.26);
   }
   28% {
     --ripple-opacity: 0.52;
     transform: scale(1.28);
   }
   30% {
     --ripple-opacity: 0.5;
     transform: scale(1.3);
   }
   32% {
     --ripple-opacity: 0.48;
     transform: scale(1.32);
   }
   34% {
     --ripple-opacity: 0.46;
     transform: scale(1.34);
   }
   36% {
     --ripple-opacity: 0.44;
     transform: scale(1.36);
   }
   38% {
     --ripple-opacity: 0.42;
     transform: scale(1.38);
   }
   40% {
     --ripple-opacity: 0.4;
     transform: scale(1.4);
   }
   42% {
     --ripple-opacity: 0.38;
     transform: scale(1.42);
   }
   44% {
     --ripple-opacity: 0.36;
     transform: scale(1.44);
   }
   46% {
     --ripple-opacity: 0.34;
     transform: scale(1.46);
   }
   48% {
     --ripple-opacity: 0.32;
     transform: scale(1.48);
   }
   50% {
     --ripple-opacity: 0.3;
     transform: scale(1.5);
   }
   52% {
     --ripple-opacity: 0.28;
     transform: scale(1.52);
   }
   54% {
     --ripple-opacity: 0.26;
     transform: scale(1.54);
   }
   56% {
     --ripple-opacity: 0.24;
     transform: scale(1.56);
   }
   58% {
     --ripple-opacity: 0.22;
     transform: scale(1.58);
   }
   60% {
     --ripple-opacity: 0.2;
     transform: scale(1.6);
   }
   62% {
     --ripple-opacity: 0.18;
     transform: scale(1.62);
   }
   64% {
     --ripple-opacity: 0.16;
     transform: scale(1.64);
   }
   66% {
     --ripple-opacity: 0.14;
     transform: scale(1.66);
   }
   68% {
     --ripple-opacity: 0.12;
     transform: scale(1.68);
   }
   70% {
     --ripple-opacity: 0.1;
     transform: scale(1.7);
   }
   72% {
     --ripple-opacity: 0.08;
     transform: scale(1.72);
   }
   74% {
     --ripple-opacity: 0.07;
     transform: scale(1.74);
   }
   76% {
     --ripple-opacity: 0.06;
     transform: scale(1.76);
   }
   78% {
     --ripple-opacity: 0.05;
     transform: scale(1.78);
   }
   80% {
     --ripple-opacity: 0.04;
     transform: scale(1.8);
   }
   82% {
     --ripple-opacity: 0.035;
     transform: scale(1.82);
   }
   84% {
     --ripple-opacity: 0.03;
     transform: scale(1.84);
   }
   86% {
     --ripple-opacity: 0.025;
     transform: scale(1.86);
   }
   88% {
     --ripple-opacity: 0.02;
     transform: scale(1.88);
   }
   90% {
     --ripple-opacity: 0.015;
     transform: scale(1.9);
   }
   92% {
     --ripple-opacity: 0.01;
     transform: scale(1.92);
   }
   94% {
     --ripple-opacity: 0.008;
     transform: scale(1.94);
   }
   96% {
     --ripple-opacity: 0.005;
     transform: scale(1.96);
   }
   98% {
     --ripple-opacity: 0.002;
     transform: scale(1.98);
   }
   100% {
     --ripple-opacity: 0;
     transform: scale(2.0);
   }
  }

   
  .button-tooltip {
   position: absolute;
   bottom: 45px;
   right: 450px;
   background: rgba(0, 0, 0, 0.8);
   color: white;
   padding: 8px 12px;
   border-radius: 6px;
   font-size: 12px;
   white-space: nowrap;
   opacity: 0;
   transform: translateY(10px);
   transition: all 0.3s ease;
   pointer-events: none;
   z-index: 100;
  }

  .button-tooltip.show {
   opacity: 1;
   transform: translateY(0);
  }

  .button-tooltip::after {
   content: '';
   position: absolute;
   top: 100%;
   left: 50%;
   transform: translateX(-50%);
   border: 5px solid transparent;
   border-top-color: rgba(0, 0, 0, 0.8);
  }

   
  .hover-ripple-effect {
   display: none;
  }

   
  #backTopBtn:hover {
   transform: translateY(-8px) scale(1.1);
   box-shadow: 0 8px 30px rgba(0, 0, 0, 0.25);
   background-color: rgba(255, 255, 255, 1);
  }

   
  #backTopBtn.sprinting {
   animation: energyBurst 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  }

  @keyframes energyBurst {
   0% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(0deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
   15% {
     transform: scale(1.2) rotate(0deg);
     opacity: 1;
     filter: brightness(1.2) hue-rotate(0deg);
     box-shadow: 0 0 25px rgba(255, 215, 0, 0.8), 0 0 50px rgba(255, 107, 107, 0.6);
   }
   30% {
     transform: scale(1.4) rotate(0deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(60deg);
     box-shadow: 0 0 35px rgba(255, 182, 193, 0.8), 0 0 70px rgba(255, 215, 0, 0.6);
   }
   45% {
     transform: scale(1.6) rotate(0deg);
     opacity: 1;
     filter: brightness(1.6) hue-rotate(120deg);
     box-shadow: 0 0 45px rgba(173, 216, 230, 0.8), 0 0 90px rgba(255, 182, 193, 0.6);
   }
   60% {
     transform: scale(1.4) rotate(0deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(180deg);
     box-shadow: 0 0 35px rgba(144, 238, 144, 0.8), 0 0 70px rgba(173, 216, 230, 0.6);
   }
   75% {
     transform: scale(1.2) rotate(0deg);
     opacity: 1;
     filter: brightness(1.2) hue-rotate(240deg);
     box-shadow: 0 0 25px rgba(255, 215, 0, 0.8), 0 0 50px rgba(144, 238, 144, 0.6);
   }
   90% {
     transform: scale(1.05) rotate(0deg);
     opacity: 1;
     filter: brightness(1.05) hue-rotate(300deg);
     box-shadow: 0 0 15px rgba(255, 107, 107, 0.6), 0 0 30px rgba(255, 215, 0, 0.4);
   }
   100% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(360deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
  }

   
  #backTopBtn.reappearing {
   animation: reappear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  }

   
  #backTopBtn.exploding {
   animation: explosionTransition 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    
   z-index: 1000;
  }

   
  #backTopBtn.exploding .button-ripple {
   opacity: 0;
   animation-play-state: paused;
  }

  @keyframes explosionTransition {
   0% {
     transform: scale(1.6) rotate(0deg);
     opacity: 1;
     filter: brightness(1.6) hue-rotate(0deg);
     box-shadow: 0 0 50px rgba(255, 215, 0, 0.8), 0 0 100px rgba(255, 107, 107, 0.6);
   }
   30% {
     transform: scale(1.4) rotate(5deg);
     opacity: 1;
     filter: brightness(1.4) hue-rotate(120deg);
     box-shadow: 0 0 40px rgba(255, 182, 193, 0.8), 0 0 80px rgba(255, 215, 0, 0.6);
   }

   100% {
     transform: scale(1) rotate(0deg);
     opacity: 1;
     filter: brightness(1) hue-rotate(360deg);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
   }
  }

  @keyframes reappear {
   0% {
     transform: scale(0.85);
     opacity: 0.7;
   }
   50% {
     transform: scale(1.05);
     opacity: 1;
   }
   100% {
     transform: scale(1);
     opacity: 1;
   }
  }

  #backTopBtn.rotating {
   animation: rotate360 0.6s ease-in-out;
  }

  @keyframes rotate360 {
   0% { transform: rotate(0deg); }
   100% { transform: rotate(360deg); }
  }

   
  .particle {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 4px;
   height: 4px;
   background: radial-gradient(circle, #fff, #ffd700, #ff69b4, #87ceeb);
   border-radius: 50%;
   pointer-events: none;
   z-index: -2;
   animation: particleExplode 1s ease-out forwards;
  }

  @keyframes particleExplode {
   0% {
     transform: translate(-50%, -50%) scale(0);
     opacity: 1;
   }
   50% {
     opacity: 1;
   }
   100% {
     transform: translate(-50%, -50%) scale(1) translate(var(--x), var(--y));
     opacity: 0;
   }
  }

   
  .energy-wave {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 0;
   height: 0;
   border: 2px solid transparent;
   border-radius: 50%;
   pointer-events: none;
   z-index: -3;
   animation: energyWave 1.2s ease-out forwards;
  }

  @keyframes energyWave {
   0% {
     width: 0;
     height: 0;
     border-color: rgba(255, 215, 0, 0.8);
     opacity: 1;
   }
   100% {
     width: 120px;
     height: 120px;
     border-color: rgba(255, 215, 0, 0);
     opacity: 0;
   }
  }

   
  .hero-aura {
   position: absolute;
   top: 50%;
   left: 50%;
   width: 100%;
   height: 100%;
   border-radius: 50%;
   background: conic-gradient(from 0deg, #ffd700, #ff69b4, #87ceeb, #98fb98, #ffa07a, #ffd700);
   background-size: 200% 200%;
   pointer-events: none;
   z-index: -4;
   animation: heroAura 2s linear infinite;
   opacity: 0;
   transition: opacity 0.3s ease;
  }

  #backTopBtn.sprinting .hero-aura {
   opacity: 0.6;
  }

  @keyframes heroAura {
   0% {
     background-position: 0% 0%;
     transform: translate(-50%, -50%) rotate(0deg);
   }
   100% {
     background-position: 100% 100%;
     transform: translate(-50%, -50%) rotate(360deg);
   }
  }

   
      @media (max-width: 768px) {
     #backTopBtn {
       left: 20px !important;  
       right: auto !important;
       bottom: 20px;
       width: 28px;
       height: 28px;
     }
     
     .button-tooltip {
       left: 20px !important;  
       right: auto !important;
       bottom: 35px;
     }
    }
  
    @media (max-width: 480px) {
     #backTopBtn {
       left: 15px !important;  
       right: auto !important;
       bottom: 15px;
       width: 26px;
       height: 26px;
     }
     
     .button-tooltip {
       left: 15px !important;
       right: auto !important;
       bottom: 31px;
     }
    }

   
   
   
  .no-text-selection {
    -webkit-user-select: none;  
    -moz-user-select: none;     
    -ms-user-select: none;      
    user-select: none;          
  }

   
   
   
  #rope-container {
    position: fixed;
    top: 0;
    left: 20px;
    z-index: 10000;
    width: 50px;
    height: 480px;
    pointer-events: none;
  }
  
   
  #rope-physics-container {
    pointer-events: auto !important;
  }
  
   
  #rope-svg-container svg {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }
  
  #rope-svg-container path {
    transition: all 0.1s ease-out;
  }
  
   
  #rope-svg-container path,
  #rope-path {
    stroke: #4b2b0f !important;
    stroke-width: 2.5 !important;
  }
  
   
  #rope-svg-container svg path {
    stroke: #4b2b0f !important;
    stroke-width: 2.5 !important;
  }
  


  #rope {
    position: absolute;
    top: -80px;
    left: 50%;
    width: 3px;
    height: 400px;
    background: linear-gradient(to bottom, #654321, #8B4513, #A0522D, #8B4513, #654321);
    border-radius: 1.5px;
    transform: translateX(-50%);
    pointer-events: auto;
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 1px 3px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
  }

  #pull-ring {
    position: absolute;
    top: 300px;
    left: 50%;
    font-size: 20px;
    color: #ffffff;
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
    transform: translateX(-50%);
    pointer-events: auto;
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
  }

  #rope:hover {
    box-shadow: 0 2px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.2);
  }

  #pull-ring:hover {
    transform: translateX(-50%) scale(1.2);
    text-shadow: 0 0 12px rgba(255, 255, 255, 1);
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
  }

   
   
   
  .highlight {
   max-height: 400px;
   overflow: hidden;
   position: relative;
   transition: max-height 0.3s ease-out;
  }

  .code-show {
   max-height: none !important;
  }

  .code-more-box {
   width: 100%;
   padding-top: 20px;
   background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), #fff);
   position: absolute;
   left: 0;
   right: 0;
   bottom: 0;
   z-index: 1;
   text-align: center;
  }

  .code-more-btn {
   display: inline-block;
   padding: 5px 15px;
   background: #f0f0f5;
   border-radius: 5px;
   cursor: pointer;
   font-size: 0.9em;
  }

   
   
   
  #particles-js {
   position: fixed;
   top: 0;
   left: 0;
    width: 100vw;
    height: 100vh;
   z-index: -1;
    pointer-events: none;
  }
  
  #particles-js canvas {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
  }

   
   
   
  .toc-lock-btn {
    position: absolute;
    top: 32px;
    right: 5px;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    background: rgba(0, 0, 0, 0.05);
    color: rgba(0, 0, 0, 0.7);
    z-index: 100;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
  
  .toc-lock-btn:hover {
    background: rgba(0, 0, 0, 0.1);
    transform: scale(1.1);
    border-color: rgba(0, 0, 0, 0.2);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  }
  
  .toc-lock-btn:active {
    transform: scale(0.95);
  }
  
   
  .toc-lock-btn:focus {
    outline: none;
    border-color: rgba(0, 0, 0, 0.4);
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.1);
    background: rgba(0, 0, 0, 0.08);
  }
  
  .toc-lock-btn:focus-visible {
    outline: none;
    border-color: rgba(0, 0, 0, 0.4);
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.1);
    background: rgba(0, 0, 0, 0.08);
  }
  
  .toc-lock-btn.locked {
    color: rgba(0, 0, 0, 0.9);
    background: rgba(0, 0, 0, 0.1);
    border-color: rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }
  
  .toc-lock-btn.locked:hover {
    background: rgba(0, 0, 0, 0.15);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
  }
  
  .toc-lock-btn.locked .lock-icon.locked {
    display: block;
  }
  
  .toc-lock-btn.locked .lock-icon.unlocked {
    display: none;
  }
  
  .toc-lock-btn .lock-icon.locked {
    display: none;
  }
  
  .toc-lock-btn .lock-icon.unlocked {
    display: block;
  }
  
  .toc-lock-btn .lock-icon {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: all 0.3s ease;
  }
  
   
  .toc-lock-label {
    position: absolute;
    top: 38px;
    right: 28px;
    font-size: 16px;
    color: rgba(0, 0, 0, 0.6);
    font-weight: 700;
    z-index: 100;
    user-select: none;
    pointer-events: none;
    line-height: 1;
    display: flex;
    align-items: center;
  }

   
  [data-scheme="dark"] .toc-lock-btn {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
  }
  
  [data-scheme="dark"] .toc-lock-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 16px rgba(255, 255, 255, 0.15);
  }
  
   
  [data-scheme="dark"] .toc-lock-btn:focus,
  [data-scheme="dark"] .toc-lock-btn:focus-visible {
    outline: none;
    border-color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1), 0 2px 8px rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.08);
  }
  
  [data-scheme="dark"] .toc-lock-btn.locked {
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
  }
  
  [data-scheme="dark"] .toc-lock-btn.locked:hover {
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 4px 16px rgba(255, 255, 255, 0.25);
  }
  
   
  [data-scheme="dark"] .toc-lock-label {
    color: rgba(255, 255, 255, 0.6);
  }

   
  #TableOfContents[data-scrollspy-disabled="true"] {
    opacity: 0.8 !important;
  }
  
  #TableOfContents[data-scrollspy-disabled="true"] .active-class {
     
    display: block !important;
    opacity: 1 !important;
  }
  
  #TableOfContents[data-scrollspy-disabled="true"] a {
    cursor: pointer !important;
  }
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

<script>
   
   
   

  let s1 = '2025-5-8 15:00:00'; 
  s1 = new Date(s1.replace(/-/g, "/"));
  let s2 = new Date();
  let timeDifference = s2.getTime() - s1.getTime();

  let days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
  let hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  let minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));

  let result = days + "天" + hours + "小时" + minutes + "分钟";
  if (document.getElementById('runningdays')) {
      document.getElementById('runningdays').innerHTML = result;
  }
  
   
   
   
  
  

  function startContinuousRipple(button) {
   
   const buttonRipple = document.createElement('div');
   buttonRipple.className = 'button-ripple';
   button.appendChild(buttonRipple);
   
   
   button.buttonRipple = buttonRipple;
  }
  
  

  function createContinuousRipple(button) {
   
   if (button.querySelector('.continuous-ripple')) {
     return;
   }
   
   
   const rippleContainer = document.createElement('div');
   rippleContainer.className = 'ripple-container continuous-ripple';
   
   
   const ripple = document.createElement('div');
   ripple.className = 'ripple';
   ripple.style.background = 'radial-gradient(circle, rgba(255, 107, 107, 0.8) 0%, rgba(255, 255, 255, 0.9) 100%)';
   
   rippleContainer.appendChild(ripple);
   button.appendChild(rippleContainer);
   
   
   setTimeout(() => {
     if (rippleContainer.parentNode) {
       rippleContainer.parentNode.removeChild(rippleContainer);
     }
   }, 800);
  }
  
  

  function createHoverRipple(button) {
   
   if (button.buttonRipple) {
     
     button.buttonRipple.style.animationDuration = '1s';
     button.buttonRipple.classList.add('hover-mode');
   }
  }
  
  

  function showTooltip(button) {
   
   hideTooltip();
   
   
   const tooltip = document.createElement('div');
   tooltip.className = 'button-tooltip';
   tooltip.textContent = '返回顶部';
   document.body.appendChild(tooltip);
   
   
   setTimeout(() => {
     tooltip.classList.add('show');
   }, 10);
   
   
   button.tooltip = tooltip;
  }
  
  

  function hideTooltip() {
   const existingTooltip = document.querySelector('.button-tooltip');
   if (existingTooltip) {
     existingTooltip.classList.remove('show');
     setTimeout(() => {
       if (existingTooltip.parentNode) {
         existingTooltip.parentNode.removeChild(existingTooltip);
       }
     }, 300);
   }
  }
  
  

  function createRippleEffect(button) {
   
   
   
   const energyWave = document.createElement('div');
   energyWave.className = 'energy-wave';
   document.body.appendChild(energyWave);
   
   
   createParticleExplosion(button);
   
   
   setTimeout(() => {
     if (energyWave.parentNode) {
       energyWave.parentNode.removeChild(energyWave);
     }
   }, 1200);
  }

  

  function createParticleExplosion(button) {
   const particleCount = 16; 
   
   
   const particleColors = [
     'radial-gradient(circle, #ff6b6b, #ffd93d, #6bcf7f, #4d96ff)',
     'radial-gradient(circle, #ff8e8e, #ffed4e, #7ddb8f, #6ba6ff)',
     'radial-gradient(circle, #ffa1a1, #fff15f, #8ee79f, #89b6ff)',
     'radial-gradient(circle, #ffb4b4, #fff570, #9ff3af, #a7c6ff)'
   ];
   
   for (let i = 0; i < particleCount; i++) {
     const particle = document.createElement('div');
     particle.className = 'particle';
     
     
     const randomColor = particleColors[Math.floor(Math.random() * particleColors.length)];
     particle.style.background = randomColor;
     
     
     const angle = (i / particleCount) * 2 * Math.PI;
     const distance = 40 + Math.random() * 30; 
     const x = Math.cos(angle) * distance;
     const y = Math.sin(angle) * distance;
     
     particle.style.setProperty('--x', `${x}px`);
     particle.style.setProperty('--y', `${y}px`);
     
     
     particle.style.animationDelay = `${Math.random() * 0.4}s`;
     
     button.appendChild(particle);
     
     
     setTimeout(() => {
       if (particle.parentNode) {
         particle.parentNode.removeChild(particle);
       }
     }, 1000);
   }
  }

   
   
   
  

  function initScrollTop() {
   let rightSideBar = document.querySelector(".right-sidebar");
   if (!rightSideBar) {
    return;
   }

   
   let btn = document.createElement("div");
   btn.id = "backTopBtn";
   let isRotating = false; 

   
   const heroAura = document.createElement('div');
   heroAura.className = 'hero-aura';
   btn.appendChild(heroAura);

   
   btn.addEventListener('mouseenter', function() {
     createHoverRipple(this);
     showTooltip(this);
   });
   
   
   btn.addEventListener('mouseleave', function() {
     if (this.buttonRipple) {
       
       this.buttonRipple.style.animationDuration = '2s';
       this.buttonRipple.classList.remove('hover-mode');
     }
     hideTooltip();
   });

   btn.onclick = function() {
    if (!isRotating) {
     isRotating = true;
     backToTop(this, () => {
      isRotating = false; 
     });
    }
   };
   rightSideBar.appendChild(btn);

   
   btn.style.display = "block";
   
   
   startContinuousRipple(btn);
  }

  

  function backToTop(button, onComplete) {
   
   button.classList.add('sprinting');
   
   
   if (button.buttonRipple) {
     button.buttonRipple.style.display = 'none';
   }
   
   
   createRippleEffect(button);
   
   
   window.scrollTo({ top: 0, behavior: "smooth" });
   
   
   const checkScrollComplete = () => {
     if (window.scrollY === 0) {
       
       button.classList.remove('sprinting');
       
       
       button.classList.add('exploding');
       
       
       createParticleExplosion(button);
       
       
       if (button.buttonRipple) {
         button.buttonRipple.style.display = 'block';
       }
       
       
       setTimeout(() => {
         button.classList.remove('exploding');
         
         
         if (button.buttonRipple) {
           
           button.buttonRipple.style.animationPlayState = 'paused';
           
           button.buttonRipple.style.animation = 'none';
           button.buttonRipple.offsetHeight; 
           button.buttonRipple.style.animation = 'buttonRippleExpand 2s steps(25, end) infinite';
           button.buttonRipple.style.animationPlayState = 'running';
         }
         
         button.classList.add('reappearing');
         
         
         setTimeout(() => {
           button.classList.remove('reappearing');
           if (onComplete) {
             onComplete();
           }
         }, 600);
       }, 800); 
       
       return;
     }
     requestAnimationFrame(checkScrollComplete);
   };
   
   checkScrollComplete();
  }

  
  initScrollTop();
  
   
   
   
  

  function initRope() {


    if (typeof Matter === 'undefined') {
      console.error('Matter.js 库未加载，无法初始化物理绳索。');
      return;
    }
    if (document.getElementById('rope-physics-container')) {

      return;
    }

    let ropeContainer = document.getElementById('rope-container');
    if (!ropeContainer) {
      console.error('#rope-container 元素未在 HTML 或 CSS 中找到。');
      return;
    }
    
    ropeContainer.innerHTML = '';
    ropeContainer.style.height = '100vh';
    ropeContainer.style.pointerEvents = 'none';

    const monthlyEmojis = [
      { month: 1, name: "一月", ring: "❄️", falling: "❄️", description: "寒冬腊月，雪花飞舞" },
      { month: 2, name: "二月", ring: "🏮", falling: "🏮", description: "新春正月，灯笼高挂" },
      { month: 3, name: "三月", ring: "🌸", falling: "🌸", description: "春暖花开，樱花绽放" },
      { month: 4, name: "四月", ring: "🌧️", falling: "🌧️", description: "清明时节，春雨绵绵" },
      { month: 5, name: "五月", ring: "🌺", falling: "🌺", description: "立夏时节，牡丹盛开" },
      { month: 6, name: "六月", ring: "🌻", falling: "🌻", description: "芒种时节，向日葵开" },
      { month: 7, name: "七月", ring: "🌿", falling: "🌿", description: "小暑时节，绿意盎然" },
      { month: 8, name: "八月", ring: "🍉", falling: "🍉", description: "七夕时节，西瓜清甜" },
      { month: 9, name: "九月", ring: "🍁", falling: "🍁", description: "白露时节，秋葉飘落" },
      { month: 10, name: "十月", ring: "🍂", falling: "🍂", description: "寒露时节，落叶纷飞" },
      { month: 11, name: "十一月", ring: "🍊", falling: "🍊", description: "霜降时节，柑橘飘香" },
      { month: 12, name: "十二月", ring: "🌨️", falling: "🌨️", description: "大雪时节，雪花纷飞" }
    ];
    window.timeEmojis = [
      { period: "morning", name: "早晨", emojis: ["☀️", "🌤️", "🌱", "🌺", "🌿"], description: "晨曦初露，万物苏醒" },
      { period: "noon", name: "中午", emojis: ["🌞", "🌻", "🦋", "🦜", "🐝"], description: "烈日当空，生机勃勃" },
      { period: "evening", name: "傍晚", emojis: ["🌙", "⭐", "🦉"], description: "夕阳西下，夜幕降临" }
    ];
    const currentMonth = new Date().getMonth() + 1;
    const currentEmoji = monthlyEmojis.find(emoji => emoji.month === currentMonth);
    
    const ropeContainerLeft = 20;
    const ropeContainerWidth = 50;
    const ropeAnchorX = ropeContainerLeft + (ropeContainerWidth / 2);

    const { Engine, World, Bodies, Composite, Constraint, Runner, Mouse, MouseConstraint, Events, Body } = Matter;

    const engine = Engine.create();
    const world = engine.world;
    
    
    
    
    engine.world.gravity.y = 0;

    
    
    
    const ropeSegments = 80; 
    const segmentRadius = 1.5; 
    const segmentRenderHeight = 6; 
    const segmentRenderWidth = 4; 
    const constraintLength = 2.5; 

    const ropeGroup = Matter.Body.nextGroup(true);
    const ropeChain = Composite.create({ label: 'Rope' });

    
    for (let i = 0; i < ropeSegments - 1; i++) {
      const segment = Bodies.circle(ropeAnchorX, i * constraintLength, segmentRadius, {
          collisionFilter: { group: ropeGroup },
          density: 0.1, 
          friction: 0.4, 
          frictionAir: 0.08, 
          restitution: 0.02 
      });
      Composite.add(ropeChain, segment);
    }

    
    const pullRingBody = Bodies.circle(
      ropeAnchorX,
      (ropeSegments - 1) * constraintLength,
      15,
      {
        collisionFilter: { group: ropeGroup },
        density: 0.01, 
        friction: 0.5,  
        frictionAir: 0.1, 
        restitution: 0.02 
      }
    );
    Composite.add(ropeChain, pullRingBody);
    World.add(world, ropeChain);

    
    Composite.addConstraint(ropeChain, Constraint.create({
      bodyB: ropeChain.bodies[0],
      pointA: { x: ropeAnchorX, y: 0 },
      stiffness: 1 
    }));

    for (let i = 0; i < ropeSegments - 1; i++) {
      Composite.addConstraint(ropeChain, Constraint.create({
        bodyA: ropeChain.bodies[i],
        bodyB: ropeChain.bodies[i + 1],
        
        
        
        stiffness: 0.8, 
        damping: 0.8,   
        length: constraintLength * 0.6, 
        
        render: {
          visible: false
        }
      }));
    }
    
    const domContainer = document.createElement('div');
    domContainer.id = 'rope-physics-container';
    domContainer.style.position = 'fixed';
    domContainer.style.top = '0';
    domContainer.style.left = '0';
    domContainer.style.pointerEvents = 'auto'; 
    domContainer.style.zIndex = '10000';
    document.body.appendChild(domContainer);

    
    const svgContainer = document.createElement('div');
    svgContainer.id = 'rope-svg-container';
    svgContainer.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100vh;
      pointer-events: none;
      z-index: 1;
      overflow: visible;
    `;
    domContainer.appendChild(svgContainer);
    
    
    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svg.setAttribute('width', '100');
    svg.setAttribute('height', '100vh');
    svg.setAttribute('viewBox', '0 0 100 100vh');
    svg.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100vh;
      overflow: visible;
    `;
    svgContainer.appendChild(svg);
    
    
    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
    const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
    gradient.setAttribute('id', 'ropeGradient');
    gradient.setAttribute('x1', '0%');
    gradient.setAttribute('y1', '0%');
    gradient.setAttribute('x2', '0%');
    gradient.setAttribute('y2', '100%');
    
    const stop1 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop1.setAttribute('offset', '0%');
    stop1.setAttribute('stop-color', '#654321');
    
    const stop2 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop2.setAttribute('offset', '25%');
    stop2.setAttribute('stop-color', '#8B4513');
    
    const stop3 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop3.setAttribute('offset', '50%');
    stop3.setAttribute('stop-color', '#A0522D');
    
    const stop4 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop4.setAttribute('offset', '75%');
    stop4.setAttribute('stop-color', '#8B4513');
    
    const stop5 = document.createElementNS('http://www.w3.org/2000/svg', 'stop');
    stop5.setAttribute('offset', '100%');
    stop5.setAttribute('stop-color', '#654321');
    
    gradient.appendChild(stop1);
    gradient.appendChild(stop2);
    gradient.appendChild(stop3);
    gradient.appendChild(stop4);
    gradient.appendChild(stop5);
    defs.appendChild(gradient);
    svg.appendChild(defs);
    
    
    const ropePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    ropePath.setAttribute('fill', 'none');
    
    ropePath.setAttribute('stroke', '#4b2b0f');
    ropePath.setAttribute('stroke-width', '2.5');
    ropePath.setAttribute('stroke-linecap', 'round');
    ropePath.setAttribute('stroke-linejoin', 'round');
    ropePath.setAttribute('id', 'rope-path'); 
    svg.appendChild(ropePath);
    
    
    ropePath.setAttribute('d', `M 50 0 L 50 400`);
    
    
    
    
    
    const pullRingDiv = document.createElement('div');
    pullRingDiv.id = 'pull-ring-physics';
    pullRingDiv.innerHTML = currentEmoji.ring;
    pullRingDiv.title = `${currentEmoji.name}: ${currentEmoji.description}`;
    pullRingDiv.style.cssText = `
      font-size: 24px; cursor: grab; pointer-events: auto;
      width: 30px; height: 30px; text-align: center;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); position: absolute;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      z-index: 2;
      transform: translate(40px, 300px); /* 初始位置，向右移动5px */
    `;
    
    
    pullRingDiv.addEventListener('mousedown', () => {
      pullRingDiv.style.cursor = 'grabbing';
    });
    
    pullRingDiv.addEventListener('mouseup', () => {
      pullRingDiv.style.cursor = 'grab';
    });
    
    domContainer.appendChild(pullRingDiv);
    
    
    const ropeElements = {
      svg: svg,
      path: ropePath,
      pullRing: pullRingDiv
    };

    const mouse = Mouse.create(document.body);
    const mouseConstraint = MouseConstraint.create(engine, {
      mouse: mouse,
      constraint: { 
        stiffness: 0.8, 
        render: { visible: false },
        
        length: 0,
        damping: 0.05 
      }
    });
    World.add(world, mouseConstraint);
    
    
    mouseConstraint.constraint.bodyB = null;
    
    
    Events.on(mouseConstraint, 'mousedown', (event) => {

    });
    
    
    mouseConstraint.mouse.element = document.body;
    
    
    let dragStartPosition = null;
    
    Events.on(mouseConstraint, 'startdrag', () => {
      document.body.classList.add('no-text-selection');
      
      
      if (mouseConstraint.body && mouseConstraint.body === pullRingBody) {
        dragStartPosition = {
          x: mouseConstraint.body.position.x,
          y: mouseConstraint.body.position.y
        };
      }
    });
    
    Events.on(mouseConstraint, 'enddrag', () => {
      document.body.classList.remove('no-text-selection');
      
      
      
      if (dragStartPosition) {
        
        const currentPosition = pullRingBody.position;
        const dragDistance = Math.sqrt(
          Math.pow(currentPosition.x - dragStartPosition.x, 2) +
          Math.pow(currentPosition.y - dragStartPosition.y, 2)
        );
        
        
        if (dragDistance > 1) {
          createSeasonalFalling(currentEmoji);
          
          
          Matter.Body.applyForce(pullRingBody, pullRingBody.position, { x: 0, y: 0.5 });
          
          
          const targetX = ropeAnchorX;
          const targetY = (ropeSegments - 1) * constraintLength;
          
          
          const dx = targetX - currentPosition.x;
          const dy = targetY - currentPosition.y;
          
          
          Matter.Body.applyForce(pullRingBody, pullRingBody.position, { 
            x: dx * 0.001, 
            y: dy * 0.001 
          });
          
        }
        
        
        dragStartPosition = null;
      }
    });
    


    
    (function render() {
      
      let pathData = '';
      
      
      const topPoint = { x: 50, y: 0 }; 
      pathData += `M ${topPoint.x} ${topPoint.y}`;
      
      
      ropeChain.bodies.forEach((body, index) => {
        if (index < ropeSegments - 1) { 
          const relativeX = body.position.x - ropeAnchorX + 50; 
          const relativeY = body.position.y;
          pathData += ` L ${relativeX} ${relativeY}`;
        }
      });
      
      
      const pullRingBody = ropeChain.bodies[ropeSegments - 1];
      if (pullRingBody) {
        const relativeX = pullRingBody.position.x - ropeAnchorX + 50; 
        const relativeY = pullRingBody.position.y;
        pathData += ` L ${relativeX} ${relativeY}`;
      }
      
      
      ropeElements.path.setAttribute('d', pathData);
      
      
      if (pullRingBody) {
        
        
        const adjustedX = pullRingBody.position.x - 15 + 3.5; 
        const adjustedY = pullRingBody.position.y - 15;
        
        ropeElements.pullRing.style.transform = `translate(
          ${adjustedX}px,
          ${adjustedY}px
        )`;
        

      }
      
      setTimeout(() => requestAnimationFrame(render), 1000 / 240); 
    })();
    
    
    
    const runner = Runner.create();
    
    runner.delta = 1000 / 240; 
    Runner.run(runner, engine);

    
    
    
    setTimeout(() => {
      engine.world.gravity.y = 1.2;
    }, 100); 

    
    
    
    
    
    ropeChain.bodies.forEach((body, index) => {
      Matter.Body.set(body, 'sleeping', false);
      
      body.sleepThreshold = Infinity;
    });
    
    
    engine.enableSleeping = false;
    
    
    mouseConstraint.constraint.bodyB = null;
    mouseConstraint.mouse.element = document.body;


  }

  

  function createSeasonalFalling(emojiConfig) {

   
   
   const fallingContainer = document.createElement('div');
   fallingContainer.id = 'falling-container';
   fallingContainer.style.cssText = `
     position: fixed;
     top: 0;
     left: 0;
     width: 100vw;
     height: 100vh;
     pointer-events: none;
     z-index: 9999;
     overflow: hidden;
   `;
   document.body.appendChild(fallingContainer);

   
   
   const currentHour = new Date().getHours();
   let currentTimePeriod;
   if (currentHour >= 5 && currentHour < 11) {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "morning");
   } else if (currentHour >= 11 && currentHour < 17) {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "noon");
   } else {
    currentTimePeriod = window.timeEmojis.find(t => t.period === "evening");
   }
   

   
   
   const totalElements = emojiConfig.month >= 11 || emojiConfig.month <= 2 ? 30 : 25; 
   let activeElements = 0;
   

   
   for (let i = 0; i < totalElements; i++) {
    setTimeout(() => {
     const element = document.createElement('div');
     
     
     let selectedEmoji, emojiType;
     if (Math.random() < 0.7) {
      selectedEmoji = emojiConfig.falling;
      emojiType = "monthly";
     } else {
      
      selectedEmoji = currentTimePeriod.emojis[Math.floor(Math.random() * currentTimePeriod.emojis.length)];
      emojiType = "time";
     }
     

     element.innerHTML = selectedEmoji;
     
     
     let fontSize, color, textShadow;
     if (emojiType === "time") {
      
      if (currentTimePeriod.period === "morning") {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FFD700';
       textShadow = '0 0 5px rgba(255, 215, 0, 0.7)';
      } else if (currentTimePeriod.period === "noon") {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FF8C00';
       textShadow = '0 0 5px rgba(255, 140, 0, 0.7)';
      } else {
       
       fontSize = Math.random() * 18 + 16;
       color = '#4B0082';
       textShadow = '0 0 5px rgba(75, 0, 130, 0.7)';
      }
     } else {
      
      if (emojiConfig.month >= 11 || emojiConfig.month <= 2) {
       
       fontSize = Math.random() * 20 + 15;
       color = 'white';
       textShadow = '0 0 5px rgba(255, 255, 255, 0.8)';
      } else if (emojiConfig.month >= 3 && emojiConfig.month <= 5) {
       
       fontSize = Math.random() * 18 + 16;
       color = '#FF69B4';
       textShadow = '0 0 5px rgba(255, 105, 180, 0.6)';
      } else if (emojiConfig.month >= 6 && emojiConfig.month <= 8) {
       
       fontSize = Math.random() * 18 + 15;
       color = '#32CD32';
       textShadow = '0 0 5px rgba(50, 205, 50, 0.6)';
      } else {
       
       fontSize = Math.random() * 18 + 15;
       color = '#FF8C00';
       textShadow = '0 0 5px rgba(255, 140, 0, 0.6)';
      }
     }
     
     element.style.cssText = `
       position: absolute;
       font-size: ${fontSize}px;
       color: ${color};
       text-shadow: ${textShadow};
       left: ${Math.random() * window.innerWidth}px;
       top: -50px;
       user-select: none;
       pointer-events: none;
       z-index: 9999;
       transition: all 0.3s ease;
     `;
     
     fallingContainer.appendChild(element);
     activeElements++;
     
     
     const duration = 4000 + Math.random() * 2000;
     const endX = parseFloat(element.style.left) + (Math.random() - 0.5) * 400;
     const endY = window.innerHeight + 50;
     
     element.style.transition = `all ${duration}ms linear`;
     
     setTimeout(() => {
      element.style.left = endX + 'px';
      element.style.top = endY + 'px';
      element.style.opacity = '0';
     }, 50);
     
     
     setTimeout(() => {
      if (element.parentNode) {
       element.parentNode.removeChild(element);
      }
      activeElements--;
      
      
      if (activeElements === 0) {
       if (fallingContainer && fallingContainer.parentNode) {
        fallingContainer.parentNode.removeChild(fallingContainer);
       }
      }
     }, duration);
    }, i * 150);
   }
  }

   
   
   
  function initCodeMoreBox() {
   let codeBlocks = document.querySelectorAll(".highlight");
   if (!codeBlocks) {
    return;
   }
   codeBlocks.forEach(codeBlock => {
    
    if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
     return;
    }
    
    
    let codeMoreBox = document.createElement('div');
    codeMoreBox.classList.add('code-more-box');
    
    let codeMoreBtn = document.createElement('span');
    codeMoreBtn.classList.add('code-more-btn');
    codeMoreBtn.innerText = '显示更多'; 
    let isExpanded = false; 

    codeMoreBtn.addEventListener('click', () => {
     if (!isExpanded) {
      codeBlock.classList.add('code-show'); 
      codeMoreBtn.innerText = '折叠'; 
      isExpanded = true;
     } else {
      codeBlock.classList.remove('code-show'); 
      codeMoreBtn.innerText = '显示更多'; 
      isExpanded = false;
     }
     
     window.dispatchEvent(new Event('resize'));
    });
    
    codeMoreBox.appendChild(codeMoreBtn);
    codeBlock.appendChild(codeMoreBox);
   });
  }


  
   
   
   
  
  

  function captureScrollListeners() {
    
    setTimeout(() => {
      
      overrideScrollspy();
    }, 2000);
  }
  
  

  function overrideScrollspy() {
    
    window.tocScrollspyEnabled = true;
    
    
    setTimeout(() => {
      
      
      
      
      if (!window.originalScrollTo) {
        window.originalScrollTo = HTMLElement.prototype.scrollTo;
        
        HTMLElement.prototype.scrollTo = function(options) {
          
          if (this.id === 'TableOfContents' && window.tocScrollDisabled) {
            return;
          }
          
          
          return window.originalScrollTo.call(this, options);
        };
      }
      
      
      if (!window.originalScrollIntoView) {
        window.originalScrollIntoView = HTMLElement.prototype.scrollIntoView;
        
        HTMLElement.prototype.scrollIntoView = function(options) {
          
          if (this.closest('#TableOfContents') && window.tocScrollDisabled) {
            return;
          }
          
          
          return window.originalScrollIntoView.call(this, options);
        };
      }
    }, 3000); 
  }
  
  function initTocLock() {
    
    
    const articleToc = document.querySelector('#TableOfContents');
    if (!articleToc) {
      
      return;
    }
    
    
    const tocContainer = document.querySelector('.widget.archives');
    if (!tocContainer) {
      return;
    }
    
    
    tocContainer.style.position = 'relative';
    
    
    captureScrollListeners();
    
    
    const lockLabel = document.createElement('div');
    lockLabel.className = 'toc-lock-label';
    lockLabel.textContent = '锁定：';
    
    
    const lockBtn = document.createElement('div');
    lockBtn.className = 'toc-lock-btn';
    lockBtn.innerHTML = `
      <svg class="lock-icon unlocked" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2z"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
      </svg>
      <svg class="lock-icon locked" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="11" width="18" height="10" rx="2" ry="2"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        <path d="M9 12v3a3 3 0 0 0 6 0v-3"/>
      </svg>
    `;
    
    
    lockBtn.addEventListener('click', function() {
      const isLocked = this.classList.contains('locked');
      
      if (isLocked) {
        
        this.classList.remove('locked');
        localStorage.setItem('tocLocked', 'false');
        enableTocScroll();
      } else {
        
        this.classList.add('locked');
        localStorage.setItem('tocLocked', 'true');
        disableTocScroll();
      }
    });
    
    
    tocContainer.appendChild(lockLabel);
    tocContainer.appendChild(lockBtn);
    
    
    
    lockBtn.classList.remove('locked');
    localStorage.setItem('tocLocked', 'false');
    
    
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          const isLocked = lockBtn.classList.contains('locked');
          if (isLocked) {
            disableTocScroll();
          } else {
            enableTocScroll();
          }
        }
      });
    });
    
    observer.observe(lockBtn, { attributes: true });
  }

  

  function disableTocScroll() {
    
    window.tocScrollDisabled = true;
    
    
    const tocContainer = document.querySelector('#TableOfContents');
    if (tocContainer) {
      
      window.savedTocScrollTop = tocContainer.scrollTop;
      
      
      const currentActive = tocContainer.querySelector('.active-class');
      if (currentActive) {
        window.savedActiveElement = currentActive;
      }
    }
    
    
    if (tocContainer) {
      tocContainer.setAttribute('data-scrollspy-disabled', 'true');
      tocContainer.title = '目录已锁定，不会自动跟随滚动';
    }
    
    
    const archivesContainer = document.querySelector('.widget.archives');
    if (archivesContainer) {
      archivesContainer.style.opacity = '0.8';
      archivesContainer.title = '目录已锁定，不会自动跟随滚动';
    }
  }

  

  function enableTocScroll() {
    
    window.tocScrollDisabled = false;
    
    
    const tocContainer = document.querySelector('#TableOfContents');
    if (tocContainer) {
      
      tocContainer.removeAttribute('data-scrollspy-disabled');
      tocContainer.title = '';
    }
    
    
    const archivesContainer = document.querySelector('.widget.archives');
    if (archivesContainer) {
      archivesContainer.style.opacity = '1';
      archivesContainer.title = '';
    }
  }

  
  
  
  document.addEventListener('DOMContentLoaded', function() {
  

    
    initCodeMoreBox();
    initRope();

    
    setTimeout(initTocLock, 1000);
  });

</script>


<div id="rope-container"></div>


<div id="particles-js"></div>

<script>

particlesJS('particles-js', {
  "particles": {
    "number": {
      "value": 80,
      "density": {
        "enable": true,
        "value_area": 800
      }
    },
    "color": {
      "value": ["#888888", "#aaaaaa", "#cccccc", "#eeeeee"]
    },
    "shape": {
      "type": "circle",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      }
    },
    "opacity": {
      "value": 0.5,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 2,
      "random": true,
      "anim": {
        "enable": false,
        "speed": 40,
        "size_min": 0.1,
        "sync": false
      }
    },
    "line_linked": {
      "enable": true,
      "distance": 150,
      "color": "#888888",
      "opacity": 0.4,
      "width": 1
    },
    "move": {
      "enable": true,
      "speed": 2,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      "onhover": {
        "enable": true,
        "mode": "grab"
      },
      "onclick": {
        "enable": true,
        "mode": "push"
      },
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 140,
        "line_linked": {
          "opacity": 1
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 200,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
});
</script>


<script>
(function() {
  'use strict';
  
  
  const categoryColors = [
    '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57',
    '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43',
    '#10ac84', '#ff6348', '#a55eea', '#e17055', '#d63031',
    '#00b894', '#fdcb6e', '#6c5ce7', '#fd79a8', '#f39c12',
    '#e67e22', '#e74c3c', '#9b59b6', '#3498db', '#1abc9c',
    '#16a085', '#27ae60', '#2ecc71', '#f1c40f', '#e67e22'
  ];
  
  
  function hashString(str) {
    let hash = 0;
    if (str.length === 0) return hash;
    
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + char;
      hash = hash & hash; 
    }
    
    return Math.abs(hash);
  }
  
  
  function assignCategoryColors() {

    
    
    const isArchivesPage = document.body.classList.contains('template-archives') ||
                          window.location.pathname.includes('/archives/');
    const isArticlePage = document.querySelector('#TableOfContents') || 
                         document.querySelector('.article-category');
    
    
    
    
    if (isArticlePage && !isArchivesPage) {
      const categoryLinks = document.querySelectorAll('.article-category a');

      
      categoryLinks.forEach((link, index) => {
        
        const href = link.getAttribute('href');
        const categoryName = href.split('/').pop() || href.split('/').slice(-2, -1)[0] || 'default';
        
        
        const hash = hashString(categoryName);
        const colorIndex = hash % categoryColors.length;
        const backgroundColor = categoryColors[colorIndex];
        
        
        
        
        link.style.setProperty('background-color', backgroundColor, 'important');
        link.style.setProperty('color', '#fff', 'important');
        
        
        link.addEventListener('mouseenter', function() {
          this.style.opacity = '0.8';
          this.style.transform = 'scale(1.05)';
        });
        
        link.addEventListener('mouseleave', function() {
          this.style.opacity = '1';
          this.style.transform = 'scale(1)';
        });
      });
    }
    
    
    if (!isArchivesPage) {
      
      const sidebarCategories = document.querySelectorAll('.widget.categories a, .widget.tagCloud a');

      
      sidebarCategories.forEach((link, index) => {
        
        const href = link.getAttribute('href');
        const categoryName = href.split('/').pop() || href.split('/').slice(-2, -1)[0] || 'default';
        
        
        const hash = hashString(categoryName);
        const colorIndex = hash % categoryColors.length;
        const backgroundColor = categoryColors[colorIndex];
        
        
        
        
        link.style.setProperty('background-color', backgroundColor, 'important');
        link.style.setProperty('color', '#fff', 'important');
        link.style.setProperty('border-radius', '6px', 'important');
        link.style.setProperty('padding', '8px 12px', 'important');
        link.style.setProperty('margin', '4px 0', 'important');
        link.style.setProperty('display', 'inline-block', 'important');
        link.style.setProperty('text-decoration', 'none', 'important');
        link.style.setProperty('transition', 'all 0.3s ease', 'important');
        
        
        link.addEventListener('mouseenter', function() {
          this.style.opacity = '0.8';
          this.style.transform = 'scale(1.05)';
          this.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.2)';
        });
        
        link.addEventListener('mouseleave', function() {
          this.style.opacity = '1';
          this.style.transform = 'scale(1)';
          this.style.boxShadow = 'none';
        });
      });
    } else {
      

    }
    

  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', assignCategoryColors);
  } else {
    assignCategoryColors();
  }
  
  
  setTimeout(assignCategoryColors, 500);
  setTimeout(assignCategoryColors, 1000);
  setTimeout(assignCategoryColors, 2000);
  
  
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
        
        const hasNewCategories = Array.from(mutation.addedNodes).some(node => {
          return node.nodeType === 1 && (
            node.classList.contains('article-category') ||
            node.querySelector('.article-category') ||
            node.classList.contains('widget') ||
            node.querySelector('.widget')
          );
        });
        
        if (hasNewCategories) {
          
          setTimeout(assignCategoryColors, 100);
          setTimeout(assignCategoryColors, 500);
        }
      }
    });
  });
  
  
  observer.observe(document.body, {
    childList: true,
    subtree: true
  });
})();
</script>


<script>
(function() {
  'use strict';
  
  
  function fixDarkModeToggleText() {
    const toggleBtn = document.getElementById('dark-mode-toggle');
    if (!toggleBtn) {
      return;
    }
    
    
    toggleBtn.classList.add('dark-mode-toggle-fix');
    
    
    const span = toggleBtn.querySelector('span');
    if (!span) {
      return;
    }
    
    
    function updateText() {
      const isDark = document.documentElement.dataset.scheme === 'dark';
      span.textContent = isDark ? '亮色模式' : '暗色模式';

    }
    
    
    updateText();
    
    
    function handleThemeChange() {
      setTimeout(updateText, 100); 
    }
    
    
    window.addEventListener('onColorSchemeChange', handleThemeChange);
    
    
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-scheme') {
          handleThemeChange();
        }
      });
    });
    
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-scheme']
    });
    
    
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', handleThemeChange);
    
    
    toggleBtn.addEventListener('click', function() {
      
      setTimeout(updateText, 200);
    });
    

  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', fixDarkModeToggleText);
  } else {
    fixDarkModeToggleText();
  }
  
  
  setTimeout(fixDarkModeToggleText, 1000);
  setTimeout(fixDarkModeToggleText, 2000);
})();
</script>

  
  <script>
  
  if (!document.getElementById('new-theme-switch')) {
    document.write(`
      <div id="new-theme-switch" style="position: fixed; bottom: 50px; left: 50px; z-index: 1000; text-align: center;">
        <label class="theme-switch">
          <input type="checkbox" class="theme-switch__checkbox" id="theme-switch-checkbox">
          <div class="theme-switch__container">
            <div class="theme-switch__clouds"></div>
            <div class="theme-switch__stars-container">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 55" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M135.831 3.00688C135.055 3.85027 134.111 4.29946 133 4.35447C134.111 4.40947 135.055 4.85867 135.831 5.71123C136.607 6.55462 136.996 7.56303 136.996 8.72727C136.996 7.95722 137.172 7.25134 137.525 6.59129C137.886 5.93124 138.372 5.39954 138.98 5.00535C139.598 4.60199 140.268 4.39114 141 4.35447C139.88 4.2903 138.936 3.85027 138.16 3.00688C137.384 2.16348 136.996 1.16425 136.996 0C136.996 1.16425 136.607 2.16348 135.831 3.00688ZM31 23.3545C32.1114 23.2995 33.0551 22.8503 33.8313 22.0069C34.6075 21.1635 34.9956 20.1642 34.9956 19C34.9956 20.1642 35.3837 21.1635 36.1599 22.0069C36.9361 22.8503 37.8798 23.2903 39 23.3545C38.2679 23.3911 37.5976 23.602 36.9802 24.0053C36.3716 24.3995 35.8864 24.9312 35.5248 25.5913C35.172 26.2513 34.9956 26.9572 34.9956 27.7273C34.9956 26.563 34.6075 25.5546 33.8313 24.7112C33.0551 23.8587 32.1114 23.4095 31 23.3545ZM0 36.3545C1.11136 36.2995 2.05513 35.8503 2.83131 35.0069C3.6075 34.1635 3.99559 33.1642 3.99559 32C3.99559 33.1642 4.38368 34.1635 5.15987 35.0069C5.93605 35.8503 6.87982 36.2903 8 36.3545C7.26792 36.3911 6.59757 36.602 5.98015 37.0053C5.37155 37.3995 4.88644 37.9312 4.52481 38.5913C4.172 39.2513 3.99559 39.9572 3.99559 40.7273C3.99559 39.563 4.38368 38.5546 2.83131 37.7112C2.05513 36.8587 1.11136 36.4095 0 36.3545ZM56.8313 24.0069C56.0551 24.8503 55.1114 25.2995 54 25.3545C55.1114 25.4095 56.0551 25.8587 56.8313 26.7112C57.6075 27.5546 57.9956 28.563 57.9956 29.7273C57.9956 28.9572 58.172 28.2513 58.5248 27.5913C58.8864 26.9312 59.3716 26.3995 59.9802 26.0053C60.5976 25.602 61.2679 25.3911 62 25.3545C60.8798 25.2903 59.9361 24.8503 59.1599 24.0069C58.3837 23.1635 57.9956 22.1642 57.9956 21C57.9956 22.1642 57.6075 23.1635 56.8313 24.0069ZM81 25.3545C82.1114 25.2995 83.0551 24.8503 83.8313 24.0069C84.6075 23.1635 84.9956 22.1642 84.9956 21C84.9956 22.1642 85.3837 23.1635 86.1599 24.0069C86.9361 24.8503 87.8798 25.2903 89 25.3545C88.2679 25.3911 87.5976 25.602 86.9802 26.0053C86.3716 26.3995 85.8864 26.9312 85.5248 27.5913C85.172 28.2513 84.9956 28.9572 84.9956 29.7273C84.9956 28.563 84.6075 27.5546 83.8313 26.7112C83.0551 25.8587 82.1114 25.4095 81 25.3545ZM136 36.3545C137.111 36.2995 138.055 35.8503 138.831 35.0069C139.607 34.1635 139.996 33.1642 139.996 32C139.996 33.1642 140.384 34.1635 141.16 35.0069C141.936 35.8503 142.88 36.2903 144 36.3545C143.268 36.3911 142.598 36.602 141.98 37.0053C141.372 37.3995 140.886 37.9312 140.525 38.5913C140.172 39.2513 139.996 39.9572 139.996 40.7273C139.996 39.563 139.607 38.5546 138.831 37.7112C138.055 36.8587 137.111 36.4095 136 36.3545ZM101.831 49.0069C101.055 49.8503 100.111 50.2995 99 50.3545C100.111 50.4095 101.055 50.8587 101.831 51.7112C102.607 52.5546 102.996 53.563 102.996 54.7273C102.996 53.9572 103.172 53.2513 103.525 52.5913C103.886 51.9312 104.372 51.3995 104.98 51.0053C105.598 50.602 106.268 50.3911 107 50.3545C105.88 50.2903 104.936 49.8503 104.16 49.0069C103.384 48.1635 102.996 47.1642 102.996 46C102.996 47.1642 102.607 48.1635 101.831 49.0069Z" fill="currentColor"></path>
              </svg>
            </div>
            <div class="theme-switch__circle-container">
              <div class="theme-switch__sun-moon-container">
                <div class="theme-switch__moon">
                  <div class="theme-switch__spot"></div>
                  <div class="theme-switch__spot"></div>
                  <div class="theme-switch__spot"></div>
                </div>
              </div>
            </div>
          </div>
        </label>
        <div id="theme-switch-text" style="color: #fff; font-size: 14px; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.5); margin-top: 8px; text-align: center;">亮色模式</div>
      </div>
    `);
  }
  </script>


<style>
   
  .theme-switch {
    --toggle-size: 20px;  
    --container-width: 3.75em;
    --container-height: 1.7em;
    --container-radius: 4.2em;
    --container-light-bg: #3D7EAE;
    --container-night-bg: #1D1F2C;
    --circle-container-diameter: 2.25em;
    --sun-moon-diameter: 1.4em;
    --sun-bg: #ECCA2F;
    --moon-bg: #C4C9D1;
    --spot-color: #959DB1;
    --circle-container-offset: calc((var(--circle-container-diameter) - var(--container-height)) / 2 * -1);
    --stars-color: #fff;
    --clouds-color: #F3FDFF;
    --back-clouds-color: #AACADF;
    --transition: .5s cubic-bezier(0, -0.02, 0.4, 1.25);
    --circle-transition: .3s cubic-bezier(0, -0.02, 0.35, 1.17);
  }

  .theme-switch, .theme-switch *, .theme-switch *::before, .theme-switch *::after {
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-size: var(--toggle-size);
  }

  .theme-switch__container {
    width: var(--container-width);
    height: var(--container-height);
    background-color: var(--container-light-bg);
    border-radius: var(--container-radius);
    overflow: hidden;
    cursor: pointer;
    -webkit-box-shadow: 0em -0.062em 0.062em rgba(0, 0, 0, 0.25), 0em 0.062em 0.125em rgba(255, 255, 255, 0.94);
    box-shadow: 0em -0.062em 0.062em rgba(0, 0, 0, 0.25), 0em 0.062em 0.125em rgba(255, 255, 255, 0.94);
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
    position: relative;
  }

  .theme-switch__container::before {
    content: "";
    position: absolute;
    z-index: 1;
    inset: 0;
    -webkit-box-shadow: 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset, 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset;
    box-shadow: 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset, 0em 0.05em 0.187em rgba(0, 0, 0, 0.25) inset;
    border-radius: var(--container-radius)
  }

  .theme-switch__checkbox {
    display: none;
  }

  .theme-switch__circle-container {
    width: var(--circle-container-diameter);
    height: var(--circle-container-diameter);
    background-color: rgba(255, 255, 255, 0.1);
    position: absolute;
    left: var(--circle-container-offset);
    top: var(--circle-container-offset);
    border-radius: var(--container-radius);
    -webkit-box-shadow: inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), 0 0 0 0.625em rgba(255, 255, 255, 0.1), 0 0 0 1.25em rgba(255, 255, 255, 0.1);
    box-shadow: inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), inset 0 0 0 3.375em rgba(255, 255, 255, 0.1), 0 0 0 0.625em rgba(255, 255, 255, 0.1), 0 0 0 1.25em rgba(255, 255, 255, 0.1);
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-transition: var(--circle-transition);
    -o-transition: var(--circle-transition);
    transition: var(--circle-transition);
    pointer-events: none;
  }

  .theme-switch__sun-moon-container {
    pointer-events: auto;
    position: relative;
    z-index: 2;
    width: var(--sun-moon-diameter);
    height: var(--sun-moon-diameter);
    margin: auto;
    border-radius: var(--container-radius);
    background-color: var(--sun-bg);
    -webkit-box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #a1872a inset;
    box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #a1872a inset;
    -webkit-filter: drop-shadow(0.062em 0.125em 0.125em rgba(0, 0, 0, 0.25)) drop-shadow(0em 0.062em 0.125em rgba(0, 0, 0, 0.25));
    filter: drop-shadow(0.062em 0.125em 0.125em rgba(0, 0, 0, 0.25)) drop-shadow(0em 0.062em 0.125em rgba(0, 0, 0, 0.25));
    overflow: hidden;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
  }

  .theme-switch__moon {
    -webkit-transform: translateX(100%);
    -ms-transform: translateX(100%);
    transform: translateX(100%);
    width: 100%;
    height: 100%;
    background-color: var(--moon-bg);
    border-radius: inherit;
    -webkit-box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #969696 inset;
    box-shadow: 0.062em 0.062em 0.062em 0em rgba(254, 255, 239, 0.61) inset, 0em -0.062em 0.062em 0em #969696 inset;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
    position: relative;
  }

  .theme-switch__spot {
    position: absolute;
    top: 0.75em;
    left: 0.312em;
    width: 0.75em;
    height: 0.75em;
    border-radius: var(--container-radius);
    background-color: var(--spot-color);
    -webkit-box-shadow: 0em 0.0312em 0.062em rgba(0, 0, 0, 0.25) inset;
    box-shadow: 0em 0.0312em 0.062em rgba(0, 0, 0, 0.25) inset;
  }

  .theme-switch__spot:nth-of-type(2) {
    width: 0.375em;
    height: 0.375em;
    top: 0.937em;
    left: 1.375em;
  }

  .theme-switch__spot:nth-last-of-type(3) {
    width: 0.25em;
    height: 0.25em;
    top: 0.312em;
    left: 0.812em;
  }

  .theme-switch__clouds {
    width: 1.25em;
    height: 1.25em;
    background-color: var(--clouds-color);
    border-radius: var(--container-radius);
    position: absolute;
    bottom: -0.625em;
    left: 0.312em;
    -webkit-box-shadow: 0.937em 0.312em var(--clouds-color), -0.312em -0.312em var(--back-clouds-color), 1.437em 0.375em var(--clouds-color), 0.5em -0.125em var(--back-clouds-color), 2.187em 0 var(--clouds-color), 1.25em -0.062em var(--back-clouds-color), 2.937em 0.312em var(--clouds-color), 2em -0.312em var(--back-clouds-color), 3.625em -0.062em var(--clouds-color), 2.625em 0em var(--back-clouds-color), 4.5em -0.312em var(--clouds-color), 3.375em -0.437em var(--back-clouds-color), 4.625em -1.75em 0 0.437em var(--clouds-color), 4em -0.625em var(--back-clouds-color), 4.125em -2.125em 0 0.437em var(--back-clouds-color);
    box-shadow: 0.937em 0.312em var(--clouds-color), -0.312em -0.312em var(--back-clouds-color), 1.437em 0.375em var(--clouds-color), 0.5em -0.125em var(--back-clouds-color), 2.187em 0 var(--clouds-color), 1.25em -0.062em var(--back-clouds-color), 2.937em 0.312em var(--clouds-color), 2em -0.312em var(--back-clouds-color), 3.625em -0.062em var(--clouds-color), 2.625em 0em var(--back-clouds-color), 4.5em -0.312em var(--clouds-color), 3.375em -0.437em var(--back-clouds-color), 4.625em -1.75em 0 0.437em var(--clouds-color), 4em -0.625em var(--back-clouds-color), 4.125em -2.125em 0 0.437em var(--back-clouds-color);
    -webkit-transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
    -o-transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
    transition: 0.5s cubic-bezier(0, -0.02, 0.4, 1.25);
  }

  .theme-switch__stars-container {
    position: absolute;
    color: var(--stars-color);
    top: -100%;
    left: 0.312em;
    width: 2.75em;
    height: auto;
    -webkit-transition: var(--transition);
    -o-transition: var(--transition);
    transition: var(--transition);
  }

   
  .theme-switch__checkbox:checked + .theme-switch__container {
    background-color: var(--container-night-bg);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__circle-container {
    left: calc(100% - var(--circle-container-offset) - var(--circle-container-diameter));
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__circle-container:hover {
    left: calc(100% - var(--circle-container-offset) - var(--circle-container-diameter) - 0.187em)
  }

  .theme-switch__circle-container:hover {
    left: calc(var(--circle-container-offset) + 0.187em);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__moon {
    -webkit-transform: translate(0);
    -ms-transform: translate(0);
    transform: translate(0);
    transform: translate(0);
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__clouds {
    bottom: -4.062em;
  }

  .theme-switch__checkbox:checked + .theme-switch__container .theme-switch__stars-container {
    top: 50%;
    -webkit-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
  }

   
  #dark-mode-toggle {
    display: none !important;
  }

   
  .dark-mode-toggle-fix span {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
</style>


<script>
(function() {
  'use strict';
  
  
  if (window.themeSwitchInitialized) {
    console.log('主题切换开关已经初始化，跳过重复执行');
    return;
  }
  
  let isInitialized = false;
  let observer = null;
  
  function initNewThemeSwitch() {
    
    if (isInitialized) {
      return;
    }
    
    const checkbox = document.getElementById('theme-switch-checkbox');
    if (!checkbox) {
      return;
    }
    
    
    function updateCheckboxState() {
      const isDark = document.documentElement.dataset.scheme === 'dark';
      checkbox.checked = isDark;
      
      
      const textElement = document.getElementById('theme-switch-text');
      if (textElement) {
        textElement.textContent = isDark ? '暗色模式' : '亮色模式';
        console.log('更新主题切换文字:', isDark ? '暗色模式' : '亮色模式');
      }
      
      console.log('当前主题状态:', isDark ? 'dark' : 'light', 'checkbox状态:', checkbox.checked);
    }
    
    
    function waitForThemeSystem() {
      
      const schemeFromData = document.documentElement.dataset.scheme;
      const schemeFromClass = document.documentElement.className.includes('dark') ? 'dark' : 
                             document.documentElement.className.includes('light') ? 'light' : null;
      const schemeFromLocalStorage = localStorage.getItem('StackColorScheme');
      
      if (schemeFromData || schemeFromClass || schemeFromLocalStorage) {
        
        let finalScheme = schemeFromData || schemeFromClass || schemeFromLocalStorage;
        
        
        if (schemeFromData) {
          finalScheme = schemeFromData;
        }
        
        
        document.documentElement.dataset.scheme = finalScheme;
        
        
        updateCheckboxState();
        isInitialized = true;
        window.themeSwitchInitialized = true;
        
        console.log('主题系统已初始化，当前主题:', finalScheme);
      } else {
        
        setTimeout(waitForThemeSystem, 100);
      }
    }
    
    
    waitForThemeSystem();
    
    
    checkbox.addEventListener('change', function() {
      const scheme = this.checked ? 'dark' : 'light';
      document.documentElement.dataset.scheme = scheme;
      
      
      localStorage.setItem('StackColorScheme', scheme);
      
      
      document.dispatchEvent(new CustomEvent('onColorSchemeChange'));
    });
    
    
    window.addEventListener('onColorSchemeChange', updateCheckboxState);
    
    
    observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-scheme') {
          updateCheckboxState();
        }
      });
    });
    
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-scheme']
    });
  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initNewThemeSwitch);
  } else {
    initNewThemeSwitch();
  }
  
  
  setTimeout(initNewThemeSwitch, 1500);
})();
</script>


<script>
(function() {
  'use strict';
  
  
  if (window.hoverEffectsInitialized) {
    console.log('悬浮效果已经初始化，跳过重复执行');
    return;
  }
  
  let isHoverEffectsInitialized = false;
  let hoverObserver = null;
  
  
  function forceCategoryHoverEffects() {
    
    if (isHoverEffectsInitialized) {
      return;
    }
    
    const articles = document.querySelectorAll('.article-list--compact article');
    if (articles.length > 0) {
      articles.forEach(article => {
        
        if (article.hasAttribute('data-hover-initialized')) {
          return;
        }
        
        
        article.style.setProperty('transition', 'all 0.3s ease', 'important');
        article.style.setProperty('will-change', 'transform, box-shadow', 'important');
        
        
        article.addEventListener('mouseenter', function() {
          this.style.setProperty('transform', 'translateY(-5px)', 'important');
          this.style.setProperty('box-shadow', '0 10px 30px rgba(0, 0, 0, 0.12)', 'important');
        });
        
        article.addEventListener('mouseleave', function() {
          this.style.setProperty('transform', 'translateY(0)', 'important');
          this.style.setProperty('box-shadow', 'none', 'important');
        });
        
        
        article.setAttribute('data-hover-initialized', 'true');
      });
      
      isHoverEffectsInitialized = true;
      window.hoverEffectsInitialized = true;
    }
  }
  
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', forceCategoryHoverEffects);
  } else {
    forceCategoryHoverEffects();
  }
  
  
  setTimeout(forceCategoryHoverEffects, 1000);
  
  
  hoverObserver = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
        
        setTimeout(forceCategoryHoverEffects, 100);
      }
    });
  });
  
  
  hoverObserver.observe(document.body, {
    childList: true,
    subtree: true
  });
})();
</script>

    </body>
</html>
