<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Re on kakahuote</title>
        <link>https://blog.928330.xyz/tags/re/</link>
        <description>Recent content in Re on kakahuote</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Example Person</copyright>
        <lastBuildDate>Sun, 02 Nov 2025 20:15:11 +0800</lastBuildDate><atom:link href="https://blog.928330.xyz/tags/re/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>é€†å‘åŸºç¡€6ï¼šDLLæ³¨å…¥</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%806dll%E6%B3%A8%E5%85%A5/</link>
        <pubDate>Sun, 02 Nov 2025 18:44:56 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%806dll%E6%B3%A8%E5%85%A5/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/a09dbc5b24b5dd58f1f021f69aca8682.jpg" alt="Featured image of post é€†å‘åŸºç¡€6ï¼šDLLæ³¨å…¥" /&gt;&lt;p&gt;åœ¨PEæ–‡ä»¶çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†å¯¼å…¥è¡¨å’ŒåŠ¨æ€é“¾æ¥åº“æ˜¯å¦‚ä½•è¢«PEåŠ è½½å™¨é“¾æ¥åœ¨ä¸€èµ·çš„ï¼Œè¿™ç§åœ¨è¿è¡Œæ—¶æ‰åŠ è½½ä»£ç å’Œæ•°æ®çš„æœºåˆ¶æ˜¯Windowsç³»ç»Ÿçš„æ ¸å¿ƒ&lt;/p&gt;
&lt;p&gt;ä½†æ­£æ‰€è°“æ°´èƒ½è½½èˆŸï¼Œäº¦èƒ½è¦†èˆŸï¼Œè¿™ç§å¼ºå¤§çš„æœºåˆ¶ä¹Ÿè¯ç”Ÿäº†é—®é¢˜ â€”â€” &lt;strong&gt;DLLæ³¨å…¥ï¼ˆDLL Injectionï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;DLLæ³¨å…¥æ˜¯ä¸€ç§å¼ºåˆ¶è®©ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹åŠ è½½å¹¶æ‰§è¡Œæˆ‘ä»¬æŒ‡å®šçš„DLLæ–‡ä»¶çš„æŠ€æœ¯ï¼Œè¯´ç™½äº†å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç &lt;/p&gt;
&lt;h1 id=&#34;åŠ¨æ€é“¾æ¥åº“-dll&#34;&gt;åŠ¨æ€é“¾æ¥åº“ (DLL)
&lt;/h1&gt;&lt;p&gt;ä¹‹å‰PEä¸»è¦è®²çš„æ˜¯exeæ–‡ä»¶ï¼Œç¨ç¨æåˆ°äº†dllï¼Œç°åœ¨æˆ‘ä»¬æ­£å¼æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç©æ„&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯åŠ¨æ€é“¾æ¥åº“&#34;&gt;ä»€ä¹ˆæ˜¯åŠ¨æ€é“¾æ¥åº“ï¼Ÿ
&lt;/h2&gt;&lt;p&gt;DLLå…¨ç§°Dynamic Link Libraryï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€é“¾æ¥åº“ï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹äºä¸»ç¨‹åºæ–‡ä»¶ä¹‹å¤–çš„ç¨‹åºåº“æ–‡ä»¶ï¼Œå®ƒåŒ…å«å¯è¢«å¤šä¸ªåº”ç”¨ç¨‹åºå…±äº«ä½¿ç”¨çš„ä»£ç ã€æ•°æ®å’Œèµ„æº&lt;/p&gt;
&lt;p&gt;ä¸é™æ€é“¾æ¥libåœ¨ç¼–è¯‘æ—¶å°†åº“ä»£ç å®Œå…¨å¤åˆ¶åˆ°exeä¸­ä¸åŒï¼ŒåŠ¨æ€é“¾æ¥çš„DLLä»£ç å’Œæ•°æ®åœ¨è¿è¡Œæ—¶æ‰è¢«åŠ è½½å™¨é“¾æ¥åˆ°ä¸»ç¨‹åºä¸­ï¼ŒåŠ è½½æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;é“¾æ¥æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;é“¾æ¥æ—¶æœº&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;å®ç°æ–¹å¼&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;éšå¼é“¾æ¥&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ç¨‹åºå¯åŠ¨æ—¶&lt;/td&gt;
          &lt;td&gt;ç”±WindowsåŠ è½½å™¨è‡ªåŠ¨æ‰«æPEæ–‡ä»¶çš„å¯¼å…¥è¡¨ï¼Œå¹¶åŠ è½½æ‰€æœ‰ä¾èµ–çš„DLL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;æ˜¾å¼é“¾æ¥&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ç¨‹åºè¿è¡Œæ—¶æŒ‰éœ€è°ƒç”¨&lt;/td&gt;
          &lt;td&gt;ç¨‹åºå‘˜é€šè¿‡è°ƒç”¨&lt;code&gt;LoadLibrary()&lt;/code&gt;å’Œ&lt;code&gt;GetProcAddress()&lt;/code&gt;APIæ¥æ‰‹åŠ¨åŠ è½½DLLå¹¶è·å–å‡½æ•°åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™éƒ¨åˆ†å†…å®¹åœ¨ä¹‹å‰æ–‡ç« å·²ç»è®²è¿‡ï¼Œè¯¦ç»†çš„å°±ä¸å†è¯´äº† -&amp;gt; &lt;a class=&#34;link&#34; href=&#34;https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%804pe%E6%96%87%E4%BB%B6/#%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93dll&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;é€†å‘åŸºç¡€4ï¼šPEæ–‡ä»¶
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Windowsç³»ç»Ÿä¸­ï¼Œæœ‰ä¸‰ä¸ªæ ¸å¿ƒçš„DLLï¼Œå‡ ä¹æ‰€æœ‰å›¾å½¢åŒ–ç¨‹åºéƒ½ç¦»ä¸å¼€å®ƒä»¬ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Kernel32.dll&lt;/code&gt;&lt;/strong&gt;ï¼šæä¾›æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¦‚è¿›ç¨‹/çº¿ç¨‹ç®¡ç†ã€å†…å­˜ç®¡ç†å’Œæ–‡ä»¶è®¿é—®&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;User32.dll&lt;/code&gt;&lt;/strong&gt;ï¼šæä¾›ç”¨æˆ·ç•Œé¢åŠŸèƒ½ï¼Œå¦‚çª—å£ç®¡ç†ã€æ¶ˆæ¯ä¼ é€’ä»¥åŠé”®ç›˜/é¼ æ ‡æ“ä½œ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;GDI32.dll&lt;/code&gt;&lt;/strong&gt;ï¼šæä¾›å›¾å½¢è®¾å¤‡æ¥å£ï¼Œè´Ÿè´£åœ¨å±å¹•æˆ–æ‰“å°æœºä¸Šç»˜åˆ¶å›¾å½¢å’Œæ˜¾ç¤ºæ–‡æœ¬&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;æ–‡ä»¶åé‡Œçš„32å¹¶ä¸ä¼šéšç€æ“ä½œç³»ç»Ÿçš„ä½æ•°è€Œæ”¹å˜ï¼Œä¸ºäº†å‘åå…¼å®¹ï¼Œå®ƒä¹Ÿä¸å¯èƒ½æ”¹å&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œä»–ä»¬ä¼šæœ‰ä¸åŒçš„ç‰ˆæœ¬ä»¥æœåŠ¡ä¸åŒä½çš„ç¨‹åºï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åŠŸèƒ½&lt;/th&gt;
          &lt;th&gt;64ä½ç³»ç»Ÿä¸­ä½ç½®&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;64ä½ç³»ç»ŸDLL&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;C:\Windows\System32&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;32ä½ç³»ç»ŸDLL&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;C:\Windows\SysWOW64&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ç³»ç»Ÿå†…éƒ¨ï¼Œå¾®è½¯é€šè¿‡WOW64ï¼ˆWindows-on-Windows 64-bitï¼‰å­ç³»ç»Ÿæ¥è®©32ä½ç¨‹åºä¹Ÿèƒ½è°ƒç”¨ç›¸åŒçš„APIæ¥å£&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&#34;å…¥å£å‡½æ•°dllmain&#34;&gt;å…¥å£å‡½æ•°ï¼šDllMain()
&lt;/h2&gt;&lt;p&gt;å½“ä¸€ä¸ªDLLè¢«åŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´æ—¶ï¼ŒWindowsåŠ è½½å™¨ä¼šæŸ¥æ‰¾å¹¶æ‰§è¡Œä¸€ä¸ªç‰¹æ®Šçš„å…¥å£å‡½æ•° â€”â€”&lt;code&gt;DllMain&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DllMain&lt;/code&gt;æ˜¯DLLå†…éƒ¨çš„å‡½æ•°ï¼Œå¹¶ä¸ä¼šä½œä¸ºAPIå¯¼å‡º&lt;/p&gt;
&lt;p&gt;å®ƒçš„å­˜åœ¨è‡³å…³é‡è¦ï¼Œè‡³å°‘å¯¹æˆ‘ä»¬è¿™äº›æ”»å‡»è€…æ¥è¯´æ˜¯é‡è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰€æœ‰åšæ‰‹è„šçš„ä»£ç éƒ½æ˜¯ä»è¿™é‡Œå¼€å§‹æ‰§è¡Œçš„&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;DllMain&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;,  &lt;span style=&#34;color:#7f848e&#34;&gt;// DLLå®ä¾‹çš„å¥æŸ„ï¼Œå³DLLè¢«æ˜ å°„åˆ°çš„åŸºåœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// ç³»ç»Ÿè°ƒç”¨ DllMain çš„åŸå› 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpReserved&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;switch&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;: 	&lt;span style=&#34;color:#7f848e&#34;&gt;// è¿›ç¨‹åŠ è½½ DLL â€”â€” è¿™æ˜¯æˆ‘ä»¬æ‰§è¡Œæ³¨å…¥ä»£ç çš„æ—¶æœºï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL é¦–æ¬¡è¢«åŠ è½½åˆ°è¿›ç¨‹æ—¶è°ƒç”¨ï¼Œä¾‹å¦‚ç¨‹åºå¯åŠ¨æˆ–è°ƒç”¨ LoadLibrary() æ—¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœåŠ è½½å¤±è´¥ï¼Œè¿”å› FALSEï¼Œç³»ç»Ÿä¼šç«‹å³å¸è½½ DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å¸¸ç”¨äºåˆå§‹åŒ–å…¨å±€å˜é‡ã€åˆ›å»ºæ‰€éœ€çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶ã€äº’æ–¥é”ã€çº¿ç¨‹æ± ç­‰ï¼‰ã€è®¾ç½®é’©å­ã€å»ºç«‹ä¸ä¸»ç¨‹åºçš„é€šä¿¡é€šé“
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_THREAD_ATTACH&lt;/span&gt;: 	&lt;span style=&#34;color:#7f848e&#34;&gt;// åˆ›å»ºæ–°çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿›ç¨‹åˆ›å»ºæ–°çº¿ç¨‹æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨æ‰€æœ‰å·²åŠ è½½DLLçš„è¿™ä¸ªåˆ†æ”¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å¸¸ç”¨äºä¸ºæ–°çº¿ç¨‹åˆ†é…çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆTLSï¼‰ ã€åˆå§‹åŒ–ä¸è¯¥çº¿ç¨‹æœ‰å…³çš„å¯¹è±¡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_THREAD_DETACH&lt;/span&gt;: 	&lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹é€€å‡º
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹ï¼ˆå¦‚è°ƒç”¨ExitThreadï¼‰æ­£å¸¸é€€å‡ºæ—¶è°ƒç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å¸¸ç”¨äºé‡Šæ”¾è¯¥çº¿ç¨‹çš„å±€éƒ¨èµ„æºã€å…³é—­å¥æŸ„ã€å†™å…¥æ—¥å¿—ç­‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_DETACH&lt;/span&gt;: 	&lt;span style=&#34;color:#7f848e&#34;&gt;// å¸è½½ DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL ä»è¿›ç¨‹åœ°å€ç©ºé—´å¸è½½æ—¶ï¼ˆå¦‚FreeLibraryï¼‰è°ƒç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;//  å¸¸ç”¨äºæ¸…ç†å…¨å±€èµ„æºï¼Œå¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾å†…å­˜ã€æ–­å¼€è¿æ¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¿…é¡»è¿”å›TRUEè¡¨ç¤ºæˆåŠŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;DllMain&lt;/code&gt;çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåœ¨ç›®æ ‡è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»æ„ä»£ç çš„æœºä¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™å¯ä»¥ç”¨æ¥ä¿®bugã€å¢åŠ æ–°åŠŸèƒ½ï¼Œå½“ç„¶ä¹Ÿèƒ½è¢«æ¶æ„ä»£ç åˆ©ç”¨&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;å¦‚æœDLLä¸­æ‰¾ä¸åˆ°&lt;code&gt;DllMain&lt;/code&gt;ï¼ŒWindowsä¼šä»å…¶å®ƒè¿è¡Œåº“ä¸­æ‰¾ä¸€ä¸ªä¸åšä»»ä½•æ“ä½œçš„ç¼ºçœ&lt;code&gt;DllMain&lt;/code&gt;å‡½æ•°æ¥å¯åŠ¨è¿™ä¸ªDLL&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&#34;dllæ³¨å…¥&#34;&gt;DLLæ³¨å…¥
&lt;/h2&gt;&lt;p&gt;é¡¾åæ€ä¹‰ï¼ŒDLLæ³¨å…¥å°±æ˜¯å‘ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å…¶ä»–è¿›ç¨‹ä¸­ï¼Œå¼ºåˆ¶æ’å…¥ä¸€ä¸ªæˆ‘ä»¬æŒ‡å®šçš„DLLæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¶æ ¸å¿ƒåŸç†æ˜¯ä»¥æŸç§æ–¹å¼è®©ç›®æ ‡è¿›ç¨‹å»è°ƒç”¨&lt;code&gt;LoadLibrary()&lt;/code&gt;APIï¼Œä»¥æ­¤æ¥åŠ è½½æˆ‘ä»¬çš„DLL&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦&lt;code&gt;LoadLibrary()&lt;/code&gt;è¢«è°ƒç”¨ï¼Œç›®æ ‡è¿›ç¨‹å°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥DLLçš„&lt;code&gt;DllMain&lt;/code&gt;å‡½æ•°ï¼Œè€Œ&lt;code&gt;DllMain&lt;/code&gt;çš„&lt;code&gt;DLL_PROCESS_ATTACH&lt;/code&gt;åˆ†æ”¯ä¸­å°±åŒ…å«äº†æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„payload&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251029225118284&#34; href=&#34;http://picture.928330.xyz/typora/image-20251029225118284.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251029225118284.png&#34; alt=&#34;image-20251029225118284&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h1 id=&#34;windowsç³»ç»Ÿç¼–ç¨‹&#34;&gt;Windowsç³»ç»Ÿç¼–ç¨‹
&lt;/h1&gt;&lt;p&gt;è¦å®ç°æ³¨å…¥ï¼Œæˆ‘ä»¬è¦å…ˆçŸ¥é“å¦‚ä½•ä¹¦å†™dllï¼Œå¦‚ä½•ä½¿ç”¨Windows APIæ¥æ“çºµè¿›ç¨‹&lt;/p&gt;
&lt;h2 id=&#34;å¸¸ç”¨æ•°æ®ç±»å‹&#34;&gt;å¸¸ç”¨æ•°æ®ç±»å‹
&lt;/h2&gt;&lt;p&gt;Windows APIæœ‰è‡ªå·±çš„ä¸€å¥—æ•°æ®ç±»å‹å®šä¹‰ï¼Œè¿™äº›ç±»å‹åœ¨&lt;code&gt;windows.h&lt;/code&gt;å¤´æ–‡ä»¶ä¸­å®šä¹‰ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;VOID&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ä½œä¸ºå‡½æ•°è¿”å›ç±»å‹æ—¶ï¼Œè¡¨ç¤ºå‡½æ•°è¿è¡Œä¸å¯èƒ½å¤±è´¥&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;BOOL&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;&lt;code&gt;int&lt;/code&gt;ç±»å‹ï¼Œä½œä¸ºå‡½æ•°è¿”å›ç±»å‹æ—¶ï¼Œ&lt;code&gt;&amp;gt;0&lt;/code&gt;ä»£è¡¨TRUEï¼Œ&lt;code&gt;=0&lt;/code&gt;ä»£è¡¨FALSE&lt;/strong&gt;&lt;br /&gt;åº”æµ‹è¯•è¿”å›å€¼æ˜¯å¦ä¸º0ï¼Œä¸è¦æµ‹è¯•æ˜¯å¦ä¸ºTRUE&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HANDLE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å†…æ ¸å¯¹è±¡çš„ç±»å‹ï¼Œç”¨äºæ ‡è¯†è¿›ç¨‹ã€çº¿ç¨‹ã€æ–‡ä»¶å¥æŸ„ç­‰&lt;/strong&gt;&lt;br /&gt;å¤±è´¥æ—¶é€šå¸¸è¿”å›&lt;code&gt;NULL&lt;/code&gt;æˆ–&lt;code&gt;INVALID_HANDLE_VALUE&lt;/code&gt;(-1)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PVOID&lt;/code&gt;/&lt;code&gt;PCVOID&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ— ç±»å‹çš„æŒ‡é’ˆï¼ˆ&lt;code&gt;void*&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;br /&gt;æŒ‡å‘ä¸€å—èƒ½å­˜æ”¾ä»»æ„ç±»å‹å€¼çš„å†…å­˜ç©ºé—´&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LONG&lt;/code&gt;/&lt;code&gt;DWORD&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è¡¨ç¤ºæœ‰ç¬¦å·/æ— ç¬¦å·çš„32ä½é•¿æ•´å‹&lt;/strong&gt;&lt;br /&gt;ä½œä¸ºå‡½æ•°è¿”å›ç±»å‹æ—¶è¿”å›æ•°é‡å€¼ï¼Œå¦‚æœæ— æ³•æ­£ç¡®è®¡æ•°åˆ™è¿”å›0æˆ–-1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PDWORD&lt;/code&gt;/&lt;code&gt;LPDWORD&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æŒ‡å‘&lt;code&gt;DWORD&lt;/code&gt;æ•°æ®çš„æŒ‡é’ˆç±»å‹&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HMODULE&lt;/code&gt;/&lt;code&gt;HINSTANCE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;åº”ç”¨ç¨‹åºåŠ è½½çš„æ¨¡å—çš„çº¿æ€§åœ°å€ï¼Œæœ¬è´¨ä¸Šæ˜¯&lt;code&gt;HANDLE&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HHOOK&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ‰€å®‰è£…çš„é’©å­çš„&lt;code&gt;HANDLE&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HWND&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;çª—å£çš„&lt;code&gt;HANDLE&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HKEY&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ³¨å†Œè¡¨é”®çš„&lt;code&gt;HANDLE&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LRESULT&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ç”±çª—å£è¿‡ç¨‹æˆ–å›è°ƒå‡½æ•°æ‰€è¿”å›çš„32ä½å€¼ç±»å‹&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WPARAM&lt;/code&gt;/&lt;code&gt;LPARAM&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ¶ˆæ¯å‚æ•°&lt;/strong&gt;&lt;br /&gt;&lt;code&gt;LPARAM&lt;/code&gt;å³&lt;code&gt;LONG_PTR&lt;/code&gt;ï¼Œ&lt;code&gt;WPARAM&lt;/code&gt;å³&lt;code&gt;UINT_PTR&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WINAPI&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;Windows APIçš„å‡½æ•°è°ƒç”¨æƒ¯ä¾‹ï¼Œç›¸å½“äº&lt;code&gt;_stdcall&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PSECURITY_ATTRIBUTES&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æŒ‡å‘&lt;code&gt;SECURITY_ATTRIBUTES&lt;/code&gt;ç»“æ„çš„æŒ‡é’ˆç±»å‹&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PTHREAD_START_ROUTINE&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å‡½æ•°æŒ‡é’ˆ&lt;/strong&gt;&lt;br /&gt;æŒ‡å‘ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›&lt;code&gt;DWORD&lt;/code&gt;å¹¶æ¥å—ä¸€ä¸ª&lt;code&gt;LPVOID&lt;/code&gt;å‚æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;HOOKPROC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;é’©å­è¿‡ç¨‹çš„åœ°å€ï¼ˆå›è°ƒå‡½æ•°ï¼‰&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;unicodeä¸ansi&#34;&gt;Unicodeä¸ANSI
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯åœ¨Windowsç¼–ç¨‹ä¸­å­—ç¬¦çš„æ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ANSI&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸æ˜¯ä¸¥æ ¼çš„æ ‡å‡†ç¼–ç åï¼Œè€Œæ˜¯æŒ‡åŸºäºç³»ç»ŸåŒºåŸŸè®¾ç½®çš„å•å­—èŠ‚æˆ–å¯å˜å­—èŠ‚ç¼–ç ï¼Œä¹Ÿç§°å¤šå­—èŠ‚å­—ç¬¦é›†&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§ç¼–ç ä¸‹ï¼Œ&lt;code&gt;char&lt;/code&gt;ï¼ˆ1 å­—èŠ‚ï¼‰è¡¨ç¤ºå­—ç¬¦ï¼ˆæˆ–è€…å­—ç¬¦çš„ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒæŸäº›å­—ç¬¦éœ€è¦ç”¨å¤šä¸ª&lt;code&gt;char&lt;/code&gt;æ‰èƒ½è¡¨ç¤º&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Unicode&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Windowså†…æ ¸ä½¿ç”¨çš„æ•°æ®ç±»å‹ï¼Œä½¿ç”¨&lt;code&gt;wchar_t&lt;/code&gt;ï¼ˆåŒå­—èŠ‚ï¼‰å­˜å‚¨å­—ç¬¦&lt;/p&gt;
&lt;p&gt;å…³äºUnicodeè¯¦ç»†å†…å®¹ç§»æ­¥ï¼š&lt;a class=&#34;link&#34; href=&#34;https://blog.928330.xyz/p/%E4%B8%80%E6%96%87%E5%BC%84%E6%87%82%E5%AD%97%E7%AC%A6%E9%9B%86%E4%B8%8E%E7%BC%96%E7%A0%81/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å­—ç¬¦é›†ä¸ç¼–ç 
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cè¿è¡Œåº“ï¼ˆ&lt;code&gt;string.h&lt;/code&gt;ï¼‰å’ŒWindows APIéƒ½ä¸ºè¿™ä¸¤ç§ç±»å‹æä¾›äº†ä¸åŒçš„å‡½æ•°ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;æ ‡å‡†ANSI Cå‡½æ•°&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;ç­‰ä»·Unicodeå‡½æ•° (string.h)&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;char *strcat(...)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;wchar_t *wcscat(...)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;char *strchr(...)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;wchar_t *wcschr(...)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;int strcmp(...)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;int wcscmp(...)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;char *strcpy(...)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;wchar_t *wcscpy(...)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;size_t strlen(...)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;size_t wcslen(...)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Windowsä¹Ÿå®šä¹‰äº†è‡ªå·±ä¸“ç”¨çš„Unicodeæ•°æ®ç±»å‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;WCHAR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Unicodeå­—ç¬¦ (&lt;code&gt;wchar_t&lt;/code&gt;)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LPWSTR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æŒ‡å‘Unicodeå­—ç¬¦ä¸²çš„æŒ‡é’ˆ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LPCWSTR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æŒ‡å‘ä¸€ä¸ª&lt;em&gt;å¸¸é‡&lt;/em&gt;Unicodeå­—ç¬¦ä¸²çš„æŒ‡é’ˆ&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸ºäº†ç¼–å†™å…¼å®¹æ€§ä»£ç ï¼ŒWindowsæ¨èä½¿ç”¨&lt;code&gt;tchar.h&lt;/code&gt;å¤´æ–‡ä»¶ä¸­çš„&lt;strong&gt;é€šç”¨æ•°æ®ç±»å‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#ifdef _UNICODE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;wchar_t&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#else
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#endif
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ï¼Œä½ çš„ä»£ç å°±å¯ä»¥é€šè¿‡æ˜¯å¦å®šä¹‰&lt;code&gt;_UNICODE&lt;/code&gt;å®æ¥ç¼–è¯‘ä¸ºANSIæˆ–Unicodeç‰ˆæœ¬&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;é€šç”¨ç±»å‹&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;TCHAR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å­—ç¬¦ï¼ˆ&lt;code&gt;CHAR&lt;/code&gt;æˆ–&lt;code&gt;WCHAR&lt;/code&gt;ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LPTSTR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å­—ç¬¦ä¸²æŒ‡é’ˆï¼ˆ&lt;code&gt;LPSTR&lt;/code&gt;æˆ–&lt;code&gt;LPWSTR&lt;/code&gt;ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LPCTSTR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¸¸é‡å­—ç¬¦ä¸²æŒ‡é’ˆï¼ˆ&lt;code&gt;LPCSTR&lt;/code&gt;æˆ–&lt;code&gt;LPCWSTR&lt;/code&gt;ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å®šä¹‰å­—ç¬¦ä¸²å¸¸é‡æ—¶ï¼Œåº”ä½¿ç”¨&lt;code&gt;_T()&lt;/code&gt;/&lt;code&gt;_TEXT()&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 1: å¼ºåˆ¶ ANSIï¼ˆchar*ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sz1&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Error&amp;#34;&lt;/span&gt;;  
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¦‚æœ UNICODE è¢«å®šä¹‰ï¼ŒTCHAR å˜æˆ wchar_tï¼Œä½†è¿™é‡ŒæŠŠ narrow string èµ‹ç»™ wchar_t* â€”â€” ä¸å®‰å…¨/é”™è¯¯ï¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 2: å¼ºåˆ¶ Unicodeï¼ˆwchar_t*ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sz2&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;L&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Error&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¦‚æœ UNICODE æœªå®šä¹‰ï¼ŒTCHAR==charï¼Œæ­¤å¤„æŠŠ wchar_t* èµ‹ç»™ char* â€”â€” ä¸å®‰å…¨/é”™è¯¯ï¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 3: æ ¹æ® UNICODE å®è‡ªåŠ¨é€‚é…ï¼ˆæ¨èç”¨äºå…¼å®¹æ—§ä»£ç ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sz3&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Error&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¦‚æœ UNICODE æœªå®šä¹‰ -&amp;gt; TCHAR==char, _T(&amp;#34;Error&amp;#34;) -&amp;gt; &amp;#34;Error&amp;#34;  ï¼ˆOKï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¦‚æœ UNICODE å®šä¹‰ -&amp;gt; TCHAR==wchar_t, _T(&amp;#34;Error&amp;#34;) -&amp;gt; L&amp;#34;Error&amp;#34; ï¼ˆOKï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;_UNICODE&lt;/code&gt;å®ç”¨äºCè¿è¡Œæ—¶å¤´æ–‡ä»¶ï¼ˆ&lt;code&gt;tchar.h&lt;/code&gt;ï¼‰ï¼Œè€Œ&lt;code&gt;UNICODE&lt;/code&gt;å®ç”¨äºWindowså¤´æ–‡ä»¶ï¼ˆ&lt;code&gt;windows.h&lt;/code&gt;ï¼‰ï¼Œåœ¨é¡¹ç›®ä¸­æœ€å¥½åŒæ—¶å®šä¹‰è¿™ä¸¤ä¸ªå®ä»¥ç¡®ä¿ä¸€è‡´æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨DLLä¸­ï¼Œå‡½æ•°é€šå¸¸ä¼šæä¾›ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¾‹å¦‚&lt;code&gt;CreateWindowEx&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CreateWindowExA&lt;/code&gt;ï¼šæ¥å—ANSIå­—ç¬¦ä¸² (A = ANSI)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CreateWindowExW&lt;/code&gt;ï¼šæ¥å—Unicodeå­—ç¬¦ä¸² (W = Wide)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šå¸¸ï¼Œ&lt;code&gt;-A&lt;/code&gt;ç‰ˆæœ¬çš„å‡½æ•°å†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡å­—ç¬¦ä¸²è½¬æ¢åè°ƒç”¨&lt;code&gt;-W&lt;/code&gt;ç‰ˆæœ¬æ¥å®ç°çš„&lt;/p&gt;
&lt;h2 id=&#34;windows-å­—ç¬¦ä¸²å‡½æ•°&#34;&gt;Windows å­—ç¬¦ä¸²å‡½æ•°
&lt;/h2&gt;&lt;p&gt;Windowsåœ¨&lt;code&gt;windows.h&lt;/code&gt;ä¸­ä¹Ÿæä¾›äº†ä¸€å¥—è‡ªå·±çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼ˆæ³¨æ„å‡½æ•°åå‰ç¼€æ˜¯&lt;code&gt;l&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;å‡½æ•°&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lstrcat&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°†ä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥åˆ°å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„ç»“å°¾&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lstrcmp&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œ&lt;strong&gt;åŒºåˆ†å¤§å°å†™&lt;/strong&gt;çš„æ¯”è¾ƒ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lstrcmpi&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œ&lt;strong&gt;ä¸åŒºåˆ†å¤§å°å†™&lt;/strong&gt;çš„æ¯”è¾ƒ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lstrcpy&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°†ä¸€ä¸ªå­—ç¬¦ä¸²æ‹·è´åˆ°å¦ä¸€ä¸ªä½ç½®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;lstrlen&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆæŒ‰å­—ç¬¦æ•°è®¡é‡ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;wsprintf&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°†ä¸€ç³»åˆ—å­—ç¬¦å’Œæ•°å€¼æ ¼å¼åŒ–è¾“å‡ºåˆ°ç¼“å†²åŒºï¼ˆæœ€å¤§1024å­—èŠ‚ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æœ‰æ—¶APIåªæ¥å—ç‰¹å®šç±»å‹çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨è½¬æ¢ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szA&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;WCHAR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szW&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å°†Unicodeå­—ç¬¦ä¸² L&amp;#34;Unicode Str&amp;#34; è½¬åŒ–ä¸º ANSIå­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;sprintf_s&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;szA&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;%S&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;L&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Unicode Str&amp;#34;&lt;/span&gt;); 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å°†ANSIå­—ç¬¦ä¸² &amp;#34;ANSI Str&amp;#34; è½¬åŒ–ä¸º Unicodeå­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;swprintf_s&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;szW&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;L&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;%S&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;ANSI Str&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å…³é”®apiåˆ—è¡¨&#34;&gt;å…³é”®APIåˆ—è¡¨
&lt;/h2&gt;&lt;h3 id=&#34;è¿›ç¨‹ä¸çº¿ç¨‹api&#34;&gt;è¿›ç¨‹ä¸çº¿ç¨‹API
&lt;/h3&gt;&lt;h4 id=&#34;openprocess&#34;&gt;OpenProcess
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;æ‰“å¼€ä¸€ä¸ªå·²å­˜åœ¨çš„è¿›ç¨‹å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªå¥æŸ„(HANDLE)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;OpenProcess&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwDesiredAccess&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// è®¿é—®æƒé™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;bInheritHandle&lt;/span&gt;,  &lt;span style=&#34;color:#7f848e&#34;&gt;// å¥æŸ„æ˜¯å¦å¯è¢«ç»§æ‰¿
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwProcessId&lt;/span&gt;      &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹ID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;&lt;code&gt;_In_&lt;/code&gt;å¹¶ä¸æ˜¯C/C++å…³é”®å­—ï¼Œè€Œæ˜¯å¾®è½¯çš„ SALï¼ˆSource Annotation Languageï¼‰æ³¨è§£&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒä¹Ÿå«&lt;strong&gt;ä»£ç æ³¨é‡Šå®&lt;/strong&gt;ï¼Œç”¨äºç»™å‡½æ•°å‚æ•°ã€è¿”å›å€¼ç­‰æ·»åŠ é¢å¤–çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¸®åŠ©é™æ€åˆ†æå™¨ã€IDEå’Œæ–‡æ¡£ç”Ÿæˆå™¨æ›´å¥½åœ°ç†è§£ä»£ç &lt;/p&gt;
&lt;p&gt;å®ƒä¸æ”¹å˜è¿è¡Œæ—¶è¡Œä¸ºï¼Œé€šå¸¸åœ¨é¢„å¤„ç†æ—¶è¢«å®šä¹‰ä¸ºç©ºæˆ–è¢«æ›¿æ¢ä¸ºç¼–è¯‘å™¨å¯è¯†åˆ«çš„å±æ€§&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„SALæ³¨è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;_In_&lt;/code&gt;ï¼šè¾“å…¥å‚æ•°ï¼Œè°ƒç”¨æ–¹è´Ÿè´£åˆå§‹åŒ–ï¼Œä¸èƒ½ä¸º NULLï¼ˆé»˜è®¤ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_In_opt_&lt;/code&gt;ï¼šå¯é€‰è¾“å…¥å‚æ•°ï¼Œå¯ä»¥ä¸º NULL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_Out_&lt;/code&gt;ï¼šè¾“å‡ºå‚æ•°ï¼Œå‡½æ•°è´Ÿè´£å†™å…¥ï¼ˆè°ƒç”¨æ–¹æä¾›ç¼“å†²åŒºï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_Out_opt_&lt;/code&gt;ï¼šå¯é€‰è¾“å‡ºå‚æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_Inout_&lt;/code&gt;ï¼šè¾“å…¥/è¾“å‡ºå‚æ•°ï¼ˆè°ƒç”¨æ–¹æä¾›åˆå§‹å€¼ï¼Œå‡½æ•°ä¼šè¯»å†™ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_Pre_satisfies_&lt;/code&gt;/&lt;code&gt;_Post_satisfies_&lt;/code&gt;ï¼šå¤æ‚çº¦æŸï¼ˆè¾ƒå°‘è§ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_In_reads_bytes_(n)&lt;/code&gt;/&lt;code&gt;_Out_writes_bytes_(n)&lt;/code&gt;ï¼šè¡¨æ˜ç¼“å†²åŒºé•¿åº¦ï¼ˆä»¥å­—èŠ‚è®¡ï¼‰ï¼Œç”¨äºæ£€æµ‹è¶Šç•Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_Null_terminated_&lt;/code&gt;ï¼šå­—ç¬¦ä¸²ä»¥&lt;code&gt;\0&lt;/code&gt;ç»“å°¾&lt;/li&gt;
&lt;li&gt;&lt;code&gt;_When_(cond, annotation)&lt;/code&gt;ï¼šæ¡ä»¶åŒ–æ³¨è§£ï¼ˆå¤æ‚åœºæ™¯ï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;egï¼šæ‰“å¼€PIDä¸º1234çš„è¿›ç¨‹ï¼Œå¹¶è¯·æ±‚æ‰€æœ‰æƒé™&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;targetPID&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1234&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;OpenProcess&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PROCESS_ALL_ACCESS&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// è¯·æ±‚æ‰€æœ‰æƒé™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;,              &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¸ç»§æ‰¿å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;targetPID&lt;/span&gt;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹ID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æ‰“å¼€å¤±è´¥ï¼Œå¤„ç†é”™è¯¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯ä»¥è°ƒç”¨GetLastError()è·å–é”™è¯¯ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;createthread&#34;&gt;CreateThread
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åœ¨è°ƒç”¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateThread&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadAttributes&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å®‰å…¨å±æ€§
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;      &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt;                 &lt;span style=&#34;color:#e06c75&#34;&gt;dwStackSize&lt;/span&gt;,        &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; åˆå§‹å †æ ˆå¤§å°(&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;ä¸ºé»˜è®¤)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;      &lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpStartAddress&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;                 &lt;span style=&#34;color:#e06c75&#34;&gt;lpParameter&lt;/span&gt;,        &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¼ é€’ç»™çº¿ç¨‹çš„å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;      &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;                  &lt;span style=&#34;color:#e06c75&#34;&gt;dwCreationFlags&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹åˆ›å»ºæ ‡å¿—(0ä¸ºç«‹å³è¿è¡Œ)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_Out_opt_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPDWORD&lt;/span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadId&lt;/span&gt;          &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶çº¿ç¨‹IDçš„æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šåœ¨å½“å‰è¿›ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 1. å®šä¹‰æˆ‘ä»¬çš„çº¿ç¨‹å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;MyThreadFunction&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpParam&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pValue&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;lpParam&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;çº¿ç¨‹å¼€å§‹ï¼Œæ¥æ”¶åˆ°çš„å‚æ•°å€¼: %d&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pValue&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ... æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡ ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹é€€å‡º
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 2. åœ¨ä¸»å‡½æ•°ä¸­åˆ›å»ºçº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;myValue&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;threadId&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateThread&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;,           &lt;span style=&#34;color:#7f848e&#34;&gt;// é»˜è®¤å®‰å…¨å±æ€§
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;,              &lt;span style=&#34;color:#7f848e&#34;&gt;// é»˜è®¤å †æ ˆå¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MyThreadFunction&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;myValue&lt;/span&gt;,       &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¼ é€’ç»™çº¿ç¨‹çš„å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;,              &lt;span style=&#34;color:#7f848e&#34;&gt;// ç«‹å³è¿è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;threadId&lt;/span&gt;       &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶çº¿ç¨‹ID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// åˆ›å»ºå¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;createremotethread&#34;&gt;CreateRemoteThread
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åœ¨å¦ä¸€ä¸ªè¿›ç¨‹(hProcess)çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt;                 &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;,             &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadAttributes&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å®‰å…¨å±æ€§
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt;                 &lt;span style=&#34;color:#e06c75&#34;&gt;dwStackSize&lt;/span&gt;,        &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; åˆå§‹å †æ ˆå¤§å°(&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;ä¸ºé»˜è®¤)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpStartAddress&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿œç¨‹çº¿ç¨‹å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;                 &lt;span style=&#34;color:#e06c75&#34;&gt;lpParameter&lt;/span&gt;,        &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¼ é€’ç»™è¿œç¨‹çº¿ç¨‹çš„å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;                  &lt;span style=&#34;color:#e06c75&#34;&gt;dwCreationFlags&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹åˆ›å»ºæ ‡å¿—(0ä¸ºç«‹å³è¿è¡Œ)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_Out_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPDWORD&lt;/span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadId&lt;/span&gt;          &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶çº¿ç¨‹IDçš„æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šåœ¨ç›®æ ‡è¿›ç¨‹(hTargetProcess)ä¸­åˆ›å»ºä¸€ä¸ªè¿œç¨‹çº¿ç¨‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// (è¿™æ˜¯ä¸€ä¸ªæ¦‚å¿µæ€§ç¤ºä¾‹ï¼Œå‡è®¾hTargetProcesså·²é€šè¿‡OpenProcessè·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// (å¹¶ä¸”pRemoteFunctionå’ŒpRemoteParamå·²é€šè¿‡VirtualAllocExå’ŒWriteProcessMemoryå†™å…¥)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hTargetProcess = ... 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// LPVOID pRemoteFunction = ... (ä¾‹å¦‚LoadLibraryAçš„åœ°å€)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// LPVOID pRemoteParam = ... (ä¾‹å¦‚DLLè·¯å¾„å­—ç¬¦ä¸²åœ¨ç›®æ ‡è¿›ç¨‹ä¸­çš„åœ°å€)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hRemoteThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hTargetProcess&lt;/span&gt;,  &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;,            &lt;span style=&#34;color:#7f848e&#34;&gt;// é»˜è®¤å®‰å…¨å±æ€§
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;,               &lt;span style=&#34;color:#7f848e&#34;&gt;// é»˜è®¤å †æ ˆå¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    (&lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteFunction&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿œç¨‹å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteParam&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿œç¨‹å‚æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;,               &lt;span style=&#34;color:#7f848e&#34;&gt;// ç«‹å³è¿è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;             &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¸å…³å¿ƒçº¿ç¨‹ID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hRemoteThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿œç¨‹çº¿ç¨‹åˆ›å»ºå¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å†…å­˜æ“ä½œapi&#34;&gt;å†…å­˜æ“ä½œAPI
&lt;/h3&gt;&lt;h4 id=&#34;virtualallocex&#34;&gt;VirtualAllocEx
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åœ¨æŒ‡å®šè¿›ç¨‹(hProcess)çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­åˆ†é…å†…å­˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;VirtualAllocEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;,         &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpAddress&lt;/span&gt;,        &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; æœŸæœ›çš„èµ·å§‹åœ°å€(&lt;span style=&#34;color:#e06c75&#34;&gt;NULLä¸ºè‡ªåŠ¨é€‰æ‹©&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt;,           &lt;span style=&#34;color:#7f848e&#34;&gt;// åˆ†é…çš„å†…å­˜å¤§å°(å­—èŠ‚)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;flAllocationType&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// å†…å­˜åˆ†é…ç±»å‹(å¦‚MEM_COMMIT)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;flProtect&lt;/span&gt;         &lt;span style=&#34;color:#7f848e&#34;&gt;// å†…å­˜ä¿æŠ¤å±æ€§(å¦‚PAGE_READWRITE)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šåœ¨hTargetProcessè¿›ç¨‹ä¸­åˆ†é…1024å­—èŠ‚çš„å¯è¯»å†™å†…å­˜&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hTargetProcess = ... (é€šè¿‡OpenProcessè·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;allocSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1024&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// 1KB
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuffer&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;VirtualAllocEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hTargetProcess&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;,           &lt;span style=&#34;color:#7f848e&#34;&gt;// ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;allocSize&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MEM_COMMIT&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MEM_RESERVE&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// æäº¤å¹¶ä¿ç•™å†…å­˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PAGE_READWRITE&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// å†…å­˜ä¿æŠ¤ï¼šå¯è¯»å¯å†™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuffer&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// åˆ†é…å¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;writeprocessmemory&#34;&gt;WriteProcessMemory
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å°†æ•°æ®(lpBuffer)å†™å…¥æŒ‡å®šè¿›ç¨‹(hProcess)çš„å†…å­˜åŒºåŸŸ(lpBaseAddress)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WriteProcessMemory&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;,               &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpBaseAddress&lt;/span&gt;,          &lt;span style=&#34;color:#7f848e&#34;&gt;// å†™å…¥çš„ç›®æ ‡å†…å­˜åŸºåœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPCVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpBuffer&lt;/span&gt;,               &lt;span style=&#34;color:#7f848e&#34;&gt;// æŒ‡å‘æœ¬åœ°æ•°æ®çš„æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;nSize&lt;/span&gt;,                  &lt;span style=&#34;color:#7f848e&#34;&gt;// è¦å†™å…¥çš„å­—èŠ‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_Out_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpNumberOfBytesWritten&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶å®é™…å†™å…¥å­—èŠ‚æ•°çš„æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šå°†ä¸€ä¸ªæœ¬åœ°å­—ç¬¦ä¸²å†™å…¥åˆ°è¿œç¨‹è¿›ç¨‹å·²åˆ†é…çš„å†…å­˜ä¸­&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hTargetProcess = ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// LPVOID pRemoteBuffer = ... (é€šè¿‡VirtualAllocExè·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;myData&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Hello, Remote Process!&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dataSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;strlen&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;myData&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// +1ä¸ºäº†nullç»ˆæ­¢ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bytesWritten&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bResult&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WriteProcessMemory&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hTargetProcess&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuffer&lt;/span&gt;,      &lt;span style=&#34;color:#7f848e&#34;&gt;// å†™å…¥çš„ç›®æ ‡åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;myData&lt;/span&gt;,             &lt;span style=&#34;color:#7f848e&#34;&gt;// æœ¬åœ°æ•°æ®æº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;dataSize&lt;/span&gt;,           &lt;span style=&#34;color:#7f848e&#34;&gt;// å†™å…¥å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;bytesWritten&lt;/span&gt;       &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶å®é™…å†™å…¥çš„å­—èŠ‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;bResult&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bytesWritten&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dataSize&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// å†™å…¥å¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ¨¡å—æ“ä½œapi&#34;&gt;æ¨¡å—æ“ä½œAPI
&lt;/h3&gt;&lt;h4 id=&#34;getmodulehandle&#34;&gt;GetModuleHandle
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è·å–ä¸€ä¸ªå·²åŠ è½½æ¨¡å—çš„å¥æŸ„ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPCTSTR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpModuleName&lt;/span&gt;  &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; æ¨¡å—åç§°(&lt;span style=&#34;color:#e06c75&#34;&gt;DLLæˆ–EXE&lt;/span&gt;)ï¼Œ&lt;span style=&#34;color:#e06c75&#34;&gt;NULLä¸ºè·å–ä¸»EXEå¥æŸ„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šè·å–å½“å‰è¿›ç¨‹EXEçš„å¥æŸ„å’Œkernel32.dllçš„å¥æŸ„&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 1. è·å–å½“å‰è¿›ç¨‹(EXE)çš„æ¨¡å—å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hExe&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 2. è·å–kernel32.dllçš„æ¨¡å—å¥æŸ„(å®ƒä¸€å®šå·²è¢«åŠ è½½)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hKernel32&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hKernel32&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// è·å–å¤±è´¥(æä¸å¯èƒ½å‘ç”Ÿ)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;getmodulefilename&#34;&gt;GetModuleFileName
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è·å–åŒ…å«æŒ‡å®šæ¨¡å—(hModule)çš„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleFileName&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hModule&lt;/span&gt;,    &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; æ¨¡å—å¥æŸ„(&lt;span style=&#34;color:#e06c75&#34;&gt;NULLä¸ºè·å–å½“å‰EXEè·¯å¾„&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_Out_&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPTSTR&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpFilename&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶è·¯å¾„çš„ç¼“å†²åŒº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;nSize&lt;/span&gt;     &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¼“å†²åŒºå¤§å°(TCHARs)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šè·å–å½“å‰å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;exePath&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;MAX_PATH&lt;/span&gt;]; &lt;span style=&#34;color:#7f848e&#34;&gt;// MAX_PATHæ˜¯ä¸€ä¸ªé¢„å®šä¹‰å¸¸é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pathLen&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleFileName&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¼ é€’NULLæ¥è·å–å½“å‰EXEçš„è·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;exePath&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶è·¯å¾„çš„ç¼“å†²åŒº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MAX_PATH&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¼“å†²åŒºå¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;pathLen&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// è·å–å¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// exePathç°åœ¨åŒ…å«&amp;#34;C:\Path\To\YourApp.exe&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;getprocaddress&#34;&gt;GetProcAddress
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ä»æŒ‡å®šçš„DLLæ¨¡å—(hModule)ä¸­æ£€ç´¢å¯¼å‡ºå‡½æ•°(lpProcName)çš„åœ°å€ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hModule&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¨¡å—å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpProcName&lt;/span&gt;  &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; å¯¼å‡ºå‡½æ•°åç§°(&lt;span style=&#34;color:#e06c75&#34;&gt;ANSIå­—ç¬¦ä¸²&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šè·å–kernel32.dllä¸­çš„CreateFileAå‡½æ•°çš„åœ°å€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 1. å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œä½¿å…¶ä¸CreateFileAåŒ¹é…
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HANDLE&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_CREATEFILEA&lt;/span&gt;)(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 2. è·å–æ¨¡å—å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hKernel32&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 3. è·å–å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hKernel32&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;CreateFileA&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ³¨æ„ï¼šå¿…é¡»æ˜¯ANSIå­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// è·å–åœ°å€å¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. å°†é€šç”¨çš„FARPROCè½¬æ¢ä¸ºæˆ‘ä»¬å®šä¹‰çš„ç±»å‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PFN_CREATEFILEA&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MyCreateFile&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_CREATEFILEA&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 5. ç°åœ¨å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨å®ƒ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// MyCreateFile(&amp;#34;test.txt&amp;#34;, ...);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;waitforsingleobject&#34;&gt;WaitForSingleObject
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°æŒ‡å®šå¥æŸ„(hHandle)çš„å¯¹è±¡è¢«&amp;quot;signaled&amp;quot;æˆ–è¶…æ—¶ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WaitForSingleObject&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hHandle&lt;/span&gt;,        &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; è¦ç­‰å¾…çš„å¯¹è±¡å¥æŸ„(å¦‚çº¿ç¨‹ã€è¿›ç¨‹)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;dwMilliseconds&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// è¶…æ—¶æ—¶é—´(æ¯«ç§’)ï¼ŒINFINITEä¸ºæ— é™ç­‰å¾…
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šç­‰å¾…ä¹‹å‰åˆ›å»ºçš„hThreadçº¿ç¨‹æ‰§è¡Œå®Œæ¯•&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hThread = ... (é€šè¿‡CreateThreadè·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;waitResult&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WaitForSingleObject&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;INFINITE&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ— é™æœŸç­‰å¾…ï¼Œç›´åˆ°çº¿ç¨‹ç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;waitResult&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WAIT_OBJECT_0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å·²æˆåŠŸç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;çº¿ç¨‹å·²é€€å‡ºã€‚&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ç­‰å¾…å¤±è´¥æˆ–è¶…æ—¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;closehandle&#34;&gt;CloseHandle
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å…³é—­ä¸€ä¸ªæ‰“å¼€çš„å¯¹è±¡å¥æŸ„(å¦‚è¿›ç¨‹ã€çº¿ç¨‹å¥æŸ„)ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hObject&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// è¦å…³é—­çš„æœ‰æ•ˆå¯¹è±¡å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šå…³é—­ä¹‹å‰æ‰“å¼€æˆ–åˆ›å»ºçš„å¥æŸ„&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hProcess = OpenProcess(...);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HANDLE hThread = CreateThread(...);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// ä½¿ç”¨å®Œæ¯•å...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// å…³é—­çº¿ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// å…³é—­è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ¶ˆæ¯é’©å–api&#34;&gt;æ¶ˆæ¯é’©å–API
&lt;/h3&gt;&lt;h4 id=&#34;setwindowshookex&#34;&gt;SetWindowsHookEx
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å°†ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„é’©å­è¿‡ç¨‹(lpfn)å®‰è£…åˆ°ä¸€ä¸ªé’©å­é“¾ä¸­ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SetWindowsHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt;       &lt;span style=&#34;color:#e06c75&#34;&gt;idHook&lt;/span&gt;,     &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; é’©å­ç±»å‹(å¦‚&lt;span style=&#34;color:#e06c75&#34;&gt;WH_KEYBOARD_LL&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HOOKPROC&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;lpfn&lt;/span&gt;,       &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­è¿‡ç¨‹(å›è°ƒå‡½æ•°)çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;,       &lt;span style=&#34;color:#7f848e&#34;&gt;// åŒ…å«é’©å­è¿‡ç¨‹çš„DLLå¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;dwThreadId&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// è¦é’©å–çš„çº¿ç¨‹ID(0ä¸ºæ‰€æœ‰çº¿ç¨‹)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šå®‰è£…ä¸€ä¸ªä½çº§é”®ç›˜é’©å­(WH_KEYBOARD_LL)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 1. å®šä¹‰ä¸€ä¸ªé’©å­è¿‡ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LRESULT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CALLBACK&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;LowLevelKeyboardProc&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;WPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HC_ACTION&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// ... å¤„ç†é”®ç›˜äº‹ä»¶ ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// å¿…é¡»è°ƒç”¨ä¸‹ä¸€ä¸ªé’©å­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CallNextHookEx&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// 2. åœ¨ä¸»å‡½æ•°ä¸­å®‰è£…é’©å­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SetWindowsHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WH_KEYBOARD_LL&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­ç±»å‹ï¼šä½çº§é”®ç›˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LowLevelKeyboardProc&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­è¿‡ç¨‹å›è°ƒå‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;), &lt;span style=&#34;color:#7f848e&#34;&gt;// åŒ…å«å›è°ƒå‡½æ•°çš„æ¨¡å—å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;                      &lt;span style=&#34;color:#7f848e&#34;&gt;// å…³è”åˆ°æ‰€æœ‰çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// å®‰è£…é’©å­å¤±è´¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;callnexthookex&#34;&gt;CallNextHookEx
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å°†é’©å­ä¿¡æ¯ä¼ é€’ç»™é’©å­é“¾ä¸­çš„ä¸‹ä¸€ä¸ªé’©å­è¿‡ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LRESULT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CallNextHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_opt_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;hhk&lt;/span&gt;,    &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; å½“å‰é’©å­çš„å¥æŸ„(å¯å¿½ç•¥ï¼Œä¼ &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;,  &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­ä»£ç (ä»å›è°ƒå‡½æ•°ä¼ å…¥)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;WPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¶ˆæ¯å‚æ•°(ä»å›è°ƒå‡½æ•°ä¼ å…¥)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;     &lt;span style=&#34;color:#e06c75&#34;&gt;LPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;  &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¶ˆæ¯å‚æ•°(ä»å›è°ƒå‡½æ•°ä¼ å…¥)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šåœ¨é’©å­è¿‡ç¨‹ä¸­è°ƒç”¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// (HHOOK g_hHook; åœ¨SetWindowsHookExä¸­è·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LRESULT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CALLBACK&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;MyHookProc&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;WPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ... åœ¨è¿™é‡Œå¯ä»¥ç›‘è§†æˆ–ä¿®æ”¹ wParam/lParam ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// åœ¨é’©å­è¿‡ç¨‹ä¸­è°ƒç”¨æ­¤å‡½æ•°è‡³å…³é‡è¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// å¦åˆ™ä¼šâ€œåæ‰â€æ¶ˆæ¯ï¼Œå¯¼è‡´ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºåŠŸèƒ½å¼‚å¸¸
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CallNextHookEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;unhookwindowshookex&#34;&gt;UnhookWindowsHookEx
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ç§»é™¤ä¸€ä¸ªç”±SetWindowsHookExå®‰è£…çš„é’©å­è¿‡ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åŸå‹ (ç»“æ„)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;UnhookWindowsHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hhk&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// è¦ç§»é™¤çš„é’©å­å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;egï¼šåœ¨ç¨‹åºé€€å‡ºå‰ï¼Œå¸è½½ä¹‹å‰å®‰è£…çš„G_HHook&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// HHOOK g_hHook = ... (é€šè¿‡SetWindowsHookExè·å–)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bResult&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;UnhookWindowsHookEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;bResult&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// å¸è½½æˆåŠŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;æ³¨å…¥ç”¨dllçš„å‡†å¤‡&#34;&gt;æ³¨å…¥ç”¨DLLçš„å‡†å¤‡
&lt;/h1&gt;&lt;p&gt;æ—¢ç„¶è¦å­¦ï¼Œé‚£è‚¯å®šè¦å®æ“ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€äº›DLLæ¥éªŒè¯æˆ‘ä»¬çš„æ³¨å…¥å™¨æ˜¯å¦å·¥ä½œ&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰ä¸ªç¤ºä¾‹&#34;&gt;ä¸‰ä¸ªç¤ºä¾‹
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹ä¸‰ä¸ªç¤ºä¾‹DLLçš„ç›®çš„éƒ½åªæ˜¯ä¸ºäº†**â€œä¸¾æ‰‹ç¤ºæ„â€**ï¼Œå‘Šè¯‰æˆ‘ä»¬å®ƒå·²ç»æˆåŠŸåœ¨ç›®æ ‡è¿›ç¨‹ä¸­è¿è¡Œï¼Œé™¤æ­¤ä¹‹å¤–å®ƒä»¬ä¸ä¼šæ‰§è¡Œä»»ä½•å…¶ä»–æ“ä½œ&lt;/p&gt;
&lt;h3 id=&#34;å¼¹çª—messagebox&#34;&gt;å¼¹çª—ï¼ˆMessageBoxï¼‰
&lt;/h3&gt;&lt;p&gt;å½“&lt;code&gt;DllMain&lt;/code&gt;è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šç«‹åˆ»å¼¹å‡ºä¸€ä¸ªæ¶ˆæ¯æ¡†&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;DllMain&lt;/code&gt;æ˜¯åœ¨ç›®æ ‡è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„ï¼Œè¿™ä¸ªæ¶ˆæ¯æ¡†å°†éš¶å±äºç›®æ ‡è¿›ç¨‹&lt;/p&gt;
&lt;p&gt;æ­¤DLLå”¯ä¸€çš„è¡Œä¸ºå°±æ˜¯è°ƒç”¨&lt;code&gt;User32.dll&lt;/code&gt;ä¸­çš„&lt;code&gt;MessageBox&lt;/code&gt;APIï¼Œä¸ä¼šå¯¹ç³»ç»Ÿé€ æˆä»»ä½•æ›´æ”¹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt; // ä¸ºäº† TCHAR å’Œ _T()&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;DllMain&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;,  &lt;span style=&#34;color:#7f848e&#34;&gt;// DLLå®ä¾‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;,     &lt;span style=&#34;color:#7f848e&#34;&gt;// è°ƒç”¨åŸå› 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpReserved&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æˆ‘ä»¬åªå…³å¿ƒDLLä½•æ—¶è¢«â€œé™„åŠ â€åˆ°è¿›ç¨‹ä¸Š
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;switch&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å½“DLLè¢«åŠ è½½æ—¶ï¼Œåœ¨ç›®æ ‡è¿›ç¨‹ä¸­å¼¹å‡ºä¸€ä¸ªæ¶ˆæ¯æ¡†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;MessageBox&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;,                             &lt;span style=&#34;color:#7f848e&#34;&gt;// çˆ¶çª—å£å¥æŸ„ (NULL äº¦å¯)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;                &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;DLL æ³¨å…¥æˆåŠŸ! (æ¥è‡ª TestDll_MsgBox)&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¶ˆæ¯å†…å®¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;                &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;æ³¨å…¥æµ‹è¯•&amp;#34;&lt;/span&gt;),                     &lt;span style=&#34;color:#7f848e&#34;&gt;// æ ‡é¢˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;MB_OK&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MB_ICONINFORMATION&lt;/span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// æŒ‰é’® (OK) å’Œå›¾æ ‡ (ä¿¡æ¯)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            );
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_THREAD_ATTACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹åˆ›å»ºæ—¶ä¸åšä»»ä½•äº‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_THREAD_DETACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹é€€å‡ºæ—¶ä¸åšä»»ä½•äº‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_DETACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// DLLè¢«å¸è½½æ—¶ä¸åšä»»ä½•äº‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å§‹ç»ˆè¿”å› TRUE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ’­æ”¾ç³»ç»Ÿæç¤ºéŸ³beep&#34;&gt;æ’­æ”¾ç³»ç»Ÿæç¤ºéŸ³ï¼ˆBeepï¼‰
&lt;/h3&gt;&lt;p&gt;æœ‰æ—¶ç›®æ ‡è¿›ç¨‹å¯èƒ½æ²¡æœ‰å›¾å½¢ç•Œé¢ï¼ˆä¾‹å¦‚ä¸€ä¸ªåå°æœåŠ¡ï¼‰ï¼Œæˆ–è€…æˆ‘ä»¬ä¸æƒ³ç”¨ä¸€ä¸ªå¼¹çª—æ¥æ‰“æ–­ç›®æ ‡è¿›ç¨‹çš„è¿è¡Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨å£°éŸ³ä½œä¸ºåé¦ˆæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªDLLåœ¨è¢«æ³¨å…¥æ—¶ï¼Œä¼šè°ƒç”¨&lt;code&gt;MessageBeep&lt;/code&gt;å‡½æ•°æ’­æ”¾ä¸€ä¸ªç³»ç»Ÿé»˜è®¤çš„ä¿¡æ¯æç¤ºéŸ³&lt;/p&gt;
&lt;p&gt;æ­¤DLLå”¯ä¸€çš„è¡Œä¸ºæ˜¯è°ƒç”¨&lt;code&gt;User32.dll&lt;/code&gt;ä¸­çš„&lt;code&gt;MessageBeep&lt;/code&gt;APIï¼Œå®ƒåªæ˜¯é€šè¿‡å£°å¡æ’­æ”¾ä¸€ä¸ªçŸ­æš‚çš„æç¤ºéŸ³ï¼Œä¸ä¼šæ‰§è¡Œä»»ä½•å…¶ä»–æ“ä½œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;DllMain&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpReserved&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;switch&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å½“DLLè¢«åŠ è½½æ—¶ï¼Œæ’­æ”¾ä¸€ä¸ªâ€œä¿¡æ¯â€æç¤ºéŸ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// MB_ICONINFORMATION å¯¹åº”ä¸€ä¸ªç³»ç»Ÿå£°éŸ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// ä½ ä¹Ÿå¯ä»¥ç”¨ Beep(1000, 500); æ¥å‘å£° (1000Hz, 500æ¯«ç§’)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;MessageBeep&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;MB_ICONINFORMATION&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;è¾“å‡ºåˆ°æ§åˆ¶å°allocconsole&#34;&gt;è¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆAllocConsoleï¼‰
&lt;/h3&gt;&lt;p&gt;å¦‚æœç›®æ ‡æ˜¯ä¸€ä¸ªGUIç¨‹åºï¼ˆå¦‚&lt;code&gt;notepad.exe&lt;/code&gt;ï¼‰ï¼Œå®ƒé»˜è®¤æ˜¯æ²¡æœ‰æ§åˆ¶å°çª—å£çš„ï¼Œè€Œè¿™ä¸ªDLLä¼šä¸ºç›®æ ‡è¿›ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ§åˆ¶å°çª—å£ï¼Œç„¶ååœ¨è¯¥çª—å£ä¸­æ‰“å°ä¸€æ¡æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;è¿™éå¸¸é€‚åˆç”¨æ¥ç¡®è®¤DLLä¸ä»…è¢«åŠ è½½äº†ï¼Œè€Œä¸”å¯ä»¥åœ¨ç›®æ ‡è¿›ç¨‹ä¸­åˆ†é…æ–°èµ„æºï¼ˆä¸€ä¸ªæ§åˆ¶å°ï¼‰å¹¶æ‰§è¡ŒI/Oæ“ä½œï¼ˆ&lt;code&gt;printf&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;æ­¤DLLè°ƒç”¨&lt;code&gt;AllocConsole&lt;/code&gt;åˆ›å»ºä¸€ä¸ªä¸´æ—¶çª—å£ï¼Œä½¿ç”¨&lt;code&gt;printf&lt;/code&gt;å‘å…¶å†™å…¥æ–‡æœ¬ï¼Œç„¶åè°ƒç”¨&lt;code&gt;FreeConsole&lt;/code&gt;å°†å…¶å…³é—­ï¼Œæ²¡æœ‰è§¦åŠç›®æ ‡è¿›ç¨‹çš„ä»»ä½•åŸæœ‰åŠŸèƒ½&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;stdio.h&amp;gt;    // ä¸ºäº† printf å’Œ FILE*&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;io.h&amp;gt;       // ä¸ºäº† _open_osfhandle&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;fcntl.h&amp;gt;    // ä¸ºäº† _O_TEXT&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// æˆ‘ä»¬çš„æ§åˆ¶å°çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// æ³¨æ„ï¼šåœ¨DllMainä¸­æ‰§è¡Œå¤æ‚æ“ä½œï¼ˆæ¯”å¦‚åˆ›å»ºæ§åˆ¶å°ï¼‰æ˜¯ä¸è¢«æ¨èçš„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å› ä¸º DllMain è¿è¡Œåœ¨åŠ è½½å™¨é” (Loader Lock) å†…éƒ¨ï¼Œå®¹æ˜“é€ æˆæ­»é”ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// æœ€å®‰å…¨çš„æ–¹æ³•æ˜¯åƒè¿™æ ·ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œå®é™…å·¥ä½œã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;ConsoleThread&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpParam&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. ä¸ºå½“å‰è¿›ç¨‹åˆ†é…ä¸€ä¸ªæ–°çš„æ§åˆ¶å°çª—å£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;AllocConsole&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;FILE&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pFile&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. å°†æ ‡å‡†è¾“å‡º (stdout) é‡å®šå‘åˆ°æ–°çš„æ§åˆ¶å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// freopen_s æ˜¯ä¸€ä¸ªå®‰å…¨çš„æ–¹å¼æ¥é‡æ–°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æµ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;freopen_s&lt;/span&gt;(&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pFile&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;CONOUT$&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;stdout&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;#34;CONOUT$&amp;#34; æ˜¯æ§åˆ¶å°è¾“å‡ºçš„è®¾å¤‡å
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. è®¾ç½®æ ‡é¢˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SetConsoleTitle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Injected Console - (TestDll_Console)&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. æ‰“å°æˆ‘ä»¬çš„æ¶ˆæ¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;--- DLL æ³¨å…¥æˆåŠŸ! ---&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;è¿™ä¸ªæ§åˆ¶å°çª—å£ç°åœ¨å±äºç›®æ ‡è¿›ç¨‹ã€‚&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;æŒ‰å›è½¦é”®å…³é—­æ­¤æ§åˆ¶å°...&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// 5. ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œä»¥ä¾¿è§‚å¯Ÿ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;getchar&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// 6. æ¸…ç†å¹¶é‡Šæ”¾æ§åˆ¶å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;pFile&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;fclose&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;pFile&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FreeConsole&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;DllMain&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpReserved&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;switch&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;fdwReason&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œæˆ‘ä»¬çš„æ§åˆ¶å°é€»è¾‘
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#7f848e&#34;&gt;// æˆ‘ä»¬ä¸å¸Œæœ›åœ¨ DllMain ä¸­ç›´æ¥åšè¿™äº›
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateThread&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ConsoleThread&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// å…³é—­å¥æŸ„ï¼Œçº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;æ³¨å…¥çš„å®ç°æ–¹æ³•&#34;&gt;æ³¨å…¥çš„å®ç°æ–¹æ³•
&lt;/h1&gt;&lt;h2 id=&#34;åˆ›å»ºè¿œç¨‹çº¿ç¨‹-createremotethread&#34;&gt;åˆ›å»ºè¿œç¨‹çº¿ç¨‹ (CreateRemoteThread)
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯æœ€ç»å…¸ç›´æ¥çš„æ³¨å…¥æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;åŸç†&#34;&gt;åŸç†
&lt;/h3&gt;&lt;p&gt;ä¹‹å‰è¯´è¿‡ï¼Œ&lt;code&gt;CreateRemoteThread&lt;/code&gt;APIå…è®¸æˆ‘ä»¬åœ¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿è§‚çœ‹ï¼Œè¿™é‡Œå†è´´ä¸€ä¸‹å®ƒçš„ç»“æ„&lt;del&gt;å‰é¢çš„å†…å®¹å…¶å®ä½ æ ¹æœ¬æ²¡çœ‹å¯¹å§&lt;/del&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt;                                       &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;,                   &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadAttributes&lt;/span&gt;,   &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å®‰å…¨å±æ€§
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;SIZE_T&lt;/span&gt;                                           &lt;span style=&#34;color:#e06c75&#34;&gt;dwStackSize&lt;/span&gt;,             &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; åˆå§‹å †æ ˆå¤§å°(&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;ä¸ºé»˜è®¤)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;lpStartAddress&lt;/span&gt;,         &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿œç¨‹çº¿ç¨‹å‡½æ•°åœ°å€ï¼Œé‡è¦ï¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;                                         &lt;span style=&#34;color:#e06c75&#34;&gt;lpParameter&lt;/span&gt;,              &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¼ é€’ç»™è¿œç¨‹çº¿ç¨‹çš„å‚æ•°ï¼Œé‡è¦ï¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;                                        &lt;span style=&#34;color:#e06c75&#34;&gt;dwCreationFlags&lt;/span&gt;,      &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹åˆ›å»ºæ ‡å¿—(0ä¸ºç«‹å³è¿è¡Œ)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_Out_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LPDWORD&lt;/span&gt;                                   &lt;span style=&#34;color:#e06c75&#34;&gt;lpThreadId&lt;/span&gt;                &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¥æ”¶çº¿ç¨‹IDçš„æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å“¦ï¼Œå®ƒæ¥å—çº¿ç¨‹å‡½æ•°åœ°å€å’Œçº¿ç¨‹å‡½æ•°å‚æ•°&amp;hellip;&amp;hellip;é‚£æˆ‘ä»¬å²‚ä¸æ˜¯å¯ä»¥ç”¨å®ƒæ¥åŠ è½½æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;æ­¥éª¤&#34;&gt;æ­¥éª¤
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†&lt;code&gt;lpStartAddress&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;LoadLibrary()&lt;/code&gt;å‡½æ•°çš„åœ°å€&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å°†&lt;code&gt;lpParameter&lt;/code&gt;è®¾ç½®ä¸ºæˆ‘ä»¬æƒ³è¦æ³¨å…¥çš„DLLæ–‡ä»¶çš„è·¯å¾„å­—ç¬¦ä¸²çš„åœ°å€&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåœ°å€å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ¨¡å—æ“ä½œAPIæ¥å¾—åˆ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;L&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;LoadLibraryW&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;äºæ˜¯å½“&lt;code&gt;CreateRemoteThread&lt;/code&gt;æ‰§è¡Œæ—¶ï¼Œå®ƒå°±ç›¸å½“äºåœ¨ç›®æ ‡è¿›ç¨‹å†…éƒ¨è°ƒç”¨äº†:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;LoadLibrary&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C:&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;path&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;to&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;myhack.dll&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·å°±è§¦å‘äº†&lt;code&gt;DllMain&lt;/code&gt;ï¼Œå®ç°äº†æ³¨å…¥&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            âš ï¸
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Warning
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;&lt;code&gt;lpStartAddress&lt;/code&gt;å’Œ&lt;code&gt;lpParameter&lt;/code&gt;éƒ½å¿…é¡»æ˜¯ç›®æ ‡è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„åœ°å€&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;è¿™é‡Œå¯èƒ½æœ‰ä¸ªç–‘é—®ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬çŸ¥é“&lt;code&gt;LoadLibrary&lt;/code&gt;çš„åœ°å€ï¼Ÿéš¾é“å®ƒæ˜¯é€šç”¨çš„ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿˜çœŸæ˜¯ï¼&lt;code&gt;LoadLibrary&lt;/code&gt;å‡½æ•°ä½äº&lt;code&gt;Kernel32.dll&lt;/code&gt;ä¸­ï¼Œè€ŒWindowsæ“ä½œç³»ç»Ÿä¸ºäº†æ•ˆç‡ï¼Œä¼šå°†è¿™äº›æ ¸å¿ƒDLLåŠ è½½åˆ°&lt;em&gt;æ‰€æœ‰&lt;/em&gt;è¿›ç¨‹ä¸­å‡ ä¹ç›¸åŒçš„ImageBase&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±è¿›ç¨‹ä¸­ç”¨æ‰¾åˆ°çš„&lt;code&gt;LoadLibrary&lt;/code&gt;åœ°å€ï¼Œä¸å®ƒåœ¨ç›®æ ‡è¿›ç¨‹ä¸­çš„åœ°å€æ˜¯å®Œå…¨ç›¸åŒçš„ï¼&lt;/p&gt;
&lt;p&gt;è¿™ä¸€æ•´ä¸ªè¿‡ç¨‹ä¸‹æ¥ï¼Œå…¶å®å°±æ˜¯åœ¨è¯´ï¼šä¸€äº›ä¸ºäº†æ–¹ä¾¿çš„è¡Œä¸ºï¼Œæ—©æ™šä¼šå˜æˆæ¼æ´ï¼ˆ&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;å°†&lt;code&gt;MyDll.dll&lt;/code&gt;æ³¨å…¥åˆ°æŒ‡å®šPIDçš„è¿›ç¨‹ä¸­&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;InjectDll&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPCTSTR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szDllPath&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. è®¡ç®—DLLè·¯å¾„å­—ç¬¦ä¸²æ‰€éœ€çš„å­—èŠ‚å¤§å° (åŒ…æ‹¬ç»“å°¾çš„ \0)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwBufSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;)(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tcslen&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;szDllPath&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pThreadProc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. è·å–ç›®æ ‡è¿›ç¨‹å¥æŸ„ (dwPID)ï¼Œéœ€è¦æ‰€æœ‰æƒé™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;OpenProcess&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;PROCESS_ALL_ACCESS&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;)))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. åœ¨ç›®æ ‡è¿›ç¨‹ä¸­åˆ†é…å†…å­˜ï¼Œç”¨äºå­˜æ”¾DLLè·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;VirtualAllocEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwBufSize&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;MEM_COMMIT&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;PAGE_READWRITE&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. å°†DLLè·¯å¾„å­—ç¬¦ä¸²å†™å…¥åˆšåˆšåˆ†é…çš„è¿œç¨‹å†…å­˜ä¸­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WriteProcessMemory&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;, (&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;szDllPath&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwBufSize&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 5. è·å– Kernel32.dll æ¨¡å—çš„å¥æŸ„ï¼ˆåœ¨å½“å‰è¿›ç¨‹ä¸­ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 6. è·å– LoadLibraryW å‡½æ•°çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// (è¿™é‡Œä½¿ç”¨ LoadLibraryW æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº† TCHARï¼Œå¹¶ä¸”å¾ˆå¯èƒ½å®šä¹‰äº† UNICODE)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pThreadProc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;)&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;LoadLibraryW&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 7. åœ¨ç›®æ ‡è¿›ç¨‹ä¸­åˆ›å»ºè¿œç¨‹çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‡½æ•° = LoadLibraryW çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‚æ•° = è¿œç¨‹å†…å­˜ä¸­DLLè·¯å¾„çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pThreadProc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WaitForSingleObject&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;INFINITE&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 8. æ¸…ç†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// VirtualFreeEx(hProcess, pRemoteBuf, 0, MEM_RELEASE); // ç†è®ºä¸Šåº”è¯¥é‡Šæ”¾å†…å­˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tmain&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ç”¨æ³•: InjectDll.exe &amp;lt;PID&amp;gt; &amp;lt;DLLè·¯å¾„&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¤ºä¾‹: InjectDll.exe 4232 F:\1\MyDll.dll
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;argc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tprintf&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Usage: InjectDll.exe &amp;lt;PID&amp;gt; &amp;lt;Full Dll Path&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;InjectDll&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_ttoi&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;]), &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tprintf&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;InjectDll(&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;) success!!!&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰§è¡Œåï¼Œä½¿ç”¨Process Explorerç­‰å·¥å…·æŸ¥çœ‹ï¼Œä¼šå‘ç°&lt;code&gt;notepad.exe&lt;/code&gt;æˆåŠŸåŠ è½½äº†&lt;code&gt;MyDll.dll&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨æ³¨å†Œè¡¨-appinit_dlls&#34;&gt;ä½¿ç”¨æ³¨å†Œè¡¨ (AppInit_DLLs)
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯ä¸€ç§æ›´è¢«åŠ¨ï¼Œä½†å½±å“èŒƒå›´æ›´å¹¿çš„æ³¨å…¥æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;åŸç†-1&#34;&gt;åŸç†
&lt;/h3&gt;&lt;p&gt;è¿˜è®°å¾—ä¹‹å‰è¯´çš„æŒç®¡ç”¨æˆ·äº‹ä»¶çš„&lt;code&gt;User32.dll&lt;/code&gt;å—ï¼Ÿå½“å®ƒè¢«åŠ è½½æ—¶ï¼Œä¼šè¯»å–ä¸€ä¸ªç‰¹æ®Šçš„æ³¨å†Œè¡¨é¡¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HKEY_LOCAL_MACHINE&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;SOFTWARE&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Microsoft&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Windows&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NT&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;CurrentVersion&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Windows&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è¿™ä¸ªé”®ä¸‹ï¼Œæœ‰ä¸€ä¸ªåä¸º&lt;code&gt;AppInit_DLLs&lt;/code&gt;çš„å€¼ï¼Œå¦‚æœè¿™ä¸ªå€¼é‡ŒåŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆç”¨é€—å·æˆ–ç©ºæ ¼åˆ†éš”ï¼‰DLLçš„å®Œæ•´è·¯å¾„ï¼Œ&lt;code&gt;User32.dll&lt;/code&gt;å°±ä¼šè‡ªåŠ¨è°ƒç”¨&lt;code&gt;LoadLibrary()&lt;/code&gt;æ¥åŠ è½½å®ƒä»¬&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªé”®&lt;code&gt;LoadAppInit_DLLs&lt;/code&gt;ï¼Œæ˜¯æ§åˆ¶å¼€å…³ï¼Œå†³å®šæ˜¯å¦å¯ç”¨&lt;code&gt;AppInit_DLLs&lt;/code&gt;åˆ—è¡¨ä¸­æŒ‡å®šçš„ DLL çš„åŠ è½½&lt;/p&gt;
&lt;p&gt;å…³äºæ³¨å†Œè¡¨ï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ä¸ªï¼š&lt;a class=&#34;link&#34; href=&#34;https://blog.928330.xyz/p/windows%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93%E4%B8%8A/#%E6%B3%A8%E5%86%8C%E8%A1%A8&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æ³¨å†Œè¡¨
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ­¥éª¤-1&#34;&gt;æ­¥éª¤
&lt;/h3&gt;&lt;p&gt;æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ (&lt;code&gt;regedit&lt;/code&gt;)ï¼Œå®šä½åˆ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HKEY_LOCAL_MACHINE&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;SOFTWARE&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Microsoft&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Windows&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NT&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;CurrentVersion&lt;/span&gt;\&lt;span style=&#34;color:#e06c75&#34;&gt;Windows&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒå‡»&lt;code&gt;AppInit_DLLs&lt;/code&gt;ï¼Œå°†è¦æ³¨å…¥çš„DLLçš„ç»å¯¹è·¯å¾„å¡«å…¥&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œæ‰¾åˆ°&lt;code&gt;LoadAppInit_DLLs&lt;/code&gt;è¿™ä¸ª&lt;code&gt;DWORD&lt;/code&gt;å€¼ï¼Œå°†å…¶æ•°æ®ä»0æ”¹ä¸º1&lt;/p&gt;
&lt;p&gt;æœ€åé‡å¯ç”µè„‘&lt;/p&gt;
&lt;p&gt;å®Œæˆä¸Šè¿°æ“ä½œåï¼Œä½ å¯åŠ¨çš„ä»»ä½•GUIç¨‹åºï¼ˆå¦‚&lt;code&gt;notepad.exe&lt;/code&gt;,&lt;code&gt;POWERPNT.EXE&lt;/code&gt;,&lt;code&gt;iexplore.exe&lt;/code&gt;ç­‰ï¼‰éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å…¥&lt;code&gt;MyDll2.dll&lt;/code&gt;ï¼Œå¦‚æœæ²¡æœ‰æ”¹æ‰ï¼Œä»–å°±ä¼šä¸€ç›´å½±å“ä½ ï¼Œè¿™ä¹Ÿæ˜¯æŒä¹…åŒ–æ³¨å…¥çš„æ–¹å¼&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹-1&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;æ²¡æœ‰ç¤ºä¾‹ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ²¡æœ‰è™šæ‹Ÿæœºï¼Œå»æ“ä½œæœ¬æœºçš„æ³¨å†Œè¡¨æ˜¯å¾ˆå±é™©çš„ï¼Œå°¤å…¶æ˜¯è‡ªå¸¦çš„&lt;code&gt;regedit&lt;/code&gt;æ²¡æœ‰æ’¤å›æœºåˆ¶ï¼Œå¾ˆå®¹æ˜“å°±æ•´åäº†&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”ï¼Œä»Windows8å¼€å§‹ï¼Œç”±äºå®‰å…¨å¯åŠ¨ï¼ˆSecure Bootï¼‰çš„å¼•å…¥ï¼Œ&lt;code&gt;AppInit_DLLs&lt;/code&gt;æœºåˆ¶é»˜è®¤è¢«ç¦ç”¨ï¼Œé™¤éDLLæ˜¯ç»è¿‡ç­¾åçš„ï¼Œä¸ç„¶ä¸ä¼šè¢«åŠ è½½çš„&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œçœ‹ä¸€ä¸‹å°±è¡Œäº†&lt;/p&gt;
&lt;h2 id=&#34;æ¶ˆæ¯é’©å–-setwindowshookex&#34;&gt;æ¶ˆæ¯é’©å– (SetWindowsHookEx)
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯åˆ©ç”¨Windowsæ¶ˆæ¯æœºåˆ¶å®ç°çš„æ³¨å…¥æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;åŸç†-2&#34;&gt;åŸç†
&lt;/h3&gt;&lt;p&gt;Windows GUIæ˜¯äº‹ä»¶é©±åŠ¨çš„&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªçš„é”®ç›˜/é¼ æ ‡æ“ä½œä¼šäº§ç”Ÿäº‹ä»¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†è¿™äº›äº‹ä»¶åŒ…è£…æˆæ¶ˆæ¯å‘é€åˆ°ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼Œåº”ç”¨ç¨‹åºå†ä»è‡ªå·±çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºå¹¶å¤„ç†æ¶ˆæ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ¶ˆæ¯å¾ªç¯&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯é’©å­æ˜¯å…è®¸æˆ‘ä»¬æ‹¦æˆªè¿™äº›æ¶ˆæ¯çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆä¹Ÿè¢«ç§°ä¸ºâ€œé’©å­è¿‡ç¨‹â€ï¼‰ï¼Œåœ¨äº‹ä»¶æ¶ˆæ¯ä»æ“ä½œç³»ç»Ÿå‘åº”ç”¨ç¨‹åºä¼ é€’çš„è¿‡ç¨‹ä¸­ï¼Œè·å–ã€æŸ¥çœ‹ã€ä¿®æ”¹ç”šè‡³æ‹¦æˆªè¿™äº›æ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;å¦‚æœå­˜åœ¨å¤šä¸ªé’©å­ï¼Œå®ƒä»¬ä¼šå½¢æˆä¸€ä¸ªâ€œé’©å­é“¾â€&lt;/p&gt;
&lt;h3 id=&#34;æ­¥éª¤-2&#34;&gt;æ­¥éª¤
&lt;/h3&gt;&lt;p&gt;ä¾æ—§æ˜¯å‰æ–‡æåˆ°è¿‡çš„å‡½æ•°&lt;code&gt;SetWindowsHookEx&lt;/code&gt;ï¼Œå®ƒæ˜¯å®‰è£…é’©å­çš„API&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SetWindowsHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt;                      &lt;span style=&#34;color:#e06c75&#34;&gt;idHook&lt;/span&gt;,          &lt;span style=&#34;color:#56b6c2&#34;&gt;//&lt;/span&gt; é’©å­ç±»å‹(å¦‚&lt;span style=&#34;color:#e06c75&#34;&gt;WH_KEYBOARD_LL&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HOOKPROC&lt;/span&gt;       &lt;span style=&#34;color:#e06c75&#34;&gt;lpfn&lt;/span&gt;,                &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­è¿‡ç¨‹(å›è°ƒå‡½æ•°)çš„åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;,            &lt;span style=&#34;color:#7f848e&#34;&gt;// åŒ…å«é’©å­è¿‡ç¨‹çš„DLLå¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;_In_&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;             &lt;span style=&#34;color:#e06c75&#34;&gt;dwThreadId&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// è¦é’©å–çš„çº¿ç¨‹ID(0ä¸ºæ‰€æœ‰çº¿ç¨‹)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨å…¥çš„åŸç†å°±å‘ç”Ÿåœ¨&lt;code&gt;hMod&lt;/code&gt;å’Œ&lt;code&gt;dwThreadId&lt;/code&gt;å‚æ•°ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬å°†é’©å­è¿‡ç¨‹&lt;code&gt;lpfn&lt;/code&gt;æ”¾åœ¨å‡†å¤‡æ³¨å…¥çš„DLLä¸­ï¼ˆæˆ‘ä»¬ç§°å‘¼å®ƒä¸º&lt;code&gt;Hook.dll&lt;/code&gt;ï¼‰ï¼Œ&lt;code&gt;hMod&lt;/code&gt;æ˜¯è¿™ä¸ª&lt;code&gt;Hook.dll&lt;/code&gt;çš„å¥æŸ„&lt;/li&gt;
&lt;li&gt;ä¹‹åï¼Œæˆ‘ä»¬è®©ä¸€ä¸ªç¨‹åºï¼ˆæˆ‘ä»¬ç§°å‘¼å®ƒä¸ºå®‰è£…ç¨‹åºï¼‰åŠ è½½&lt;code&gt;Hook.dll&lt;/code&gt;ï¼Œå¹¶ç”¨&lt;code&gt;SetWindowsHookEx&lt;/code&gt;æ³¨å†Œé’©å­&lt;/li&gt;
&lt;li&gt;å¦‚æœ&lt;code&gt;dwThreadId&lt;/code&gt;è¢«è®¾ç½®ä¸º&lt;code&gt;0&lt;/code&gt;ï¼Œ&lt;code&gt;SetWindowsHookEx&lt;/code&gt;ä¼šå®‰è£…ä¸€ä¸ªå…¨å±€é’©å­ï¼Œä¹Ÿå°±æ˜¯è¯´ç³»ç»Ÿä¼šæŠŠè¿™ä¸ªé’©å­åŠ å…¥åˆ°ç³»ç»Ÿé’©å­é“¾ä¸­ï¼Œå®ƒè¿™æ ·ç³»ç»Ÿé‡Œæ‰€æœ‰ç›¸å…³çº¿ç¨‹äº§ç”Ÿçš„æ¶ˆæ¯éƒ½å¯èƒ½è§¦å‘è¯¥é’©å­&lt;/li&gt;
&lt;li&gt;å½“è¢«é’©å–çš„æ¶ˆæ¯åœ¨ç³»ç»Ÿä¸­çš„ä»»ä½•è¿›ç¨‹ä¸­å‘ç”Ÿæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºäº†èƒ½è°ƒç”¨é’©å­è¿‡ç¨‹&lt;code&gt;lpfn&lt;/code&gt;ï¼Œä¼šå¼ºåˆ¶å°†åŒ…å«é’©å­è¿‡ç¨‹çš„DLLæ³¨å…¥åˆ°é‚£ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å°±è¿™æ ·ï¼Œåªè¦ä½ åœ¨&lt;code&gt;notepad.exe&lt;/code&gt;é‡ŒæŒ‰ä¸€ä¸‹é”®ï¼Œ&lt;code&gt;Hook.dll&lt;/code&gt;å°±è¢«æ³¨å…¥è¿›å»äº†&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹-2&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªä¾‹å­åŒ…å«ä¸¤éƒ¨åˆ†ï¼š&lt;code&gt;HookDll.dll&lt;/code&gt;ï¼ˆæœ¨é©¬ï¼‰å’Œ&lt;code&gt;TestHook.exe&lt;/code&gt;ï¼ˆå®‰è£…å™¨ï¼‰&lt;/p&gt;
&lt;h4 id=&#34;æœ¨é©¬hookdllcpp&#34;&gt;æœ¨é©¬ï¼šHookDll.cpp
&lt;/h4&gt;&lt;p&gt;è¿™ä¸ªDLLåŒ…å«äº†çœŸæ­£çš„é’©å­è¿‡ç¨‹&lt;code&gt;KeyboardProc&lt;/code&gt;ï¼Œå®ƒè¿˜å¯¼å‡ºäº†ä¸¤ä¸ªå‡½æ•°&lt;code&gt;HkStart&lt;/code&gt;å’Œ&lt;code&gt;HkStop&lt;/code&gt;ï¼Œä¾›å®‰è£…å™¨è°ƒç”¨&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¿…é¡»ä½¿ç”¨å…±äº«å˜é‡ï¼Œä»¥ä¾¿åœ¨ä¸åŒè¿›ç¨‹ä¸­å…±äº«å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#pragma data_seg(&amp;#34;Shared&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;g_hInstance&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// DLLå®ä¾‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HHOOK&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;         &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#pragma data_seg()
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#pragma comment(linker, &amp;#34;/SECTION:Shared,RWS&amp;#34;) &lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// è®¾ç½®æ®µå±æ€§ä¸ºè¯»ã€å†™ã€å…±äº«
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;DllMain&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;HINSTANCE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwReason&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lpvReserved&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;dwReason&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DLL_PROCESS_ATTACH&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;g_hInstance&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hinstDLL&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿å­˜DLLå®ä¾‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­è¿‡ç¨‹ï¼ˆå›è°ƒå‡½æ•°ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LRESULT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CALLBACK&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;KeyboardProc&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;WPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// lParamçš„ç¬¬31ä½ï¼š0è¡¨ç¤ºæŒ‰é”®ï¼Œ1è¡¨ç¤ºé‡Šæ”¾é”®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x80000000&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szPath&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;MAX_PATH&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleFileName&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;szPath&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;MAX_PATH&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tcsrchr&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;szPath&lt;/span&gt;, &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\\&amp;#39;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// æ£€æŸ¥å½“å‰è¿›ç¨‹æ˜¯å¦ä¸º notepad.exe
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;lstrcmpi&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;notepad.exe&amp;#34;&lt;/span&gt;))) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ˜¯Notepadï¼Œè¿”å›1ï¼Œæ‹¦æˆªè¯¥æ¶ˆæ¯ï¼ˆæŒ‰é”®å¤±æ•ˆï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¸æ˜¯Notepadï¼Œæˆ–ä¸æ˜¯æŒ‰é”®æ¶ˆæ¯ï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™ä¸‹ä¸€ä¸ªé’©å­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CallNextHookEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;nCode&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;wParam&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å‡ºå‡½æ•°ï¼šå¼€å§‹é’©å–
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;__declspec&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;dllexport&lt;/span&gt;) &lt;span style=&#34;color:#e5c07b&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HkStart&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;SetWindowsHookEx&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;WH_KEYBOARD&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­ç±»å‹ï¼šé”®ç›˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;KeyboardProc&lt;/span&gt;,   &lt;span style=&#34;color:#7f848e&#34;&gt;// é’©å­è¿‡ç¨‹åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;g_hInstance&lt;/span&gt;,    &lt;span style=&#34;color:#7f848e&#34;&gt;// DLLå®ä¾‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;               &lt;span style=&#34;color:#7f848e&#34;&gt;// å…¨å±€é’©å­ï¼ˆæ‰€æœ‰çº¿ç¨‹ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    );
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å‡ºå‡½æ•°ï¼šåœæ­¢é’©å–
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;__declspec&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;dllexport&lt;/span&gt;) &lt;span style=&#34;color:#e5c07b&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HkStop&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;UnhookWindowsHookEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;g_hHook&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å®‰è£…å™¨testhookcpp&#34;&gt;å®‰è£…å™¨ï¼šTestHook.cpp
&lt;/h4&gt;&lt;p&gt;è¿™ä¸ªç¨‹åºè´Ÿè´£åŠ è½½&lt;code&gt;HookDll.dll&lt;/code&gt;å¹¶è°ƒç”¨å…¶å¯¼å‡ºçš„&lt;code&gt;HkStart&lt;/code&gt;æ¥å®‰è£…å…¨å±€é’©å­&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å®šä¹‰å¯¼å‡ºå‡½æ•°çš„æŒ‡é’ˆç±»å‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;void&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTART&lt;/span&gt;)();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;void&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTOP&lt;/span&gt;)();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tmain&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. åŠ è½½DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;LoadLibraryA&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HookDll.dll&amp;#34;&lt;/span&gt;))) &lt;span style=&#34;color:#7f848e&#34;&gt;// ä½¿ç”¨Aç‰ˆæœ¬
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. è·å–å¯¼å‡ºå‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTART&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HookStart&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTART&lt;/span&gt;)&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HkStart&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTOP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;HookStop&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;PFN_HOOKSTOP&lt;/span&gt;)&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;HkStop&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HookStart&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HookStop&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FreeLibrary&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. è°ƒç”¨å¯¼å‡ºå‡½æ•°ï¼Œå®‰è£…å…¨å±€é’©å­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HookStart&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tprintf&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Hook installed. Press &amp;#39;q&amp;#39; to quit!&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. é˜»å¡ï¼Œç­‰å¾…ç”¨æˆ·é€€å‡º
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;getchar&lt;/span&gt;() &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;q&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 5. å¸è½½é’©å­
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HookStop&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 6. é‡Šæ”¾DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FreeLibrary&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿è¡Œ&lt;code&gt;TestHook.exe&lt;/code&gt;åï¼Œæ‰“å¼€è®°äº‹æœ¬ï¼ˆ&lt;code&gt;notepad.exe&lt;/code&gt;ï¼‰ï¼Œä½ ä¼šå‘ç°æ— æ³•è¾“å…¥ä»»ä½•å­—ç¬¦ï¼Œå› ä¸ºé”®ç›˜æ¶ˆæ¯è¢«&lt;code&gt;HookDll.dll&lt;/code&gt;æ‹¦æˆªäº†&lt;/p&gt;
&lt;h2 id=&#34;ä¿®æ”¹peå¯¼å…¥è¡¨-é™æ€æ³¨å…¥&#34;&gt;ä¿®æ”¹PEå¯¼å…¥è¡¨ (é™æ€æ³¨å…¥)
&lt;/h2&gt;&lt;p&gt;ä¸æ“ä½œè¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹ç£ç›˜ä¸Šçš„exeæ–‡ä»¶&lt;/p&gt;
&lt;h3 id=&#34;åŸç†-3&#34;&gt;åŸç†
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ç›´æ¥åœ¨ç›®æ ‡exeçš„PEç»“æ„ä¸­ï¼Œå°†å…¶å¯¼å…¥è¡¨æŒ‡å‘çš„&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;æ•°ç»„è¿›è¡Œä¿®æ”¹ï¼Œæ·»åŠ ä¸€ä¸ªæŒ‡å‘æˆ‘ä»¬DLLçš„æ–°æ¡ç›®&lt;/p&gt;
&lt;p&gt;è¿™æ ·ï¼Œå½“WindowsåŠ è½½å™¨è¿è¡Œè¿™ä¸ªè¢«ä¿®æ”¹çš„exeæ—¶ï¼Œå®ƒä¼šåƒåŠ è½½&lt;code&gt;kernel32.dll&lt;/code&gt;ä¸€æ ·ï¼Œè‡ªåŠ¨åŠ è½½æˆ‘ä»¬çš„&lt;code&gt;MyDll3.dll&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹-3&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;PEåŠ è½½å™¨å¯¼å…¥DLLçš„ç›®çš„æ˜¯ä¸ºäº†è°ƒç”¨å®ƒçš„å‡½æ•°ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬çš„æ³¨å…¥DLLå¿…é¡»è‡³å°‘æä¾›ä¸€ä¸ªå¯¼å‡ºå‡½æ•°ï¼Œå¦åˆ™æ— æ³•è¢«éšå¼é“¾æ¥&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªç©ºçš„å‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯æ‰€è°“çš„&lt;code&gt;dummy&lt;/code&gt;å‡½æ•°ï¼‰ç³Šå¼„å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;urlmon.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#pragma comment(lib, &amp;#34;urlmon.lib&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å¿…é¡»æä¾›è‡³å°‘ä¸€ä¸ªå¯¼å‡ºå‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;__declspec&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;dllexport&lt;/span&gt;) &lt;span style=&#34;color:#e5c07b&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;dummy&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt;;    &lt;span style=&#34;color:#7f848e&#34;&gt;//ä»€ä¹ˆä¹Ÿä¸åš
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¿®æ”¹å¯¼å…¥è¡¨&#34;&gt;ä¿®æ”¹å¯¼å…¥è¡¨
&lt;/h3&gt;&lt;h4 id=&#34;å®šä½åŸå¯¼å…¥è¡¨&#34;&gt;å®šä½åŸå¯¼å…¥è¡¨
&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨PEviewæŸ¥çœ‹&lt;code&gt;notepad.exe&lt;/code&gt;ï¼Œæ‰¾åˆ°å¯¼å…¥è¡¨ï¼Œè¿™ä¸ªäº‹æƒ…æˆ‘ä»¬åœ¨ä¹‹å‰çš„è¯¾ä¸­å·²ç»åšè¿‡&lt;/p&gt;
&lt;h4 id=&#34;å¯»æ‰¾æ–°ç©ºé—´&#34;&gt;å¯»æ‰¾æ–°ç©ºé—´
&lt;/h4&gt;&lt;p&gt;å› ä¸ºåŸå¯¼å…¥è¡¨åé¢ç´§è·Ÿç€å…¶ä»–æ•°æ®ï¼Œç©ºé—´å·²æ»¡ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥åœ¨æœ«å°¾æ·»åŠ æ–°æ¡ç›®ï¼Œæ‰€ä»¥å¿…é¡»æŠŠæ•´ä¸ªå¯¼å…¥è¡¨ç§»åŠ¨åˆ°æ–‡ä»¶ä¸­çš„ä¸€ä¸ªç©ºç™½åŒºåŸŸ&lt;/p&gt;
&lt;p&gt;å¦‚ä½•æŸ¥æ‰¾æ–‡ä»¶ä¸­çš„ç©ºç™½åŒºåŸŸï¼Ÿä¾‹å¦‚ï¼Œ&lt;code&gt;.reloc&lt;/code&gt;èŠ‚åŒºæœ«å°¾å¯èƒ½æœ‰å‡ ç™¾å­—èŠ‚çš„&lt;code&gt;00&lt;/code&gt;å¡«å……ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251102163528866&#34; href=&#34;http://picture.928330.xyz/typora/image-20251102163528866.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251102163528866.png&#34; alt=&#34;image-20251102163528866&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;å¤åˆ¶æ·»åŠ å¹¶æ›´æ–°peå¤´&#34;&gt;å¤åˆ¶ã€æ·»åŠ å¹¶æ›´æ–°PEå¤´
&lt;/h4&gt;&lt;p&gt;å°†åŸ&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;æ•°ç»„å®Œæ•´å¤åˆ¶åˆ°æ–°ä½ç½®ï¼Œç„¶ååœ¨æ–°ä½ç½®çš„æœ«å°¾è¿½åŠ ä¸€ä¸ªæ¡ç›®ï¼Œè¿™ä¸ªæ¡ç›®è¦åœ¨ç»ˆç»“æè¿°ç¬¦ä¹‹å‰&lt;/p&gt;
&lt;p&gt;æ›´æ”¹åï¼Œæ€»å­—èŠ‚æ•°æ˜¯&lt;code&gt;(N+1)*0x14&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;æˆ–è®¸ä½ è¿˜è®°å¾—å¯¼å…¥è¡¨æ¡ç›®çš„ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;OriginalFirstThunk&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;//å¯¼å…¥åç§°è¡¨ INT çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TimeDateStamp&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ForwarderChain&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º -1 æˆ– 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;;                    &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL åç§°çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FirstThunk&lt;/span&gt;;              &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å…¥åœ°å€è¡¨ IAT çš„ RVA 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;unionæ˜¯æˆå‘˜å…±ç”¨ä¸€å—åœ°å€ï¼Œæ‰€ä»¥ä¸€ä¸ª&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;å ç”¨20å­—èŠ‚ï¼ˆ0x14ï¼‰&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæ•°ç»„å¿…é¡»ä»¥ä¸€ä¸ªå…¨0çš„ç»ˆç»“æè¿°ç¬¦ç»“å°¾ï¼ˆç±»ä¼¼Cå­—ç¬¦ä¸²çš„ &lt;code&gt;&#39;\0&#39;&lt;/code&gt;ï¼‰ï¼Œè¿™ä¸ªæè¿°ç¬¦ä¹Ÿæ˜¯20å­—èŠ‚&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;è¿™æ—¶å€™å°±èƒ½è®¡ç®—æ–°è¡¨çš„RVAäº†ï¼šå‡è®¾æˆ‘ä»¬å°±ç”¨&lt;code&gt;.reloc&lt;/code&gt;èŠ‚åé¢çš„ç©ºç™½åŒºåŸŸï¼Œç”¨&lt;code&gt;.reloc&lt;/code&gt;çš„&lt;code&gt;RAW&lt;/code&gt;å’Œ&lt;code&gt;RVA&lt;/code&gt;ä½œä¸ºåŸºå‡†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;æ–°RVA&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;æ–°RAW&lt;/span&gt; - &lt;span style=&#34;color:#e06c75&#34;&gt;èŠ‚RAW&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;èŠ‚RVA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªæ–°RAWæˆ‘ä»¬èƒ½åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­ç›´æ¥çœ‹è§ï¼Œå°±æ˜¯é€‰å®šçš„ç©ºç™½ä½ç½®&lt;/p&gt;
&lt;p&gt;ä¹‹åä¿®æ”¹PEå¤´ï¼Œå°†&lt;code&gt;DataDirectory[1]&lt;/code&gt;ï¼ˆå¯¼å…¥è¡¨ç›®å½•ï¼‰çš„&lt;code&gt;VirtualAddress&lt;/code&gt;å’Œ&lt;code&gt;Size&lt;/code&gt;æ›´æ–°&lt;/p&gt;
&lt;h4 id=&#34;æ„å»ºæ–°çš„intiatå’Œå­—ç¬¦ä¸²&#34;&gt;æ„å»ºæ–°çš„INTã€IATå’Œå­—ç¬¦ä¸²
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;ç»“æ„éœ€è¦æŒ‡å‘INTã€IATå’ŒDLLåç§°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;OriginalFirstThunk&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;//å¯¼å…¥åç§°è¡¨ INT çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TimeDateStamp&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ForwarderChain&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º -1 æˆ– 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;;                    &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL åç§°çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FirstThunk&lt;/span&gt;;              &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å…¥åœ°å€è¡¨ IAT çš„ RVA 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¿…é¡»åœ¨æ–‡ä»¶çš„å¦ä¸€ä¸ªç©ºç™½åŒºåŸŸæ‰‹åŠ¨æ„å»ºè¿™äº›ä¸œè¥¿&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºäº†æ–¹ä¾¿çœ‹ï¼Œå…ˆå‡è®¾æ˜¯åœ¨&lt;code&gt;.text&lt;/code&gt;èŠ‚çš„&lt;code&gt;RAW: 0xAB10&lt;/code&gt;å¤„ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;RAW: 0xAB10&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åˆ›å»ºINTï¼Œå†™å…¥æŒ‡å‘&lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;çš„RVA&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;RAW: 0xAB20&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å†™å…¥å­—ç¬¦ä¸²&lt;code&gt;&amp;quot;MyDll.dll\0&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;RAW: 0xAB30&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åˆ›å»ºIATï¼Œå†…å®¹åœ¨åŠ è½½å‰ä¸INTå®Œå…¨ç›¸åŒï¼Œä¹Ÿå†™å…¥æŒ‡å‘&lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;çš„RVA&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;RAW: 0xAB40&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å†™å…¥&lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;ç»“æ„ï¼ˆHint&lt;code&gt;0x0000&lt;/code&gt;+ å‡½æ•°å&lt;code&gt;&amp;quot;dummy\0&amp;quot;&lt;/code&gt;ï¼‰ã€&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—´éš”0x10å­—èŠ‚çš„åŸå› æ˜¯è¿™æ ·æ–¹ä¾¿è§‚çœ‹ï¼Œå¦‚æœç©ºé—´è¶³å¤Ÿå¯ä»¥éšæ„&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251102174301399&#34; href=&#34;http://picture.928330.xyz/typora/image-20251102174301399.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251102174301399.png&#34; alt=&#34;image-20251102174301399&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251102174314034&#34; href=&#34;http://picture.928330.xyz/typora/image-20251102174314034.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251102174314034.png&#34; alt=&#34;image-20251102174314034&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;è®¡ç®—æ–°æ„å»ºå†…å®¹çš„rva&#34;&gt;è®¡ç®—æ–°æ„å»ºå†…å®¹çš„RVA
&lt;/h4&gt;&lt;p&gt;å¯ä»¥çœ‹è§ï¼Œåœ¨&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;ä¸­çš„ä¸€åˆ‡éƒ½æ˜¯RVAï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»è®¡ç®—æ‰€æœ‰çš„RVA&lt;/p&gt;
&lt;p&gt;åŒæ ·ï¼Œå‡è®¾&lt;code&gt;.text&lt;/code&gt;èŠ‚çš„&lt;code&gt;RAW&lt;/code&gt;æ˜¯&lt;code&gt;0x400&lt;/code&gt;ï¼Œ&lt;code&gt;RVA&lt;/code&gt;æ˜¯&lt;code&gt;0x1000&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;INT RVA = 0xAB10 - 0x400 + 0x1000 = 0xB710&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Name RVA = 0xAB20 - 0x400 + 0x1000 = 0xB720&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IAT RVA = 0xAB30 - 0x400 + 0x1000 = 0xB730&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IMAGE_IMPORT_BY_NAME RVA = 0xAB40 - 0x400 + 0x1000 = 0xB740&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å¡«å……æ–°çš„image_import_descriptor&#34;&gt;å¡«å……æ–°çš„IMAGE_IMPORT_DESCRIPTOR**
&lt;/h4&gt;&lt;p&gt;å›åˆ°æˆ‘ä»¬ç§»åŠ¨çš„å¯¼å…¥è¡¨æœ«å°¾ï¼Œå¡«å…¥æˆ‘ä»¬æ–°çš„&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OriginalFirstThunk (INT)&lt;/code&gt;ï¼š&lt;code&gt;0xB710&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TimeDateStamp&lt;/code&gt;ï¼š&lt;code&gt;0xFFFFFFFF&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ForwarderChain&lt;/code&gt;ï¼š&lt;code&gt;0xFFFFFFFF&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Name&lt;/code&gt;ï¼š&lt;code&gt;0xB720&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FirstThunk (IAT)&lt;/code&gt;ï¼š&lt;code&gt;0xB730&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ä¿®æ”¹èŠ‚åŒºå±æ€§&#34;&gt;ä¿®æ”¹èŠ‚åŒºå±æ€§
&lt;/h4&gt;&lt;p&gt;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬çš„IATè¢«æ”¾åœ¨äº†&lt;code&gt;.text&lt;/code&gt;èŠ‚åŒºï¼Œè€Œ&lt;code&gt;.text&lt;/code&gt;èŠ‚åŒºé»˜è®¤å±æ€§æ˜¯å¯æ‰§è¡Œã€å¯è¯»ï¼Œä½†ä¸å¯å†™&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒPEåŠ è½½å™¨åœ¨è¿è¡Œæ—¶éœ€è¦å‘IATä¸­å†™å…¥å‡½æ•°çš„çœŸå®åœ°å€ï¼Œæ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬å¿…é¡»ä¿®æ”¹&lt;code&gt;.text&lt;/code&gt;èŠ‚å¤´çš„&lt;code&gt;Characteristics&lt;/code&gt;å­—æ®µï¼Œä¸ºå…¶æ·»åŠ &lt;code&gt;IMAGE_SCN_MEM_WRITE&lt;/code&gt;ï¼ˆ&lt;code&gt;0x80000000&lt;/code&gt;ï¼‰å±æ€§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x60000020&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x80000000&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0xE0000020&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;å›é¡¾ä¸€ä¸‹èŠ‚åŒºå¤´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#define IMAGE_SIZEOF_SHORT_NAME 8
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_SECTION_HEADER&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BYTE&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_SIZEOF_SHORT_NAME&lt;/span&gt;]; &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åç§°ï¼Œä¾‹å¦‚ &amp;#34;.text&amp;#34; &amp;#34;.data&amp;#34; &amp;#34;.rdata&amp;#34; &amp;#34;.rsrc&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PhysicalAddress&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualSize&lt;/span&gt;;               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åŒºåœ¨å†…å­˜ä¸­çš„å¤§å°ï¼ˆRVAå¯¹åº”ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    } &lt;span style=&#34;color:#e06c75&#34;&gt;Misc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualAddress&lt;/span&gt;;                     &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨å†…å­˜ä¸­çš„ RVAï¼ˆç›¸å¯¹äº ImageBaseï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfRawData&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨æ–‡ä»¶ä¸­çš„å¤§å°ï¼ˆç£ç›˜å¯¹é½åçš„å­—èŠ‚æ•°ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToRawData&lt;/span&gt;;               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨æ–‡ä»¶ä¸­çš„èµ·å§‹åç§»
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToRelocations&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// é‡å®šä½è¡¨æŒ‡é’ˆï¼ˆå¦‚æœæœ‰é‡å®šä½ä¿¡æ¯ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToLinenumbers&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// è¡Œå·ä¿¡æ¯æŒ‡é’ˆï¼ˆè°ƒè¯•ç”¨ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfRelocations&lt;/span&gt;;             &lt;span style=&#34;color:#7f848e&#34;&gt;// é‡å®šä½è¡¨æ¡ç›®æ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfLinenumbers&lt;/span&gt;;            &lt;span style=&#34;color:#7f848e&#34;&gt;// è¡Œå·æ¡ç›®æ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;;                               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚ç‰¹æ€§æ ‡å¿—ï¼ˆå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œç­‰ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_SECTION_HEADER&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_SECTION_HEADER&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­&lt;code&gt;Characteristics&lt;/code&gt;å­—æ®µå†³å®šäº†èŠ‚çš„ç‰¹æ€§ï¼Œå®ƒçš„æœºåˆ¶ç±»ä¼¼linuxçš„rwxï¼Œæ¯ä¸€ä¸ªå±æ€§å¯¹åº”ä¸€ä¸ªå€¼ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä½æ ‡å¿—&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0x00000020&lt;/td&gt;
          &lt;td&gt;èŠ‚é‡Œæœ‰ä»£ç &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;0x20000000&lt;/td&gt;
          &lt;td&gt;æ˜ å°„åå¯æ‰§è¡Œï¼ˆEï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;0x40000000&lt;/td&gt;
          &lt;td&gt;æ˜ å°„åå¯è¯»ï¼ˆRï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;0x80000000&lt;/td&gt;
          &lt;td&gt;æ˜ å°„åå¯å†™ï¼ˆWï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å½“ Windows åŠ è½½å™¨è¯»å– PE æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šéå†èŠ‚è¡¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çœ‹åˆ°èŠ‚çš„&lt;code&gt;Characteristics&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æŒ‰æ ‡å¿—ç¡®å®šåº”è¯¥ä¸ºè¿™å—åŒºåŸŸç”³è¯·æ€æ ·çš„å†…å­˜é¡µ&lt;/li&gt;
&lt;li&gt;è°ƒç”¨å†…æ ¸ API&lt;/li&gt;
&lt;li&gt;æŠŠèŠ‚çš„æ•°æ®æ˜ å°„è¿›å»ï¼Œå¹¶æŠŠé¡µä¿æŠ¤è®¾ç½®ä¸ºå¯¹åº”çš„Windowså†…å­˜ä¿æŠ¤ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;PEå±æ€§ç»„åˆ&lt;/th&gt;
          &lt;th&gt;æ˜ å°„åçš„é¡µä¿æŠ¤&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;R&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PAGE_READONLY&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R + W&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PAGE_READWRITE&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;E + R&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PAGE_EXECUTE_READ&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;E + R + W&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PAGE_EXECUTE_READWRITE&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;é»˜è®¤&lt;code&gt;.text&lt;/code&gt;çš„å±æ€§ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x60000020&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x20000000&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;EXECUTE&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x40000000&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;READ&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x00000020&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;CODE&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯E+Rï¼ŒåŠ è½½å™¨æ˜ å°„æ—¶ä¼šåˆ†é…ä¸º&lt;code&gt;PAGE_EXECUTE_READ&lt;/code&gt;ï¼Œå› æ­¤&lt;code&gt;.text&lt;/code&gt;åœ¨å†…å­˜ä¸­å¯æ‰§è¡Œã€å¯è¯»ï¼Œä½†ä¸å¯å†™&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä»–å¯å†™ï¼Œå°±è¦åŠ ä¸ŠWå±æ€§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x60000020&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x80000000&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0xE0000020&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼Œè¦æŠŠ&lt;code&gt;.text&lt;/code&gt;èŠ‚çš„&lt;code&gt;Characteristics&lt;/code&gt;å­—æ®µæ”¹æˆ&lt;code&gt;0xE0000020&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h4 id=&#34;æ¸…é™¤ç»‘å®šå¯¼å…¥è¡¨&#34;&gt;æ¸…é™¤ç»‘å®šå¯¼å…¥è¡¨
&lt;/h4&gt;&lt;p&gt;PEæ–‡ä»¶ä¸­çš„&lt;code&gt;DataDirectory[12]&lt;/code&gt;ï¼ˆç»‘å®šå¯¼å…¥è¡¨ï¼‰ç”¨äºåŠ é€ŸDLLåŠ è½½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰æ²¡æœ‰æåˆ°&lt;/p&gt;
&lt;p&gt;å®ƒçš„å­˜åœ¨å¯èƒ½ä¼šå¹²æ‰°æˆ‘ä»¬ä¿®æ”¹è¿‡çš„å¯¼å…¥è¡¨ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥å°†å…¶RVAå’ŒSizeéƒ½æ¸…é›¶ï¼Œç¦ç”¨è¯¥åŠŸèƒ½&lt;/p&gt;
&lt;h4 id=&#34;å¼€å§‹æ³¨å…¥&#34;&gt;å¼€å§‹æ³¨å…¥
&lt;/h4&gt;&lt;p&gt;å®Œæˆåï¼Œå°†&lt;code&gt;MyDll.dll&lt;/code&gt;æ”¾åœ¨ä¿®æ”¹åçš„&lt;code&gt;notepad_patch.exe&lt;/code&gt;åŒç›®å½•ä¸‹ï¼Œè¿è¡Œ&lt;code&gt;notepad_patch.exe&lt;/code&gt;ï¼Œæ³¨å…¥å°±ä¼šè‡ªåŠ¨å‘ç”Ÿ&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç æ³¨å…¥&#34;&gt;ä»£ç æ³¨å…¥
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯DLLæ³¨å…¥çš„å˜ä½“ï¼Œæˆ‘ä»¬ä¸æ³¨å…¥ä¸€ä¸ªå®Œæ•´çš„DLLæ–‡ä»¶ï¼Œè€Œæ˜¯åªæ³¨å…¥ä¸€å°æ®µç‹¬ç«‹çš„æœºå™¨ç &lt;/p&gt;
&lt;h3 id=&#34;åŸç†-4&#34;&gt;åŸç†
&lt;/h3&gt;&lt;p&gt;ä»£ç æ³¨å…¥ä¹Ÿå¸¸è¢«ç§°ä¸ºçº¿ç¨‹æ³¨å…¥ï¼Œæˆ‘ä»¬ä¸åœ¨&lt;code&gt;CreateRemoteThread&lt;/code&gt;ä¸­è°ƒç”¨&lt;code&gt;LoadLibrary&lt;/code&gt;ï¼Œè€Œæ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ç›®æ ‡è¿›ç¨‹ä¸­åˆ†é…ä¸¤å—å†…å­˜ã€‚ä¸€å—ç”¨äº&lt;strong&gt;ä»£ç &lt;/strong&gt;ï¼ˆå±æ€§&lt;code&gt;PAGE_EXECUTE_READWRITE&lt;/code&gt;ï¼‰ï¼Œå¦ä¸€å—ç”¨äº&lt;strong&gt;æ•°æ®/å‚æ•°&lt;/strong&gt;ï¼ˆå±æ€§&lt;code&gt;PAGE_READWRITE&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;å°†æˆ‘ä»¬çš„æœºå™¨ç ï¼ˆä¸€ä¸ªå‡½æ•°çš„å®Œæ•´ä½“ï¼‰å†™å…¥ä»£ç å†…å­˜&lt;/li&gt;
&lt;li&gt;å°†ä»£ç æ‰€éœ€çš„æ•°æ®ï¼ˆä¾‹å¦‚è¦è°ƒç”¨çš„APIåœ°å€ã€å­—ç¬¦ä¸²ç­‰ï¼‰æ‰“åŒ…æˆä¸€ä¸ªç»“æ„ä½“ï¼Œå†™å…¥æ•°æ®å†…å­˜&lt;/li&gt;
&lt;li&gt;è°ƒç”¨&lt;code&gt;CreateRemoteThread&lt;/code&gt;ï¼Œå°†&lt;code&gt;lpStartAddress&lt;/code&gt;æŒ‡å‘ä»£ç å†…å­˜çš„åœ°å€ï¼Œ&lt;code&gt;lpParameter&lt;/code&gt;æŒ‡å‘æ•°æ®å†…å­˜çš„åœ°å€&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ç¤ºä¾‹-4&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•æ³¨å…¥ä¸€æ®µä»£ç ï¼Œè®©&lt;code&gt;notepad.exe&lt;/code&gt;å¼¹å‡ºä¸€ä¸ª&lt;code&gt;MessageBoxA&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç¬¬1æ­¥å®šä¹‰å…±äº«ç»“æ„ä½“&#34;&gt;ç¬¬1æ­¥ï¼šå®šä¹‰å…±äº«ç»“æ„ä½“
&lt;/h4&gt;&lt;p&gt;è¢«æ³¨å…¥çš„ä»£ç æ— æ³•è®¿é—®æ³¨å…¥å™¨çš„å†…å­˜ã€‚æˆ‘ä»¬å¿…é¡»å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ï¼Œå°†æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯ï¼ˆAPIåœ°å€ã€å­—ç¬¦ä¸²ï¼‰æ‰“åŒ…ä¼ è¿‡å»&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_THREAD_PARAM&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æˆ‘ä»¬éœ€è¦ç›®æ ‡è¿›ç¨‹è°ƒç”¨ LoadLibraryA å’Œ GetProcAddress
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æ‰€ä»¥æˆ‘ä»¬æå‰æŸ¥å¥½è¿™ä¸¤ä¸ªAPIçš„åœ°å€ä¼ è¿›å»
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pLoadLibrary&lt;/span&gt;;      
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pGetProcAddress&lt;/span&gt;;   
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼ˆå­—ç¬¦ä¸²ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;moduleName&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;128&lt;/span&gt;];     &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;#34;user32.dll&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;procName&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;128&lt;/span&gt;];       &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;#34;MessageBoxA&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;THREAD_PARAM&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PTHREAD_PARAM&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;ç¬¬2æ­¥è¢«æ³¨å…¥çš„å‡½æ•°-payload&#34;&gt;ç¬¬2æ­¥ï¼šè¢«æ³¨å…¥çš„å‡½æ•° (Payload)
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;ThreadProc&lt;/code&gt;å°±æ˜¯å³å°†è¢«å®Œæ•´å¤åˆ¶åˆ°ç›®æ ‡è¿›ç¨‹çš„å‡½æ•°ï¼Œå®ƒè¢«è®¾è®¡ä¸ºå®Œå…¨ç‹¬ç«‹ï¼Œåªä¾èµ–ä¼ å…¥çš„&lt;code&gt;THREAD_PARAM&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œä»¥ä¾¿åœ¨ä»£ç ä¸­è°ƒç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;HMODULE&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFLOADLIBRARYA&lt;/span&gt;)(&lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FARPROC&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFGETPROCADDRESS&lt;/span&gt;)(&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;int&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PFMESSAGEBOXA&lt;/span&gt;)(&lt;span style=&#34;color:#e06c75&#34;&gt;HWND&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPCSTR&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;UINT&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// è¿™å°±æ˜¯æˆ‘ä»¬çš„â€œæœ‰æ•ˆè½½è·â€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// å®ƒå°†åœ¨ç›®æ ‡è¿›ç¨‹çš„å†…å­˜ä¸­æ‰§è¡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;ThreadProc&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PTHREAD_PARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;PTHREAD_PARAM&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;lParam&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. ä½¿ç”¨ä¼ å…¥çš„ pLoadLibrary åœ°å€ï¼ŒåŠ è½½ &amp;#34;user32.dll&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; ((&lt;span style=&#34;color:#e06c75&#34;&gt;PFLOADLIBRARYA&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pLoadLibrary&lt;/span&gt;)(&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;moduleName&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. ä½¿ç”¨ä¼ å…¥çš„ pGetProcAddress åœ°å€ï¼Œè·å– &amp;#34;MessageBoxA&amp;#34; åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; ((&lt;span style=&#34;color:#e06c75&#34;&gt;PFGETPROCADDRESS&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pGetProcAddress&lt;/span&gt;)(&lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;procName&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. è°ƒç”¨ MessageBoxA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    ((&lt;span style=&#34;color:#e06c75&#34;&gt;PFMESSAGEBOXA&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;pFunc&lt;/span&gt;)(&lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;moduleName&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;procName&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;MB_OK&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;ç¬¬3æ­¥æ³¨å…¥å™¨-injectcode&#34;&gt;ç¬¬3æ­¥ï¼šæ³¨å…¥å™¨ (InjectCode)
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;InjectCode&lt;/code&gt;å‡½æ•°è´Ÿè´£å¡«å……&lt;code&gt;THREAD_PARAM&lt;/code&gt;ï¼Œåˆ†é…ä¸¤å—è¿œç¨‹å†…å­˜ï¼Œå†™å…¥æ•°æ®å’Œä»£ç ï¼Œæœ€åå¯åŠ¨è¿œç¨‹çº¿ç¨‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;InjectCode&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;}; &lt;span style=&#34;color:#7f848e&#34;&gt;// pRemoteBuf[0] = å‚æ•°, pRemoteBuf[1] = ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;THREAD_PARAM&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. å¡«å……å‚æ•°ç»“æ„ä½“ (åœ¨æ³¨å…¥å™¨è¿›ç¨‹ä¸­)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;pLoadLibrary&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;LoadLibraryA&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;pGetProcAddress&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hMod&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;GetProcAddress&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;strcpy_s&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;moduleName&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;user32.dll&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;strcpy_s&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;procName&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;MessageBoxA&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ... (OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID) è·å– hProcess) ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. æ³¨å…¥å‚æ•° (pRemoteBuf[0])
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;THREAD_PARAM&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;VirtualAllocEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;MEM_COMMIT&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;PAGE_READWRITE&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;]) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WriteProcessMemory&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;], (&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;)&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;param&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. æ³¨å…¥ä»£ç  (pRemoteBuf[1])
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;//    (InjectCode å’Œ ThreadProc å¿…é¡»åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œ)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;InjectCode&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;ThreadProc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¡®ä¿å¤§å°æ­£ç¡®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;VirtualAllocEx&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;MEM_COMMIT&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;PAGE_EXECUTE_READWRITE&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;]) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WriteProcessMemory&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;], (&lt;span style=&#34;color:#e06c75&#34;&gt;LPVOID&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;ThreadProc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. åˆ›å»ºè¿œç¨‹çº¿ç¨‹ï¼Œæ‰§è¡Œä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        (&lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#7f848e&#34;&gt;// lpStartAddress = ä»£ç åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;pRemoteBuf&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;],                         &lt;span style=&#34;color:#7f848e&#34;&gt;// lpParameter = å‚æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// ... (æ¸…ç†å¥æŸ„) ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨&lt;code&gt;InjectCode&lt;/code&gt;ç¤ºä¾‹ä¸­ï¼Œä»£ç å¤§å°æ˜¯è¿™æ ·è®¡ç®—çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;dwSize&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;InjectCode&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;)&lt;span style=&#34;color:#e06c75&#34;&gt;ThreadProc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å½“ä½¿ç”¨Visual C++çš„Releaseæ¨¡å¼ç¼–è¯‘æ—¶ï¼Œæºä»£ç ä¸­ç›¸é‚»çš„å‡½æ•°åœ¨æœ€ç»ˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ä¹Ÿç‰©ç†ç›¸é‚»åœ°å­˜æ”¾ï¼Œå› æ­¤ï¼Œ&lt;code&gt;ThreadProc&lt;/code&gt;å‡½æ•°çš„äºŒè¿›åˆ¶ç ä¹‹åç´§è·Ÿç€&lt;code&gt;InjectCode&lt;/code&gt;å‡½æ•°çš„äºŒè¿›åˆ¶ç &lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°èµ·å§‹åœ°å€ç›¸å‡ï¼Œå°±è¿‘ä¼¼å¾—åˆ°äº†&lt;code&gt;ThreadProc&lt;/code&gt;å‡½æ•°çš„äºŒè¿›åˆ¶ç é•¿åº¦&lt;/p&gt;
&lt;h1 id=&#34;dllçš„å¸è½½-dll-eject&#34;&gt;DLLçš„å¸è½½ (Dll Eject)
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;æ³¨å…¥çš„é€†è¿‡ç¨‹å°±æ˜¯å¸è½½ï¼ˆEjectï¼‰ï¼Œå…¶åŸç†æ˜¯å¼ºåˆ¶ç›®æ ‡è¿›ç¨‹è°ƒç”¨&lt;code&gt;FreeLibrary()&lt;/code&gt;API&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;FreeLibrary&lt;/code&gt;çš„å‡½æ•°åŸå‹æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;WINAPI&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FreeLibrary&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hLibModule&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒåªæ¥å—ä¸€ä¸ªå‚æ•°ï¼šè¦å¸è½½çš„DLLåœ¨ç›®æ ‡è¿›ç¨‹ä¸­çš„æ¨¡å—å¥æŸ„ï¼Œä¹Ÿå°±æ˜¯åŸºåœ°å€&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹-5&#34;&gt;ç¤ºä¾‹
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tchar.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;tlhelp32.h&amp;gt; // ç”¨äºCreateToolhelp32Snapshot&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// (è¿™é‡Œéœ€è¦ä¸€ä¸ªFindProcessIDå‡½æ•°ï¼ŒPDFä¸­çœç•¥äº†ï¼Œæˆ‘ä»¬å‡è®¾å®ƒå·²å®ç°)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FindProcessID&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;LPCTSTR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szProcessName&lt;/span&gt;); 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;EjectDll&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;LPCTSTR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;szDllName&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HANDLE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MODULEENTRY32&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#c678dd&#34;&gt;sizeof&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;)}; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¿…é¡»åˆå§‹åŒ–dwSize
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 1. åˆ›å»ºå·¥å…·å¿«ç…§ï¼Œè·å–æŒ‡å®šPIDè¿›ç¨‹åŠ è½½çš„æ‰€æœ‰æ¨¡å—ï¼ˆDLLï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateToolhelp32Snapshot&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;TH32CS_SNAPMODULE&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;INVALID_HANDLE_VALUE&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 2. éå†æ¨¡å—åˆ—è¡¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bFound&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BOOL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bMore&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;Module32First&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;for&lt;/span&gt; (; &lt;span style=&#34;color:#e06c75&#34;&gt;bMore&lt;/span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;bMore&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;Module32Next&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¯”è¾ƒæ¨¡å—åæˆ–è·¯å¾„ï¼Œæ‰¾åˆ°æˆ‘ä»¬è¦å¸è½½çš„DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;lstrcmpi&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;szModule&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;szDllName&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;||&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;lstrcmpi&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;szExePath&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;szDllName&lt;/span&gt;)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;bFound&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ‰¾åˆ°äº†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hSnapshot&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// å…³é—­å¿«ç…§å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;bFound&lt;/span&gt;) &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ²¡æ‰¾åˆ°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 3. è·å–ç›®æ ‡è¿›ç¨‹å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;OpenProcess&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;PROCESS_ALL_ACCESS&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;)))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 4. è·å– FreeLibrary çš„åœ°å€ï¼ˆå®ƒä¹Ÿåœ¨ kernel32.dll ä¸­ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hModule&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandle&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;pThreadProc&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;)&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hModule&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;FreeLibrary&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// 5. åˆ›å»ºè¿œç¨‹çº¿ç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‡½æ•° = FreeLibrary
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// çº¿ç¨‹å‚æ•° = è¦å¸è½½çš„DLLçš„åŸºåœ°å€ (me.modBaseAddr)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CreateRemoteThread&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;pThreadProc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;me&lt;/span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;modBaseAddr&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FALSE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;WaitForSingleObject&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;INFINITE&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hThread&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;CloseHandle&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hProcess&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TRUE&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_tmain&lt;/span&gt;(&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argc&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;TCHAR&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[]) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FindProcessID&lt;/span&gt;(&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;notepad.exe&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;EjectDll&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;dwPID&lt;/span&gt;, &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;_T&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;MyDll.dll&amp;#34;&lt;/span&gt;));
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        </item>
        <item>
        <title>é€†å‘åŸºç¡€5ï¼šæ··æ·†æŠ€æœ¯</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%805%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/</link>
        <pubDate>Sun, 26 Oct 2025 19:56:22 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%805%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/1942e99d5e2b2ffc67184eba1cfe48ea.jpg" alt="Featured image of post é€†å‘åŸºç¡€5ï¼šæ··æ·†æŠ€æœ¯" /&gt;&lt;p&gt;ç»è¿‡å‰å‡ èŠ‚è¯¾ï¼Œè·Ÿç€ç ´è§£äº†å‡ ä¸ªcrackï¼Œæˆ‘ä¹Ÿè§‰å¾—æˆ‘æˆé€†å‘å¤§ç¥äº†&amp;hellip;&amp;hellip;å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç ´è§£è½¯ä»¶å“ªæœ‰é‚£ä¹ˆå®¹æ˜“ï¼Œå°¤å…¶æ˜¯å•†ç”¨çš„ï¼Œæ›´ä¸å¯èƒ½å°†è‡ªå·±çš„ä»£ç å°±è¿™æ ·æš´éœ²åœ¨å¤§ä¼—é¢å‰ï¼Œè‚¯å®šä¼šæƒ³æ–¹è®¾æ³•æé«˜é€†å‘å·¥ç¨‹çš„éš¾åº¦ï¼&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æˆ‘ä»¬æåˆ°è¿‡ï¼Œåˆ æ‰ELFçš„èŠ‚è¡¨å°±èƒ½å¾ˆå¥½çš„åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æ˜¯é‚£æ¯•ç«Ÿåªåœ¨linuxä¸Šï¼Œæœ‰æ²¡æœ‰æ›´æ™®éçš„åšæ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« è¦è¯´çš„æŠ€æœ¯ â€”â€” &lt;strong&gt;ä»£ç æ··æ·†ï¼ˆObfuscationï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ‰€è°“çŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ä¸æ®†ï¼Œåªæœ‰çŸ¥é“æ··æ·†æ˜¯ä»€ä¹ˆåï¼Œæ‰çŸ¥é“å¦‚ä½•å»å¯¹æŠ—å’Œç ´è§£å®ƒ&lt;/p&gt;
&lt;h1 id=&#34;æ··æ·†çš„åŸºæœ¬åŸç†&#34;&gt;æ··æ·†çš„åŸºæœ¬åŸç†
&lt;/h1&gt;&lt;h2 id=&#34;æ··æ·†æ˜¯ä»€ä¹ˆ&#34;&gt;æ··æ·†æ˜¯ä»€ä¹ˆï¼Ÿ
&lt;/h2&gt;&lt;p&gt;æ··æ·†æ˜¯ä¸€ç§ç¨‹åºå˜æ¢æŠ€æœ¯ï¼Œå…¶ç›®çš„æ˜¯é€šè¿‡é‡æ„ä»£ç ï¼Œåœ¨ä¿æŒç¨‹åºåŸæœ‰åŠŸèƒ½ï¼ˆè¯­ä¹‰ï¼‰ç­‰ä»·çš„å‰æä¸‹ï¼Œå¢åŠ ä»£ç çš„å¤æ‚æ€§ï¼Œä½¿å…¶æ›´éš¾ä»¥è¢«é€†å‘åˆ†æå’Œç†è§£&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªè½¬æ¢ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251026203141655&#34; href=&#34;http://picture.928330.xyz/typora/image-20251026203141655.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251026203141655.png&#34; alt=&#34;image-20251026203141655&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ··æ·†å¯ä»¥åœ¨å¤šä¸ªä¸åŒå±‚æ¬¡ä¸Šè¿›è¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æºä»£ç çº§&lt;/strong&gt;ï¼šå¯¹é«˜çº§è¯­è¨€ä»£ç ï¼ˆå¦‚Cã€Javaï¼‰è¿›è¡Œå˜é‡é‡å‘½åã€é€»è¾‘å˜æ¢ç­‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸­é—´ä»£ç /å­—èŠ‚ç çº§&lt;/strong&gt;ï¼šé’ˆå¯¹.NETæˆ–Javaçš„å­—èŠ‚ç è¿›è¡Œæ··æ·†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ±‡ç¼–/äºŒè¿›åˆ¶çº§&lt;/strong&gt;ï¼šç›´æ¥å¯¹ç¼–è¯‘åçš„æœºå™¨ç æˆ–æ±‡ç¼–ä»£ç è¿›è¡Œä¿®æ”¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰äº›ä¸ç†è§£ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„æ±‡ç¼–æ··æ·†ç‰‡æ®µï¼ˆä¸ºäº†æ–¹ä¾¿è§‚çœ‹ï¼Œå‰é¢å°±åŠ ä¸Šè¡Œå·äº†ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;01&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;02&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;03&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;04&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;INC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;05&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NEG&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;06&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;A6098326H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;07&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;08&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;59F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CD5H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;09&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0FF&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FFFFFFH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;11&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;RCL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;CL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;12&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;13&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;14&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SBB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;15&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSHFD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;17&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSHAD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;18&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;19&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TEST&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;21&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å“‡ï¼ŒçœŸæ˜¯å†™äº†å¥½å¤šå•Šï¼Œé‚£è¿™ä¹ˆé•¿çš„ä»£ç ï¼Œå®ç°äº†ä»€ä¹ˆå¼ºå¤§çš„åŠŸèƒ½å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯„å­˜å™¨äº¤æ¢ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; åˆå§‹çŠ¶æ€&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;M&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;01&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;         ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;M&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;02&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;         ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;M&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;M&lt;/span&gt; (å³ &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; çš„åˆå§‹å€¼)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;03&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;         ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;M&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;M&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;N&lt;/span&gt; (å³ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; çš„åˆå§‹å€¼)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªä¸ä½¿ç”¨ç¬¬ä¸‰ä¸ªå¯„å­˜å™¨æ¥äº¤æ¢&lt;code&gt;EAX&lt;/code&gt;å’Œ&lt;code&gt;EBX&lt;/code&gt;å†…å®¹çš„æŠ€å·§ï¼Œçœ‹ç€è™½ç„¶æœ‰äº›å¤æ‚ï¼Œä½†ä¹Ÿè¿˜åˆç†&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åƒåœ¾æŒ‡ä»¤ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;04&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;INC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;              ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;05&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NEG&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;              ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;N&lt;/span&gt; (å¯¹&lt;span style=&#34;color:#e06c75&#34;&gt;Nå–è¡¥&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;06&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;A6098326H&lt;/span&gt;  ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;N&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;A6098326H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;07&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;         ; æ¯”è¾ƒ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; å’Œ &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å—¯ï¼Ÿæœ‰äº›ä¸å¯¹åŠ²äº†&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;04&lt;/code&gt;ä¿®æ”¹äº†&lt;code&gt;EAX&lt;/code&gt; â€”â€” ä½†æ˜¯&lt;code&gt;EAX&lt;/code&gt;çš„å€¼åœ¨åé¢çš„ç¬¬&lt;code&gt;08&lt;/code&gt;è¡Œè¢«å®Œå…¨è¦†ç›–äº†ï¼Œæ‰€ä»¥è¿™æ¬¡&lt;code&gt;INC&lt;/code&gt;æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼å®ƒå®Œå…¨å¯ä»¥ä¸å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¡åƒåœ¾æŒ‡ä»¤ï¼&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;05&lt;/code&gt;å’Œ&lt;code&gt;06&lt;/code&gt;æ˜¯å¯¹&lt;code&gt;EBX&lt;/code&gt;çš„å€¼&lt;code&gt;N&lt;/code&gt;çš„å–è¡¥è®¡ç®—&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;07&lt;/code&gt;çš„&lt;code&gt;CMP&lt;/code&gt;ä¼šè®¾ç½®&lt;code&gt;EFLAGS&lt;/code&gt;æ ‡å¿—å¯„å­˜å™¨ï¼Œä½†è¿™äº›æ ‡å¿—ä½åœ¨è¢«ä»»ä½•æ¡ä»¶è·³è½¬æŒ‡ä»¤ä½¿ç”¨ä¹‹å‰ï¼Œå°±è¢«ç¬¬&lt;code&gt;09&lt;/code&gt;è¡Œçš„ &lt;code&gt;XOR&lt;/code&gt;æŒ‡ä»¤ç»™è¦†ç›–äº†ï¼ˆå®ƒä¹Ÿä¼šä¿®æ”¹æ ‡å¿—ä½ï¼‰ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸€æ¡åƒåœ¾æŒ‡ä»¤ï¼&lt;/p&gt;
&lt;p&gt;å¥½å§å¥½å§ï¼Œåæ­£è¿™éƒ¨åˆ†ç»“æŸä¹‹åï¼Œ&lt;code&gt;EBX&lt;/code&gt;çš„å€¼å˜æˆäº†&lt;code&gt;-N + 0A6098326H&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¸¸é‡å±•å¼€ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;08&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;59F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CD5H&lt;/span&gt;   ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;59F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CD5H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;09&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0FF&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FFFFFFH&lt;/span&gt;   ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NOT&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;59F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;67&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CD5H&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;A609832AH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;          ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡Œ&lt;code&gt;08&lt;/code&gt;å’Œ&lt;code&gt;09&lt;/code&gt;æ²¡æœ‰ç›´æ¥ä½¿ç”¨&lt;code&gt;MOV EAX, 0A609832AH&lt;/code&gt;ä¿®æ”¹EAXï¼Œè€Œæ˜¯é€šè¿‡ä¸¤æ­¥è®¡ç®—ï¼ˆ&lt;code&gt;XOR 0xFFFFFFFF&lt;/code&gt;ç­‰åŒäº&lt;code&gt;NOT&lt;/code&gt;ï¼Œå³æŒ‰ä½å–åï¼‰æ¥å¾—åˆ°è¿™ä¸ªå€¼ï¼Œå¢åŠ äº†åˆ†æéš¾åº¦ï¼Œè¿™ç§æ–¹æ³•å«åšå¸¸é‡å±•å¼€&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;10&lt;/code&gt;ç”¨&lt;code&gt;EBX&lt;/code&gt;å‡å»&lt;code&gt;EAX&lt;/code&gt;ï¼š&lt;code&gt;EBX = (-N + 0A6098326H) - 0A609832AH = -N - 4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„ä¸­é—´ç»“æœ, &lt;code&gt;EBX&lt;/code&gt;çš„å€¼å˜æˆäº†&lt;code&gt;-N - 4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸºäºæ ˆçš„æ··æ·†ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;11&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;RCL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;CL&lt;/span&gt;          ; [åƒåœ¾æŒ‡ä»¤]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;12&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt;      ; å‹å…¥ä¸€ä¸ªå¸¸é‡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;13&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt; ; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;14&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SBB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;          ; [åƒåœ¾æŒ‡ä»¤]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;15&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; ; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡Œ&lt;code&gt;11&lt;/code&gt;å’Œ&lt;code&gt;14&lt;/code&gt;éƒ½æ˜¯åƒåœ¾æŒ‡ä»¤ï¼Œå› ä¸º&lt;code&gt;EAX&lt;/code&gt;çš„å€¼åœ¨ç¬¬&lt;code&gt;18&lt;/code&gt;è¡Œè¢«&lt;code&gt;POP&lt;/code&gt;è¦†ç›–äº†&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;12&lt;/code&gt;å’Œ&lt;code&gt;13&lt;/code&gt;å†æ¬¡ä½¿ç”¨äº†å¸¸é‡å±•ï¼Œå®ƒä»¬çš„ç›®çš„ä»…ä»…æ˜¯&lt;code&gt;PUSH 0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;15&lt;/code&gt;ä»æ ˆé¡¶çš„å€¼ä¸­å‡å»&lt;code&gt;EBX&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ï¼š&lt;code&gt;[ESP] = 0 - (-N - 4) = N + 4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œ&lt;code&gt;N + 4&lt;/code&gt;è¿™ä¸ªå€¼åœ¨æ ˆé¡¶ï¼Œæ²¡æœ‰åœ¨ä»£ç è¡¨é¢&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤æ‚çš„ç©ºæ“ä½œï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSHFD&lt;/span&gt;                ; å‹å…¥ &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;EFLAGS&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; å­—èŠ‚)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;17&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PUSHAD&lt;/span&gt;                ; å‹å…¥æ‰€æœ‰é€šç”¨å¯„å­˜å™¨ (&lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt; å­—èŠ‚)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;18&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;               ; å¼¹å‡º &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; å­—èŠ‚ (&lt;span style=&#34;color:#e06c75&#34;&gt;PUSHAD&lt;/span&gt; å‹å…¥çš„ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;19&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt;          ; å¼¹å‡º &lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt; å­—èŠ‚ (&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TEST&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;         ; [åƒåœ¾æŒ‡ä»¤]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¡Œ&lt;code&gt;16&lt;/code&gt;å’Œ&lt;code&gt;17&lt;/code&gt;ä¸€å…±å‘æ ˆä¸Šå‹å…¥äº†&lt;code&gt;4 + 32 = 36&lt;/code&gt;å­—èŠ‚çš„æ•°æ®ï¼Œè¡Œ&lt;code&gt;18&lt;/code&gt;å’Œ&lt;code&gt;19&lt;/code&gt;ä¸€å…±ä»æ ˆä¸Šå¼¹å‡ºäº†&lt;code&gt;4 + 32 = 36&lt;/code&gt; å­—èŠ‚çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;è¿™å››æ¡æŒ‡ä»¤ &lt;code&gt;(16, 17, 18, 19)&lt;/code&gt; ç»„åˆèµ·æ¥ï¼Œæ˜¯ä»€ä¹ˆä¹Ÿæ²¡åšï¼åŒæ—¶ï¼Œå®ƒè¿˜æ…ä¹±äº†&lt;code&gt;EAX&lt;/code&gt;å¯„å­˜å™¨ï¼ŒçœŸæ˜¯å¤ªåäº†&lt;/p&gt;
&lt;p&gt;è¡Œ&lt;code&gt;20&lt;/code&gt;ä¹Ÿæ˜¯åƒåœ¾æŒ‡ä»¤ï¼Œå®ƒè®¾ç½®çš„æ ‡å¿—ä½å¹¶æ²¡æœ‰è¢«ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¿™å››è¡Œå®Œå…¨å°±æ˜¯çº¯åºŸè¯&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è·å–æœ€ç»ˆç»“æœï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;21&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;               ; å¼¹å‡ºæ ˆé¡¶çš„å€¼åˆ° &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœæ˜¯&lt;code&gt;EAX = N + 4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸€é•¿ä¸²ä»¤äººçœ¼èŠ±ç¼­ä¹±çš„ä»£ç ï¼Œå…¶ç­‰ä»·è¯­ä¹‰ä»…ä»…æ˜¯ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;çœŸæ˜¯ç¥ä¹å…¶æŠ€ï¼Œå¯¹å§ï¼Ÿ&lt;del&gt;å“å‘¦ï¼Œæ¶å¿ƒæ­»äº†&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¾‹å­é‡Œé¢ä½“ç°äº†å“ªäº›æ··æ·†çš„æ–¹æ³•å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºäºæ¨¡å¼çš„æ··æ·†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æŠŠå¸¸è§çš„é€»è¾‘æ›¿æ¢æˆäº†ç»•äººçš„å†™æ³•ï¼Œæ¯”å¦‚&lt;code&gt;XOR&lt;/code&gt;äº¤æ¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¸¸é‡å±•å¼€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”¨è®¡ç®—ä»£æ›¿å¸¸é‡&lt;code&gt;0&lt;/code&gt;å’Œ&lt;code&gt;0A609832AH&lt;/code&gt;ï¼Œå¿…é¡»ä¸€æ­¥æ­¥åˆ†ææ‰çŸ¥é“æœ€åçš„ç»“æœ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ— å…³ä»£ç æ’å…¥&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¤§é‡çš„åƒåœ¾æŒ‡ä»¤ï¼Œå®Œå…¨æ²¡æœ‰æ„ä¹‰çš„æ“ä½œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸºäºæ ˆçš„æ··æ·†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿ç®—ç»“æœæš‚å­˜åœ¨æ ˆä¸Šï¼Œå…‰çœ‹å¯„å­˜å™¨æˆ–è€…å†…å­˜ä»€ä¹ˆéƒ½çœ‹ä¸å‡ºæ¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ä¸å¸¸ç”¨æŒ‡ä»¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;RCL&lt;/code&gt;ã€&lt;code&gt;SBB&lt;/code&gt;ã€&lt;code&gt;PUSHFD&lt;/code&gt;ã€&lt;code&gt;PUSHAD&lt;/code&gt;ï¼Œè¿™å‡ ä¸ªæŒ‡ä»¤é™¤äº†RCLï¼Œæˆ‘éƒ½æ²¡æœ‰å†™åœ¨é€†å‘åŸºç¡€çš„ç¬¬ä¸€ç« &amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›æ··æ·†æ–¹æ³•åé¢æˆ‘ä»¬ä¸€ä¸ªä¸ªè¯´&lt;/p&gt;
&lt;h2 id=&#34;ç†è®ºä¸Šçš„å®‰å…¨æ€§&#34;&gt;ç†è®ºä¸Šçš„å®‰å…¨æ€§
&lt;/h2&gt;&lt;p&gt;ç†è®ºä¸Šï¼Œä¸€ä¸ªå®Œç¾çš„æ··æ·†å™¨åº”è¯¥å…·æœ‰æ‰€è°“çš„&lt;strong&gt;è™šæ‹Ÿé»‘ç›’&lt;/strong&gt;ï¼ˆVirtual Black-Box, VBBï¼‰å±æ€§&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªæºç¨‹åº$P$è¢«æ··æ·†åå¾—åˆ°çš„ç¨‹åº$P&amp;rsquo;$æ‰€èƒ½æå–åˆ°çš„ä»»ä½•ä¿¡æ¯ï¼Œéƒ½åº”è¯¥åŒæ ·èƒ½é€šè¿‡â€œé»‘ç›’â€è®¿é—®ï¼ˆå³åªè§‚å¯Ÿè¾“å…¥å’Œè¾“å‡ºï¼‰å¾—åˆ°&lt;/p&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œå¯¹äºæ”»å‡»è€…è€Œè¨€ï¼Œæ‹¥æœ‰$P&amp;rsquo;$çš„ä»£ç æ–‡æœ¬å¹¶ä¸æ¯”åªæ‹¥æœ‰$P$çš„æ‰§è¡Œæƒé™èƒ½è·å¾—æ›´å¤šä¿¡æ¯&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå®Œç¾çš„æ··æ·†å™¨åº”æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½æ€§&lt;/strong&gt;ï¼šæ··æ·†åçš„ç¨‹åº$P&amp;rsquo;$ä¸åŸç¨‹åº$P$åŠŸèƒ½å®Œå…¨ç›¸åŒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šé¡¹å¼å‡é€Ÿ&lt;/strong&gt;ï¼š$P&amp;rsquo;$çš„æ‰§è¡Œæ—¶é—´å’Œç©ºé—´å¼€é”€ç›¸æ¯”$P$æœ€å¤šå‘ˆå¤šé¡¹å¼çº§å¢é•¿&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è™šæ‹Ÿé»‘ç›’å±æ€§&lt;/strong&gt;ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œæ‹¥æœ‰$P&amp;rsquo;$ä»£ç çš„æ”»å‡»è€…æ— æ³•æ¯”åªæ‹¥æœ‰$P$çš„è®¿é—®æƒçš„æ”»å‡»è€…æ¨æ–­å‡ºæ›´å¤šä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç°çŠ¶ä¸åº”ç”¨&#34;&gt;ç°çŠ¶ä¸åº”ç”¨
&lt;/h2&gt;&lt;p&gt;ä½†ç†è®ºç»ˆç©¶æ˜¯ç†è®ºè€Œå·²&lt;/p&gt;
&lt;p&gt;2001å¹´å·²æœ‰ç ”ç©¶è¯æ˜ï¼Œèƒ½å¤Ÿæ»¡è¶³ä¸Šè¿°æ‰€æœ‰æ¡ä»¶çš„å®Œç¾æ··æ·†å™¨æ˜¯ä¸å­˜åœ¨çš„ï¼&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæ··æ·†çš„ç›®æ ‡å¹¶éå®ç°ç†è®ºä¸Šçš„ç»å¯¹ä¸å¯åˆ†æï¼Œè€Œæ˜¯ä½¿é€†å‘åˆ†æä»˜å‡ºçš„æˆæœ¬è¦å¤§äºé€šè¿‡é€†å‘å¯èƒ½è·å¾—çš„æ”¶ç›Šï¼Œä¹Ÿå°±æ˜¯åŠªåŠ›è®©ç ´è§£è½¯ä»¶çš„äººæ”¾å¼ƒ&lt;/p&gt;
&lt;p&gt;æ··æ·†æŠ€æœ¯è¢«å¹¿æ³›åº”ç”¨åœ¨ä»¥ä¸‹é¢†åŸŸï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„è½¯ä»¶&lt;/strong&gt;ï¼šç—…æ¯’ã€æœ¨é©¬ç­‰ç”¨äºå¯¹æŠ—å®‰å…¨è½¯ä»¶çš„åˆ†æå’Œæ£€æµ‹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯ä»¶çŸ¥è¯†äº§æƒä¿æŠ¤&lt;/strong&gt;ï¼šä¿æŠ¤å•†ä¸šè½¯ä»¶çš„æ ¸å¿ƒç®—æ³•ä¸è¢«çªƒå–&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è½¯ä»¶é˜²ç¯¡æ”¹&lt;/strong&gt;ï¼šå¢åŠ æ”»å‡»è€…ä¿®æ”¹ç¨‹åºé€»è¾‘ï¼ˆå¦‚ç»•è¿‡ä»˜è´¹éªŒè¯ï¼‰çš„éš¾åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;+++&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹é¢æˆ‘ä»¬æ­£å¼æ¥ä»‹ç»æ··æ·†æ–¹æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ•°æ®æ··æ·†&#34;&gt;æ•°æ®æ··æ·†
&lt;/h1&gt;&lt;p&gt;æ•°æ®æ··æ·†ä¾§é‡äºéšè—ç¨‹åºä¸­ä½¿ç”¨çš„æ•°æ®ï¼Œå¦‚å¸¸é‡ã€å­—ç¬¦ä¸²ã€å˜é‡ç­‰&lt;/p&gt;
&lt;h2 id=&#34;å¸¸é‡å±•å¼€&#34;&gt;å¸¸é‡å±•å¼€
&lt;/h2&gt;&lt;h3 id=&#34;defend&#34;&gt;defend
&lt;/h3&gt;&lt;p&gt;å¸¸é‡å±•å¼€æ˜¯ä¸€ç§ä¸ç¼–è¯‘å™¨ä¼˜åŒ–ç›¸åçš„æŠ€æœ¯ï¼Œå®ƒå°†ä»£ç ä¸­ä¸€ä¸ªæ˜æ–‡å¸¸é‡æ›¿æ¢ä¸ºä¸€ç»„è®¡ç®—è¿‡ç¨‹ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹çš„æœ€ç»ˆç»“æœç­‰äºè¯¥å¸¸é‡&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”»å‡»è€…ä¸èƒ½é€šè¿‡ç®€å•çš„æŸ¥çœ‹æŸä¸€ä¸ªæ˜æ–‡å€¼æ¥å¾—åˆ°æœ€ç»ˆçš„ç»“æœï¼Œå¿…é¡»å¯¹å¤§å—çš„ä»£ç è¿›è¡Œåˆ†æ&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä¾‹å­æˆ‘ä»¬å·²ç»è§è¿‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt;      ; å‹å…¥ä¸€ä¸ªç«‹å³æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt; ; æ ˆé¡¶å€¼å˜ä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°±æ˜¯æŠŠ&lt;code&gt;0&lt;/code&gt;è¿™ä¸ªå€¼éšæ€§åœ°åŠ å…¥äº†é€»è¾‘ä¸­&lt;/p&gt;
&lt;p&gt;æ›´é«˜çº§çš„å¸¸é‡å±•å¼€ä¸ä¼šå°†è®¡ç®—æŒ‡ä»¤ç´§æŒ¨ç€æ”¾åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯å°†å®ƒä»¬äº¤é”™åœ¨å¤§é‡ä¸ç›¸å…³çš„åƒåœ¾æŒ‡ä»¤ä¹‹é—´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; ... (å¤§é‡åƒåœ¾æŒ‡ä»¤)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; ... (æ›´å¤šåƒåœ¾æŒ‡ä»¤)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ†æå™¨å¾ˆéš¾å°†&lt;code&gt;PUSH&lt;/code&gt;å’Œ&lt;code&gt;ADD&lt;/code&gt;ä¸¤æ¡æŒ‡ä»¤å…³è”èµ·æ¥ï¼Œä»è€Œæ— æ³•è½»æ˜“è¯†åˆ«å‡º&lt;code&gt;0&lt;/code&gt;è¿™ä¸ªå¸¸é‡&lt;/p&gt;
&lt;h3 id=&#34;attack&#34;&gt;attack
&lt;/h3&gt;&lt;p&gt;å¦‚ä½•ç ´è§£è¿™ç§æ··æ·†å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„æ–¹æ³•æ˜¯åŠ¨æ€åˆ†æï¼Œåœ¨è°ƒè¯•å™¨ä¸­è¿è¡Œåˆ°è¯¥ä»£ç å—ä¹‹åï¼Œç›´æ¥çœ‹æ ˆé¡¶æˆ–ç›®æ ‡å¯„å­˜å™¨çš„å€¼å°±è¡Œ&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯é™æ€åˆ†æï¼Œå¤§å¤šæ•°å·¥å…·ä¼šå°†å¯„å­˜å™¨å’Œå†…å­˜è§†ä¸ºç¬¦å·å˜é‡ï¼Œè€Œä¸æ˜¯å…·ä½“æ•°å€¼&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œå½“å®ƒä»¬åˆ†æ&lt;code&gt;MOV EAX, 0F9CBE47AH&lt;/code&gt;æ—¶ï¼Œ&lt;code&gt;EAX&lt;/code&gt;çš„å€¼ä¼šè¢«è®°ä¸ºç±»ä¼¼è¿™æ ·çš„å½¢å¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sym_EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹ååˆ°&lt;code&gt;ADD DWORD PTR [ESP], 6341B86H&lt;/code&gt;æ—¶ï¼Œä¼šè‡ªåŠ¨è®¡ç®—å‡ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sym_ESP_val&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0F&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CBE47AH&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6341&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B86H&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯åœ¨é™æ€çš„æ—¶å€™æŠŠå˜é‡å…¨éƒ¨è®¡ç®—å‡ºæ¥&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œé™æ€åˆ†æå·¥å…·è¿˜èƒ½è¿½è¸ªç‰¹å®šå¯„å­˜å™¨æˆ–å†…å­˜ä½ç½®çš„å€¼ï¼Œè¿™å¯ä»¥è·¨è¶Šåƒåœ¾æŒ‡ä»¤ï¼Œæ‰¾å‡ºæ‰€æœ‰ä¿®æ”¹è¯¥å€¼çš„æŒ‡ä»¤ï¼Œå¹¶æœ€ç»ˆè®¡ç®—å‡ºç»“æœ&lt;/p&gt;
&lt;h2 id=&#34;åŸºäºæ¨¡å¼çš„æ··æ·†&#34;&gt;åŸºäºæ¨¡å¼çš„æ··æ·†
&lt;/h2&gt;&lt;h3 id=&#34;defend-1&#34;&gt;defend
&lt;/h3&gt;&lt;p&gt;è¿™ç§æŠ€æœ¯å°†ä¸€æ¡æˆ–å¤šæ¡æŒ‡ä»¤ï¼Œæ›¿æ¢ä¸ºå¦ä¸€ç»„åŠŸèƒ½ä¸Šç­‰ä»·ã€ä½†å½¢å¼ä¸Šæ›´å¤æ‚çš„æŒ‡ä»¤åºåˆ—&lt;/p&gt;
&lt;p&gt;å…¶å®ä¹Ÿå°±æ˜¯æ‰€è°“çš„æŠŠç®€å•é—®é¢˜å¤æ‚åŒ–&lt;/p&gt;
&lt;p&gt;æ¨¡å¼çš„æ··æ·†å¯ä»¥åœ¨é«˜çº§è¯­è¨€ï¼Œä¹Ÿèƒ½åœ¨æ±‡ç¼–è¯­è¨€ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›ç¤ºä¾‹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é«˜çº§è¯­è¨€å±‚é¢ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;åŸå§‹è¿ç®—&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;ç­‰ä»·æ··æ·†è¿ç®—&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;-x&lt;/td&gt;
          &lt;td&gt;~x + 1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;$x + 1$&lt;/td&gt;
          &lt;td&gt;$-(\sim x)$&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;$x - 1$&lt;/td&gt;
          &lt;td&gt;$\sim(-x)$&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;rotate left (x, y)&lt;/td&gt;
          &lt;td&gt;$(x&amp;laquo;y)$&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;æ±‡ç¼–è¯­è¨€å±‚é¢ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;åŸå§‹æŒ‡ä»¤&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;ç­‰ä»·æ··æ·†æŒ‡ä»¤&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PUSH REG32&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SUB ESP, 4&lt;/code&gt;ã€&lt;code&gt;MOV DWORD PTR [ESP], REG32&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PUSH REG32&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;LEA ESP, [ESP-4]&lt;/code&gt;ã€&lt;code&gt;MOV DWORD PTR [ESP], REG32&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV EDX, IMM32&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CALL $+5&lt;/code&gt;ã€&lt;code&gt;POP EDX&lt;/code&gt;ã€&lt;code&gt;XOR EDX, (Mask ^ IMM32)&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV EDX, OFFSET LBL&lt;/code&gt;  &lt;code&gt;JMP EDX&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PUSH (OFFSET LBL ^ Mask)&lt;/code&gt;ã€&lt;code&gt;POP EDX&lt;/code&gt;ã€&lt;code&gt;XOR EDX, Mask&lt;/code&gt;ã€&lt;code&gt;JMP EDX&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ±‡ç¼–å±‚é¢çš„æ¨¡å¼æ›¿æ¢æ›´éš¾ï¼Œå› ä¸ºå®ƒä¸ä»…è¦ä¿è¯é€šç”¨å¯„å­˜å™¨çš„ç»“æœç­‰ä»·ï¼Œè¿˜å¿…é¡»è€ƒè™‘å¯¹æ ‡å¿—ä½å¯„å­˜å™¨çš„å‰¯ä½œç”¨æ˜¯å¦ç­‰ä»·ï¼Œä½†æ±‡ç¼–å±‚é¢çš„æ¨¡å¼æ›¿æ¢å¾€å¾€æ¯”é«˜çº§è¯­è¨€å±‚é¢çš„æ›´æœ‰æ•ˆï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;äºæ˜¯ï¼Œè‡ªåŠ¨åŒ–çš„æ··æ·†å™¨è¯ç”Ÿäº†&lt;/p&gt;
&lt;p&gt;é«˜çº§æ··æ·†å™¨æ‹¥æœ‰ä¸€ä¸ªåºå¤§çš„ç­‰ä»·æŒ‡ä»¤æ¨¡æ¿åº“ï¼Œä¾‹å¦‚å¯¹äº&lt;code&gt;ADD EAX, 1&lt;/code&gt;ï¼Œå®ƒå¯èƒ½æœ‰10ç§ä¸åŒçš„å®ç°æ–¹å¼&lt;/p&gt;
&lt;p&gt;åœ¨æ··æ·†æ—¶ï¼Œå®ƒä¼šéšæœºä»åº“ä¸­æŒ‘é€‰ä¸€ä¸ªæ¨¡æ¿ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ªåŸå§‹å‡½æ•°åœ¨ä¸¤æ¬¡ä¸åŒæ··æ·†åï¼Œå…¶äºŒè¿›åˆ¶ä»£ç å¯èƒ½æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œå¹¶ä¸”è¿™ä¸ªåº“è¿˜èƒ½éšæ—¶æ›´æ–°ï¼Œè¿™ä½¿å¾—åŸºäºç­¾åçš„æ¨¡å¼åŒ¹é…å®Œå…¨å¤±æ•ˆ&lt;/p&gt;
&lt;h3 id=&#34;attack-1&#34;&gt;attack
&lt;/h3&gt;&lt;p&gt;åç¼–è¯‘å™¨å¯¹äºç ´è§£è¿™ç§æ··æ·†éå¸¸æœ‰æ•ˆï¼Œå› ä¸ºå®ƒä»¬çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯è¯­ä¹‰åˆ†æï¼Œä¸å…³å¿ƒå…·ä½“æŒ‡ä»¤çš„å®ç°&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œéšä¾¿æ±‡ç¼–çš„&lt;code&gt;PUSH&lt;/code&gt;æ€ä¹ˆç©ï¼Œåç¼–è¯‘å™¨åªå…³å¿ƒåœ¨å‡½æ•°&lt;code&gt;X&lt;/code&gt;çš„ç¬¬&lt;code&gt;Y&lt;/code&gt;è¡Œï¼Œ&lt;code&gt;REG32&lt;/code&gt;è¢«æ”¾åˆ°äº†æ ˆé¡¶&lt;/p&gt;
&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œå°±ç®—æ¨¡å¼è¢«æ›¿æ¢äº†ï¼Œåç¼–è¯‘ç”Ÿæˆçš„ä¼ªCä»£ç å¾ˆå¯èƒ½æ˜¯ä¸€æ ·çš„&lt;/p&gt;
&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;ç”±äºå„ç§æŠ€æœ¯åŸå› ï¼Œåç¼–è¯‘å™¨å¹¶ä¸æ˜¯åœ¨è¿˜åŸçœŸå®çš„æºä»£ç ï¼Œè€Œæ˜¯åœ¨çŒœæµ‹æ€§åœ°é‡å»ºä¸€ç§â€œçœ‹èµ·æ¥åƒCçš„é«˜å±‚è¯­ä¹‰è¡¨ç¤ºâ€ï¼Œå®ƒæœªå¿…æ˜¯æ ‡å‡†Cã€æœªå¿…å¯ç¼–è¯‘ã€ä¹Ÿæœªå¿…ä¸åŸä»£ç é€å­—ç­‰ä»·ï¼Œæ‰€ä»¥å«ä¼ªCä»£ç ï¼ˆpseudocodeï¼‰&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;æ­¤å¤–ï¼ŒæŸäº›è„šæœ¬æˆ–æ’ä»¶å¯ä»¥åœ¨æ±‡ç¼–å±‚é¢æ¨¡æ‹Ÿç¼–è¯‘å™¨çš„ä¼˜åŒ–å™¨ï¼Œå®ƒä¼šæ£€æŸ¥ä¸€ä¸ªå°çš„æŒ‡ä»¤çª—å£ï¼ˆä¾‹å¦‚3-5æ¡æŒ‡ä»¤ï¼‰ï¼Œå¦‚æœå‘ç°&lt;code&gt;SUB ESP, 4; MOV [ESP], EAX&lt;/code&gt;è¿™æ ·çš„æ¨¡å¼ï¼Œå°±è‡ªåŠ¨å°†å…¶æŠ˜å ï¼ˆæˆ–æ³¨é‡Šï¼‰ä¸º&lt;code&gt;PUSH EAX&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™ç§æ–¹æ³•åœ¨ä¸Šé¢ä¹Ÿè¯´è¿‡ï¼Œå¾ˆå®¹æ˜“è¢«é’ˆå¯¹&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®ç¼–ç &#34;&gt;æ•°æ®ç¼–ç 
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯ä¸€ç§æ›´é«˜çº§çš„æ··æ·†æ–¹å¼&lt;/p&gt;
&lt;h3 id=&#34;æ™®é€šç¼–ç &#34;&gt;æ™®é€šç¼–ç 
&lt;/h3&gt;&lt;h4 id=&#34;defend-2&#34;&gt;defend
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¼–ç &lt;/strong&gt;ï¼šè®¾å®šä¸€ä¸ªç¼–ç å‡½æ•° $y = f(x)$ã€‚åœ¨ç¨‹åºä¸­ä¸å­˜å‚¨åŸå§‹æ•°æ® $x_0$ï¼Œè€Œæ˜¯å­˜å‚¨ç¼–ç åçš„æ•°æ® $f(x_0)$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§£ç &lt;/strong&gt;ï¼šåœ¨è¿è¡Œæ—¶ï¼Œå½“éœ€è¦ä½¿ç”¨ $x_0$ æ—¶ï¼Œå†é€šè¿‡ $f(x_0)$ å°†å…¶æ¢å¤ï¼ˆè§£ç ï¼‰ä¸º $x_0$&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹ç¼–ç å‡½æ•°$f$çš„è¦æ±‚æ˜¯ï¼Œå®ƒå¿…é¡»æ˜¯éš¾ä»¥é€†å‘çš„ï¼Œå³ä» $y_0$ éš¾ä»¥æ¨æ–­ $x_0$ï¼Œæˆ–è€…ä»å¤šç»„ $(x, y)$ éš¾ä»¥æ¨æ–­å‡º $f$â€‹&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œç¨‹åºä¸­çš„æ•°æ®ï¼ˆç‰¹åˆ«æ˜¯å­—ç¬¦ä¸²ã€APIåã€å¸¸é‡ï¼‰æ˜¯ä»¥åŠ å¯†å½¢å¼å­˜å‚¨åœ¨&lt;code&gt;.data&lt;/code&gt;æˆ–&lt;code&gt;.rdata&lt;/code&gt;æ®µä¸­çš„&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªç»å…¸çš„åŒæ€æ··æ·†æ˜¯&lt;strong&gt;MBA (Mixed Boolean-Arithmetic)&lt;/strong&gt; ï¼Œå®ƒå°†ä¸€ä¸ªç®€å•çš„ç®—æœ¯è¿ç®—ï¼ˆå¦‚&lt;code&gt;z = x + y&lt;/code&gt;ï¼‰æ›¿æ¢ä¸ºä¸€ä¸ªæå…¶å¤æ‚çš„ã€ä½†ä»£æ•°ä¸Šç­‰ä»·çš„æ··åˆå¸ƒå°”-ç®—æœ¯è¡¨è¾¾å¼&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;code&gt;z = x + y&lt;/code&gt;å¯ä»¥è¢«æ›¿æ¢ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;z&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ›´å¯èƒ½æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;z&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; ( ( (&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;~&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;|&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;~&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;) ) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; ( (&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;) ) &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ï¼Œæ”»å‡»è€…é¢å¯¹çš„å°±æ˜¯ä¸€ä¸ªç”±&lt;code&gt;XOR&lt;/code&gt;ã€&lt;code&gt;OR&lt;/code&gt;ã€&lt;code&gt;AND&lt;/code&gt;ã€&lt;code&gt;ADD&lt;/code&gt;ç­‰ç­‰æŒ‡ä»¤ç»„æˆçš„å·¨å¤§å…¬å¼ï¼Œæéš¾å°†å…¶è¿˜åŸ&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªçœ‹ä¸Šå»æœ‰ç‚¹åƒæ¨¡å¼æ··æ·†ï¼Œä½†æ˜¯ä»–ä»¬å…¶å®æ˜¯ä¸ä¸€æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¨¡å¼æ··æ·†æ”¹çš„æ˜¯æŒ‡ä»¤å½¢è²Œï¼Œå±äºè¯­æ³•å±‚&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®ç¼–ç æ”¹çš„æ˜¯ç®—å¼ï¼Œå±äºè¯­ä¹‰å±‚&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åç¼–è¯‘å™¨å¯¹å‰è€…é€šå¸¸æ˜¯ç§’æ€ï¼Œä½†å¯¹åè€…éœ€è¦åšæ•°å­¦&lt;/p&gt;
&lt;h4 id=&#34;attack-2&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;è¿™ç§ç¼–ç æ–¹å¼æœ‰ä¸€ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼š&lt;strong&gt;æ•°æ®ä½¿ç”¨çš„æ—¶å€™ï¼Œä¼šè¢«è§£å¯†æˆæ˜æ–‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œåªè¦æ”»å‡»è€…åœ¨è°ƒè¯•å™¨ä¸­å¯¹å­˜å‚¨åŠ å¯†æ•°æ®çš„å†…å­˜åœ°å€è®¾ç½®ä¸€ä¸ªå†…å­˜æ–­ç‚¹ï¼Œå½“ç¨‹åºè¯»å–è¯¥æ•°æ®ï¼ˆå‡†å¤‡è§£å¯†ï¼‰æ—¶ï¼Œåªéœ€å•æ­¥è·Ÿè¸ªï¼Œå°±ä¸€å®šèƒ½çœ‹è§è§£å¯†çš„è¿‡ç¨‹ï¼ŒUç›´åˆ°è§£å¯†å®Œæˆï¼Œå³å¯åœ¨å†…å­˜æˆ–å¯„å­˜å™¨ä¸­çœ‹åˆ°æ˜æ–‡&lt;/p&gt;
&lt;p&gt;æˆ–è€…ä¹Ÿèƒ½åœ¨æŸä¸ªå‡½æ•°æ‰§è¡Œå‰ï¼Œè½¬å‚¨ä¸€æ¬¡è¿›ç¨‹å†…å­˜ï¼Œæ‰§è¡Œå‡½æ•°åï¼Œå†è½¬å‚¨ä¸€æ¬¡ï¼Œæ¯”è¾ƒä¸¤æ¬¡å¿«ç…§çš„å·®å¼‚ï¼Œå¾€å¾€èƒ½ç›´æ¥å‘ç°è§£å¯†åˆ°å†…å­˜ä¸­çš„æ˜æ–‡æ•°æ®ï¼Œä¸è¿‡è¿™ç§æ–¹æ³•å¾ˆå®¹æ˜“è¢«**ç”¨åå³ç„šï¼ˆä½¿ç”¨å®Œè§£å¯†æ•°æ®åç«‹åˆ»æ¸…é™¤ï¼‰**é˜²å¾¡ä½&lt;/p&gt;
&lt;h3 id=&#34;åŒæ€ç¼–ç &#34;&gt;åŒæ€ç¼–ç 
&lt;/h3&gt;&lt;h4 id=&#34;defend-3&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;æ­£å¦‚ä¹‹å‰æ‰€è¯´çš„ï¼Œä¸€èˆ¬çš„æ•°æ®ç¼–ç æ–¹æ¡ˆéœ€è¦åœ¨æ¯æ¬¡ä½¿ç”¨æ•°æ®å‰éƒ½è¿›è¡ŒåŠ¨æ€è§£ç ï¼Œè¿™ä¼šå¸¦æ¥å¼€é”€å’Œé£é™©&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬èƒ½&lt;strong&gt;ç›´æ¥åœ¨ç¼–ç åçš„æ•°æ®ä¸Šå®æ–½è¿ç®—&lt;/strong&gt; â€”â€” è¿™å°±æ˜¯&lt;strong&gt;åŒæ€&lt;/strong&gt;çš„æ¦‚å¿µ&lt;/p&gt;
&lt;p&gt;åœ¨æŠ½è±¡ä»£æ•°ä¸­ï¼ŒåŒæ€æ˜¯ä¸¤ä¸ªç¾¤ $G$ï¼ˆæºä»£æ•°ï¼‰å’Œ $H$ï¼ˆç›®æ ‡ä»£æ•°ï¼‰ä¹‹é—´çš„ä¸€ä¸ªæ˜ å°„ $f$ï¼Œå®ƒä¿ç•™äº†è¿ç®—ç»“æ„&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœ $G$ å’Œ $H$ åˆ†åˆ«æ”¯æŒ $+_g$ å’Œ $+_h$ è¿ç®—ï¼Œåˆ™ $f(x +_g y) = f(x) +_h f(y)$&lt;/p&gt;
&lt;p&gt;åœ¨æ··æ·†ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¯¹ç¼–ç åçš„æ•°æ® $f(x)$ å’Œ $f(y)$ æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œå…¶ç»“æœç­‰åŒäºå¯¹åŸå§‹æ•°æ® $x$ å’Œ $y$â€‹â€‹ æ‰§è¡Œæ“ä½œåå†ç¼–ç çš„ç»“æœ&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„ä¾‹å­å°±æ˜¯å¼‚æˆ–ï¼š$f(x)=xâŠ•k$&lt;/p&gt;
&lt;h4 id=&#34;attack-3&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;åŒæ€ç¼–ç æ¯”è¾ƒéš¾ç ´è§£ï¼Œå¯ä»¥é‡‡ç”¨é»‘ç›’æ–¹å¼&lt;/p&gt;
&lt;p&gt;å›ºå®š&lt;code&gt;y&lt;/code&gt;ï¼Œç„¶åè¾“å…¥&lt;code&gt;x=1, 2, 3...&lt;/code&gt;ï¼Œè§‚å¯Ÿè¾“å‡ºï¼Œé€šè¿‡å¤šè½®æµ‹è¯•å’Œå½’çº³ï¼Œå¯ä»¥çŒœå‡ºåŸå§‹æ“ä½œ&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ç¼–ç æ··æ·†çš„åŸºç¡€å°±æ˜¯ä¸å®¹æ˜“çŒœå‡ºå‡½æ•°ï¼Œæ‰€ä»¥çœŸçš„å¾ˆéš¾ç ´è§£å•Š&lt;/p&gt;
&lt;h1 id=&#34;æ§åˆ¶æµæ··æ·†&#34;&gt;æ§åˆ¶æµæ··æ·†
&lt;/h1&gt;&lt;p&gt;æ§åˆ¶æµæ··æ·†ï¼ˆControl Flow Obfuscationï¼ŒCFOï¼‰çš„ç›®æ ‡æ˜¯æ‰“ç ´é™æ€åˆ†æå·¥å…·å¯¹ç¨‹åºæ‰§è¡Œæµç¨‹çš„å‡è®¾&lt;/p&gt;
&lt;p&gt;é™æ€ä»£ç åˆ†æå·¥å…·é€šå¸¸ä¾èµ–ä»¥ä¸‹å‡è®¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CALL&lt;/code&gt;æŒ‡ä»¤åªç”¨äºå‡½æ•°è°ƒç”¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CALL&lt;/code&gt;ä¼šè¿”å›åˆ°ç´§éšå…¶åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RET&lt;/code&gt;æŒ‡ä»¤ä»£è¡¨å‡½æ•°çš„è¾¹ç•Œå’Œè¿”å›&lt;/li&gt;
&lt;li&gt;æ¡ä»¶è·³è½¬çš„ä¸¤ä¾§åˆ†æ”¯å‡å¯èƒ½è¢«æ‰§è¡Œï¼Œä¸”åˆ†æ”¯ç›®æ ‡éƒ½æ˜¯ä»£ç è€Œéæ•°æ®&lt;/li&gt;
&lt;li&gt;é—´æ¥è·³è½¬çš„ç›®æ ‡æ˜¯å®¹æ˜“ç¡®å®šçš„ï¼ˆä¾‹å¦‚&lt;code&gt;switch&lt;/code&gt;ç»“æ„æˆ–å‡½æ•°æŒ‡é’ˆï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CFOçš„æ‰€æœ‰æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†æ‰“ç ´ä¸Šè¿°ä¸€ä¸ªæˆ–å¤šä¸ªå‡è®¾ï¼Œç»™åˆ†æå™¨åˆ¶é€ éº»çƒ¦&lt;/p&gt;
&lt;h2 id=&#34;æ’å…¥æ— æ•ˆä»£ç èŠ±æŒ‡ä»¤&#34;&gt;æ’å…¥æ— æ•ˆä»£ç ï¼ˆèŠ±æŒ‡ä»¤ï¼‰
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯æœ€å¸¸è§çš„æ··æ·†æ‰‹æ®µä¹‹ä¸€ï¼Œåˆ†ä¸ºæ­»ä»£ç å’Œåƒåœ¾ä»£ç &lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://ctf-wiki.org/reverse/obfuscate/junk-code/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CTFwiki
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;p&gt;â€œèŠ±æŒ‡ä»¤ï¼ˆjunk codeï¼‰æ˜¯ä¸€ç§ä¸“é—¨ç”¨æ¥è¿·æƒ‘åç¼–è¯‘å™¨çš„æŒ‡ä»¤ç‰‡æ®µï¼Œè¿™äº›æŒ‡ä»¤ç‰‡æ®µä¸ä¼šå½±å“ç¨‹åºçš„åŸæœ‰åŠŸèƒ½ï¼Œä½†ä¼šä½¿å¾—åæ±‡ç¼–å™¨çš„ç»“æœå‡ºç°åå·®ï¼Œä»è€Œä½¿ç ´è§£è€…åˆ†æå¤±è´¥ã€‚æ¯”è¾ƒç»å…¸çš„èŠ±æŒ‡ä»¤æŠ€å·§æœ‰åˆ©ç”¨ &lt;code&gt;jmp&lt;/code&gt; ã€&lt;code&gt;call&lt;/code&gt;ã€&lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤æ”¹å˜æ‰§è¡Œæµï¼Œä»è€Œä½¿å¾—åæ±‡ç¼–å™¨è§£æå‡ºä¸è¿è¡Œæ—¶ä¸ç›¸ç¬¦çš„é”™è¯¯ä»£ç â€&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h3 id=&#34;æ­»ä»£ç &#34;&gt;æ­»ä»£ç 
&lt;/h3&gt;&lt;h4 id=&#34;defend-4&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;æ­»ä»£ç æ˜¯æŒ‡é‚£äº›ä¼šè¢«æ‰§è¡Œã€ä½†å…¶æ‰§è¡Œç»“æœå¯¹ç¨‹åºçš„æœ€ç»ˆçŠ¶æ€æ²¡æœ‰ä»»ä½•å½±å“çš„æŒ‡ä»¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¾§é‡äºæ•°æ®æ··æ·†&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ’å…¥æ­»ä»£ç ï¼Œæ··æ·†å™¨éœ€è¦è¿›è¡Œæ´»è·ƒå˜é‡åˆ†æï¼ˆè¿™æ˜¯é™æ€åˆ†æçš„å†…å®¹ï¼‰ï¼Œæ‰¾å‡ºåœ¨æŸä¸ªç¨‹åºç‚¹ä¸Šå“ªäº›å¯„å­˜å™¨æˆ–å˜é‡æ˜¯æ­»çš„ï¼Œä¹Ÿå°±æ˜¯å³å®ƒä»¬çš„å€¼åœ¨è¢«å†æ¬¡èµ‹å€¼å‰ä¸ä¼šè¢«ä½¿ç”¨ï¼Œç„¶åæ’å…¥ä¿®æ”¹è¿™äº›æ­»å¯„å­˜å™¨çš„æŒ‡ä»¤&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;f&lt;/span&gt;() { 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;lt;-- æ­»ä»£ç , x çš„å€¼åœ¨è¢«ä½¿ç”¨å‰å°±è¢«ç¬¬3è¡Œè¦†ç›–äº†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;y&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;lt;-- æ­»ä»£ç , y ä»æœªè¢«ä½¿ç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// &amp;lt;-- x åœ¨æ­¤å˜ä¸ºâ€œæ´»â€çš„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;attack-4&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;æ—¢ç„¶ä»–ä»¬èƒ½ç”¨æ´»è·ƒå˜é‡åˆ†ææ’å…¥æ­»ä»£ç ï¼Œé‚£ä¹ˆæ”»å‡»è€…ä¹Ÿå¯ä»¥åŒæ ·åˆ©ç”¨æ´»è·ƒå˜é‡åˆ†æå»é™¤æ­»ä»£ç &lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œå¤§éƒ¨åˆ†é™æ€åˆ†æå·¥å…·å¯ä»¥è®¡ç®—å‡ºåœ¨&lt;code&gt;x = 1&lt;/code&gt;ä¹‹åï¼Œ&lt;code&gt;x&lt;/code&gt;åœ¨è¢«&lt;code&gt;x = 3&lt;/code&gt;è¦†ç›–ä¹‹å‰ä»æœªè¢«è¯»å–è¿‡ï¼Œå› æ­¤ &lt;code&gt;x=1&lt;/code&gt;æ˜¯æ­»ä»£ç ï¼Œå¯ä»¥å®‰å…¨ç§»é™¤ï¼Œæˆ–æ ‡è®°ä¸ºæ­»ä»£ç &lt;/p&gt;
&lt;h3 id=&#34;åƒåœ¾ä»£ç &#34;&gt;åƒåœ¾ä»£ç 
&lt;/h3&gt;&lt;h4 id=&#34;defend-5&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;åƒåœ¾ä»£ç æ˜¯æŒ‡é‚£äº›æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œåˆ°çš„ä»£ç å—ï¼Œä¾§é‡äºæ§åˆ¶æµæ··æ·†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰è¯´è¿‡ï¼Œé™æ€åˆ†æå·¥å…·ä¼šå‡è®¾æ¡ä»¶è·³è½¬çš„ä¸¤ä¾§åˆ†æ”¯å‡å¯èƒ½è¢«æ‰§è¡Œï¼Œæ’å…¥åƒåœ¾ä»£ç å°±ä¼šå¤§å¤§å¢åŠ è´Ÿæ‹…&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;eg1ï¼šç®€å•çš„æ— æ¡ä»¶è·³è½¬&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç å¼€å§‹ &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç ç»“æŸ &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;             ; æœ‰æ•ˆä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;eg2ï¼šä¼ªè£…çš„æ¡ä»¶è·³è½¬&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ•°æ®æ··æ·†ï¼Œå°†æ— æ¡ä»¶è·³è½¬ä¼ªè£…æˆæ¡ä»¶è·³è½¬&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;            ; ä¿å­˜ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, åŒæ—¶è®¾ç½® &lt;span style=&#34;color:#e06c75&#34;&gt;ZF&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JZ&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;ZF&lt;/span&gt; æ°¸è¿œä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;ï¼Œæ‰€ä»¥è¿™æ¡ &lt;span style=&#34;color:#e06c75&#34;&gt;JZ&lt;/span&gt; æ°¸è¿œä¼šè·³è½¬
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç å¼€å§‹ &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0xDEADBEEF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;some_func&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç ç»“æŸ &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;             ; æ¢å¤ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;eg3ï¼šæ— æ•ˆçš„æ¡ä»¶è·³è½¬&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JZ&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;target_1&lt;/span&gt;         ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;target_2&lt;/span&gt;        ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;target_1&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;NOP&lt;/span&gt;                 ; &lt;span style=&#34;color:#e06c75&#34;&gt;target_1&lt;/span&gt; åªæ˜¯ä¸€ä¸ªç©ºæŒ‡ä»¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;target_2&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; çœŸæ­£çš„æœ‰æ•ˆä»£ç  &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é™æ€åˆ†æå™¨å¯èƒ½ä¼šè®¤ä¸º&lt;code&gt;target_1&lt;/code&gt;å’Œ&lt;code&gt;target_2&lt;/code&gt;éƒ½æ˜¯æœ‰æ•ˆçš„åˆ†æ”¯ï¼Œä½†å®é™…ä¸Š&lt;code&gt;target_1&lt;/code&gt;ä»€ä¹ˆç”¨ä¹Ÿæ²¡æœ‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;eg4ï¼šåæ±‡ç¼–å»åŒæ­¥&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ç§é«˜çº§çš„åƒåœ¾ä»£ç æ’å…¥æŠ€æœ¯ï¼Œå®ƒåˆ©ç”¨äº†åæ±‡ç¼–å™¨å’Œ CPUå®é™…æ‰§è¡Œä¹‹é—´çš„å·®å¼‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®ƒä¼šåœ¨ä¸€ä¸ª&lt;code&gt;JMP&lt;/code&gt;æŒ‡ä»¤åï¼Œæ’å…¥ä¸€äº›çœ‹èµ·æ¥åƒæŒ‡ä»¤ã€ä½†å®é™…ä¸Šæ˜¯æ•°æ®çš„å­—èŠ‚ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;start&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;           ; ç›´æ¥è·³è¿‡ä¸‹é¢è¿™ä¸²â€œæ•°æ®â€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;db&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x55&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x8B&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0xEC&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x83&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0xEC&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; çœ‹ä¸Šå»åƒæ ‡å‡† &lt;span style=&#34;color:#e06c75&#34;&gt;prologue&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; å†™å…¥ &lt;span style=&#34;color:#d19a66&#34;&gt;0xDEADBEEF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; çœŸæ­£æ‰§è¡Œçš„ä»£ç ä»è¿™é‡Œå¼€å§‹
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;eax&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæ˜¯çº¿æ€§æ‰«æå¼åæ±‡ç¼–ï¼ˆä»æŸä¸ªèµ·ç‚¹åœ°å€å¼€å§‹ï¼ŒæŒ‰åœ°å€é€’å¢é¡ºåºä¸€æ¡æ¡è§£ç æŒ‡ä»¤ï¼‰ï¼Œå°±ä¼šæŠŠdbçš„è¿™ä¸²æ•°æ®è§£ç ï¼Œè€Œè¿™ä¸²æ•°æ®çš„æ„ä¹‰åˆšå¥½æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;55&lt;/span&gt;          &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;B&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EC&lt;/span&gt;       &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;83&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EC&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;sub&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°±æ˜¯ä¸€ä¸ªå‡½æ•°å‰è¨€ï¼Œè€Œè®¸å¤šåæ±‡ç¼–å™¨å’Œå‡½æ•°è¯†åˆ«å™¨ä¼šç”¨å‰è¨€/åè¨€æ¨¡å¼æ¥çŒœæµ‹â€œè¿™é‡Œæ˜¯ä¸æ˜¯å‡½æ•°çš„å¼€å¤´â€&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦åœ¨çº¿æ‰«è¿‡ç¨‹ä¸­é‡åˆ°ç±»ä¼¼&lt;code&gt;55 8B EC&lt;/code&gt;çš„åºåˆ—ï¼Œå°±å€¾å‘äºæ ‡è®°ä¸ºå‡½æ•°èµ·ç‚¹ï¼Œå¹¶ç»§ç»­æŠŠåé¢å­—èŠ‚å½“ä»£ç è§£ä¸‹å»ï¼Œè¿™å°±æ‰è¿›é™·é˜±äº†&lt;/p&gt;
&lt;h4 id=&#34;attack-5&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;ä»–ä»¬æ¬ºéª—äº†é™æ€åˆ†æå™¨ï¼Œå…³æˆ‘åŠ¨æ€åˆ†æä»€ä¹ˆäº‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ”»å‡»è€…å¯ä»¥åˆ©ç”¨äºŒè¿›åˆ¶æ’æ¡©å·¥å…·æ¥è¿½è¸ªç¨‹åºçš„å®é™…æ‰§è¡Œè·¯å¾„ï¼Œè¿è¡Œç¨‹åºåï¼Œæ‰€æœ‰ä»æœªè¢«æ‰§è¡Œåˆ°çš„ä»£ç å—éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯åƒåœ¾ä»£ç &lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹æ³•éœ€è¦å°½å¯èƒ½å¤šæ ·çš„æ•°æ®è¾“å…¥ï¼Œæ¥é¿å…æœ‰æ‰€é—æ¼ï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯å¾ˆæœ‰æ•ˆï¼Œæ¯”è¾ƒé€šå¸¸çš„è¿˜æ˜¯äººå·¥åˆ†æ&lt;/p&gt;
&lt;h2 id=&#34;ä¸é€æ˜è°“è¯&#34;&gt;ä¸é€æ˜è°“è¯
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯æ’å…¥åƒåœ¾ä»£ç çš„å‡çº§ç‰ˆ&lt;/p&gt;
&lt;p&gt;ä¸é€æ˜è°“è¯æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå…¶ç»“æœåœ¨æ··æ·†æ—¶æ˜¯ç¡®å®šçš„ï¼Œä½†å¯¹äºé™æ€åˆ†æå™¨æ¥è¯´å´éå¸¸éš¾æ¨å¯¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$P^T$ï¼šä¸€ä¸ªæ°¸è¿œä¸ºTrueçš„ä¸é€æ˜è°“è¯&lt;/li&gt;
&lt;li&gt;$P^F$ï¼šä¸€ä¸ªæ°¸è¿œä¸ºFalseçš„ä¸é€æ˜è°“è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡ä½¿ç”¨ä¸é€æ˜è°“è¯ä½œä¸ºåˆ†æ”¯æ¡ä»¶ï¼Œæ··æ·†å™¨å¯ä»¥å‘ç¨‹åºçš„æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ä¸­æ’å…¥ä¼ªåˆ†æ”¯&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹ä»£ç ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;B&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ $P^T$ æ··æ·†åï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;Block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;IF&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;P&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;T&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;GOTO&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;B&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ELSE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;GOTO&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Block_B_Buggy&lt;/span&gt;  ; è¿™æ˜¯ä¸€ä¸ªåŒ…å«åƒåœ¾ä»£ç çš„ä¼ªé€ å—
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ†æå™¨ä¼šçœ‹åˆ°ä¸¤ä¸ªåˆ†æ”¯ï¼Œä½†å®é™…ä¸Šåªæœ‰&lt;code&gt;Block B&lt;/code&gt;æ°¸è¿œä¼šè¢«æ‰§è¡Œï¼Œä»¥æ­¤å¢åŠ åˆ†æçš„è´Ÿæ‹…&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251026203004768&#34; href=&#34;http://picture.928330.xyz/typora/image-20251026203004768.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251026203004768.png&#34; alt=&#34;image-20251026203004768&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;åŸºäºæ•°å­¦çš„è°“è¯&#34;&gt;åŸºäºæ•°å­¦çš„è°“è¯
&lt;/h3&gt;&lt;h4 id=&#34;defend-6&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨ä¸€ä¸ªæ•°å­¦æ’ç­‰å¼æˆ–æ•°è®ºå±æ€§æ¥æ„é€ ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¡¨è¾¾å¼åœ¨æ··æ·†æ—¶è¢«è®¾è®¡ä¸ºæ°¸è¿œä¸ºçœŸ ($P^T$) æˆ–æ°¸è¿œä¸ºå‡ ($P^F$â€‹)ï¼Œä½†å…¶å½¢å¼å¯¹äºé™æ€åˆ†æå™¨æˆ–äººç±»åˆ†æå¸ˆæ¥è¯´å¹¶ä¸ç›´è§‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ä¸ªç®€å•çš„$P^T$ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»»ä½•å®æ•´æ•°çš„å¹³æ–¹æ°¸è¿œå¤§äºç­‰äºé›¶ï¼Œè¿™å¯¹äºåˆ†æå™¨æ¥è¯´æ¯”è¾ƒå®¹æ˜“è¯†åˆ«&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ä¸ªé«˜çº§çš„$P^T$ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#d19a66&#34;&gt;7&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;x&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;x * 2&lt;/code&gt;æ€»æ˜¯å¶æ•°ï¼Œ&lt;code&gt;å¶æ•° + 1&lt;/code&gt;æ€»æ˜¯å¥‡æ•°ï¼Œä»»ä½•å¥‡æ•°å¯¹2å–æ¨¡æ°¸è¿œä¸ç­‰äº0&lt;/p&gt;
&lt;h4 id=&#34;attack-6&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;å¯ä»¥ä½¿ç”¨SMTï¼ˆsatisfiability modulo theoriesï¼Œæ¨¡ç†è®ºå¯æ»¡è¶³æ€§ï¼‰æ±‚è§£å™¨ï¼Œæ¯”å¦‚å¤§åé¼é¼çš„Z3ï¼Œå°†è°“è¯å–‚è¿›å»ï¼Œå¹¶è¯¢é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªxï¼Œä½¿å¾—è¯¥è¡¨è¾¾å¼ä¸ºFalseï¼Œå¦‚æœ&lt;code&gt;Z3&lt;/code&gt;å›ç­”ä¸å¯æ»¡è¶³ï¼Œåˆ™è¯æ˜è¯¥è°“è¯æ˜¯ $P^T$&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥åœ¨è°ƒè¯•å™¨ä¸­ï¼Œä½¿ç”¨ä¸åŒçš„è¾“å…¥è¿è¡Œä»£ç æˆåƒä¸Šä¸‡æ¬¡ï¼Œå¦‚æœ&lt;code&gt;if&lt;/code&gt;è¯­å¥çš„&lt;code&gt;True&lt;/code&gt;åˆ†æ”¯æ¯æ¬¡éƒ½è¢«å‘½ä¸­ï¼Œè€Œ&lt;code&gt;False&lt;/code&gt;åˆ†æ”¯è¢«å‘½ä¸­äº†0æ¬¡ï¼Œé‚£ä¹ˆå®ƒæœ‰æé«˜çš„æ¦‚ç‡æ˜¯ä¸€ä¸ª$P^T$ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸ºåŠ¨æ€æ¢æµ‹ï¼Œæ˜¯æ›´ä¸ºå»‰ä»·æš´åŠ›çš„æ‰‹æ®µ&lt;/p&gt;
&lt;h3 id=&#34;åŸºäºç¯å¢ƒçš„è°“è¯&#34;&gt;åŸºäºç¯å¢ƒçš„è°“è¯
&lt;/h3&gt;&lt;h4 id=&#34;defend-7&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ˜¯è°“è¯çš„ç»“æœä¸ä¾èµ–äºç¨‹åºå†…éƒ¨çš„è®¡ç®—ï¼Œè€Œæ˜¯ä¾èµ–äºå¤–éƒ¨ç¯å¢ƒçš„ä¸€ä¸ªæ’å®šçŠ¶æ€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;egï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetModuleHandleA&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;kernel32.dll&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;NULL&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;kernel32.dll&lt;/code&gt;æ˜¯æ‰€æœ‰Windowsç”¨æˆ·æ¨¡å¼è¿›ç¨‹çš„åŸºç¡€æ ¸å¿ƒåº“ï¼Œå®ƒå¿…ç„¶å·²ç»è¢«åŠ è½½åˆ°è¿›ç¨‹ç©ºé—´ä¸­ï¼Œå› æ­¤ï¼Œè¿™ä¸ª API è°ƒç”¨æ°¸è¿œä¸ä¼šè¿”å›&lt;code&gt;NULL&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè°“è¯åœ¨ä»»ä½•Windowsè¿›ç¨‹ä¸­éƒ½æ˜¯$P^T$â€‹&lt;/p&gt;
&lt;p&gt;è€Œé™æ€åˆ†æå™¨ä¸çŸ¥é“&lt;code&gt;GetModuleHandleA&lt;/code&gt;çš„è¿”å›å€¼ï¼Œå®ƒå¿…é¡»å‡è®¾è¿™ä¸ªAPIæ—¢å¯èƒ½æˆåŠŸä¹Ÿå¯èƒ½å¤±è´¥ï¼Œè¿™ä¼šè¿«ä½¿åˆ†æå™¨åœ¨æ§åˆ¶æµå›¾ä¸­ä¿ç•™ä¸¤ä¸ªåˆ†æ”¯ï¼Œè€Œ&lt;code&gt;False&lt;/code&gt;åˆ†æ”¯ä¼šæ˜¯æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œçš„åƒåœ¾ä»£ç &lt;/p&gt;
&lt;h4 id=&#34;attack-7&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;å¯ä»¥ä½¿ç”¨hookæˆ–è€…patchæ¥æ‹¦æˆªè¿™ä¸ªAPIè°ƒç”¨ï¼Œå½“æ£€æµ‹åˆ°è¾“å…¥æ˜¯&lt;code&gt;&amp;quot;kernel32.dll&amp;quot;&lt;/code&gt;æ—¶ï¼Œå¼ºè¡Œä¿®æ”¹å…¶è¿”å›å€¼ä¸º&lt;code&gt;NULL&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…æ ¹æ®ç»éªŒåˆ¤æ–­ï¼Œé€šè¿‡è°“è¯ç­¾ååº“åŒ¹é…å›ºå®šçš„ç¯å¢ƒè°“è¯æ¨¡å¼ï¼Œç„¶åæ ‡è®°å®ƒ&lt;/p&gt;
&lt;h3 id=&#34;åŸºäºæŒ‡é’ˆåˆ«åçš„è°“è¯&#34;&gt;åŸºäºæŒ‡é’ˆåˆ«åçš„è°“è¯
&lt;/h3&gt;&lt;h4 id=&#34;defend-8&#34;&gt;defend
&lt;/h4&gt;&lt;p&gt;è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨æŒ‡é’ˆåˆ«åï¼ˆå³ä¸¤ä¸ªæˆ–å¤šä¸ªä¸åŒçš„æŒ‡é’ˆå˜é‡æŒ‡å‘äº†åŒä¸€å—å†…å­˜åœ°å€ï¼‰æ¥æ„é€ è°“è¯&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ç°åœ¨æœ‰ä¸€ä¸ª$P^T$:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ··æ·†å™¨ä¼šé€šè¿‡ä¸¤æ¡è¡¨é¢ä¸Šå®Œå…¨ä¸åŒã€ä½†ç»“æœç›¸åŒçš„å¤æ‚è®¡ç®—è·¯å¾„æ¥åˆ†åˆ«åˆå§‹åŒ–&lt;code&gt;p&lt;/code&gt;å’Œ&lt;code&gt;q&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;arr&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;int&lt;/span&gt;* &lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; = &amp;amp;&lt;span style=&#34;color:#e06c75&#34;&gt;arr&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;]; (&lt;span style=&#34;color:#e06c75&#34;&gt;è·¯å¾„1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;int&lt;/span&gt;* &lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt; = &amp;amp;&lt;span style=&#34;color:#e06c75&#34;&gt;arr&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;]; (&lt;span style=&#34;color:#e06c75&#34;&gt;è·¯å¾„2&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;å¼€å§‹&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// ... (æ’å…¥ 50 è¡Œåƒåœ¾æŒ‡ä»¤) ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;; (&lt;span style=&#34;color:#e06c75&#34;&gt;è·¯å¾„2&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ç»§ç»­&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// ... (æ’å…¥ 50 è¡Œåƒåœ¾æŒ‡ä»¤) ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;; (&lt;span style=&#34;color:#e06c75&#34;&gt;è·¯å¾„2&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ç»“æŸ&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;q&lt;/span&gt;) { &lt;span style=&#34;color:#56b6c2&#34;&gt;..&lt;/span&gt;. } (&lt;span style=&#34;color:#e06c75&#34;&gt;æ’ä¸ºçœŸ&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é™æ€åˆ†æå™¨å¾ˆéš¾åœ¨æ•°ç™¾è¡Œåƒåœ¾æŒ‡ä»¤çš„å¹²æ‰°ä¸‹ï¼Œé™æ€åœ°è·Ÿè¸ª&lt;code&gt;q&lt;/code&gt;çš„å€¼å¹¶æ¨å¯¼å‡º&lt;code&gt;&amp;amp;arr[0] + 5 + 5&lt;/code&gt;ç­‰äº&lt;code&gt;&amp;amp;arr[10]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå®ƒå¿…é¡»å‡è®¾&lt;code&gt;p == q&lt;/code&gt;å’Œ&lt;code&gt;p != q&lt;/code&gt;ä¸¤ç§æƒ…å†µéƒ½å¯èƒ½å‘ç”Ÿ&lt;/p&gt;
&lt;h4 id=&#34;attack-8&#34;&gt;attack
&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ä»£ç åˆ‡ç‰‡æŠ€æœ¯ï¼Œä»&lt;code&gt;if (p == q)&lt;/code&gt;å¼€å§‹å‘ä¸Šå›æº¯ä»£ç ï¼Œåªæå–é‚£äº›å¯¹&lt;code&gt;p&lt;/code&gt;æˆ–&lt;code&gt;q&lt;/code&gt;çš„å€¼æœ‰å½±å“çš„æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;p&lt;/code&gt;çš„åˆ‡ç‰‡å¯èƒ½æ˜¯ï¼š&lt;code&gt;mov eax, OFFSET arr; add eax, 40; mov p, eax&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;q&lt;/code&gt;çš„åˆ‡ç‰‡å¯èƒ½æ˜¯ï¼š&lt;code&gt;mov ebx, OFFSET arr; add ebx, 20; add ebx, 20; mov q, ebx&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“æœå°±æ˜¯æ‰€æœ‰çš„åƒåœ¾æŒ‡ä»¤éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œé€šè¿‡è¿™ä¸ªç®€åŒ–çš„åˆ‡ç‰‡ï¼Œå¯ä»¥è½»è€Œæ˜“ä¸¾åœ°çœ‹å‡º&lt;code&gt;p&lt;/code&gt;å’Œ&lt;code&gt;q&lt;/code&gt;ç›¸ç­‰&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œå°±ä¸Šä¾‹æ¥è¯´ï¼Œé™æ€åˆ†æå·¥å…·ä¹Ÿå¯ä»¥å°†arrçš„åŸºå€çœ‹åšæ˜¯ä¸€ä¸ªç¬¦å·ï¼Œç„¶åé¡ºç€æŒ‡ä»¤åˆ†æï¼Œä½†ä¸åšè¿ç®—ï¼Œå¾—åˆ°æœ€åçš„è¡¨è¾¾å¼ï¼Œå†å–‚ç»™SMTæ±‚è§£å™¨ä»–ä»¬ç»“æœæ˜¯å¦ç›¸ç­‰&lt;/p&gt;
&lt;h2 id=&#34;ç ´åä»£ç å±€éƒ¨æ€§&#34;&gt;ç ´åä»£ç å±€éƒ¨æ€§
&lt;/h2&gt;&lt;h3 id=&#34;defend-9&#34;&gt;defend
&lt;/h3&gt;&lt;h4 id=&#34;è·³è½¬é‡æ’&#34;&gt;è·³è½¬é‡æ’
&lt;/h4&gt;&lt;p&gt;é€šè¿‡å‘åŸºæœ¬å—ä¸­å¼•å…¥æ— æ„ä¹‰çš„&lt;code&gt;JMP&lt;/code&gt;æŒ‡ä»¤ï¼Œå°†åŸæœ¬åœ¨é€»è¾‘ä¸Šå’Œç‰©ç†ä¸Šéƒ½è¿ç»­çš„ä»£ç å—æ‰“æ•£ï¼Œç ´åå…¶å±€éƒ¨æ€§&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹ä»£ç ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;start&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;offset&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;caption&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;offset&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;digtxt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MessageBoxA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ··æ·†åï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;start&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;instr_1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;instr_2&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MessageBoxA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;instr_5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;instr_3&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;instr_2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;instr_4&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;offset&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;digtxt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;instr_3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;instr_1&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;offset&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;caption&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;jmp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;instr_4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;instr_5&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å‡½æ•°å†…è”ä¸å¤–è”&#34;&gt;å‡½æ•°å†…è”ä¸å¤–è”
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å‡½æ•°å†…è” (Inlining)&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å°†å­å‡½æ•°$P$çš„ä»£ç ç›´æ¥åˆå¹¶åˆ°è°ƒç”¨è€…$Q$çš„ä»£ç ä¸­ï¼Œå¦‚æœ$P$è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¼šå¯¼è‡´ä»£ç ä½“ç§¯æ˜¾è‘—è†¨èƒ€&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‡½æ•°å¤–è” (Outlining)&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;å°†å‡½æ•°$Q$ä¸­ä»»æ„ä¸€æ®µä»£ç ï¼ˆç‰¹åˆ«æ˜¯é€»è¾‘ä¸Šä¸ç›¸å…³çš„éƒ¨åˆ†ï¼‰æå–å‡ºæ¥ï¼Œæ„æˆä¸€ä¸ªæ–°çš„å‡½æ•°$R$ï¼Œç„¶ååœ¨$Q$â€‹â€‹â€‹çš„åŸä½ç½®æ›¿æ¢ä¸ºä¸€ä¸ª&lt;code&gt;CALL R&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;åŸºæœ¬å—é‡æ’&#34;&gt;åŸºæœ¬å—é‡æ’
&lt;/h4&gt;&lt;p&gt;å°†ä¸€ä¸ªå‡½æ•°çš„æ‰€æœ‰åŸºæœ¬å—æ‰“ä¹±ï¼Œå¹¶åœ¨ç‰©ç†ä¸Šéšæœºæ•£å¸ƒåˆ°ç¨‹åºçš„&lt;code&gt;.text&lt;/code&gt;æ®µä¸­ï¼Œç”šè‡³æ’å…¥åˆ°å…¶ä»–å‡½æ•°çš„ç¼éš™ä¸­ï¼Œç„¶åé€šè¿‡&lt;code&gt;JMP&lt;/code&gt;å°†å®ƒä»¬é‡æ–°é“¾æ¥èµ·æ¥&lt;/p&gt;
&lt;h4 id=&#34;å‡½æ•°å…‹éš†&#34;&gt;å‡½æ•°å…‹éš†
&lt;/h4&gt;&lt;p&gt;å¤åˆ¶ä¸€ä¸ªå‡½æ•°$f$ï¼Œå¾—åˆ° $f&amp;rsquo;$ï¼Œä»–ä»¬çš„çš„åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œä½†å¯èƒ½ä½¿ç”¨äº†ä¸åŒçš„æŒ‡ä»¤æ¨¡æ¿ï¼ˆä¹Ÿå°±æ˜¯åŸºäºæ¨¡å¼çš„æ··æ·†ï¼‰&lt;/p&gt;
&lt;p&gt;æ··æ·†å™¨å°†ç¨‹åºä¸­ä¸€åŠå¯¹$f$çš„è°ƒç”¨æ›¿æ¢ä¸ºå¯¹ $f&amp;rsquo;$çš„è°ƒç”¨ï¼Œè¿«ä½¿æ”»å‡»è€…æµªè´¹ä¸€å€çš„æ—¶é—´å»åˆ†æä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œæœ€åæ‰å‘ç°å®ƒä»¬æ˜¯ç­‰ä»·çš„&lt;/p&gt;
&lt;h3 id=&#34;attack-9&#34;&gt;attack
&lt;/h3&gt;&lt;p&gt;å®é™…ä¸Šï¼Œç ´åä»£ç å±€éƒ¨æ€§åªèƒ½å¯¹äººå·¥åˆ†æé€ æˆè¾ƒå¤§é˜»ç¢&lt;/p&gt;
&lt;p&gt;åˆ†æå·¥å…·éƒ½ä¸åº”è¯¥å…³å¿ƒåŸºæœ¬å—çš„ç‰©ç†ä½ç½®ï¼Œåªåº”è¯¥å…³å¿ƒå®ƒä»¬ä¹‹é—´çš„é€»è¾‘å…³ç³»ï¼Œé€šè¿‡è·Ÿéšè¿™äº›è·³è½¬ï¼Œå¯ä»¥100%è¿˜åŸå‡ºåŸå§‹çš„æ§åˆ¶æµå›¾ï¼Œè¿™å°±è®©å‰é¢ä¸‰ç§æ··æ·†å®Œå…¨æ— æ•ˆäº†ï¼Œç›¸ä¿¡ç”¨è¿‡IDAçš„ä¸€å®šèƒ½ä½“ä¼šåˆ°è¿™ç§å›¾çš„ä¾¿åˆ©&lt;/p&gt;
&lt;p&gt;è€Œå¯¹æŠ—å‡½æ•°å…‹éš†ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡ç³Šå“ˆå¸Œï¼Œè¿™äº›å·¥å…·æ¯”è¾ƒä¸¤ä¸ªå‡½æ•°çš„çš„CFGç»“æ„ã€å¸¸é‡ã€APIè°ƒç”¨ç­‰ï¼Œå¦‚æœç›¸ä¼¼åº¦æé«˜ï¼Œå°±å¯ä»¥åˆ¤å®šå®ƒä»¬æ˜¯å…‹éš†å‡½æ•°&lt;/p&gt;
&lt;h2 id=&#34;æ§åˆ¶æµé—´æ¥åŒ–&#34;&gt;æ§åˆ¶æµé—´æ¥åŒ–
&lt;/h2&gt;&lt;h3 id=&#34;defend-10&#34;&gt;defend
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åŠ¨æ€è®¡ç®—çš„åˆ†æ”¯åœ°å€ï¼Œæˆ–è€…æ¨¡æ‹Ÿ&lt;code&gt;JMP&lt;/code&gt;å’Œ&lt;code&gt;CALL&lt;/code&gt;æŒ‡ä»¤ï¼Œæ¥éšè—çœŸå®çš„æ§åˆ¶æµ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;eg1ï¼šä½¿ç”¨&lt;code&gt;RET&lt;/code&gt;æ¨¡æ‹Ÿ&lt;code&gt;JMP&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;JMP &amp;lt;target&amp;gt;&lt;/code&gt;å¯ä»¥è¢«ç­‰ä»·æ›¿æ¢ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;target&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt;     ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;               ;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¼šæ‰“ç ´é™æ€åˆ†æå™¨â€œ&lt;code&gt;RET&lt;/code&gt;ä»£è¡¨å‡½æ•°è¿”å›â€çš„å‡è®¾&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egï¼šï¼šä½¿ç”¨&lt;code&gt;CALL&lt;/code&gt;æ¨¡æ‹Ÿ&lt;code&gt;JMP&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;      ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç  &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;   
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;real_code&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;          ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; çœŸæ­£çš„æœ‰æ•ˆä»£ç  &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„&lt;code&gt;CALL&lt;/code&gt;åªæ˜¯èµ·åˆ°äº†&lt;code&gt;PUSH &amp;lt;è¿”å›åœ°å€&amp;gt;&lt;/code&gt;å’Œ&lt;code&gt;JMP real_code&lt;/code&gt;çš„ä½œç”¨&lt;/p&gt;
&lt;p&gt;è€Œ&lt;code&gt;real_code&lt;/code&gt;å¼€å¤´çš„&lt;code&gt;ADD ESP, 4&lt;/code&gt;åˆ™æŠ›å¼ƒäº†å‹å…¥æ ˆçš„è¿”å›åœ°å€ï¼ˆåƒåœ¾ä»£ç çš„åœ°å€ï¼‰ï¼Œä»è€Œå®ç°äº†&lt;code&gt;JMP&lt;/code&gt;çš„æ•ˆæœ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;eg3ï¼šä¿®æ”¹æ ˆä¸Šçš„è¿”å›åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FunctionA&lt;/span&gt;      ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;original_ret_addr&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; åƒåœ¾ä»£ç  &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;   
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;actual_ret_addr&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;NOP&lt;/span&gt;                 ;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt; çœŸæ­£çš„æœ‰æ•ˆä»£ç  &lt;span style=&#34;color:#56b6c2&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FunctionA&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ; å‡è®¾åƒåœ¾ä»£ç é•¿åº¦ä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt; å­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt; ; å…³é”®ï¼ä¿®æ”¹æ ˆé¡¶çš„è¿”å›åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;                 ;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;CALL FunctionA&lt;/code&gt;æ—¶ï¼Œå‹å…¥æ ˆçš„è¿”å›åœ°å€æ˜¯&lt;code&gt;original_ret_addr&lt;/code&gt;ï¼Œä½†&lt;code&gt;FunctionA&lt;/code&gt;å†…éƒ¨é€šè¿‡&lt;code&gt;[ESP]&lt;/code&gt;ï¼ˆå³æŒ‡å‘è¿”å›åœ°å€çš„æŒ‡é’ˆï¼‰ä¿®æ”¹äº†å®ƒï¼Œå°†å…¶æ”¹ä¸ºäº†&lt;code&gt;actual_ret_addr&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®ä¹Ÿå°±æ˜¯ä¸Šä¸€ç§çš„å˜ç§&lt;/p&gt;
&lt;h3 id=&#34;attack-10&#34;&gt;attack
&lt;/h3&gt;&lt;p&gt;å¯¹äº&lt;code&gt;PUSH &amp;lt;target&amp;gt;; RET&lt;/code&gt;ï¼ŒIDAç­‰ç°ä»£å·¥å…·å·²ç»å¯ä»¥å¾ˆå¥½åœ°è¯†åˆ«&lt;/p&gt;
&lt;p&gt;å®ƒä»¬ä¼šåˆ†æ&lt;code&gt;RET&lt;/code&gt;æŒ‡ä»¤æ—¶&lt;code&gt;ESP&lt;/code&gt;æŒ‡å‘çš„å€¼ï¼Œå¦‚æœå®ƒä¸æ˜¯ä¸€ä¸ª&lt;code&gt;CALL&lt;/code&gt;æŒ‡ä»¤çš„è¿”å›åœ°å€ï¼Œè€Œæ˜¯ä¸€ä¸ª&lt;code&gt;PUSH&lt;/code&gt;å‹å…¥çš„å¸¸é‡ï¼ŒIDAä¼šè‡ªåŠ¨å°†å…¶æ ‡è®°ä¸º&lt;code&gt;JMP&lt;/code&gt;ï¼ˆæ˜¾ç¤ºä¸º&lt;code&gt;retn_0&lt;/code&gt;å¹¶æ·»åŠ æ³¨é‡Šï¼‰&lt;/p&gt;
&lt;h2 id=&#34;æ§åˆ¶æµå›¾æ‰å¹³åŒ–&#34;&gt;æ§åˆ¶æµå›¾æ‰å¹³åŒ–
&lt;/h2&gt;&lt;h3 id=&#34;defend-11&#34;&gt;defend
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯æœ€å¤æ‚çš„æ§åˆ¶æµæ··æ·†æŠ€æœ¯ä¹‹ä¸€&lt;/p&gt;
&lt;p&gt;å®ƒå°†ä¸€ä¸ªå‡½æ•°å†…æ‰€æœ‰æ§åˆ¶ç»“æ„ï¼ˆå¦‚ &lt;code&gt;if-else&lt;/code&gt;ã€&lt;code&gt;while&lt;/code&gt;ã€&lt;code&gt;for&lt;/code&gt;ï¼‰å…¨éƒ¨â€œæ‹å¹³â€ï¼Œç”¨ä¸€ä¸ªå•ä¸€çš„åˆ†å‘å™¨ç»“æ„æ¥æ›¿ä»£&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ†å‘å™¨&lt;/strong&gt;ï¼šè¿™é€šå¸¸æ˜¯ä¸€ä¸ªå·¨å¤§çš„&lt;code&gt;switch&lt;/code&gt;ç»“æ„&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çŠ¶æ€å˜é‡&lt;/strong&gt;ï¼šå¼•å…¥ä¸€ä¸ª &lt;code&gt;swVar&lt;/code&gt; å˜é‡&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç å—æ‹†åˆ†&lt;/strong&gt;ï¼šåŸå§‹å‡½æ•°çš„æ‰€æœ‰åŸºæœ¬å—è¢«æ‹†åˆ†ï¼Œå¹¶æ”¾å…¥&lt;code&gt;switch&lt;/code&gt;çš„ä¸åŒ&lt;code&gt;case&lt;/code&gt;ä¸­&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¯ä¸ªåŸºæœ¬å—çš„æœ«å°¾ä¸å†æ˜¯&lt;code&gt;JMP&lt;/code&gt;æˆ–&lt;code&gt;JZ&lt;/code&gt;ï¼Œè€Œæ˜¯è´Ÿè´£æ›´æ–°&lt;code&gt;swVar&lt;/code&gt;ï¼Œå°†å…¶è®¾ç½®ä¸ºä¸‹ä¸€ä¸ªåº”è¯¥æ‰§è¡Œçš„åŸºæœ¬å—çš„ ID&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹ä»£ç ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;++&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;--&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;use&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251026203050831&#34; href=&#34;http://picture.928330.xyz/typora/image-20251026203050831.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251026203050831.png&#34; alt=&#34;image-20251026203050831&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CFGæ‰å¹³åŒ–æ··æ·†å (ä¼ªä»£ç )ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// çŠ¶æ€å˜é‡ï¼Œåˆå§‹ä¸º 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;switch&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¸‹ä¸€ä¸ªå» S2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S2 (while)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// (while å¾ªç¯ç»“æŸï¼Œå» S6)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// (while å¾ªç¯ä½“ï¼Œå» S3)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// (if ä¸º falseï¼Œå» S5)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// (if ä¸º trueï¼Œå» S4)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S4 (if-true)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;a&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;++&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å›åˆ° S2 (while å¤´éƒ¨)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S5 (if-false)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;--&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å›åˆ° S2 (while å¤´éƒ¨)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;goto&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dispatcher&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#c678dd&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¹åº”åŸå§‹çš„ S6 (use(b))
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;            &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;use&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#c678dd&#34;&gt;break&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// ç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251026203105731&#34; href=&#34;http://picture.928330.xyz/typora/image-20251026203105731.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251026203105731.png&#34; alt=&#34;image-20251026203105731&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ç§æ··æ·†å½»åº•æ‘§æ¯äº†åŸå§‹çš„&lt;code&gt;while&lt;/code&gt;å’Œ&lt;code&gt;if&lt;/code&gt;é€»è¾‘ç»“æ„ï¼Œé™æ€åˆ†æå™¨å’Œæ”»å‡»è€…åªèƒ½çœ‹åˆ°ä¸€å †åŸºæœ¬å—å’Œä¸€ä¸ª&lt;code&gt;switch&lt;/code&gt;ï¼ŒåŸºæœ¬å—ä¹‹é—´çš„é€»è¾‘å…³ç³»è¢«éšè—åœ¨å¯¹&lt;code&gt;swVar&lt;/code&gt;çš„æ§åˆ¶æ“ä½œä¸­&lt;/p&gt;
&lt;p&gt;æ›´æœ‰ç”šè€…ï¼Œ&lt;code&gt;swVar&lt;/code&gt;çš„æ›´æ–°ä¸å†æ˜¯ç®€å•çš„èµ‹å€¼ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªå¤æ‚çš„MBAè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;swVar&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; ((&lt;span style=&#34;color:#e06c75&#34;&gt;swVar_old&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0xABCDEF&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x123456&lt;/span&gt;) &lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0xDEADBEEF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŒæ—¶ï¼Œ&lt;code&gt;case&lt;/code&gt;æ ‡ç­¾ä¹Ÿä¸æ˜¯&lt;code&gt;1,2,3...&lt;/code&gt;ï¼Œè€Œæ˜¯&lt;code&gt;0xABC, 0xDEF, 0x123...&lt;/code&gt;ï¼Œè¿™ä½¿å¾—åˆ†æå¸ˆå¿…é¡»å…ˆé€†å‘å‡ºçŠ¶æ€è½¬æ¢å‡½æ•°ï¼Œæ‰èƒ½é‡å»ºCFG&lt;/p&gt;
&lt;h3 id=&#34;attack-11&#34;&gt;attack
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¿›è¡Œé™æ€CFGé‡å»ºï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®šä½åˆ†å‘å™¨&lt;code&gt;switch&lt;/code&gt;å’ŒçŠ¶æ€å˜é‡&lt;code&gt;swVar&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åˆ†ææ¯ä¸ª&lt;code&gt;case&lt;/code&gt;å—&lt;/li&gt;
&lt;li&gt;å¿½ç•¥å—å†…çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼Œåªçœ‹å—æœ«å°¾å¯¹&lt;code&gt;swVar&lt;/code&gt;çš„å†™å…¥&lt;/li&gt;
&lt;li&gt;&lt;code&gt;case 3:&lt;/code&gt; &amp;hellip; &lt;code&gt;swVar = 4;&lt;/code&gt;è¿™æ¡æŒ‡ä»¤å°±æ˜¯ä¸€æ¡ä»&lt;code&gt;Block 3&lt;/code&gt;åˆ°&lt;code&gt;Block 4&lt;/code&gt;çš„æœ‰å‘è¾¹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;case 2:&lt;/code&gt; &amp;hellip; &lt;code&gt;if (cond) swVar = 6; else swVar = 3;&lt;/code&gt;è¿™æ˜¯ä»&lt;code&gt;Block 2&lt;/code&gt;å‡ºå‘çš„ä¸¤æ¡è¾¹ï¼Œåˆ†åˆ«æŒ‡å‘&lt;code&gt;Block 6&lt;/code&gt;å’Œ&lt;code&gt;Block 3&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥100%è‡ªåŠ¨åŒ–åœ°é‡å»ºåŸå§‹çš„CFG&lt;/p&gt;
</description>
        </item>
        <item>
        <title>é€†å‘åŸºç¡€4ï¼šPEæ–‡ä»¶</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%804pe%E6%96%87%E4%BB%B6/</link>
        <pubDate>Sun, 12 Oct 2025 23:25:42 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%804pe%E6%96%87%E4%BB%B6/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/d9dc6363235d1bc4e4bf2e1debb14e39.jpg" alt="Featured image of post é€†å‘åŸºç¡€4ï¼šPEæ–‡ä»¶" /&gt;&lt;p&gt;åŒæ ·æ˜¯å¾ˆé‡è¦çš„æ–‡ä»¶æ ¼å¼ï¼Œæœ¬ç¯‡è®¾è®¡åˆ°ä¸€äº›ç®€å•é€»è¾‘è®¡ç®—ï¼Œä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://thunderjie.github.io/2019/03/27/PE%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PEç»“æ„è¯¦è§£
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;peæ–‡ä»¶çš„ç±»åˆ«&#34;&gt;PEæ–‡ä»¶çš„ç±»åˆ«
&lt;/h1&gt;&lt;p&gt;PEæ–‡ä»¶æ ¼å¼æ˜¯Windowsæ“ä½œç³»ç»Ÿä¸‹ä½¿ç”¨çš„æ ‡å‡†å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼ŒæŒ‰ç…§ç³»ç»Ÿåˆ’åˆ†ä¸€èˆ¬æœ‰ä¸¤ä¸ªç§°å‘¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PE32ï¼šæŒ‡32ä½çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæœ‰äººç›´æ¥ç”¨PEä»£æŒ‡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PE32+ï¼š64ä½ç³»ç»Ÿä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ˜¯PE32æ ¼å¼çš„ä¸€ä¸ªæ‰©å±•ï¼Œä¹Ÿè¢«å«åšPE+&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PEæ ¼å¼æ¶µç›–äº†å¤šç§æ–‡ä»¶ç±»å‹ï¼Œå®ƒä»¬é€šè¿‡ä¸åŒçš„æ‰©å±•åæ¥åŒºåˆ†ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ç§ç±»&lt;/th&gt;
          &lt;th&gt;ä¸»æ‰©å±•å&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;å¯æ‰§è¡Œç³»åˆ—&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;.exe&lt;/code&gt;ï¼Œ&lt;code&gt;.scr&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;åº“ç³»åˆ—&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;.dll&lt;/code&gt;ï¼Œ&lt;code&gt;.ocx&lt;/code&gt;ï¼Œ&lt;code&gt;.cpl&lt;/code&gt;ï¼Œ&lt;code&gt;.drv&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;é©±åŠ¨ç¨‹åºç³»åˆ—&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;.sys&lt;/code&gt;ï¼Œ&lt;code&gt;.vxd&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;å¯¹è±¡æ–‡ä»¶ç³»åˆ—&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;.obj&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å…¶ä¸­ï¼Œé™¤äº†ç”¨äºé“¾æ¥è¿‡ç¨‹çš„å¯¹è±¡æ–‡ä»¶ï¼ˆ&lt;code&gt;.obj&lt;/code&gt;ï¼‰ä¹‹å¤–ï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶éƒ½èƒ½å¤Ÿè¢«ç³»ç»ŸåŠ è½½å¹¶æ‰§è¡Œ&lt;/p&gt;
&lt;h1 id=&#34;pe32æ–‡ä»¶çš„åŸºæœ¬ç»“æ„&#34;&gt;PE32æ–‡ä»¶çš„åŸºæœ¬ç»“æ„
&lt;/h1&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;1&#34; href=&#34;http://picture.928330.xyz/typora/1.jpg&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/1.jpg&#34; alt=&#34;1&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;doså¤´&#34;&gt;DOSå¤´
&lt;/h2&gt;&lt;p&gt;PEç»“æ„çš„æœ€å‰ç«¯æ˜¯DOSå¤´ï¼Œè¿™æ˜¯ä¸€ä¸ªå†å²é—ç•™çš„ç»“æ„ï¼Œä¸»è¦ä¸ºäº†å…¼å®¹å¤è€çš„MS-DOSç³»ç»Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_DOS_HEADER&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_magic&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// é­”æ•°ï¼Œå¿…é¡»æ˜¯ 0x5A4Dï¼Œå³â€œMZâ€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_cblp&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_cp&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_crlc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_cparhdr&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_minalloc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_maxalloc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_ss&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_sp&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_csum&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_ip&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_cs&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_lfarlc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_ovno&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_res&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_oemid&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_oeminfo&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_res2&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;LONG&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;e_lfanew&lt;/span&gt;;     &lt;span style=&#34;color:#7f848e&#34;&gt;// æŒ‡å‘ PE å¤´çš„åç§»
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_DOS_HEADER&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_DOS_HEADER&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿˜æ˜¯ä½¿ç”¨ä¸€ä¸ªhello.cç”Ÿæˆçš„exeæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;Hello, World!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œç”¨010editoræŸ¥çœ‹exeæ–‡ä»¶çš„äºŒè¿›åˆ¶ï¼Œå®ƒæœ‰æ¨¡ç‰ˆåŠŸèƒ½ï¼Œèƒ½å¾ˆå¥½çš„å±•ç¤ºPEæ–‡ä»¶çš„ç»“æ„ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012120832329&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012120832329.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012120832329.png&#34; alt=&#34;image-20251012120832329&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;PEçš„èµ·å§‹ä¸¤ä¸ªå­—èŠ‚æ˜¯å›ºå®šçš„ç­¾åâ€œMZâ€ï¼ˆ&lt;code&gt;0x4D5A&lt;/code&gt;ï¼‰ï¼Œæ˜¯è¯†åˆ«ä¸€ä¸ªPEæ–‡ä»¶çš„æœ€åˆæ­¥æ ‡å¿—&lt;/p&gt;
&lt;p&gt;DOSå¤´æœ€é‡è¦çš„ä½œç”¨æ˜¯å…¶æœ«å°¾çš„å››å­—èŠ‚çš„&lt;code&gt;e_lfanew&lt;/code&gt;å­—æ®µï¼Œè¯¥å­—æ®µä¿å­˜äº†æŒ‡å‘NTå¤´çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯PEç¨‹åºçš„çœŸæ­£å…¥å£&lt;/p&gt;
&lt;h2 id=&#34;doså­˜æ ¹&#34;&gt;DOSå­˜æ ¹
&lt;/h2&gt;&lt;p&gt;ç´§éšDOSå¤´ä¹‹åçš„æ˜¯ä¸€æ®µå¯é€‰çš„DOSå­˜æ ¹ï¼ˆDOS Stubï¼‰å°ç¨‹åº&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012125641309&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012125641309.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012125641309.png&#34; alt=&#34;image-20251012125641309&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¸œè¥¿çš„ç”±æ¥æ¯”è¾ƒå¥½ç©ï¼Œä¹Ÿç¨å¾®è®²è®²&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šä¸–çºª80ï½90å¹´ä»£åˆæœŸï¼Œä¸ªäººç”µè„‘ä¸»è¦è¿è¡ŒMS-DOSç³»ç»Ÿï¼Œé‚£æ—¶å€™çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼æ˜¯MZæ ¼å¼ï¼Œç”±å¾®è½¯å·¥ç¨‹å¸ˆMark Zbikowskiè®¾è®¡ï¼ˆä»–åå­—çš„é¦–å­—æ¯å°±æ˜¯MZï¼‰&lt;/p&gt;
&lt;p&gt;åæ¥åˆ°äº†Windows3.xï¼Œå¾®è½¯å¼•å…¥äº†PEæ ¼å¼ï¼Œä½†é‚£æ—¶çš„å¾ˆå¤šç”µè„‘è¿˜ç»å¸¸åœ¨DOSæ¨¡å¼ä¸‹å¯åŠ¨ï¼Œç”¨æˆ·å¦‚æœç›´æ¥åœ¨DOSå‘½ä»¤è¡Œä¸­é‡Œè¿è¡Œä¸€ä¸ªPEæ ¼å¼çš„ç¨‹åºå°±ä¼šå‡ºç°é—®é¢˜ï¼šDOSæ ¹æœ¬ä¸è®¤è¯†PEæ ¼å¼ï¼&lt;/p&gt;
&lt;p&gt;å¾®è½¯ä¸å¸Œæœ›è®©DOSæŠ¥é”™æˆ–è€…æ­»æœºï¼Œäºæ˜¯åšäº†è¿™æ ·çš„è®¾è®¡ï¼šåœ¨æ–°æ ¼å¼çš„å¼€å¤´ä¿ç•™äº†ä¸€ä¸ªæ—§çš„MZå¤´å’Œä¸€å°æ®µèƒ½åœ¨DOSä¸‹æ‰§è¡Œçš„ç¨‹åºï¼Œè¿™å°±æ˜¯DOSå­˜æ ¹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœåœ¨çº¯DOSç¯å¢ƒä¸‹å°è¯•è¿è¡Œä¸€ä¸ªç°ä»£çš„Windowsç¨‹åºï¼Œè¿™æ®µå­˜æ ¹ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œå®ƒé€šå¸¸åªä¼šåœ¨å±å¹•ä¸Šæ‰“å°ä¸€å¥æç¤ºä¿¡æ¯â€œThis program cannot be run in DOS modeâ€ï¼Œç„¶åæ­£å¸¸é€€å‡º&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è€Œåœ¨windowsç¯å¢ƒä¸‹ï¼Œå½“windowsè¯†åˆ«åˆ°è¿™æ˜¯ä¸€ä¸ªPEæ–‡ä»¶ï¼Œå°±ä¼šç›´æ¥è·³è½¬åˆ°æ–‡ä»¶åç§»&lt;code&gt;e_lfanew&lt;/code&gt;å¤„ï¼ŒDOSå­˜æ ¹ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰&lt;/strong&gt;&lt;del&gt;æ‰€ä»¥å¯ä»¥éšä¾¿æ”¹è¿™ä¸€æ®µä¹Ÿä¸ä¼šå‡ºé”™&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ ·æ—¢ä¿è¯äº†å…¼å®¹æ€§ï¼Œä¹Ÿé¿å…äº†é”™è¯¯ï¼Œè¿˜æ˜¯æŒºä¸é”™çš„&lt;/p&gt;
&lt;h2 id=&#34;ntå¤´&#34;&gt;NTå¤´
&lt;/h2&gt;&lt;p&gt;NTå¤´æ˜¯PEæ ¼å¼çš„æ ¸å¿ƒå¤´éƒ¨ï¼ŒåŒ…å«äº†å…³äºæ–‡ä»¶çš„å¤§é‡å…³é”®ä¿¡æ¯ï¼Œå®ƒç”±ä¸€ä¸ªç­¾åå’Œä¸¤ä¸ªé‡è¦çš„å­ç»“æ„ç»„æˆ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_NT_HEADERS&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Signature&lt;/span&gt;;                                                    &lt;span style=&#34;color:#7f848e&#34;&gt;// ç­¾å &amp;#34;PE\0\0&amp;#34; (0x00004550)ï¼Œå››å­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_FILE_HEADER&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FileHeader&lt;/span&gt;;                              &lt;span style=&#34;color:#7f848e&#34;&gt;// æ–‡ä»¶å¤´ï¼Œ20å­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_OPTIONAL_HEADER32&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;OptionalHeader&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯é€‰å¤´ï¼ˆå¯¹äº32ä½ï¼‰ï¼Œ32ä½ä¸‹224å­—èŠ‚ï¼Œ 64ä½ä¸‹240å­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_NT_HEADERS32&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_NT_HEADERS32&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŠ è½½å™¨é€šè¿‡ç­¾åç¡®è®¤æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„PEæ–‡ä»¶&lt;/p&gt;
&lt;h3 id=&#34;æ–‡ä»¶å¤´&#34;&gt;æ–‡ä»¶å¤´
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_FILE_HEADER&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Machine&lt;/span&gt;;              &lt;span style=&#34;color:#7f848e&#34;&gt;// è¿è¡Œå¹³å°ï¼ˆå¦‚ x86 = 0x14Cï¼Œx64 = 0x8664ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfSections&lt;/span&gt;;     &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åŒºæ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TimeDateStamp&lt;/span&gt;;        &lt;span style=&#34;color:#7f848e&#34;&gt;// æ—¶é—´æˆ³ï¼ˆæ–‡ä»¶ç¼–è¯‘æ—¶é—´ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToSymbolTable&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// è°ƒè¯•ç¬¦å·è¡¨æŒ‡é’ˆï¼ˆç°ä»£ PE é€šå¸¸ä¸º 0ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfSymbols&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¬¦å·æ•°é‡ï¼ˆé€šå¸¸ä¸º 0ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfOptionalHeader&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯é€‰å¤´å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// æ–‡ä»¶å±æ€§æ ‡å¿—ä½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_FILE_HEADER&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_FILE_HEADER&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¯é€‰å¤´&#34;&gt;å¯é€‰å¤´
&lt;/h3&gt;&lt;p&gt;ä¹Ÿæœ‰ç§°å‘¼å…¶ä¸ºæ‰©å±•å¤´çš„&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_OPTIONAL_HEADER32&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Magic&lt;/span&gt;;                       &lt;span style=&#34;color:#7f848e&#34;&gt;// æ ‡è¯†ç±»å‹ï¼š0x10B è¡¨ç¤º PE32ï¼Œ0x20B è¡¨ç¤º PE32+
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BYTE&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MajorLinkerVersion&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// é“¾æ¥å™¨ä¸»ç‰ˆæœ¬å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BYTE&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MinorLinkerVersion&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// é“¾æ¥å™¨æ¬¡ç‰ˆæœ¬å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfCode&lt;/span&gt;;                  &lt;span style=&#34;color:#7f848e&#34;&gt;// ä»£ç æ®µæ€»å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfInitializedData&lt;/span&gt;;       &lt;span style=&#34;color:#7f848e&#34;&gt;// å·²åˆå§‹åŒ–æ•°æ®æ®µå¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfUninitializedData&lt;/span&gt;;     &lt;span style=&#34;color:#7f848e&#34;&gt;// æœªåˆå§‹åŒ–æ•°æ®æ®µå¤§å°ï¼ˆ.bssï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AddressOfEntryPoint&lt;/span&gt;;         &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¨‹åºå…¥å£ç‚¹ï¼ˆRVAï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;BaseOfCode&lt;/span&gt;;                  &lt;span style=&#34;color:#7f848e&#34;&gt;// ä»£ç æ®µèµ·å§‹ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;BaseOfData&lt;/span&gt;;                  &lt;span style=&#34;color:#7f848e&#34;&gt;// æ•°æ®æ®µèµ·å§‹ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ImageBase&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¨‹åºé¦–é€‰è£…è½½åŸºå€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SectionAlignment&lt;/span&gt;;            &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åŒºåœ¨å†…å­˜ä¸­çš„å¯¹é½å•ä½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FileAlignment&lt;/span&gt;;                  &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åŒºåœ¨æ–‡ä»¶ä¸­çš„å¯¹é½å•ä½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MajorOperatingSystemVersion&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// ç›®æ ‡æ“ä½œç³»ç»Ÿä¸»ç‰ˆæœ¬
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MinorOperatingSystemVersion&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¬¡ç‰ˆæœ¬
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MajorImageVersion&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¨‹åºç‰ˆæœ¬å·ï¼ˆä¸»ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MinorImageVersion&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ç¨‹åºç‰ˆæœ¬å·ï¼ˆæ¬¡ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MajorSubsystemVersion&lt;/span&gt;;       &lt;span style=&#34;color:#7f848e&#34;&gt;// å­ç³»ç»Ÿç‰ˆæœ¬å·ï¼ˆä¸»ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;MinorSubsystemVersion&lt;/span&gt;;       &lt;span style=&#34;color:#7f848e&#34;&gt;// å­ç³»ç»Ÿç‰ˆæœ¬å·ï¼ˆæ¬¡ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Win32VersionValue&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™ï¼ˆä¸€èˆ¬ä¸º 0ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfImage&lt;/span&gt;;                 &lt;span style=&#34;color:#7f848e&#34;&gt;// æ˜ åƒåœ¨å†…å­˜ä¸­çš„æ€»å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfHeaders&lt;/span&gt;;               &lt;span style=&#34;color:#7f848e&#34;&gt;// æ‰€æœ‰å¤´éƒ¨çš„æ€»å¤§å°ï¼ˆå¯¹é½åï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CheckSum&lt;/span&gt;;                    &lt;span style=&#34;color:#7f848e&#34;&gt;// æ ¡éªŒå’Œï¼ˆç³»ç»Ÿæ–‡ä»¶ä½¿ç”¨ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Subsystem&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// å­ç³»ç»Ÿç±»å‹ï¼ˆGUIã€CUI ç­‰ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;DllCharacteristics&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL ç‰¹æ€§æ ‡å¿—
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfStackReserve&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™çš„æ ˆç©ºé—´å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfStackCommit&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// å·²æäº¤çš„æ ˆç©ºé—´å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfHeapReserve&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™çš„å †ç©ºé—´å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfHeapCommit&lt;/span&gt;;            &lt;span style=&#34;color:#7f848e&#34;&gt;// å·²æäº¤çš„å †ç©ºé—´å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LoaderFlags&lt;/span&gt;;                 &lt;span style=&#34;color:#7f848e&#34;&gt;// åŠ è½½æ ‡å¿—ï¼ˆä¿ç•™ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfRvaAndSizes&lt;/span&gt;;         &lt;span style=&#34;color:#7f848e&#34;&gt;// æ•°æ®ç›®å½•æ•°é‡ï¼ˆä¸€èˆ¬ä¸º 16ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_DATA_DIRECTORY&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DataDirectory&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;]; &lt;span style=&#34;color:#7f848e&#34;&gt;// æ•°æ®ç›®å½•æ•°ç»„ï¼ˆå¯¼å…¥è¡¨ã€å¯¼å‡ºè¡¨ç­‰ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_OPTIONAL_HEADER32&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_OPTIONAL_HEADER32&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ç¨‹åºçš„çœŸæ­£å…¥å£ç‚¹ = &lt;code&gt;ImageBase&lt;/code&gt; + &lt;code&gt;AddressOfEntryPoint&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è™šæ‹Ÿåœ°å€ (Virtual Address, VA)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¨‹åºåœ¨å†…å­˜ä¸­æ‰§è¡Œæ—¶ä½¿ç”¨çš„ç»å¯¹åœ°å€&lt;/p&gt;
&lt;p&gt;åœ¨32ä½ç³»ç»Ÿä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª0x00000000åˆ°0xFFFFFFFFèŒƒå›´å†…çš„å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ˜ åƒåŸºå€ (ImageBase)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PEæ˜ åƒåœ¨å†…å­˜ä¸­çš„èµ·å§‹è™šæ‹Ÿåœ°å€&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å€¼ï¼ŒåŠ è½½å™¨ä¼šä¼˜å…ˆå°è¯•å°†æ–‡ä»¶åŠ è½½åˆ°è¿™é‡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›¸å¯¹è™šæ‹Ÿåœ°å€ (Relative Virtual Address, RVA)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹äº&lt;code&gt;ImageBase&lt;/code&gt;çš„åç§»é‡&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨åˆ›å»ºPEæ–‡ä»¶æ—¶ï¼Œæ— æ³•é¢„çŸ¥å®ƒæœ€ç»ˆä¼šè¢«åŠ è½½åˆ°å†…å­˜çš„å“ªä¸ªç¡®åˆ‡ä½ç½®ï¼Œå› æ­¤PEæ–‡ä»¶å†…éƒ¨çš„å¤§éƒ¨åˆ†åœ°å€ä¿¡æ¯éƒ½ä»¥RVAçš„å½¢å¼å­˜åœ¨ï¼Œè¿™æ ·ä¾¿äºåç»­çš„é‡å®šä½&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¬å¼ï¼š&lt;code&gt;VA = RVA + ImageBase&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹åç§» (RAW offset)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„ä½ç½®ï¼Œç›¸å¯¹äºæ–‡ä»¶å¼€å¤´çš„åç§»é‡ï¼Œèµ·å§‹å€¼ä¸º0ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨åå…­è¿›åˆ¶æŸ¥çœ‹å™¨é‡Œé¢çœ‹åˆ°çš„åœ°å€å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012143534278&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012143534278.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012143534278.png&#34; alt=&#34;image-20251012143534278&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;èŠ‚è¡¨&#34;&gt;èŠ‚è¡¨
&lt;/h2&gt;&lt;p&gt;ç´§è·Ÿåœ¨NTå¤´åé¢çš„æ˜¯èŠ‚è¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒç”±å¤šä¸ªèŠ‚åŒºå¤´ç»“æ„&lt;code&gt;IMAGE_SECTION_HEADER&lt;/code&gt;ç»“æ„ç»„æˆ&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶ä¸­æœ‰å¤šå°‘ä¸ªèŠ‚åŒºï¼Œå°±æœ‰å¤šå°‘ä¸ªèŠ‚åŒºå¤´ï¼ŒèŠ‚è¡¨å°±æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Œè¯¦ç»†æè¿°ç€PEä½“ä¸­å¯¹åº”èŠ‚åŒºçš„å±æ€§&lt;/p&gt;
&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;å’ŒELFçš„èŠ‚ç±»ä¼¼ï¼ŒPEçš„èŠ‚ä¹Ÿç”¨äºåˆ†ç±»å„ç§ä¸åŒçš„æ•°æ®&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ä¸åŒçš„æ˜¯ï¼ŒPEçš„èŠ‚æ˜¯ç›´æ¥å‚ä¸åˆ°ç¨‹åºè¿è¡Œä¸­çš„ï¼Œè€ŒELFåˆ™ä¾é æ®µè¿è¡Œï¼ŒèŠ‚åˆ æ‰ä¹Ÿæ— æ‰€è°“&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¢è¨€ä¹‹ï¼ŒPEçš„èŠ‚æ›´åƒæ˜¯ELFèŠ‚ä¸æ®µçš„ç»“åˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼ŒPEèŠ‚çš„åç§°ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›å¸¸è§çš„èŠ‚ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ä½œç”¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.text&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯æ‰§è¡Œä»£ç &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.data&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å·²åˆå§‹åŒ–æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.rdata&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åªè¯»æ•°æ®ï¼ˆå¸¸é‡ã€å­—ç¬¦ä¸²ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.bss&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æœªåˆå§‹åŒ–æ•°æ®ï¼ˆé€šå¸¸ä¸å æ–‡ä»¶ç©ºé—´ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.rsrc&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;èµ„æºï¼ˆå›¾æ ‡ã€èœå•ã€å¯¹è¯æ¡†ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.reloc&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;é‡å®šä½è¡¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.idata&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯¼å…¥è¡¨ï¼ˆImport Tableï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.edata&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯¼å‡ºè¡¨ï¼ˆExport Tableï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;æ¯ä¸ªèŠ‚åŒºå¤´å¤§å°å›ºå®šä¸º40å­—èŠ‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#define IMAGE_SIZEOF_SHORT_NAME 8
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_SECTION_HEADER&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BYTE&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_SIZEOF_SHORT_NAME&lt;/span&gt;]; &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åç§°ï¼Œä¾‹å¦‚ &amp;#34;.text&amp;#34; &amp;#34;.data&amp;#34; &amp;#34;.rdata&amp;#34; &amp;#34;.rsrc&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PhysicalAddress&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualSize&lt;/span&gt;;               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åŒºåœ¨å†…å­˜ä¸­çš„å¤§å°ï¼ˆRVAå¯¹åº”ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    } &lt;span style=&#34;color:#e06c75&#34;&gt;Misc&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualAddress&lt;/span&gt;;                     &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨å†…å­˜ä¸­çš„ RVAï¼ˆç›¸å¯¹äº ImageBaseï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfRawData&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨æ–‡ä»¶ä¸­çš„å¤§å°ï¼ˆç£ç›˜å¯¹é½åçš„å­—èŠ‚æ•°ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToRawData&lt;/span&gt;;               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚åœ¨æ–‡ä»¶ä¸­çš„èµ·å§‹åç§»
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToRelocations&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// é‡å®šä½è¡¨æŒ‡é’ˆï¼ˆå¦‚æœæœ‰é‡å®šä½ä¿¡æ¯ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PointerToLinenumbers&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// è¡Œå·ä¿¡æ¯æŒ‡é’ˆï¼ˆè°ƒè¯•ç”¨ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfRelocations&lt;/span&gt;;             &lt;span style=&#34;color:#7f848e&#34;&gt;// é‡å®šä½è¡¨æ¡ç›®æ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfLinenumbers&lt;/span&gt;;            &lt;span style=&#34;color:#7f848e&#34;&gt;// è¡Œå·æ¡ç›®æ•°é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;;                               &lt;span style=&#34;color:#7f848e&#34;&gt;// èŠ‚ç‰¹æ€§æ ‡å¿—ï¼ˆå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œç­‰ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_SECTION_HEADER&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_SECTION_HEADER&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°å„ä¸ªèŠ‚åŒºçš„å¤§å°å›ºå®šï¼Œä¸è¶³çš„éƒ½ä½¿ç”¨0å¡«å……äº†ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012145412911&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012145412911.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012145412911.png&#34; alt=&#34;image-20251012145412911&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¡¨ç¤ºPEå¤´ï¼ˆDOSå¤´ + DOS Stub + NTå¤´ + èŠ‚è¡¨ï¼‰çš„å¤§å°çš„å­—æ®µ&lt;code&gt;SizeOfHeaders&lt;/code&gt;æ˜¯æ ¹æ®NTå¤´çš„æ–‡ä»¶å¤´çš„æ–‡ä»¶åœ¨&lt;strong&gt;ç£ç›˜&lt;/strong&gt;çš„å¯¹é½å­—æ®µ&lt;code&gt;FileAlignment&lt;/code&gt;å¯¹é½çš„ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;SizeOfHeaders&lt;/code&gt;çš„å¤§å°æŒ‰ç…§&lt;code&gt;FileAlignment&lt;/code&gt;å‘ä¸Šå–æ•´ï¼Œè¿™ç§å¤§å°ç§°ä½œ&lt;code&gt;SizeOfRawData&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–è¿˜æœ‰&lt;code&gt;SectionAlignment&lt;/code&gt;ï¼Œè¿™æ˜¯æ–‡ä»¶åœ¨&lt;strong&gt;å†…å­˜&lt;/strong&gt;çš„å¯¹é½å¤§å°ï¼Œä¸€èˆ¬è¦æ¯”&lt;code&gt;FileAlignment&lt;/code&gt;å¤§å¾—å¤šï¼Œè™½ç„¶æ¯”è¾ƒç¨€ç–æµªè´¹ç©ºé—´ï¼Œä½†å¯ä»¥æé«˜CPUè®¿é—®æ•ˆç‡ï¼Œè¿™ç§å¤§å°ç§°ä½œ&lt;code&gt;VirtualSize&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æˆ‘ä»¬èƒ½çœ‹è§ç¤ºä¾‹exeé‡Œé¢çš„å…·ä½“æ•°æ®ï¼Œ&lt;code&gt;SizeOfHeaders&lt;/code&gt;çš„ç¡®æ˜¯&lt;code&gt;FileAlignment&lt;/code&gt;çš„æ•´æ•°å€ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012142942423&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012142942423.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012142942423.png&#34; alt=&#34;image-20251012142942423&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è€ŒPEå¤´ç»“æŸå¤„åœ°å€ä¹Ÿç¡®å®æ˜¯&lt;code&gt;600h&lt;/code&gt;ï¼Œä¸è¶³çš„åœ°æ–¹éƒ½è¡¥0äº†ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012141813286&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012141813286.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012141813286.png&#34; alt=&#34;image-20251012141813286&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¥½çš„å·¥å…·æŸ¥çœ‹&#34;&gt;æ›´å¥½çš„å·¥å…·æŸ¥çœ‹
&lt;/h2&gt;&lt;p&gt;è™½ç„¶010æœ‰æ¨¡ç‰ˆåŠŸèƒ½ï¼Œä½†ç»ˆç©¶ä¸æ˜¯å¾ˆç›´è§‚ï¼Œè¦æ‰¾æŸä¸€ä¸ªå­—æ®µè¿˜æ˜¯æœ‰äº›å›°éš¾&lt;/p&gt;
&lt;p&gt;ç°åœ¨å·²ç»æœ‰å¾ˆå¤šPEæ–‡ä»¶ç»“æ„æŸ¥çœ‹å™¨ï¼Œæ¯”å¦‚PEviewï¼Œå°±èƒ½å¾ˆæ–¹ä¾¿æŸ¥çœ‹PEæ–‡ä»¶ç»“æ„ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012193311068.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012193311068.png&#34; alt=&#34;&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h1 id=&#34;åŠ¨æ€é“¾æ¥&#34;&gt;åŠ¨æ€é“¾æ¥
&lt;/h1&gt;&lt;h2 id=&#34;åŠ¨æ€é“¾æ¥åº“dll&#34;&gt;åŠ¨æ€é“¾æ¥åº“ï¼ˆDLLï¼‰
&lt;/h2&gt;&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯dll&#34;&gt;ä»€ä¹ˆæ˜¯DLL
&lt;/h3&gt;&lt;p&gt;DLLæ˜¯ä¸€ä¸ªç‹¬ç«‹äºä¸»ç¨‹åºæ–‡ä»¶ä¹‹å¤–çš„ç¨‹åºåº“æ–‡ä»¶ï¼Œå®ƒåŒ…å«å¯è¢«å¤šä¸ªåº”ç”¨ç¨‹åºå…±äº«ä½¿ç”¨çš„ä»£ç ã€æ•°æ®å’Œèµ„æº&lt;/p&gt;
&lt;p&gt;ä¸é™æ€é“¾æ¥å°†LIBåº“ä»£ç ç›´æ¥åµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ä¸åŒï¼ŒDLLçš„ä»£ç å’Œæ•°æ®åœ¨ç¨‹åºç¼–è¯‘æ—¶å¹¶ä¸åˆå¹¶ï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰è¢«é“¾æ¥åˆ°ä¸»ç¨‹åºä¸­ï¼Œå°±åƒELFçš„&lt;code&gt;.so&lt;/code&gt;å…±äº«æ–‡ä»¶&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ç‰¹æ€§&lt;/th&gt;
          &lt;th&gt;é™æ€åº“ï¼ˆ.libï¼‰&lt;/th&gt;
          &lt;th&gt;åŠ¨æ€åº“ï¼ˆ.dllï¼‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;é“¾æ¥æ—¶æœº&lt;/td&gt;
          &lt;td&gt;ç¼–è¯‘/é“¾æ¥é˜¶æ®µç›´æ¥åµŒå…¥ EXE&lt;/td&gt;
          &lt;td&gt;ç¨‹åºè¿è¡Œæ—¶æ‰åŠ è½½ï¼ˆåŠ¨æ€é“¾æ¥ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å…±äº«æ€§&lt;/td&gt;
          &lt;td&gt;æ¯ä¸ªEXEæ‹¥æœ‰ç‹¬ç«‹å‰¯æœ¬&lt;/td&gt;
          &lt;td&gt;å¤šä¸ªè¿›ç¨‹å¯å…±äº«åŒä¸€ DLLçš„ä»£ç æ®µ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ–‡ä»¶å¤§å°&lt;/td&gt;
          &lt;td&gt;EXEæ–‡ä»¶å¢å¤§&lt;/td&gt;
          &lt;td&gt;EXEæ–‡ä»¶è¾ƒå°ï¼ŒDLLç‹¬ç«‹å­˜åœ¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ›´æ–°&lt;/td&gt;
          &lt;td&gt;æ›´æ–°åº“éœ€é‡æ–°ç¼–è¯‘ EXE&lt;/td&gt;
          &lt;td&gt;æ›´æ–°DLLä¸éœ€é‡æ–°ç¼–è¯‘EXEï¼ˆåªè¦æ¥å£æœªå˜ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;å¯ä»¥ä½¿ç”¨è½¯ä»¶dnspyå¯¹dllè¿›è¡Œé€†å‘&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h3 id=&#34;dllçš„è£…è½½æ–¹å¼&#34;&gt;DLLçš„è£…è½½æ–¹å¼
&lt;/h3&gt;&lt;h4 id=&#34;æ˜¾å¼é“¾æ¥explicit-linking&#34;&gt;æ˜¾å¼é“¾æ¥ï¼ˆExplicit Linkingï¼‰
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ç¨‹åºè¿è¡Œåˆ°å¯¹åº”ä»£ç çš„æ—¶å€™æ—¶æ‰è£…è½½DLL&lt;/strong&gt;ï¼Œä½¿ç”¨å®Œæ¯•åç«‹å³é‡Šæ”¾å†…å­˜&lt;/p&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨Windows APIå®Œæˆå¯¹DLLä¸­ç‰¹å®šå‡½æ•°çš„é“¾æ¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;HMODULE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;LoadLibrary&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;example.dll&amp;#34;&lt;/span&gt;);         &lt;span style=&#34;color:#7f848e&#34;&gt;// åŠ è½½ DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;FARPROC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;GetProcAddress&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;FunctionName&amp;#34;&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// è·å–å‡½æ•°åœ°å€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;FreeLibrary&lt;/span&gt;(&lt;span style=&#34;color:#e06c75&#34;&gt;hDll&lt;/span&gt;);                                 &lt;span style=&#34;color:#7f848e&#34;&gt;// å¸è½½ DLL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœå‘ç°æ²¡åŠæ³•è°ƒç”¨ç›®æ ‡DLLï¼Œç¨‹åºæ‰ä¼šæŠ¥é”™&lt;/p&gt;
&lt;h4 id=&#34;éšå¼é“¾æ¥implicit-linking&#34;&gt;éšå¼é“¾æ¥ï¼ˆImplicit Linkingï¼‰
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ç¨‹åºå¯åŠ¨æ—¶å°±è£…è½½æ‰€æœ‰éœ€è¦ä½¿ç”¨çš„DLL&lt;/strong&gt;ï¼Œç¨‹åºç»ˆæ­¢æ—¶æ‰é‡Šæ”¾å ç”¨çš„å†…å­˜&lt;/p&gt;
&lt;p&gt;åœ¨EXEç¼–è¯‘æ—¶å°±å£°æ˜ä¾èµ–DLLï¼ŒWindowsåŠ è½½å™¨åœ¨è¿›ç¨‹åˆå§‹åŒ–æ—¶æ‰«æEXEçš„å¯¼å…¥è¡¨ï¼Œå¹¶åŠ è½½æ‰€æœ‰ä¾èµ–DLL&lt;/p&gt;
&lt;p&gt;å¦‚æœDLLç¼ºå¤±ï¼Œç¨‹åºå¯åŠ¨ä¼šå¤±è´¥&lt;/p&gt;
&lt;h2 id=&#34;å¯¼å…¥è¡¨&#34;&gt;å¯¼å…¥è¡¨
&lt;/h2&gt;&lt;p&gt;å½“ä¸€ä¸ªPEæ–‡ä»¶éœ€è¦è°ƒç”¨å…¶ä»–DLLæä¾›çš„å‡½æ•°ï¼ˆç§°ä¸ºå¯¼å…¥å‡½æ•°ï¼‰æ—¶ï¼Œå®ƒå°±é€šè¿‡å¯¼å…¥è¡¨æ¥è®°å½•è¿™äº›ä¾èµ–å…³ç³»&lt;/p&gt;
&lt;p&gt;PEæ–‡ä»¶åŠ è½½æ—¶ï¼ŒWindowsåŠ è½½å™¨ä¼šè¯»å–å…¶å¯¼å…¥è¡¨ï¼Œå¾—çŸ¥å®ƒéœ€è¦å“ªäº›DLLï¼Œä¹‹ååŠ è½½å™¨ä¼šæ‰¾åˆ°å¹¶åŠ è½½è¿™äº›DLLï¼Œç„¶åæŸ¥è¯¢DLLçš„å¯¼å‡ºè¡¨ï¼Œæ‰¾åˆ°æ‰€éœ€å‡½æ•°çš„çœŸå®å†…å­˜åœ°å€ï¼Œæœ€åå°†è¿™ä¸ªåœ°å€å¡«å…¥PEæ–‡ä»¶çš„å¯¼å…¥åœ°å€è¡¨ä¸­&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å…¥è¡¨ç›®å½•&#34;&gt;å¯¼å…¥è¡¨ç›®å½•
&lt;/h3&gt;&lt;p&gt;ä¸çŸ¥é“ä½ æ˜¯å¦è¿˜è®°å¾—ï¼Œåœ¨ä¹‹å‰ä»‹ç»å¯é€‰å¤´çš„æ—¶å€™ï¼Œç»“æ„ä½“é‡Œé¢æœ€åæœ‰ä¸€ä¸ªæ•°ç»„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_DATA_DIRECTORY&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DataDirectory&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ç¬¬2ä¸ªå…ƒç´ ï¼ˆ&lt;code&gt;OptionalHeader.DataDirectory[1]&lt;/code&gt;ï¼‰å°±æ˜¯&lt;strong&gt;å¯¼å…¥è¡¨çš„ç›®å½•&lt;/strong&gt;ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_DATA_DIRECTORY&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualAddress&lt;/span&gt;; &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å…¥è¡¨åœ¨æ–‡ä»¶å†…å­˜æ˜ åƒä¸­çš„RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Size&lt;/span&gt;;                  &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å…¥è¡¨å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_DATA_DIRECTORY&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒçš„ä½œç”¨å°±æ˜¯æŒ‡å‘å¯¼å…¥è¡¨çš„å¼€å¤´&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å…¥è¡¨ç»“æ„&#34;&gt;å¯¼å…¥è¡¨ç»“æ„
&lt;/h3&gt;&lt;p&gt;å¯¼å…¥è¡¨ç”±&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;æ•°ç»„æ„æˆï¼Œç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;OriginalFirstThunk&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;//å¯¼å…¥åç§°è¡¨ INT çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    };
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;TimeDateStamp&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ForwarderChain&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// é€šå¸¸ä¸º -1 æˆ– 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;;                    &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL åç§°çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FirstThunk&lt;/span&gt;;              &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯¼å…¥åœ°å€è¡¨ IAT çš„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¯¼å…¥åç§°è¡¨intä¸å¯¼å…¥åœ°å€è¡¨iat&#34;&gt;å¯¼å…¥åç§°è¡¨ï¼ˆINTï¼‰ä¸å¯¼å…¥åœ°å€è¡¨ï¼ˆIATï¼‰
&lt;/h3&gt;&lt;p&gt;å¯¼å…¥åç§°è¡¨ï¼ˆImport Name Tableï¼ŒINTï¼‰ä¸å¯¼å…¥åœ°å€è¡¨ï¼ˆImport Address Tableï¼ŒIATï¼‰éƒ½æ˜¯&lt;code&gt;IMAGE_THUNK_DATA&lt;/code&gt;ç»“æ„çš„æ•°ç»„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_THUNK_DATA32&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;union&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ForwarderString&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// è½¬å‘å­—ç¬¦ä¸²çš„RVAï¼ˆä¸å¸¸è§ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Function&lt;/span&gt;;         &lt;span style=&#34;color:#7f848e&#34;&gt;// å®é™…å‡½æ•°åœ°å€ï¼ˆIATåŠ è½½åå¡«å……ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Ordinal&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// æŒ‰åºå·å¯¼å…¥æ—¶çš„æ ‡å¿—å’Œåºå·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AddressOfData&lt;/span&gt;;    &lt;span style=&#34;color:#7f848e&#34;&gt;// æŒ‡å‘ IMAGE_IMPORT_BY_NAME çš„RVAï¼ˆINTæŒ‰åç§°å¯¼å…¥æ—¶ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    } &lt;span style=&#34;color:#e06c75&#34;&gt;u1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_THUNK_DATA32&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯¼å…¥åç§°è¡¨INTï¼ˆOriginalFirstThunkï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ¡ç›®æŒ‡å‘&lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;ï¼ŒåŒ…å«å¯¼å…¥å‡½æ•°çš„åç§°æˆ–åºå·ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_IMPORT_BY_NAME&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Hint&lt;/span&gt;;        &lt;span style=&#34;color:#7f848e&#34;&gt;// æç¤ºå€¼ï¼ˆç¼–è¯‘å™¨ç”Ÿæˆçš„ç´¢å¼•ï¼Œç”¨äºåŠ å¿«æŸ¥æ‰¾ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;BYTE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;];     &lt;span style=&#34;color:#7f848e&#34;&gt;// å‡½æ•°åç§°çš„å­—ç¬¦ä¸²ï¼Œä»¥&amp;#39;\0&amp;#39;ç»“å°¾
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_IMPORT_BY_NAME&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®°å½•å‡½æ•°ä¿¡æ¯ï¼Œä½†æœªè§£æçœŸå®åœ°å€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸å¯¼å…¥åœ°å€è¡¨IATï¼ˆFirstThunkï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨åŠ è½½å‰ï¼ŒIATå†…å®¹å’ŒINT ä¸€æ¨¡ä¸€æ ·&lt;/p&gt;
&lt;p&gt;åŠ è½½æ—¶WindowsåŠ è½½å™¨è§£æDLLä¸­å‡½æ•°å®é™…åœ°å€ï¼Œç„¶åè¦†ç›–IATå¯¹åº”æ¡ç›®&lt;/p&gt;
&lt;p&gt;ç¨‹åºè°ƒç”¨å‡½æ•°æ—¶ï¼Œé€šè¿‡IATä¸­çš„åœ°å€ç›´æ¥è·³è½¬&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PEæ–‡ä»¶åŠ è½½å‰ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;10&#34; href=&#34;http://picture.928330.xyz/typora/10.jpg&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/10.jpg&#34; alt=&#34;10&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;PEæ–‡ä»¶è¿è¡Œæ—¶ï¼š&lt;/p&gt;
&lt;p&gt;è¯»å–INTæ¡ç›®è·å–å‡½æ•°åï¼Œä½¿ç”¨DLLæ¨¡å—å¯¼å‡ºè¡¨æ‰¾åˆ°å‡½æ•°å®é™…åœ°å€ï¼Œè¦†ç›–IATå¯¹åº”æ¡ç›®&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;11&#34; href=&#34;http://picture.928330.xyz/typora/11.jpg&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/11.jpg&#34; alt=&#34;11&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹åˆ†ænotepadexeçš„å¯¼å…¥è¡¨&#34;&gt;ç¤ºä¾‹ï¼šåˆ†ænotepad.exeçš„å¯¼å…¥è¡¨
&lt;/h3&gt;&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;å…ˆåŒºåˆ†å‡ ä¸ªæ¦‚å¿µä»¥åŠå…¬å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è™šæ‹Ÿåœ°å€ (Virtual Address, VA)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¨‹åºåœ¨å†…å­˜ä¸­æ‰§è¡Œæ—¶ä½¿ç”¨çš„ç»å¯¹åœ°å€&lt;/p&gt;
&lt;p&gt;åœ¨32ä½ç³»ç»Ÿä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª0x00000000åˆ°0xFFFFFFFFèŒƒå›´å†…çš„å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ˜ åƒåŸºå€ (ImageBase)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PEæ˜ åƒåœ¨å†…å­˜ä¸­çš„èµ·å§‹è™šæ‹Ÿåœ°å€&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å€¼ï¼ŒåŠ è½½å™¨ä¼šä¼˜å…ˆå°è¯•å°†æ–‡ä»¶åŠ è½½åˆ°è¿™é‡Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›¸å¯¹è™šæ‹Ÿåœ°å€ (Relative Virtual Address, RVA)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹äº&lt;code&gt;ImageBase&lt;/code&gt;çš„åç§»é‡&lt;/p&gt;
&lt;p&gt;ç”±äºåœ¨åˆ›å»ºPEæ–‡ä»¶æ—¶ï¼Œæ— æ³•é¢„çŸ¥å®ƒæœ€ç»ˆä¼šè¢«åŠ è½½åˆ°å†…å­˜çš„å“ªä¸ªç¡®åˆ‡ä½ç½®ï¼Œå› æ­¤PEæ–‡ä»¶å†…éƒ¨çš„å¤§éƒ¨åˆ†åœ°å€ä¿¡æ¯éƒ½ä»¥RVAçš„å½¢å¼å­˜åœ¨ï¼Œè¿™æ ·ä¾¿äºåç»­çš„é‡å®šä½&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;VA&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;RVA&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ImageBase&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŸå§‹åç§» (RAW offset)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ•°æ®åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„ä½ç½®ï¼Œç›¸å¯¹äºæ–‡ä»¶å¼€å¤´çš„åç§»é‡ä¹Ÿå°±æ˜¯æ–‡ä»¶åç§»ï¼Œèµ·å§‹å€¼ä¸º0ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨åå…­è¿›åˆ¶æŸ¥çœ‹å™¨é‡Œé¢çœ‹åˆ°çš„åœ°å€å€¼&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä½ç½®ä¸€èˆ¬é€šè¿‡å·²çŸ¥çš„RAWç¡®å®šï¼Œç‰¹åˆ«æ˜¯èŠ‚çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ç›®æ ‡&lt;span style=&#34;color:#e06c75&#34;&gt;RAW&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; èŠ‚åœ¨æ–‡ä»¶ä¸­çš„èµ·å§‹ä½ç½® &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; (ç›®æ ‡&lt;span style=&#34;color:#e06c75&#34;&gt;RVA&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; èŠ‚åœ¨å†…å­˜ä¸­çš„èµ·å§‹è™šæ‹Ÿåœ°å€)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­&lt;code&gt;èŠ‚åœ¨å†…å­˜ä¸­çš„èµ·å§‹è™šæ‹Ÿåœ°å€&lt;/code&gt;å°±æ˜¯èŠ‚çš„RVAï¼Œ&lt;code&gt;èŠ‚åœ¨æ–‡ä»¶ä¸­çš„èµ·å§‹ä½ç½®&lt;/code&gt;å°±æ˜¯èŠ‚çš„RAW&lt;/p&gt;
&lt;p&gt;&lt;code&gt;RVA - èŠ‚åœ¨å†…å­˜ä¸­çš„èµ·å§‹è™šæ‹Ÿåœ°å€&lt;/code&gt;è®¡ç®—çš„å°±æ˜¯ç›®æ ‡åœ¨èŠ‚å†…çš„åç§»&lt;/p&gt;
&lt;p&gt;å°½é‡ç†è§£å§ï¼ŒçœŸæ˜¯å¼¯å¼¯åˆç»•ç»•&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;å…ˆåœ¨&lt;code&gt;OptionalHeader&lt;/code&gt;ä¸­æ‰¾åˆ°å¯¼å…¥è¡¨çš„RVAä¸º&lt;code&gt;0x2A5AC&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆè¿™ä¸ªå°±æ˜¯å¯é€‰å¤´æœ«å°¾æ•°ç»„çš„ç¬¬äºŒé¡¹&lt;code&gt;_IMAGE_DATA_DIRECTORY&lt;/code&gt;ï¼Œå­˜æ”¾äº†å¯¼å…¥è¡¨çš„RVAå’Œå¤§å°ï¼‰&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012193440142&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012193440142.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012193440142.png&#34; alt=&#34;image-20251012193440142&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬è¦å»æ‰¾åˆ°è¡¨è¢«å­˜å‚¨åœ¨äº†å“ªä¸ªèŠ‚é‡Œ&lt;/p&gt;
&lt;p&gt;å…ˆçœ‹ç¬¬ä¸€ä¸ª&lt;code&gt;.text&lt;/code&gt;èŠ‚ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯&lt;code&gt;RVA&lt;/code&gt;ã€&lt;code&gt;SizeOfRawData&lt;/code&gt;ã€&lt;code&gt;PointerToRawData&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;ImageBase&lt;/code&gt;åªæœ‰ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡&lt;code&gt;RVA&lt;/code&gt;åˆ¤æ–­ä½ç½®&lt;/p&gt;
&lt;p&gt;å› ä¸º&lt;code&gt;0x01000 + 0x26A00 ï¼œ 0x2A5AC&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¼å…¥è¡¨çš„ä½ç½®ä¸å¯èƒ½åœ¨&lt;code&gt;.text&lt;/code&gt;èŠ‚é‡Œé¢ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012193533307&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012193533307.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012193533307.png&#34; alt=&#34;image-20251012193533307&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;å°±è¿™æ ·é€ä¸ªå¾€ä¸‹æ‰¾ï¼Œèƒ½æ‰¾åˆ°å¯¼å…¥è¡¨ä½ç½®åœ¨&lt;code&gt;.idata&lt;/code&gt;èŠ‚ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012200435441&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012200435441.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012200435441.png&#34; alt=&#34;image-20251012200435441&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦æ±‚å‡ºå¯¼å…¥è¡¨çš„RAW&lt;/p&gt;
&lt;p&gt;çŸ¥é“äº†å¯¼å…¥è¡¨çš„RVAä¸º&lt;code&gt;0x2A5AC&lt;/code&gt;ï¼Œå†ç»“åˆ&lt;code&gt;.idata&lt;/code&gt;èŠ‚çš„RVA(&lt;code&gt;0x2A000&lt;/code&gt;)å’ŒRAW(&lt;code&gt;0x27800&lt;/code&gt;)ï¼Œå°±èƒ½è®¡ç®—å‡ºç¬¬ä¸€ä¸ª&lt;code&gt;IMAGE_IMPORT_DESCRIPTOR&lt;/code&gt;åœ¨æ–‡ä»¶ä¸­çš„RAWä¸º&lt;code&gt;0x2A5AC - 0x2A000 + 0x27800 = 0x27DAC&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€å¯¼å…¥è¡¨ï¼Œæœç„¶ç¬¬ä¸€é¡¹çš„INTåœ°å€å’Œæˆ‘ä»¬ç®—çš„ä¸€æ ·ï¼ˆå¯¼å…¥è¡¨ç»“æ„æœ€å‰é¢çš„å°±æ˜¯INTï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012200811269&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012200811269.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012200811269.png&#34; alt=&#34;image-20251012200811269&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ ¹æ®è¡¨é‡Œé¢å­˜å‚¨çš„INTçš„RVAï¼Œèƒ½è®¡ç®—å‡ºå®ƒçš„RAWï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;0x2A9C4 - 0x2A000 + 0x27800 = 0x281C4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹INTï¼Œè¿™ä¸ªåœ°å€å¯¹åº”çš„å°±æ˜¯ç¬¬ä¸€é¡¹ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012203024038&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012203024038.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012203024038.png&#34; alt=&#34;image-20251012203024038&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;INTå­˜å‚¨çš„æ˜¯&lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;çš„RVAï¼Œè¿˜æ˜¯è¿™æ ·ç®—å‡ºRAWï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;0x2B004 - 0x2A000 + 0x27800 = 0x28804&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ–‡ä»¶åç§»é‡Œèƒ½æ‰¾åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012203711363&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012203711363.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012203711363.png&#34; alt=&#34;image-20251012203711363&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯é€‰å¤´çš„å¯¼å‡ºè¡¨å…¥å£ -&amp;gt; å¯¼å‡ºè¡¨ -&amp;gt; INT -&amp;gt; &lt;code&gt;IMAGE_IMPORT_BY_NAME&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸€åˆ‡éƒ½åŸºäºå¯¹åº”èŠ‚çš„RAW&lt;/p&gt;
&lt;h2 id=&#34;å¯¼å‡ºè¡¨&#34;&gt;å¯¼å‡ºè¡¨
&lt;/h2&gt;&lt;p&gt;è£…è½½DLLæ–‡ä»¶æ—¶ï¼Œå®é™…ä¸Šä¹Ÿåˆ›å»ºäº†ä¸€ç³»åˆ—èƒ½å¤Ÿè¢«å…¶ä»–PEæ–‡ä»¶è°ƒç”¨çš„å‡½æ•°ï¼Œè€Œå¯¼å‡ºè¡¨å°±æ˜¯DLLæ–‡ä»¶ç”¨æ¥å‘Šè¯‰å¤–ç•Œå®ƒèƒ½æä¾›å“ªäº›å‡½æ•°çš„åŠŸèƒ½çš„ï¼ŒEXEæ–‡ä»¶é€šå¸¸æ²¡æœ‰å¯¼å‡ºè¡¨&lt;/p&gt;
&lt;p&gt;å’Œå¯¼å…¥è¡¨ä¸€æ ·ï¼Œå®ƒçš„åœ°å€ä¹Ÿåœ¨å¯é€‰å¤´æœ«å°¾çš„æ•°ç»„é‡Œï¼Œæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ &lt;code&gt;OptionalHeader.DataDirectory[0]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç»„æˆå¯¼å‡ºè¡¨çš„ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_EXPORT_DIRECTORY&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;Characteristics&lt;/span&gt;;        &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¿ç•™ï¼Œé€šå¸¸ä¸º 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;TimeDateStamp&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// æ—¶é—´æˆ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MajorVersion&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// ä¸»ç‰ˆæœ¬å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MinorVersion&lt;/span&gt;;           &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¬¡ç‰ˆæœ¬å·
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;Name&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// DLL åç§° RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;Base&lt;/span&gt;;                   &lt;span style=&#34;color:#7f848e&#34;&gt;// èµ·å§‹åºå·ï¼ˆOrdinals ä» Base å¼€å§‹ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfFunctions&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// EAT ä¸­å‡½æ•°æ€»æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;NumberOfNames&lt;/span&gt;;          &lt;span style=&#34;color:#7f848e&#34;&gt;// ENT ä¸­å‡½æ•°åæ€»æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;AddressOfFunctions&lt;/span&gt;;     &lt;span style=&#34;color:#7f848e&#34;&gt;// EAT RVAï¼ˆå‡½æ•°åœ°å€è¡¨ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;AddressOfNames&lt;/span&gt;;         &lt;span style=&#34;color:#7f848e&#34;&gt;// ENT RVAï¼ˆå‡½æ•°åè¡¨ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;AddressOfNameOrdinals&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// åºæ•°æ•°ç»„ RVA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_EXPORT_DIRECTORY&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PIMAGE_EXPORT_DIRECTORY&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªç»“æ„ä¸­åŒ…å«äº†ä¸‰ä¸ªé‡è¦çš„æŒ‡é’ˆæ•°ç»„çš„RVAï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;AddressOfFunctions&lt;/code&gt;ï¼šæŒ‡å‘å¯¼å‡ºåœ°å€è¡¨ï¼ˆEATï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddressOfNames&lt;/code&gt;ï¼šæŒ‡å‘å¯¼å‡ºåç§°è¡¨ï¼ˆENTï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddressOfNameOrdinals&lt;/code&gt;ï¼šæŒ‡å‘ä¸€ä¸ªåºæ•°æ•°ç»„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸‰ä¸ªè¡¨ååŒå·¥ä½œï¼šé€šè¿‡å‡½æ•°ååœ¨ENTä¸­æ‰¾åˆ°å…¶ç´¢å¼•ï¼Œç”¨è¿™ä¸ªç´¢å¼•åœ¨åºæ•°æ•°ç»„ä¸­æ‰¾åˆ°å¯¹åº”çš„åºæ•°ï¼Œæœ€åç”¨è¿™ä¸ªåºæ•°ä½œä¸ºç´¢å¼•åœ¨EATä¸­æ‰¾åˆ°å‡½æ•°çš„æœ€ç»ˆRVA&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012212321253&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012212321253.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012212321253.png&#34; alt=&#34;image-20251012212321253&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹åˆ†ækernel32dllçš„å¯¼å‡ºè¡¨&#34;&gt;ç¤ºä¾‹ï¼šåˆ†ækernel32.dllçš„å¯¼å‡ºè¡¨
&lt;/h3&gt;&lt;p&gt;å…ˆæ‰¾åˆ°å¯¼å‡ºè¡¨çš„ä½ç½®&lt;/p&gt;
&lt;p&gt;åœ¨å¯é€‰å¤´æœ«å°¾æ•°ç»„çš„ç¬¬ä¸€é¡¹æ‰¾åˆ°å¯¼å‡ºè¡¨å­˜æ”¾çš„RVAå’Œå¤§å°ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019143357325&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019143357325.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019143357325.png&#34; alt=&#34;image-20251019143357325&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;.text&lt;/code&gt;èŠ‚èƒ½çœ‹åˆ°&lt;code&gt;RVA+SizeOfRawData&lt;/code&gt;å·²ç»è¿œå¤§äºå¯¼å‡ºè¡¨çš„&lt;code&gt;RVA+Size&lt;/code&gt;ï¼Œè¯´æ˜å¯¼å‡ºè¡¨å°±å­˜æ”¾åœ¨&lt;code&gt;.text&lt;/code&gt;ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019144055513&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019144055513.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019144055513.png&#34; alt=&#34;image-20251019144055513&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ ¹æ®&lt;code&gt;PointerToRawData&lt;/code&gt;ï¼Œèƒ½æ‰¾å‡ºç¬¬ä¸€ä¸ª&lt;code&gt;IMAGE_EXPORT_DIRECTORY&lt;/code&gt;é¡¹çš„RAWä¸º&lt;code&gt;0x262C - 0x1000 + 0x0400= 0x1A2C&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;.text&lt;/code&gt;èŠ‚é‡Œé¢æ‰¾åˆ°å¯¼å‡ºè¡¨ï¼Œå¯ä»¥çœ‹è§ç¬¬ä¸€ä¸ªå­—æ®µçš„æ–‡ä»¶åœ°å€å°±æ˜¯&lt;code&gt;0x1A2C&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019150408138&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019150408138.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019150408138.png&#34; alt=&#34;image-20251019150408138&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ ¹æ®å¯¼å‡ºè¡¨å¼€å¤´çš„RVAæ•°æ®ï¼Œå¯ä»¥è®¡ç®—å‡ºå„ä¸ªéƒ¨åˆ†å†…å®¹çš„RAWï¼š&lt;/p&gt;
&lt;p&gt;DLL NAMEï¼š&lt;code&gt;0x4B8E- 0x1000 + 0x0400= 0x3F8E&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019151548499&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019151548499.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019151548499.png&#34; alt=&#34;image-20251019151548499&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;EXPORT Address Tableï¼š&lt;code&gt;0x2654 - 0x1000 + 0x0400= 0x1A54&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019151848234&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019151848234.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019151848234.png&#34; alt=&#34;image-20251019151848234&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;EXPORT Name Pointer Tableï¼š&lt;code&gt;0x3538 - 0x1000 + 0x0400= 0x2938&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019151904687&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019151904687.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019151904687.png&#34; alt=&#34;image-20251019151904687&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;EXPORT Ordinal Tableï¼š&lt;code&gt;0x441C - 0x1000 + 0x0400= 0x381C&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019151917756&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019151917756.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019151917756.png&#34; alt=&#34;image-20251019151917756&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;ç°åœ¨æ ¹æ®è¿™äº›è¡¨æˆ‘ä»¬æ‰¾ä¸€ä¸‹å‡½æ•°&lt;code&gt;CreatProcessA&lt;/code&gt;çš„å…¥å£åœ°å€&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥æ˜¯åœ¨ENTè¡¨ä¸­æ‰¾åˆ°è¯¥å‡½æ•°çš„ç´¢å¼•ï¼Œé€ä¸ªåŒ¹é…ï¼Œæœ€ç»ˆåœ¨ç¬¬62é¡¹æ‰¾åˆ°&lt;code&gt;CreatProcessA&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019152331199&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019152331199.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019152331199.png&#34; alt=&#34;image-20251019152331199&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è®°ä¸‹62è¿™ä¸ªç´¢å¼•å€¼&lt;/p&gt;
&lt;p&gt;æ¥ç€æ¥åˆ°åºå·è¡¨ï¼Œè¿™é‡Œæ¯é¡¹å¤§å°æ˜¯&lt;code&gt;0x0002&lt;/code&gt;ï¼Œå–å‡ºç¬¬62é¡¹çš„å€¼ï¼š&lt;code&gt;0x381C + 62 * 0x0002 = 0x38E0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„è¡¨æ˜¯æŒ‰é¡ºåºæ¥çš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯62ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019152558857&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019152558857.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019152558857.png&#34; alt=&#34;image-20251019152558857&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æœ€åæ¥åˆ°EATè¡¨ï¼Œè¿™é‡Œæ¯é¡¹å¤§å°æ˜¯&lt;code&gt;0x0004&lt;/code&gt;ï¼Œå–å‡ºç¬¬62é¡¹ï¼š&lt;code&gt;0x1A54 + 62 * 0x0004 = 0x1BDC&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­å­˜æ”¾çš„RVAå°±æ˜¯å‡½æ•°&lt;code&gt;CreatProcessA&lt;/code&gt;çš„RVA&lt;code&gt;0x236B&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251019152918944&#34; href=&#34;http://picture.928330.xyz/typora/image-20251019152918944.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251019152918944.png&#34; alt=&#34;image-20251019152918944&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸ªRVAè®¡ç®—RAWï¼š&lt;code&gt;0x236B - 0x1000 + 0x0400 = 0x176B&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;åŸºå€é‡å®šä½&#34;&gt;åŸºå€é‡å®šä½
&lt;/h2&gt;&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦é‡å®šä½&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦é‡å®šä½
&lt;/h3&gt;&lt;p&gt;å½“åŠ è½½å™¨å‡†å¤‡å°†ä¸€ä¸ªDLLåŠ è½½åˆ°å…¶é¦–é€‰çš„ImageBaseåœ°å€æ—¶ï¼Œå¦‚æœè¯¥åœ°å€å·²ç»è¢«å…¶ä»–æ¨¡å—å ç”¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯åŠ è½½å™¨ä¼šä¸ºè¿™ä¸ªDLLåœ¨å†…å­˜ä¸­å¦æ‰¾ä¸€ä¸ªç©ºé—²çš„ä½ç½®ï¼Œç„¶åå¯¹å…¶è¿›è¡Œ&lt;strong&gt;åŸºå€é‡å®šä½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¯´PEæ–‡ä»¶ä¸­å¤§éƒ¨åˆ†åœ°å€æ˜¯RVAï¼Œä½†ä»£ç æˆ–æ•°æ®ä¸­ä»ç„¶å¯èƒ½å­˜åœ¨ä¸€äº›ç¡¬ç¼–ç çš„ç»å¯¹åœ°å€ï¼ˆä¹Ÿå°±æ˜¯ç¡®å®šçš„è™šæ‹Ÿåœ°å€ï¼ŒVAï¼‰ï¼Œè¿™äº›åœ°å€æ˜¯åŸºäºåŸå§‹ImageBaseè®¡ç®—çš„&lt;/p&gt;
&lt;p&gt;å½“ImageBaseæ”¹å˜æ—¶ï¼Œè¿™äº›åœ°å€å°±å¿…é¡»è¢«ä¿®æ­£ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;æ–°åœ°å€ &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; ç¡¬ç¼–ç åœ°å€ &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; å›ºæœ‰&lt;span style=&#34;color:#e06c75&#34;&gt;ImageBase&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; å®é™…åŠ è½½åŸºå€
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;é‡å®šä½è¡¨&#34;&gt;é‡å®šä½è¡¨
&lt;/h3&gt;&lt;p&gt;PEæ–‡ä»¶é€šè¿‡åŸºå€é‡å®šä½è¡¨æ¥å‘Šè¯‰åŠ è½½å™¨å“ªäº›ä½ç½®å­˜åœ¨ç¡¬ç¼–ç åœ°å€éœ€è¦ä¿®æ­£&lt;/p&gt;
&lt;p&gt;é‡å®šä½è¡¨çš„åœ°å€ä¹Ÿå­˜æ”¾åœ¨å¯é€‰å¤´æœ«å°¾çš„æ•°ç»„ä¸­ï¼Œæ˜¯ç¬¬å…­ä¸ªå…ƒç´ &lt;code&gt;OptionalHeader.DataDirectory[5]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç»„æˆé‡å®šä½è¡¨çš„ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;typedef&lt;/span&gt; &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;_IMAGE_BASE_RELOCATION&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;VirtualAddress&lt;/span&gt;;  &lt;span style=&#34;color:#7f848e&#34;&gt;// æœ¬å—èµ·å§‹ RVAï¼ˆç›¸å¯¹äº ImageBaseï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt;   &lt;span style=&#34;color:#e06c75&#34;&gt;SizeOfBlock&lt;/span&gt;;     &lt;span style=&#34;color:#7f848e&#34;&gt;// å½“å‰å—å¤§å°ï¼ŒåŒ…æ‹¬å¤´éƒ¨ + 16-bit åç§»è¡¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;WORD&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;TypeOffset&lt;/span&gt;[&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;];   &lt;span style=&#34;color:#7f848e&#34;&gt;// å¯å˜é•¿åº¦çš„ 16-bit æ•°ç»„ï¼Œè®°å½•åç§»å’Œç±»å‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;} &lt;span style=&#34;color:#e06c75&#34;&gt;IMAGE_BASE_RELOCATION&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251012213310777&#34; href=&#34;http://picture.928330.xyz/typora/image-20251012213310777.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251012213310777.png&#34; alt=&#34;image-20251012213310777&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå—ä¸­ï¼Œ&lt;code&gt;VirtualAddress&lt;/code&gt;å­—æ®µå®šä¹‰äº†ä¸€ä¸ªåŸºå‡†RVAï¼Œå—åé¢ç´§è·Ÿä¸€ä¸ª&lt;code&gt;TypeOffset&lt;/code&gt;æ•°ç»„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TypeOffset&lt;/code&gt;æ˜¯16bitå…ƒç´ æ„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ å¯ä»¥å¦‚ä¸‹åˆ†å‰²ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é«˜4bitï¼šé‡å®šä½ç±»å‹&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Type&lt;/th&gt;
          &lt;th&gt;æè¿°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;IMAGE_REL_BASED_ABSOLUTEï¼ˆä¸è°ƒæ•´ï¼Œå ä½ç”¨ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;IMAGE_REL_BASED_HIGHLOWï¼ˆ32-bit åœ°å€è°ƒæ•´ï¼Œå¸¸ç”¨åœ¨ PE32ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;10&lt;/td&gt;
          &lt;td&gt;IMAGE_REL_BASED_DIR64ï¼ˆ64-bit åœ°å€è°ƒæ•´ï¼ŒPE32+ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å…¶ä»–&lt;/td&gt;
          &lt;td&gt;ä¸åŒå¹³å°/ç‰¹æ®Šç”¨é€”&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä½12bitï¼šç›¸å¯¹äºVirtualAddressçš„åç§»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å°†è¿™ä¸ªåç§»é‡ä¸å—çš„åŸºå‡†RVAç›¸åŠ ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªéœ€è¦è¢«é‡å®šä½çš„ç¡¬ç¼–ç åœ°å€çš„RVA&lt;/p&gt;
&lt;p&gt;åŠ è½½å™¨ä¼šå®šä½åˆ°è¿™äº›RVAçš„RAWï¼Œè¯»å–å…¶ä¸­çš„ç¡¬ç¼–ç VAï¼Œç„¶åè¿›è¡Œä¿®æ­£&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®ƒä»¬å°±å­˜å‚¨åœ¨.relocèŠ‚é‡Œï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251013011531638&#34; href=&#34;http://picture.928330.xyz/typora/image-20251013011531638.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251013011531638.png&#34; alt=&#34;image-20251013011531638&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
</description>
        </item>
        <item>
        <title>é€†å‘åŸºç¡€3ï¼šELFæ–‡ä»¶</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%803elf%E6%96%87%E4%BB%B6/</link>
        <pubDate>Sat, 11 Oct 2025 09:45:23 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%803elf%E6%96%87%E4%BB%B6/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/16e7b03d07acb9525b5cade30292739c.jpg" alt="Featured image of post é€†å‘åŸºç¡€3ï¼šELFæ–‡ä»¶" /&gt;&lt;p&gt;ç»ˆäºè®²åˆ°äº†ï¼Œä¹…é—»ELFå¤§åï¼ŒçœŸçš„å¾ˆæœ‰æ„æ€&lt;/p&gt;
&lt;p&gt;åœ¨å‡ ä¹æ‰€æœ‰çš„ç°ä»£Unix-likeæ“ä½œç³»ç»Ÿï¼ˆæ¯”å¦‚Linuxï¼‰ä¸­ï¼Œä»å¯æ‰§è¡Œç¨‹åºã€å…±äº«åº“åˆ°ç›®æ ‡æ–‡ä»¶ï¼ŒèƒŒåéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ ‡å‡†â€”â€”é‚£å°±æ˜¯&lt;strong&gt;ELF ï¼ˆExecutable and Linkable Formatï¼Œå¯æ‰§è¡Œå’Œå¯é“¾æ¥æ ¼å¼ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ELFæ ¼å¼çš„æ–‡ä»¶ä¹Ÿå¸¸ç®€ç§°&lt;strong&gt;å¯¹è±¡æ–‡ä»¶&lt;/strong&gt;ï¼Œå¯¹è±¡æ–‡ä»¶å‚ä¸ç¨‹åºçš„é“¾æ¥å’Œæ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡ç« ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.laumy.tech/1091.html/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5%E4%B8%8E%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;é™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/linhaostudy/p/8855238.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ELFæ–‡ä»¶ç»“æ„æè¿° 
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://yjy123123.github.io/2021/12/06/%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å»¶è¿Ÿç»‘å®šè¿‡ç¨‹åˆ†æ
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰ç§å½¢æ€&#34;&gt;ä¸‰ç§å½¢æ€
&lt;/h1&gt;&lt;p&gt;æ ¹æ®åœ¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­æ‰€å¤„çš„é˜¶æ®µï¼ŒELFæ–‡ä»¶ä¸»è¦è¡¨ç°ä¸ºä¸‰ç§å½¢å¼ï¼š&lt;/p&gt;
&lt;h2 id=&#34;å¯é‡å®šä½æ–‡ä»¶o&#34;&gt;å¯é‡å®šä½æ–‡ä»¶ï¼ˆ.oï¼‰
&lt;/h2&gt;&lt;p&gt;ç”±ç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨ç”Ÿæˆï¼ŒåŒ…å«äº†ä»£ç å’Œæ•°æ®&lt;/p&gt;
&lt;p&gt;å®ƒå¯ä»¥ä¸å…¶ä»–ç›®æ ‡æ–‡ä»¶é“¾æ¥ï¼Œä»¥åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶æˆ–å…±äº«åº“&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Bash&#34; data-lang=&#34;Bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# ä» test.c ç”Ÿæˆå¯é‡å®šä½æ–‡ä»¶ test.o&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -c test.c -o test.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶
&lt;/h2&gt;&lt;p&gt;åŒ…å«äº†æ‰§è¡Œä¸€ä¸ªç¨‹åºæ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå®ƒæŒ‡å®šäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ˜ åƒ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Bash&#34; data-lang=&#34;Bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# ä» test.o é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ test&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc test.o -o &lt;span style=&#34;color:#e5c07b&#34;&gt;test&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å…±äº«å¯¹è±¡æ–‡ä»¶-so&#34;&gt;å…±äº«å¯¹è±¡æ–‡ä»¶ ï¼ˆ.soï¼‰
&lt;/h2&gt;&lt;p&gt;è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„åŠ¨æ€é“¾æ¥åº“ï¼Œå®ƒæœ‰ä¸¤ä¸ªç”¨æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é“¾æ¥å™¨èƒ½å°†å®ƒä¸å…¶ä»–&lt;code&gt;.o&lt;/code&gt;å’Œ&lt;code&gt;.so&lt;/code&gt;æ–‡ä»¶é“¾æ¥ï¼Œç”Ÿæˆæ–°çš„å¯¹è±¡æ–‡ä»¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŠ¨æ€é“¾æ¥å™¨åœ¨ç¨‹åºè¿è¡Œæ—¶èƒ½å°†å¤šä¸ªå®ƒä¸å¯æ‰§è¡Œæ–‡ä»¶ç»“åˆï¼Œå…±åŒåˆ›å»ºè¿›ç¨‹æ˜ åƒ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Bash&#34; data-lang=&#34;Bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# ç”Ÿæˆä½ç½®æ— å…³ä»£ç çš„ç›®æ ‡æ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -c -fPIC shared.c -o shared.o
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# é“¾æ¥ç”Ÿæˆå…±äº«åº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -shared -o libshared.so shared.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;é“¾æ¥ä¸æ‰§è¡Œ&#34;&gt;é“¾æ¥ä¸æ‰§è¡Œ
&lt;/h1&gt;&lt;p&gt;ELFæ ¼å¼çš„ä¸€ä¸ªæ ¸å¿ƒè®¾è®¡æ€æƒ³æ˜¯ä¸ºåŒä¸€ä¸ªæ–‡ä»¶æä¾›ä¸¤ç§ä¸åŒçš„è§£æè§†å›¾ï¼Œä»¥æ»¡è¶³ä¸åŒå·¥å…·çš„éœ€æ±‚&lt;/p&gt;
&lt;h2 id=&#34;é“¾æ¥è§†å›¾&#34;&gt;é“¾æ¥è§†å›¾
&lt;/h2&gt;&lt;p&gt;ä¾›é“¾æ¥å™¨ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶è¢«çœ‹ä½œæ˜¯ä¸€ç³»åˆ—**èŠ‚ï¼ˆSectionï¼‰**çš„é›†åˆï¼Œé“¾æ¥å™¨é€šè¿‡è§£æèŠ‚å¤´è¡¨æ¥å¤„ç†å’Œåˆå¹¶è¿™äº›èŠ‚&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010153927970&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010153927970.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010153927970.png&#34; alt=&#34;image-20251010153927970&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ‰§è¡Œè§†å›¾&#34;&gt;æ‰§è¡Œè§†å›¾
&lt;/h2&gt;&lt;p&gt;ä¾›åŠ è½½å™¨ï¼ˆæ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€éƒ¨åˆ†ï¼‰ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶è¢«çœ‹ä½œæ˜¯ä¸€ç³»åˆ—**æ®µï¼ˆSegmentï¼‰**çš„é›†åˆï¼ŒåŠ è½½å™¨é€šè¿‡è§£æç¨‹åºå¤´è¡¨æ¥å°†æ®µåŠ è½½åˆ°å†…å­˜å¹¶åˆ›å»ºè¿›ç¨‹&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010153944253&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010153944253.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010153944253.png&#34; alt=&#34;image-20251010153944253&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ä¼šåˆ†åˆ«è§£é‡Šå®ƒä»¬æ˜¯ä»€ä¹ˆ&lt;/p&gt;
&lt;h1 id=&#34;elfæ–‡ä»¶æ ¸å¿ƒç»“æ„&#34;&gt;ELFæ–‡ä»¶æ ¸å¿ƒç»“æ„
&lt;/h1&gt;&lt;h2 id=&#34;elfå¤´&#34;&gt;ELFå¤´
&lt;/h2&gt;&lt;p&gt;ä½äºæ–‡ä»¶çš„æœ€å¼€å§‹ï¼ˆå³åç§»é‡æ˜¯0ï¼‰ï¼Œæ˜¯æ•´ä¸ªæ–‡ä»¶çš„ç´¢å¼•åç‰‡ï¼ŒåŒ…å«äº†æœ€åŸºæœ¬çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ–‡ä»¶é­”æ•°&lt;/strong&gt;ï¼Œç”¨äºè¯†åˆ«ELFæ ¼å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ–‡ä»¶ä½æ•°&lt;/strong&gt;ï¼Œ32ä½è¿˜æ˜¯64ä½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®ç¼–ç å­˜å‚¨æ–¹å¼&lt;/strong&gt;ï¼Œå¤§ç«¯åºè¿˜æ˜¯å°ç«¯åº&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æŒ‡ä»¤é›†ä½“ç³»ç»“æ„&lt;/strong&gt;ï¼Œå¦‚ x86-64ã€ARM&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¨‹åºæ‰§è¡Œçš„å…¥å£ç‚¹åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¨‹åºå¤´è¡¨å’ŒèŠ‚å¤´è¡¨åœ¨æ–‡ä»¶ä¸­çš„åç§»é‡ã€æ¡ç›®æ•°é‡å’Œå¤§å°&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿˜ç”±å…¶ä»–çš„ä¸€äº›ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨&lt;code&gt;readelf&lt;/code&gt;å‘½ä»¤æŸ¥çœ‹ELFå¤´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Bash&#34; data-lang=&#34;Bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;readelf -h &amp;lt;filename&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010205639241&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010205639241.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010205639241.png&#34; alt=&#34;image-20251010205639241&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;èŠ‚å¤´è¡¨ä¸é‡è¦èŠ‚åŒº&#34;&gt;èŠ‚å¤´è¡¨ä¸é‡è¦èŠ‚åŒº
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯&lt;strong&gt;é“¾æ¥è§†å›¾&lt;/strong&gt;çš„æ ¸å¿ƒ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæè¿°äº†æ–‡ä»¶ä¸­æ‰€æœ‰çš„èŠ‚ï¼Œæ¯ä¸ªèŠ‚éƒ½æ˜¯ä¸€å—å…·æœ‰ç›¸ä¼¼å±æ€§çš„æ•°æ®æˆ–ä»£ç çš„é›†åˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸€äº›é‡è¦çš„èŠ‚ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;èŠ‚åç§°&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.text&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç¨‹åºçš„å¯æ‰§è¡ŒæŒ‡ä»¤ï¼ˆä»£ç ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.data&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.bss&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼ˆåœ¨æ–‡ä»¶ä¸­ä¸å ç©ºé—´ï¼ŒåŠ è½½æ—¶æ‰åˆ†é…ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.rodata&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åªè¯»æ•°æ®ï¼Œå¦‚å­—ç¬¦ä¸²å¸¸é‡&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.interp&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾&lt;strong&gt;åŠ¨æ€é“¾æ¥å™¨çš„è·¯å¾„å&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.plt&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è¿‡ç¨‹é“¾æ¥è¡¨&lt;/strong&gt;ï¼Œç”¨äºåŠ¨æ€é“¾æ¥ä¸­çš„å‡½æ•°è°ƒç”¨è·³è½¬&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.got&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å…¨å±€åç§»é‡è¡¨&lt;/strong&gt;ï¼Œå­˜å‚¨åŠ¨æ€é“¾æ¥ç¬¦å·çš„åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.rel.&amp;lt;x&amp;gt;&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;èŠ‚&lt;code&gt;&amp;lt;x&amp;gt;&lt;/code&gt;çš„é‡å®šä½ä¿¡æ¯ï¼Œæ¯”å¦‚&lt;code&gt;.rel.text&lt;/code&gt;å°±æ˜¯&lt;code&gt;.text&lt;/code&gt;èŠ‚çš„é‡å®šä½ä¿¡æ¯&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;.dynamic&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åŠ¨æ€é“¾æ¥æ‰€éœ€çš„ä¿¡æ¯&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨&lt;code&gt;readelf&lt;/code&gt;æŸ¥çœ‹è¯¦ç»†çš„èŠ‚å¤´è¡¨ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Bash&#34; data-lang=&#34;Bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;readelf -S &amp;lt;filename&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010210448607&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010210448607.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010210448607.png&#34; alt=&#34;image-20251010210448607&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;ç¨‹åºå¤´è¡¨ä¸æ®µ&#34;&gt;ç¨‹åºå¤´è¡¨ä¸æ®µ
&lt;/h2&gt;&lt;p&gt;è¿™æ˜¯&lt;strong&gt;æ‰§è¡Œè§†å›¾&lt;/strong&gt;çš„æ ¸å¿ƒ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœ¨åŠ è½½å™¨çœ¼ä¸­ï¼Œæ–‡ä»¶è¢«åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ®µï¼Œè€Œå®ƒå‘Šè¯‰ç³»ç»Ÿå¦‚ä½•å°†æ–‡ä»¶å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ä»¥åˆ›å»ºä¸€ä¸ªè¿›ç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é‡è¦çš„æ®µç±»å‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ®µç±»å‹&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;LOAD&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¯åŠ è½½æ®µï¼ŒåŠ è½½å™¨éœ€è¦å°†æ­¤ç±»å‹çš„æ®µä»æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜&lt;br /&gt;é€šå¸¸ï¼Œä¸€ä¸ª&lt;code&gt;LOAD&lt;/code&gt;æ®µå¯¹åº”ä»£ç ï¼ˆå¯è¯»å¯æ‰§è¡Œï¼‰ï¼Œå¦ä¸€ä¸ªå¯¹åº”æ•°æ®ï¼ˆå¯è¯»å¯å†™ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;INTERP&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æŒ‡å‘åŠ¨æ€é“¾æ¥å™¨çš„è·¯å¾„ï¼ˆå¯¹åº”&lt;code&gt;.interp&lt;/code&gt;èŠ‚ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DYNAMIC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æŒ‡å‘åŠ¨æ€é“¾æ¥ä¿¡æ¯ï¼ˆå¯¹åº”&lt;code&gt;.dynamic&lt;/code&gt;èŠ‚ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;PHDR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æè¿°ç¨‹åºå¤´è¡¨æœ¬èº«çš„ä½ç½®å’Œå¤§å°&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨&lt;code&gt;readelf -l &amp;lt;filename&amp;gt;&lt;/code&gt;æŸ¥çœ‹ç¨‹åºå¤´è¡¨ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010210617934&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010210617934.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010210617934.png&#34; alt=&#34;image-20251010210617934&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;èŠ‚ä¸æ®µåˆ°åº•æ˜¯ä»€ä¹ˆå•Š&#34;&gt;èŠ‚ä¸æ®µåˆ°åº•æ˜¯ä»€ä¹ˆå•Š
&lt;/h2&gt;&lt;p&gt;è¿™ä¿©ä¸œè¥¿çš„ç¡®æœ‰äº›éš¾ä»¥ç†è§£ï¼Œæˆ‘ä»¬å±•å¼€è¯´ä¸€ä¸‹&lt;/p&gt;
&lt;h3 id=&#34;èŠ‚&#34;&gt;èŠ‚
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;èŠ‚æ˜¯ELFæ–‡ä»¶ä¸­åŸºæœ¬çš„é€»è¾‘å•ä½ï¼Œç”¨æ¥åˆ†ç±»ä¸åŒç±»å‹çš„æ•°æ®ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆ&lt;code&gt;.o&lt;/code&gt;ï¼‰æ—¶ï¼Œä¼šæŠŠä¸åŒæ€§è´¨çš„å†…å®¹æ”¾åˆ°ä¸åŒçš„èŠ‚é‡Œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æ‹¿ä¹‹å‰æ‰“å°è¾“å‡ºhelloçš„é‚£ä¸ªcè¯­è¨€ç¨‹åºä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬æŠŠå®ƒç¼–è¯‘é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶åï¼Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å†…éƒ¨å°±æœ‰äº†è®¸å¤šçš„èŠ‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚&lt;code&gt;.text&lt;/code&gt;å­˜æ”¾çš„æ˜¯å‡½æ•°çš„æœºå™¨æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;main()&lt;/code&gt;å‡½æ•°çš„æ±‡ç¼–ä»£ç ï¼Œè€Œ&lt;code&gt;.rodata&lt;/code&gt;å­˜æ”¾åªè¯»å¸¸é‡ï¼Œæ¯”å¦‚å­—ç¬¦ä¸² &lt;code&gt;&amp;quot;hello&amp;quot;&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ç»™æ–‡ä»¶é‡Œé¢çš„ä¸œè¥¿åˆ†ç±»æ‘†æ”¾äº†&lt;/p&gt;
&lt;p&gt;å½“å¤šä¸ª&lt;code&gt;.o&lt;/code&gt;æ–‡ä»¶è¢«åˆå¹¶æ—¶ï¼Œé“¾æ¥å™¨ä¼šæŠŠåŒåçš„èŠ‚æ‹¼åœ¨ä¸€èµ·ï¼Œæ¯”å¦‚æŠŠæ‰€æœ‰&lt;code&gt;.text&lt;/code&gt;åˆå¹¶æˆä¸€ä¸ªå¤§&lt;code&gt;.text&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œè¿™äº›èŠ‚åªå¯¹ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨æœ‰æ„ä¹‰ï¼Œåˆ«çš„ä¸œè¥¿æ¥çœ‹æ˜¯æ²¡æœ‰ä»€ä¹ˆç”¨çš„&lt;/p&gt;
&lt;h3 id=&#34;æ®µ&#34;&gt;æ®µ
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å½“é“¾æ¥å™¨æŠŠ&lt;code&gt;.o&lt;/code&gt;æ–‡ä»¶åˆå¹¶æˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶åï¼Œå®ƒè¿˜è¦å‘Šè¯‰æ“ä½œç³»ç»Ÿè¿è¡Œè¿™ä¸ªç¨‹åºæ—¶è¦åŠ è½½å“ªäº›éƒ¨åˆ†ï¼Œè¿™æ—¶å®ƒå°±ä¼šç”Ÿæˆä¸€ç»„æ®µä¿¡æ¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ®µæè¿°çš„æ˜¯å†…å­˜æ˜ å°„çš„åŒºåŸŸï¼Œæ¯”å¦‚å“ªä¸€éƒ¨åˆ†æ˜¯å¯æ‰§è¡Œçš„ï¼ˆä»£ç æ®µï¼‰ï¼Œå“ªä¸€éƒ¨åˆ†åˆæ˜¯å¯è¯»å†™çš„ï¼ˆæ•°æ®æ®µï¼‰ç­‰ç­‰ï¼Œ&lt;strong&gt;ä¸€ä¸ªæ®µå¾€å¾€åŒ…å«å¤šä¸ªèŠ‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šé¢ä»£ç ç¼–è¯‘ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¼šæœ‰ä¸¤ä¸ªä¸»è¦çš„åŠ è½½æ®µï¼š&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªæ˜¯å¯æ‰§è¡Œæ®µï¼ŒåŒ…å«&lt;code&gt;.text&lt;/code&gt;å’Œ&lt;code&gt;.rodata&lt;/code&gt;ï¼Œç¨‹åºåŠ è½½æ—¶ï¼Œè¿™éƒ¨åˆ†ä¼šæ˜ å°„æˆåªè¯»ã€å¯æ‰§è¡Œçš„å†…å­˜åŒºåŸŸ&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒä¸ªæ˜¯å¯è¯»å†™æ®µï¼ŒåŒ…å«&lt;code&gt;.data&lt;/code&gt;å’Œ&lt;code&gt;.bss&lt;/code&gt;ï¼Œç¨‹åºåŠ è½½æ—¶ï¼Œè¿™éƒ¨åˆ†ä¼šæ˜ å°„æˆå¯è¯»å¯å†™çš„åŒºåŸŸï¼Œç”¨äºå­˜å‚¨å…¨å±€å˜é‡&lt;/p&gt;
&lt;p&gt;é™¤äº†è¿™ä¸¤ä¸ªæ®µè¿˜ä¼šæœ‰ä¸€äº›ç‰¹æ®Šæ®µï¼Œå°±ä¸å¤šè¯´äº†&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸Šé¢è¯´çš„éƒ½æ˜¯â€œç¨‹åºåŠ è½½æ—¶â€ï¼Œä¹Ÿå°±æ˜¯è¯´æ®µæ˜¯ç»™åŠ è½½å™¨çœ‹çš„ï¼Œåœ¨åŠ è½½çš„æ—¶å€™æ‰èµ·ä½œç”¨&lt;/p&gt;
&lt;h3 id=&#34;å¦‚æ­¤ç¾ç»Š&#34;&gt;å¦‚æ­¤ç¾ç»Š
&lt;/h3&gt;&lt;p&gt;æ€»ä¹‹å•Šå¯ä»¥è¿™æ ·ç†è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;èŠ‚æ˜¯ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨å…³å¿ƒçš„åˆ’åˆ†ï¼Œå®ƒæè¿°&lt;strong&gt;æ–‡ä»¶ä¸­çš„é€»è¾‘å†…å®¹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ®µæ˜¯æ“ä½œç³»ç»ŸåŠ è½½å™¨å…³å¿ƒçš„åˆ’åˆ†ï¼Œå®ƒæè¿°&lt;strong&gt;ç¨‹åºåŠ è½½åˆ°å†…å­˜åçš„å¸ƒå±€&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;èŠ‚æ˜¯&lt;strong&gt;ç¼–è¯‘æ—¶&lt;/strong&gt;çš„å•ä½&lt;/p&gt;
&lt;p&gt;æ®µæ˜¯&lt;strong&gt;è¿è¡Œæ—¶&lt;/strong&gt;çš„å•ä½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;èŠ‚å­˜åœ¨äº&lt;strong&gt;æ–‡ä»¶é€»è¾‘ç»“æ„&lt;/strong&gt;ä¸­&lt;/p&gt;
&lt;p&gt;æ®µå­˜åœ¨äº&lt;strong&gt;æ–‡ä»¶åŠ è½½æ˜ å°„&lt;/strong&gt;ä¸­&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;åœ¨é“¾æ¥é˜¶æ®µå®Œæˆä¹‹åï¼ŒèŠ‚å’Œæ®µå®Œå…¨å°±æ˜¯ä¸¤ä¸ªä¸œè¥¿ï¼Œä¸ä¼šäº’ç›¸å¹²æ‰°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;readelf -l&lt;/code&gt;çœ‹æ–‡ä»¶çš„æ—¶å€™ï¼Œå…¶å®è¿˜ä¼šæœ‰ä¸‹é¢è¿™æ ·çš„è¾“å‡ºï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010210659755&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010210659755.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010210659755.png&#34; alt=&#34;image-20251010210659755&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å·¦è¾¹å°±æ˜¯æ®µè¡¨å„ä¸ªæ®µçš„ç´¢å¼•å·ï¼Œå³è¾¹å°±æ˜¯å¯¹åº”æ®µé‡Œé¢å­˜å‚¨äº†é‚£äº›èŠ‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è®°å¾—ä¹‹å‰çš„&lt;code&gt;strip&lt;/code&gt;å‘½ä»¤å—ï¼Œå½“æ‰§è¡Œ&lt;code&gt;strip&lt;/code&gt;æ—¶ï¼Œç¨‹åºä¼šåˆ é™¤èŠ‚å¤´è¡¨ï¼Œäºæ˜¯é‡Œé¢çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å…ƒæ•°æ®ï¼Œéƒ½æ²¡æœ‰äº†&lt;/p&gt;
&lt;p&gt;é‚£ä¸ºä»€ä¹ˆåˆ é™¤å®ƒä¸ä¼šå½±å“æ‰§è¡Œå‘¢ï¼Ÿç°åœ¨æˆ‘ä»¬å°±åº”è¯¥çŸ¥é“äº†â€”â€”&lt;/p&gt;
&lt;p&gt;**å› ä¸ºæ“ä½œç³»ç»ŸåŠ è½½ç¨‹åºæ—¶åªçœ‹æ®µä¿¡æ¯ï¼**èŠ‚æ²¡äº†å°±æ²¡äº†å‘—&lt;/p&gt;
&lt;h1 id=&#34;ç¨‹åºçš„é“¾æ¥ä¸è£…è½½&#34;&gt;ç¨‹åºçš„é“¾æ¥ä¸è£…è½½
&lt;/h1&gt;&lt;p&gt;okï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†ELFæ–‡ä»¶çš„å†…éƒ¨ç»“æ„ï¼Œä½†ä¸€ä¸ªé™æ€çš„æ–‡ä»¶æ˜¯æ€ä¹ˆå˜æˆä¸€ä¸ªåœ¨å†…å­˜ä¸­è¿è¡Œçš„è¿›ç¨‹çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹çš„æ ¸å¿ƒå°±æ˜¯&lt;strong&gt;é“¾æ¥å’Œè£…è½½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è€Œé“¾æ¥åˆ™è´Ÿè´£è§£å†³ä¸åŒä»£ç æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œè€Œè£…è½½è´Ÿè´£å°†æ–‡ä»¶å†…å®¹æ¬å…¥å†…å­˜&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç çš„ä¸¤ç§å½¢æ€&#34;&gt;ä»£ç çš„ä¸¤ç§å½¢æ€
&lt;/h2&gt;&lt;p&gt;åœ¨ä»‹ç»é“¾æ¥ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä»£ç ç”Ÿæˆçš„ä¸¤ç§ä¸åŒæ¨¡å¼ï¼Œå®ƒä»¬ç›´æ¥å†³å®šäº†æ–‡ä»¶åº”å¦‚ä½•è¢«åŠ è½½&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼Œä¸‹é¢çš„æ¦‚å¿µéƒ½æ˜¯åŸºäºè™šæ‹Ÿåœ°å€çš„&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç»å¯¹ä»£ç absolute-code&#34;&gt;ç»å¯¹ä»£ç ï¼ˆAbsolute Codeï¼‰
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¿™æ˜¯åœ¨ç¼–è¯‘æ—¶å°±å‡å®šè‡ªå·±ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ä¸€ä¸ªå›ºå®šåœ°å€çš„ä»£ç &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¢„è®¾çš„åœ°å€è¢«è®°å½•åœ¨ç¨‹åºå¤´è¡¨çš„&lt;code&gt;p_vaddr&lt;/code&gt;å­—æ®µä¸­ï¼Œæ“ä½œç³»ç»ŸåŠ è½½å™¨å¿…é¡»å°†ä»£ç æ®µå­˜æ”¾åˆ°è¿™ä¸ªæŒ‡å®šçš„è™šæ‹Ÿåœ°å€ï¼Œå¦åˆ™ç¨‹åºå†…éƒ¨çš„åœ°å€å¼•ç”¨å°±ä¼šå…¨éƒ¨å‡ºé”™&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªè¿›ç¨‹çš„ä¸»ç¨‹åºæ¥è¯´ï¼Œè¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºå®ƒæ˜¯ç¬¬ä¸€ä¸ªè¢«åŠ è½½çš„ï¼Œå…¶é¦–é€‰åœ°å€é€šå¸¸æ˜¯ç©ºé—²çš„&lt;/p&gt;
&lt;h3 id=&#34;ä½ç½®æ— å…³ä»£ç pic-position-independent-code&#34;&gt;ä½ç½®æ— å…³ä»£ç ï¼ˆPIC, Position-Independent Codeï¼‰
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¿™æ˜¯ä¸ºå…±äº«åº“ï¼ˆ&lt;code&gt;.so&lt;/code&gt;æ–‡ä»¶ï¼‰é‡èº«å®šåšçš„ä»£ç å–”&lt;/strong&gt;ï¼Œåœ¨ä¹‹å‰ä»‹ç».soæ–‡ä»¶çš„æ—¶å€™å·²ç»æåˆ°è¿‡ï¼Œä½¿ç”¨GCCç¼–è¯‘æ—¶åŠ ä¸Š&lt;code&gt;-fPIC&lt;/code&gt;é€‰é¡¹å³å¯ç”Ÿæˆ&lt;/p&gt;
&lt;p&gt;å…±äº«åº“ä¼šè¢«è®¸å¤šä¸åŒçš„è¿›ç¨‹åŠ è½½å’Œå…±äº«ï¼Œæˆ‘ä»¬æ— æ³•ä¸ºä¸€ä¸ªåº“é¢„è®¾ä¸€ä¸ªå›ºå®šçš„åŠ è½½åœ°å€ï¼Œå› ä¸ºè¿™ä¸ªåœ°å€åœ¨Aè¿›ç¨‹ä¸­å¯èƒ½æ˜¯ç©ºé—²çš„ï¼Œä½†åœ¨Bè¿›ç¨‹ä¸­å¯èƒ½å·²ç»è¢«ä¸»ç¨‹åºæˆ–å…¶ä»–åº“å ç”¨äº†&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PICé€šè¿‡ç”Ÿæˆä¸ä¾èµ–äºä»»ä½•ç»å¯¹åœ°å€çš„ä»£ç ï¼Œå®Œç¾åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“åŠ è½½ä¸€ä¸ªPICåº“æ—¶ï¼Œç³»ç»Ÿä¼šä¸ºå®ƒåœ¨å½“å‰è¿›ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªç©ºé—²çš„è™šæ‹ŸåŸºåœ°å€ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ª&lt;code&gt;.so&lt;/code&gt;æ–‡ä»¶ï¼Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¸­å…¶æ®µçš„èµ·å§‹è™šæ‹Ÿåœ°å€æ˜¯ä¸åŒçš„&lt;/p&gt;
&lt;p&gt;PICä»£ç ä¹‹æ‰€ä»¥èƒ½æ­£å¸¸å·¥ä½œï¼Œå…³é”®åœ¨äºå®ƒå†…éƒ¨æ‰€æœ‰çš„åœ°å€å¼•ç”¨ï¼ˆå¦‚è°ƒç”¨åº“å†…å¦ä¸€ä¸ªå‡½æ•°ã€è®¿é—®å…¨å±€å˜é‡ï¼‰éƒ½ä¸æ˜¯ç¡¬ç¼–ç çš„ç»å¯¹åœ°å€ï¼Œè€Œæ˜¯é€šè¿‡&lt;strong&gt;ç›¸å¯¹å¯»å€&lt;/strong&gt;çš„æ–¹å¼å®ç°çš„&lt;/p&gt;
&lt;p&gt;ç³»ç»Ÿä¸ºPICä»£ç ç»´æŠ¤äº†æ®µé—´çš„ç›¸å¯¹ä½ç½®ï¼Œæ— è®ºåº“è¢«åŠ è½½åˆ°å¤šé«˜çš„åŸºåœ°å€ï¼Œå…¶ä»£ç æ®µå’Œæ•°æ®æ®µä¹‹é—´çš„è™šæ‹Ÿåœ°å€å·®å€¼å§‹ç»ˆä¿æŒä¸å˜ï¼Œè¿™ä¸ªå·®å€¼ä¸å®ƒä»¬åœ¨åŸå§‹&lt;code&gt;.so&lt;/code&gt;æ–‡ä»¶ä¸­çš„è™šæ‹Ÿåœ°å€å·®å€¼æ˜¯ç›¸ç­‰çš„&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;strong&gt;å½é‡Œå‘±å•¦è¯´é‚£ä¹ˆå¤šï¼Œæ€»ä¹‹ä½ç½®æ— å…³ä»£ç å¾ˆçµæ´»ï¼Œåœ¨ä¸åŒè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´é‡Œä½ç½®å¯å˜ï¼Œä½†å†…éƒ¨å„æ®µä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¿æŒä¸å˜&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;h2 id=&#34;é™æ€é“¾æ¥&#34;&gt;é™æ€é“¾æ¥
&lt;/h2&gt;&lt;p&gt;é™æ€é“¾æ¥å‘ç”Ÿåœ¨ç¨‹åºç¼–è¯‘çš„æœ€åé˜¶æ®µï¼Œå®ƒæ˜¯ä¸€ä¸ªå°†åˆ†æ•£çš„æ¨¡å—ç»„åˆæˆä¸€ä¸ªå®Œæ•´ã€ç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é“¾æ¥å™¨è¯»å–å¼€å‘è€…ç¼–å†™çš„å¤šä¸ªå¯é‡å®šä½æ–‡ä»¶ï¼ˆ&lt;code&gt;.o&lt;/code&gt;æ–‡ä»¶ï¼‰å’Œå¯èƒ½ç”¨åˆ°çš„é™æ€åº“ï¼ˆ&lt;code&gt;.a&lt;/code&gt;æ–‡ä»¶ï¼‰ï¼Œå°†å®ƒä»¬çš„æ‰€æœ‰å†…å®¹â€œæ‰“åŒ…â€åˆ°ä¸€ä¸ªå•ç‹¬çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é“¾æ¥çš„æ ¸å¿ƒæ“ä½œä¹‹ä¸€æ˜¯å°†æ‰€æœ‰è¾“å…¥æ–‡ä»¶ä¸­çš„åŒç±»å‹èŠ‚åˆå¹¶ï¼Œåœ¨ä¹‹å‰ä»‹ç»èŠ‚çš„æ—¶å€™æåˆ°è¿‡çš„ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;img&#34; href=&#34;http://picture.928330.xyz/typora/wp_editor_md_3a5fd321b0149ea88c936a9277eb0ea0.jpg&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/wp_editor_md_3a5fd321b0149ea88c936a9277eb0ea0.jpg&#34; alt=&#34;img&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è€Œåœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œé“¾æ¥å™¨æœ€å…³é”®çš„å·¥ä½œå°±æ˜¯è¿›è¡Œé‡å®šä½&lt;/p&gt;
&lt;p&gt;å®ƒè´Ÿè´£è§£æå„ä¸ªæ¨¡å—é—´çš„ç¬¦å·å¼•ç”¨ï¼ˆæ¯”å¦‚å‡½æ•°è°ƒç”¨ï¼‰ï¼Œå¹¶ä¿®æ­£ä»£ç å’Œæ•°æ®ä¸­çš„åœ°å€ï¼Œç¡®ä¿å®ƒä»¬æŒ‡å‘æ­£ç¡®çš„ä½ç½®&lt;/p&gt;
&lt;h2 id=&#34;é‡å®šä½&#34;&gt;é‡å®šä½
&lt;/h2&gt;&lt;h3 id=&#34;é‡å®šä½çš„ä½œç”¨&#34;&gt;é‡å®šä½çš„ä½œç”¨
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é‡å®šä½æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ‰“è¡¥ä¸çš„æœºåˆ¶ï¼Œå®ƒå°†ä»£ç ä¸­å¯¹ç¬¦å·çš„å¼•ç”¨è¿æ¥åˆ°è¯¥ç¬¦å·çš„å®šä¹‰ä¸Šï¼Œè§£å†³åœ°å€æœªçŸ¥é—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æ‹¿ä¹‹å‰çš„&lt;code&gt;hello.c&lt;/code&gt;ç¨‹åºä¸¾ä¾‹å§ï¼Œæˆ‘ä»¬è°ƒç”¨äº†&lt;code&gt;printf&lt;/code&gt;å‡½æ•°ï¼Œä½†æ˜¯ç¨‹åºä¸çŸ¥é“è¿™ä¸ªå‡½æ•°åœ¨å“ªï¼Œæ‰€ä»¥ç¼–è¯‘å™¨åªèƒ½åœ¨æœºå™¨ç é‡Œç•™ä¸‹ä¸€ä¸ªä¸´æ—¶çš„å ä½ç¬¦ï¼Œå†ç”¨ä¸€ä¸ªé‡å®šä½å…¥å£æ¥å‘Šè¯‰é“¾æ¥å™¨â€œè¿™é‡Œæœ‰ä¸ªåœ°å€éœ€è¦ä½ å¡«ä¸€ä¸‹â€&lt;/p&gt;
&lt;p&gt;æˆ–è®¸ä½ è¿˜è®°å¾—ä¹‹å‰ä½¿ç”¨&lt;code&gt;objdump&lt;/code&gt;æŸ¥çœ‹æ±‡ç¼–åçš„æ–‡ä»¶çš„é‚£å¼ å›¾ç‰‡ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251011153952525&#34; href=&#34;http://picture.928330.xyz/typora/image-20251011153952525.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251011153952525.png&#34; alt=&#34;image-20251011153952525&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;é‡Œé¢callï¼ˆè°ƒç”¨å‡½æ•°ï¼‰è¿™ä¸€è¡Œæ€ä¹ˆç†è§£å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å³è¾¹æ˜¯æ±‡ç¼–ï¼Œæˆ‘ä»¬ä¸ç®¡ï¼Œåªçœ‹å·¦è¾¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;17&lt;/span&gt;: &lt;span style=&#34;color:#e06c75&#34;&gt;e8&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;00&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;00&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†’å·å‰é¢çš„&lt;code&gt;17&lt;/code&gt;æ„æ€æ˜¯å½“å‰æŒ‡ä»¤åœ°å€ä¸º&lt;code&gt;0x17&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†’å·åé¢çš„&lt;code&gt;e8 00 00 00 00&lt;/code&gt;äº”ä¸ªå­—èŠ‚æ˜¯æŒ‡ä»¤ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå­—èŠ‚&lt;code&gt;e8&lt;/code&gt;æ˜¯å¯¹åº”callçš„æ“ä½œç ï¼Œåé¢å››ä¸ªå­—èŠ‚æ˜¯åç§»é‡ï¼Œéƒ½æ˜¯â€œ00â€ï¼Œè¿™å°±æ˜¯â€œç¼–è¯‘å™¨åœ¨æœºå™¨ç é‡Œç•™ä¸‹çš„ä¸´æ—¶å ä½ç¬¦â€ï¼&lt;/p&gt;
&lt;p&gt;ä¹‹å‰æˆ‘ä»¬æ²¡æœ‰çœ‹é“¾æ¥åçš„å¯æ‰§è¡Œæ–‡ä»¶ç»“æ„ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œè¿˜æ˜¯ä½¿ç”¨&lt;code&gt;objdump&lt;/code&gt;å‘½ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251011154918553&#34; href=&#34;http://picture.928330.xyz/typora/image-20251011154918553.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251011154918553.png&#34; alt=&#34;image-20251011154918553&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;å“¦ï¼é“¾æ¥ä¹‹åï¼Œè¿™é‡Œçš„åç§»é‡è¢«æ¢æˆäº†ç¡®å®šçš„æ•°æ®äº†ï¼&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯é‡å®šä½çš„ä½œç”¨&lt;/p&gt;
&lt;h3 id=&#34;é‡å®šä½å…¥å£&#34;&gt;é‡å®šä½å…¥å£
&lt;/h3&gt;&lt;p&gt;é“¾æ¥å™¨ä¹‹æ‰€ä»¥çŸ¥é“è¦å»å“ªé‡Œæ‰“è¡¥ä¸ï¼Œæ˜¯å› ä¸ºå®ƒè¯»å–äº†æ–‡ä»¶ä¸­çš„é‡å®šä½èŠ‚ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;.rel.&amp;lt;X&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå…¥å£éƒ½ç”¨ä»¥ä¸‹å­—æ®µæè¿°äº†ä¸€ä¸ªé‡å®šä½æ“ä½œï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;OFFSET&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;éœ€è¦ä¿®æ­£çš„ä½ç½®åœ¨èŠ‚å†…çš„åç§»é‡ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;TYPE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;é‡å®šä½ç±»å‹ï¼Œå†³å®šæ€ä¹ˆè®¡ç®—åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;VALUE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ç›®æ ‡ç¬¦å·ï¼Œä¹Ÿå°±æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡çš„åç§°&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;objdump&lt;/code&gt;èƒ½æŸ¥çœ‹é‡å®šä½è¡¨ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251011160328709&#34; href=&#34;http://picture.928330.xyz/typora/image-20251011160328709.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251011160328709.png&#34; alt=&#34;image-20251011160328709&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;é‡Œé¢çš„ç¬¬äºŒæ¡è®°å½•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0000000000000018&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;R_X86_64_PLT32&lt;/span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;printf&lt;/span&gt;-&lt;span style=&#34;color:#d19a66&#34;&gt;0x4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯´æ˜åœ¨&lt;code&gt;.text&lt;/code&gt;æ®µåç§»&lt;code&gt;0x18&lt;/code&gt;å¤„æœ‰ä¸€ä¸ªé€šè¿‡PLTï¼ˆè¿‡ç¨‹é“¾æ¥è¡¨ï¼‰è°ƒç”¨çš„&lt;code&gt;printf&lt;/code&gt;çš„æŒ‡ä»¤&lt;/p&gt;
&lt;h3 id=&#34;é‡å®šä½åœ°å€è®¡ç®—&#34;&gt;é‡å®šä½åœ°å€è®¡ç®—
&lt;/h3&gt;&lt;p&gt;é“¾æ¥å™¨æ ¹æ®é‡å®šä½ç±»å‹ä½¿ç”¨ç‰¹å®šå…¬å¼æ¥è®¡ç®—æœ€ç»ˆè¦å¡«å…¥çš„å€¼&lt;/p&gt;
&lt;p&gt;ä¸Šæ–‡çš„è®°å½•çš„ç±»å‹æ˜¯&lt;code&gt;R_X86_64_PLT32&lt;/code&gt;ï¼Œç”¨åœ¨&lt;code&gt;x86-64&lt;/code&gt;æ¶æ„ï¼Œå³64ä½æ¶æ„&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿™é‡Œä»‹ç»ä¸€ä¸ªç±»ä¼¼çš„ç”¨åœ¨32ä½çš„&lt;code&gt;R_386_PC32&lt;/code&gt;ç±»å‹ï¼Œå…¶å…¬å¼ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ç›®æ ‡å€¼&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;S&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt; - &lt;span style=&#34;color:#e06c75&#34;&gt;P&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;S&lt;/strong&gt;ï¼šæ˜¯ç¬¦å·çš„æœ€ç»ˆå€¼ï¼Œå³è¢«è°ƒç”¨å‡½æ•°åœ¨å†…å­˜ä¸­çš„ç»å¯¹åœ°å€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;A&lt;/strong&gt;ï¼šæ˜¯å­˜å‚¨åœ¨è¦ä¿®æ”¹ä½ç½®çš„åŸå§‹å€¼ï¼Œç§°ä¸ºéšå¼åŠ æ•°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;P&lt;/strong&gt;ï¼šæ˜¯è¦ä¿®æ”¹ä½ç½®æœ¬èº«çš„åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åŠ¨æ€é“¾æ¥&#34;&gt;åŠ¨æ€é“¾æ¥
&lt;/h2&gt;&lt;p&gt;åŠ¨æ€é“¾æ¥å°†é“¾æ¥è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†æ¨è¿Ÿåˆ°ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œã€‚å½“ç¨‹åºä¾èµ–äºå…±äº«åº“ï¼ˆå¦‚&lt;code&gt;libc.so&lt;/code&gt;ï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶æ‰¾åˆ°è¿™äº›åº“ï¼Œå¹¶å°†å®ƒä»¬åŠ¨æ€åœ°ç»‘å®šåˆ°è¿›ç¨‹ä¸Šã€‚è¿™ç§æ–¹å¼æå¤§åœ°å‡å°‘äº†å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯å’Œç³»ç»Ÿå†…å­˜çš„å ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯åŠ¨è¿‡ç¨‹&#34;&gt;å¯åŠ¨è¿‡ç¨‹
&lt;/h3&gt;&lt;p&gt;ç³»ç»Ÿè£…è½½å¯æ‰§è¡Œæ–‡ä»¶æœ¬èº«åï¼Œå¦‚æœåœ¨è§£æç¨‹åºå¤´è¡¨æ—¶å‘ç°æœ‰ä¸€ä¸ª&lt;code&gt;INTERP&lt;/code&gt;æ®µï¼Œå®ƒå°±çŸ¥é“è¿™ä¸ªç¨‹åºéœ€è¦åŠ¨æ€é“¾æ¥&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ä¼šåŠ è½½å¹¶å¯åŠ¨&lt;code&gt;INTERP&lt;/code&gt;æ®µä¸­æŒ‡å®šçš„&lt;strong&gt;åŠ¨æ€é“¾æ¥å™¨&lt;/strong&gt;ï¼ˆåœ¨Linuxä¸Šé€šå¸¸æ˜¯&lt;code&gt;/lib/ld-linux.so.2&lt;/code&gt;ï¼‰ï¼Œå¹¶å°†æ§åˆ¶æƒç§»äº¤ç»™åŠ¨æ€é“¾æ¥å™¨&lt;/p&gt;
&lt;p&gt;åŠ¨æ€è¿æ¥å™¨ä¼šåˆ†æå¯æ‰§è¡Œæ–‡ä»¶éœ€è¦ä¾èµ–å“ªäº›å…±äº«åº“ï¼Œç„¶åæŸ¥æ‰¾ã€åŠ è½½è¿™äº›åº“ï¼Œå¹¶å°†å®ƒä»¬ä¹Ÿæ˜ å°„åˆ°è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­&lt;/p&gt;
&lt;h3 id=&#34;å»¶è¿Ÿç»‘å®š&#34;&gt;å»¶è¿Ÿç»‘å®š
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†åŠ å¿«ç¨‹åºçš„å¯åŠ¨é€Ÿåº¦ï¼ŒåŠ¨æ€é“¾æ¥å™¨é»˜è®¤é‡‡ç”¨å»¶è¿Ÿç»‘å®šç­–ç•¥ï¼šä¸€ä¸ªå¤–éƒ¨åº“å‡½æ•°çš„åœ°å€åªæœ‰åœ¨å®ƒç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«è§£æ&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæœºåˆ¶ç”±&lt;strong&gt;è¿‡ç¨‹é“¾æ¥è¡¨ (PLT)&lt;/strong&gt; å’Œ &lt;strong&gt;å…¨å±€åç§»é‡è¡¨ (GOT)&lt;/strong&gt; ååŒå®Œæˆ&lt;/p&gt;
&lt;h4 id=&#34;è¿‡ç¨‹é“¾æ¥è¡¨-plt&#34;&gt;è¿‡ç¨‹é“¾æ¥è¡¨ (PLT)
&lt;/h4&gt;&lt;p&gt;ç»™å¤–éƒ¨å‡½æ•°æä¾›ä¸€ä¸ªç»Ÿä¸€çš„è·³æ¿å…¥å£ï¼Œè´Ÿè´£ç¬¬ä¸€æ¬¡è°ƒç”¨çš„åŠ¨æ€è§£æ&lt;/p&gt;
&lt;p&gt;å®ƒåœ¨è¿è¡Œä¹‹å‰å°±å·²ç»ç¡®å®šå¹¶ä¸”ä¸ä¼šè¢«ä¿®æ”¹&lt;/p&gt;
&lt;h4 id=&#34;å…¨å±€åç§»é‡è¡¨-got&#34;&gt;å…¨å±€åç§»é‡è¡¨ (GOT)
&lt;/h4&gt;&lt;p&gt;ä¿å­˜å¤–éƒ¨å‡½æ•°æˆ–å…¨å±€å˜é‡çš„çœŸå®åœ°å€ï¼Œç¨‹åºé€šè¿‡å®ƒæ¥é—´æ¥è®¿é—®å¤–éƒ¨ç¬¦å·&lt;/p&gt;
&lt;p&gt;å®ƒå¯ä»¥åœ¨ç¨‹åºè¿è¡Œä¸­è¢«ä¿®æ”¹ï¼ˆè¿™å°±å¯¼è‡´å®ƒå¾ˆå®¹æ˜“ä½œä¸ºæ¼æ´åˆ©ç”¨ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å…³äºPLTå’ŒGOTçš„è¯¦ç»†çš„ç»“æ„ï¼Œä¸»è¦æ˜¯pwnçš„å†…å®¹ï¼Œæˆ‘ä»¬å­¦é€†å‘å°±ç‚¹åˆ°ä¸ºæ­¢&lt;/del&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç»‘å®šè¿‡ç¨‹&#34;&gt;ç»‘å®šè¿‡ç¨‹
&lt;/h4&gt;&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ç”¨&lt;code&gt;printf&lt;/code&gt;ä¸ºä¾‹çœ‹çœ‹ä»€ä¹ˆå«å»¶è¿Ÿç»‘å®šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–æ¬¡è°ƒç”¨å‡½æ•°ï¼š
&lt;ol&gt;
&lt;li&gt;ä»£ç ä¸­çš„&lt;code&gt;call&lt;/code&gt;æŒ‡ä»¤å®é™…ä¸Šè·³è½¬åˆ°&lt;code&gt;printf&lt;/code&gt;åœ¨PLTä¸­çš„ä¸€ä¸ªä¸“å±æ¡ç›®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º&lt;code&gt;printf@plt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;printf@plt&lt;/code&gt;çš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ˜¯è·³è½¬åˆ°GOTä¸­ä¸º&lt;code&gt;printf&lt;/code&gt;å‡½æ•°é¢„ç•™çš„åœ°å€æ§½&lt;code&gt;printf_in_got&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;GOTæ§½é‡Œå­˜æ”¾çš„å¹¶ä¸æ˜¯&lt;code&gt;printf&lt;/code&gt;çš„çœŸå®åœ°å€ï¼Œè€Œæ˜¯&lt;code&gt;printf@plt&lt;/code&gt;ä¸­ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼æ‰€ä»¥è¿™ä¸ª&lt;code&gt;jmp&lt;/code&gt;å®é™…ä¸Šåˆè·³äº†å›æ¥&lt;/li&gt;
&lt;li&gt;ç¨‹åºç»§ç»­æ‰§è¡ŒPLTæ¡ç›®ä¸­çš„åç»­æŒ‡ä»¤ï¼Œå®ƒä¼šå°†&lt;code&gt;printf&lt;/code&gt;å‡½æ•°çš„ä¸€ä¸ªæ ‡è¯†ä¿¡æ¯å‹æ ˆï¼Œç„¶åè·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ä¸­ä¸€ä¸ªå…¬å…±çš„è§£æå‡½æ•°&lt;/li&gt;
&lt;li&gt;è§£æå‡½æ•°æ ¹æ®ä¼ å…¥çš„æ ‡è¯†ä¿¡æ¯ï¼ŒæŸ¥æ‰¾&lt;code&gt;printf&lt;/code&gt;å‡½æ•°çš„çœŸå®åœ°å€ï¼Œç„¶åç”¨è¿™ä¸ªçœŸå®åœ°å€è¦†ç›–GOTä¸­&lt;code&gt;printf_in_got&lt;/code&gt;åŸæ¥çš„å€¼&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œè§£æå‡½æ•°ç›´æ¥è·³è½¬åˆ°&lt;code&gt;printf&lt;/code&gt;çš„çœŸå®åœ°å€å»æ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;å†æ¬¡è°ƒç”¨å‡½æ•°ï¼š
&lt;ol&gt;
&lt;li&gt;ä»£ç å†æ¬¡æ‰§è¡Œ&lt;code&gt;call printf@plt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;PLTæ¡ç›®å†æ¬¡æ‰§è¡Œ&lt;code&gt;jmp *[printf_in_got]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½†è¿™ä¸€æ¬¡ï¼Œ&lt;code&gt;printf_in_got&lt;/code&gt;è¿™ä¸ªæ§½é‡Œå·²ç»å­˜æ”¾äº†&lt;code&gt;printf&lt;/code&gt;å‡½æ•°çš„çœŸå®åœ°å€ï¼æ‰€ä»¥ï¼Œç¨‹åºä¼šç›´æ¥è·³è½¬åˆ°&lt;code&gt;printf&lt;/code&gt;å‡½æ•°ï¼Œå®Œå…¨ä¸å†éœ€è¦åŠ¨æ€é“¾æ¥å™¨ä»‹å…¥ï¼Œä»è€Œå®ç°äº†é«˜æ•ˆè°ƒç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;img&#34; href=&#34;http://picture.928330.xyz/typora/3.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/3.png&#34; alt=&#34;img&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ€»ä¹‹ï¼Œpltå°±åƒæŒ‡ç¤ºç‰Œï¼ŒæŒ‡å‘gotï¼Œè€Œgoté‡Œé¢å­˜äº†çœŸæ­£çš„åœ°å€ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨pltä¼šæ›´æ–°gotå€¼ï¼Œåé¢å°±éšä¾¿ç”¨äº†&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;ç¨‹åºçš„è£…è½½&#34;&gt;ç¨‹åºçš„è£…è½½
&lt;/h1&gt;&lt;p&gt;å°†ä¸€ä¸ªé™æ€çš„ELFå¯æ‰§è¡Œæ–‡ä»¶è½¬æ¢ä¸ºä¸€ä¸ªåŠ¨æ€è¿è¡Œçš„è¿›ç¨‹æ˜ åƒï¼Œæ“ä½œç³»ç»Ÿçš„åŠ è½½å™¨æœ‰ç€ä¸¥è°¨çš„æ­¥éª¤&lt;/p&gt;
&lt;h2 id=&#34;shellè°ƒç”¨&#34;&gt;Shellè°ƒç”¨
&lt;/h2&gt;&lt;p&gt;å½“ç”¨æˆ·åœ¨shellè¾“å…¥&lt;code&gt;./hello&lt;/code&gt;æ—¶ï¼Œshellçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è°ƒç”¨&lt;code&gt;fork()&lt;/code&gt;åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹&lt;/li&gt;
&lt;li&gt;å­è¿›ç¨‹è°ƒç”¨&lt;code&gt;execve(&amp;quot;./a.out&amp;quot;, argv, envp)&lt;/code&gt;æ‰§è¡ŒæŒ‡å®šçš„ELFæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;çˆ¶è¿›ç¨‹ï¼ˆshellï¼‰ç»§ç»­æŒ‚èµ·ï¼Œç­‰å¾…å­è¿›ç¨‹ç»“æŸåç»§ç»­æ¥æ”¶ç”¨æˆ·è¾“å…¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶shellæœ¬èº«å¹¶ä¸ç›´æ¥æ‰§è¡ŒELFæ–‡ä»¶ï¼Œè€Œæ˜¯é€šè¿‡&lt;code&gt;execve()&lt;/code&gt;è¯·æ±‚å†…æ ¸å°†å­è¿›ç¨‹çš„åœ°å€ç©ºé—´æ›¿æ¢ä¸ºELFå¯æ‰§è¡Œæ–‡ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;execve()&lt;/code&gt;çš„åŸå‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;execve&lt;/span&gt;(&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;filename&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[], &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;envp&lt;/span&gt;[]);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‚æ•°åˆ†åˆ«ä¸ºï¼šç¨‹åºæ–‡ä»¶åã€å‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;h2 id=&#34;execveç³»ç»Ÿè°ƒç”¨&#34;&gt;execveç³»ç»Ÿè°ƒç”¨
&lt;/h2&gt;&lt;p&gt;ç³»ç»Ÿè°ƒç”¨å…¥å£ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;sys_execve&lt;/span&gt;(&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;filename&lt;/span&gt;, &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;argv&lt;/span&gt;[], &lt;span style=&#34;color:#e5c07b&#34;&gt;char&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;envp&lt;/span&gt;[]);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å†…æ ¸ä¸­ï¼Œ&lt;code&gt;sys_execve()&lt;/code&gt;ä¼šè°ƒç”¨&lt;code&gt;do_execve()&lt;/code&gt;ï¼ŒæŠŠç”¨æˆ·ä¼ å…¥çš„æ–‡ä»¶åã€&lt;code&gt;argv&lt;/code&gt;ã€&lt;code&gt;envp&lt;/code&gt;ï¼ˆç¯å¢ƒå˜é‡æ•°ç»„ï¼‰å°è£…ä¸ºå†…æ ¸å¯ä»¥ä½¿ç”¨çš„æ ¼å¼ï¼Œç„¶åè¿›å…¥&lt;code&gt;do_execve_common()&lt;/code&gt;ï¼Œå¤„ç†å®é™…åŠ è½½è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥è¿›ç¨‹é™åˆ¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚æ¯ç”¨æˆ·è¿›ç¨‹æ•°æ˜¯å¦è¶…è¿‡é™åˆ¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è°ƒåº¦å‡†å¤‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sched_exec()&lt;/code&gt;é€‰æ‹©è´Ÿè½½æœ€å°çš„CPU&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å‡†å¤‡æ‰§è¡Œå‚æ•°ç»“æ„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åˆ›å»ºç»“æ„ä½“&lt;code&gt;struct linux_binprm bprm&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;linux_binfmt&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bprm&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;list_head&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;lh&lt;/span&gt;;        &lt;span style=&#34;color:#7f848e&#34;&gt;// å•é“¾è¡¨è¡¨å¤´
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;module&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;module&lt;/span&gt;;      &lt;span style=&#34;color:#7f848e&#34;&gt;// æ¨¡å—
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;load_binary&lt;/span&gt;)(&lt;span style=&#34;color:#c678dd&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;linux_binprm&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;); &lt;span style=&#34;color:#7f848e&#34;&gt;// è£…è½½å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¿å­˜æ–‡ä»¶æŒ‡é’ˆã€å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€æ–‡ä»¶å¼€å¤´çš„ç¼“å†²åŒºï¼ˆå‰128å­—èŠ‚ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ‹·è´å‚æ•°ä¸ç¯å¢ƒå˜é‡åˆ°å†…æ ¸&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨&lt;code&gt;copy_strings()&lt;/code&gt;å°†argvå’Œenvpæ‹·è´åˆ°å†…æ ¸ç©ºé—´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è°ƒç”¨&lt;code&gt;exec_binprm()&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœç´¢å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œå¹¶è°ƒç”¨å¯¹åº”åŠ è½½å‡½æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ ¼å¼è¯†åˆ«&#34;&gt;æ ¼å¼è¯†åˆ«
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;exec_binprm()&lt;/code&gt;ä¼šè°ƒç”¨&lt;code&gt;search_binary_handler()&lt;/code&gt;ï¼Œéå†ç”±bprmç»„æˆçš„é“¾è¡¨ï¼Œè°ƒç”¨å¯¹åº”æ ¼å¼çš„&lt;code&gt;load_binary()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œå¯¹äºå¯èƒ½çš„ELFæ–‡ä»¶ï¼Œè°ƒç”¨&lt;code&gt;load_elf_binary()&lt;/code&gt;ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯»å–ELFå¤´&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¯»å–æ–‡ä»¶å¼€å¤´128å­—èŠ‚ï¼Œæ£€æŸ¥é­”æ•° &lt;code&gt;{0x7f, &#39;E&#39;, &#39;L&#39;, &#39;F&#39;}&lt;/code&gt;ï¼ŒéªŒè¯ELFç±»å‹ï¼ˆ&lt;code&gt;ET_EXEC&lt;/code&gt; æˆ– &lt;code&gt;ET_DYN&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½å¥‡æ€ªä¸ºä»€ä¹ˆå·²ç»çŸ¥é“æ˜¯ELFäº†ï¼Œè¿˜è¦å†è¯†åˆ«ä¸€æ¬¡ï¼Œé‚£æ˜¯å› ä¸ºä¹‹å‰åªæ˜¯åˆæ­¥åŒ¹é…ï¼Œè¿™ä¸€æ­¥æ‰æ˜¯ä¸¥æ ¼æ£€æŸ¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¯»å–ç¨‹åºå¤´è¡¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è·å–æ®µçš„æ•°é‡ã€åç§»ä½ç½®ç­‰ä¿¡æ¯ï¼Œç¡®å®šæ¯ä¸ªæ®µåœ¨æ–‡ä»¶ä¸­çš„åç§»ã€å¤§å°ã€å†…å­˜åŠ è½½åœ°å€å’Œæƒé™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥åŠ¨æ€é“¾æ¥å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå­˜åœ¨&lt;code&gt;.interp&lt;/code&gt;æ®µï¼Œè¯´æ˜ELFéœ€è¦åŠ¨æ€é“¾æ¥ï¼Œå†…æ ¸ä¼šæ‰“å¼€åŠ¨æ€é“¾æ¥å™¨ELFæ–‡ä»¶ï¼Œå¹¶é€’å½’è°ƒç”¨ &lt;code&gt;load_elf_binary()&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;è§„åˆ’å†…å­˜å¸ƒå±€&#34;&gt;è§„åˆ’å†…å­˜å¸ƒå±€
&lt;/h2&gt;&lt;p&gt;åœ¨è¯»å–ç¨‹åºå¤´è¡¨çš„æ—¶å€™ï¼ŒåŠ è½½å™¨ä¼šç‰¹åˆ«å…³æ³¨æ‰€æœ‰ç±»å‹ä¸º&lt;code&gt;LOAD&lt;/code&gt;çš„æ®µï¼Œå› ä¸ºè¿™äº›æ®µæ˜¯éœ€è¦è¢«å®Œæ•´åŠ è½½åˆ°å†…å­˜ä¸­çš„&lt;/p&gt;
&lt;p&gt;ç¨‹åºå¤´è¡¨ä¸­çš„æ¯ä¸ª&lt;code&gt;LOAD&lt;/code&gt;æ¡ç›®éƒ½ç²¾ç¡®åœ°æŒ‡æ˜äº†ä¸‹é¢çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯¥æ®µåœ¨æ–‡ä»¶ä¸­çš„åç§»é‡å’Œå¤§å°ï¼ˆ&lt;code&gt;p_offset&lt;/code&gt;, &lt;code&gt;p_filesz&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;è¯¥æ®µåº”è¯¥è¢«åŠ è½½åˆ°çš„ç›®æ ‡è™šæ‹Ÿå†…å­˜åœ°å€ï¼ˆ&lt;code&gt;p_vaddr&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;è¯¥æ®µåœ¨å†…å­˜ä¸­åº”è¯¥å æ®çš„ç©ºé—´å¤§å°ï¼ˆ&lt;code&gt;p_memsz&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;è¯¥æ®µçš„å†…å­˜è®¿é—®æƒé™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¹‹åï¼Œè·Ÿæ®è¿™äº›ä¿¡æ¯ç¡®å®šå†…å­˜å¸ƒå±€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.text&lt;/code&gt;ã€&lt;code&gt;.rodata&lt;/code&gt; â†’ å¯æ‰§è¡Œã€åªè¯»æ®µ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.data&lt;/code&gt;ã€&lt;code&gt;.bss&lt;/code&gt; â†’ å¯å†™æ®µ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œ
&lt;/h2&gt;&lt;p&gt;è°ƒç”¨&lt;code&gt;flush_old_exec(bprm)&lt;/code&gt;é‡Šæ”¾æ—§ç¨‹åºçš„ä»£ç æ®µã€æ•°æ®æ®µã€æ ˆç­‰èµ„æº&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;setup_new_exec(bprm)&lt;/code&gt;åˆå§‹åŒ–&lt;code&gt;mm_struct&lt;/code&gt;(è¿›ç¨‹åœ°å€ç©ºé—´æè¿°ç¬¦)ã€åœ°å€ç©ºé—´&lt;/p&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;setup_arg_pages()&lt;/code&gt;ï¼Œä¸ºè¿›ç¨‹åˆ†é…ç”¨æˆ·æ€æ ˆï¼Œå°†&lt;code&gt;argv&lt;/code&gt;ã€&lt;code&gt;envp&lt;/code&gt;å†™å…¥æ ˆé¡¶&lt;/p&gt;
&lt;h2 id=&#34;æ˜ å°„æ®µåˆ°å†…å­˜&#34;&gt;æ˜ å°„æ®µåˆ°å†…å­˜
&lt;/h2&gt;&lt;p&gt;æ ¹æ®è§„åˆ’å¥½çš„å†…å­˜å¸ƒå±€ï¼ŒåŠ è½½å™¨å¼€å§‹ä¸ºæ¯ä¸€ä¸ª&lt;code&gt;LOAD&lt;/code&gt;æ®µæ‰§è¡Œå†…å­˜æ˜ å°„æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼Œäº&lt;code&gt;p_vaddr&lt;/code&gt;å¤„å¼€è¾Ÿä¸€å—å†…å­˜åŒºåŸŸï¼Œå¤§å°ä¸º&lt;code&gt;p_memsz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œå°†æ®µçš„æ•°æ®ä»ELFæ–‡ä»¶ä¸­ï¼ˆä»&lt;code&gt;p_offset&lt;/code&gt;åç§»é‡å¼€å§‹ï¼‰å¤åˆ¶åˆ°åˆšåˆšå¼€è¾Ÿçš„è™šæ‹Ÿå†…å­˜ä¸­ï¼Œå¤åˆ¶çš„æ•°æ®é‡ä¸º&lt;code&gt;p_filesz&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&lt;code&gt;p_memsz&lt;/code&gt;ï¼ˆå†…å­˜å¤§å°ï¼‰å¸¸å¸¸ä¼šå¤§äº&lt;code&gt;p_filesz&lt;/code&gt;ï¼ˆæ–‡ä»¶å¤§å°ï¼‰&lt;/p&gt;
&lt;p&gt;è¿™ç§å·®å¼‚é€šå¸¸æ˜¯ä¸ºäº†æ–¹ä¾¿&lt;code&gt;.bss&lt;/code&gt;èŠ‚ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯æœªåˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€å˜é‡ï¼Œå®ƒä»¬åœ¨ç¨‹åºè¿è¡Œå‰æ²¡æœ‰å…·ä½“å€¼ï¼Œå› æ­¤åœ¨æ–‡ä»¶ä¸­æ— éœ€å­˜å‚¨ï¼Œä¸å ç”¨ç£ç›˜ç©ºé—´&lt;/p&gt;
&lt;p&gt;åŠ è½½å™¨ä¼šåœ¨å†…å­˜ä¸­å°†&lt;code&gt;p_memsz&lt;/code&gt;ä¸&lt;code&gt;p_filesz&lt;/code&gt;ä¹‹é—´çš„å·®é¢éƒ¨åˆ†å…¨éƒ¨ç”¨0å¡«å……ï¼Œä»è€Œå®Œæˆè¿™äº›å˜é‡çš„é»˜è®¤åˆå§‹åŒ–&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;æœ€åï¼ŒåŠ è½½å™¨æ ¹æ®ç¨‹åºå¤´è¡¨ä¸­ä¸ºè¯¥æ®µæŒ‡å®šçš„æƒé™ä½ï¼Œè®¾ç½®è¿™å—å†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™&lt;/p&gt;
&lt;h2 id=&#34;è®¾ç½®å…¥å£ç‚¹&#34;&gt;è®¾ç½®å…¥å£ç‚¹
&lt;/h2&gt;&lt;p&gt;å¯¹äºé™æ€é“¾æ¥ç¨‹åºï¼Œç›´æ¥ä½¿ç”¨ELFå¤´ä¸­çš„&lt;code&gt;e_entry&lt;/code&gt;ä½œä¸ºå…¥å£&lt;/p&gt;
&lt;p&gt;å¯¹äºåŠ¨æ€é“¾æ¥ç¨‹åºï¼Œå…¥å£ç‚¹ç”±åŠ¨æ€é“¾æ¥å™¨æä¾›&lt;/p&gt;
&lt;h2 id=&#34;è¿”å›ç”¨æˆ·æ€&#34;&gt;è¿”å›ç”¨æˆ·æ€
&lt;/h2&gt;&lt;p&gt;è°ƒç”¨&lt;code&gt;start_thread()&lt;/code&gt;åˆå§‹åŒ–ç”¨æˆ·æ€å¯„å­˜å™¨ï¼Œè®¾ç½®&lt;code&gt;EIP&lt;/code&gt;ä¸ºç¨‹åºå…¥å£ï¼Œè®¾ç½®&lt;code&gt;ESP&lt;/code&gt;ä¸ºæ ˆé¡¶ï¼Œè®¾ç½®CPUæ ‡å¿—ä½&lt;/p&gt;
&lt;h2 id=&#34;å¯åŠ¨ç¨‹åºæ‰§è¡Œ&#34;&gt;å¯åŠ¨ç¨‹åºæ‰§è¡Œ
&lt;/h2&gt;&lt;p&gt;æ§åˆ¶æƒäº¤ç»™ELFç¨‹åºï¼Œç¨‹åºä»å…¥å£ç‚¹&lt;code&gt;_start&lt;/code&gt;æˆ–åŠ¨æ€é“¾æ¥å™¨å…¥å£å¼€å§‹è¿è¡Œ&lt;/p&gt;
</description>
        </item>
        <item>
        <title>é€†å‘åŸºç¡€2ï¼šå¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%802%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E6%A6%82%E8%BF%B0/</link>
        <pubDate>Thu, 09 Oct 2025 15:52:32 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%802%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E6%A6%82%E8%BF%B0/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/fd5a5ff7fbfb389c2ea3c8f72e2c9e69.png" alt="Featured image of post é€†å‘åŸºç¡€2ï¼šå¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°" /&gt;&lt;p&gt;æ¯”è¾ƒç®€çŸ­ï¼Œç»“åˆ&lt;a class=&#34;link&#34; href=&#34;https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%801%E5%86%85%E5%AD%98%E4%B8%8E%E6%B1%87%E7%BC%96/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;é€†å‘åŸºç¡€1
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    
&lt;/a&gt;çœ‹å§ï¼Œä¹‹åçš„å†…å®¹æ¯”è¾ƒå¤æ‚å°±å•ç‹¬å¼€ç¯‡äº†~&lt;/p&gt;
&lt;h1 id=&#34;ä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;ä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶
&lt;/h1&gt;&lt;h2 id=&#34;ç¼–ç¨‹è¯­è¨€çš„å±‚æ¬¡&#34;&gt;ç¼–ç¨‹è¯­è¨€çš„å±‚æ¬¡
&lt;/h2&gt;&lt;p&gt;è®¡ç®—æœºç¡¬ä»¶çš„ä¸–ç•Œå»ºç«‹åœ¨äºŒè¿›åˆ¶ä¹‹ä¸Šï¼Œç”µå­å™¨ä»¶çš„å¼€ä¸å…³ç›´æ¥å¯¹åº”ç€0å’Œ1&lt;/p&gt;
&lt;p&gt;è¦é©±åŠ¨è¿™äº›ç¡¬ä»¶ï¼Œå°±éœ€è¦ä¸€ç§å®ƒä»¬èƒ½ç›´æ¥â€œå¬æ‡‚â€çš„è¯­è¨€ï¼Œè¿™ä¾¿æ˜¯ç¼–ç¨‹è¯­è¨€æ¼”è¿›çš„èµ·ç‚¹&lt;/p&gt;
&lt;h3 id=&#34;æœºå™¨è¯­è¨€&#34;&gt;æœºå™¨è¯­è¨€
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯æœ€åº•å±‚çš„è¯­è¨€&lt;/p&gt;
&lt;p&gt;å®ƒç”±0å’Œ1ç»„æˆçš„äºŒè¿›åˆ¶åºåˆ—æ„æˆï¼Œå³æœºå™¨ç æˆ–åŸç”Ÿç ï¼ŒCPUå¯ä»¥ä¸ç»ä»»ä½•ç¿»è¯‘ç›´æ¥è§£è¯»å¹¶æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;æ—©æœŸçš„è®¡ç®—æœºç¨‹åºï¼Œä¾‹å¦‚1951å¹´â€œå“ˆç»´å°”Â·å¾·å¡ç‰¹ä¼¦â€è®¡ç®—æœºæ‰€ä½¿ç”¨çš„ç©¿å­”çº¸å¸¦ï¼Œè®°å½•çš„å°±æ˜¯è¿™ç§æœºå™¨ç &lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå®ƒå®Œå…¨æ²¡æœ‰å¯ç§»æ¤æ€§ï¼Œä¸”å¯¹äººç±»æ¥è¯´æå…¶æ™¦æ¶©éš¾æ‡‚ï¼Œæ¯•ç«Ÿè°ä¼šå»èƒŒé‚£ä¹ˆå¤šä¸åŒçš„ä¸€é•¿ä¸²çš„0å’Œ1ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;æ±‡ç¼–è¯­è¨€&#34;&gt;æ±‡ç¼–è¯­è¨€
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ”¹å–„æœºå™¨è¯­è¨€çš„å¯è¯»æ€§ï¼Œæ±‡ç¼–è¯­è¨€åº”è¿è€Œç”Ÿï¼Œå®ƒä½¿ç”¨åŠ©è®°ç¬¦æ¥ä»£æ›¿äºŒè¿›åˆ¶æŒ‡ä»¤ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºç¬¦å·è¯­è¨€&lt;/p&gt;
&lt;p&gt;æ±‡ç¼–è¯­è¨€ä¸æœºå™¨è¯­è¨€å‡ ä¹æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œåœ¨æ‰§è¡Œå‰éœ€è¦é€šè¿‡&lt;strong&gt;æ±‡ç¼–å™¨&lt;/strong&gt;è½¬æ¢ä¸ºç›®æ ‡å¹³å°çš„æœºå™¨ç &lt;/p&gt;
&lt;p&gt;ä½†å°½ç®¡å®ƒçš„å¯è¯»æ€§å¤§å¹…æå‡äº†ï¼Œå´ä¾ç„¶ä¸ç‰¹å®šçš„CPUæŒ‡ä»¤é›†æ¶æ„ç»‘å®šï¼Œå¯ç§»æ¤æ€§å¾ˆå·®&lt;/p&gt;
&lt;h3 id=&#34;é«˜çº§è¯­è¨€&#34;&gt;é«˜çº§è¯­è¨€
&lt;/h3&gt;&lt;p&gt;é«˜çº§è¯­è¨€æ˜¯ç¼–ç¨‹é¢†åŸŸçš„ä¼Ÿå¤§åˆä¼Ÿå¤§çš„é©å‘½&lt;/p&gt;
&lt;p&gt;å®ƒé«˜åº¦æŠ½è±¡å’Œå°è£…äº†åº•å±‚ç¡¬ä»¶ç»†èŠ‚ï¼Œè¯­æ³•ç»“æ„æ›´æ¥è¿‘è‡ªç„¶è¯­è¨€ï¼Œé€»è¾‘ä¹Ÿæ›´è´´åˆäººç±»çš„æ€ç»´ä¹ æƒ¯&lt;/p&gt;
&lt;p&gt;è¿™ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥ä»ç¹ççš„å†…å­˜åœ°å€å’Œå¯„å­˜å™¨æ“ä½œä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œä»è€Œæå¤§åœ°æé«˜äº†å¼€å‘æ•ˆç‡å’Œä»£ç çš„å¯è¯»æ€§&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šæˆ‘ä»¬ç†ŸçŸ¥çš„ Java, C, C++, Python, C# ç­‰ç­‰ï¼Œéƒ½å±äºé«˜çº§è¯­è¨€&lt;/p&gt;
&lt;h2 id=&#34;ç¼–è¯‘ä¸è§£é‡Š&#34;&gt;ç¼–è¯‘ä¸è§£é‡Š
&lt;/h2&gt;&lt;p&gt;æ‹¥æœ‰äº†ç¼–ç¨‹è¯­è¨€è¿™ä¸€å·¥å…·åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥ä½œå°æ¥ç¼–å†™ã€è°ƒè¯•å’Œç”Ÿæˆç¨‹åº&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå·¥ä½œå°å°±æ˜¯&lt;strong&gt;IDEï¼ˆIntegrated Development Environmentï¼Œé›†æˆå¼€å‘ç¯å¢ƒï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡IDEï¼Œæˆ‘ä»¬å¯ä»¥å°†æºä»£ç è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ç¨‹åºï¼Œæ ¹æ®ç”Ÿæˆå’Œè¿è¡Œæ–¹å¼çš„ä¸åŒï¼Œç¨‹åºä¸»è¦åˆ†ä¸ºä¸¤ç±»&lt;/p&gt;
&lt;h3 id=&#34;ç¼–è¯‘å‹ç¨‹åº&#34;&gt;ç¼–è¯‘å‹ç¨‹åº
&lt;/h3&gt;&lt;p&gt;åœ¨æ‰§è¡Œå‰ï¼Œé€šè¿‡ç¼–è¯‘å™¨å°†å…¨éƒ¨æºä»£ç ä¸€æ¬¡æ€§ç¿»è¯‘æˆç›®æ ‡å¹³å°çš„æœºå™¨ç ï¼Œå¹¶æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;è¿è¡Œæ•ˆç‡éå¸¸é«˜ï¼Œè·¨å¹³å°æ€§å·®ï¼Œæ¯”å¦‚ä¸ºWindowsç¼–è¯‘çš„ç¨‹åºæ— æ³•ç›´æ¥åœ¨Linuxä¸Šè¿è¡Œ&lt;/p&gt;
&lt;p&gt;Cã€C++ã€Goéƒ½æ˜¯å¦‚æ­¤&lt;/p&gt;
&lt;h3 id=&#34;è§£é‡Šå‹ç¨‹åº&#34;&gt;è§£é‡Šå‹ç¨‹åº
&lt;/h3&gt;&lt;p&gt;è¿è¡Œæ—¶ï¼Œç”±è§£é‡Šå™¨é€è¡Œè¯»å–æºä»£ç ï¼Œå¹¶å³æ—¶ç¿»è¯‘æˆæœºå™¨ç äº¤ç»™CPUæ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;è·¨å¹³å°æ€§å¥½ï¼Œåªè¦æœ‰è§£é‡Šå™¨ï¼Œä»£ç å°±èƒ½è¿è¡Œï¼Œä½†æ˜¯è¿è¡Œæ•ˆç‡ç›¸å¯¹è¾ƒä½&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨çš„æœ‰Python, JavaScript, Ruby&lt;/p&gt;
&lt;h3 id=&#34;æ··åˆå‹èŒƒä¾‹&#34;&gt;æ··åˆå‹èŒƒä¾‹
&lt;/h3&gt;&lt;p&gt;Javaï¼&lt;/p&gt;
&lt;p&gt;æ‰€è°“â€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„Javaé‡‡ç”¨äº†ä¸€ç§å·§å¦™çš„æ··åˆæ¨¡å¼ï¼Œæºä»£ç é¦–å…ˆè¢«ç¼–è¯‘æˆä¸€ç§å¹³å°æ— å…³çš„ä¸­é—´ä»£ç â€”â€”&lt;strong&gt;å­—èŠ‚ç ï¼ˆ.classæ–‡ä»¶ï¼‰&lt;/strong&gt;ï¼Œç„¶åï¼Œåœ¨ä¸åŒå¹³å°ä¸Šçš„**Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰**ä¼šè§£é‡Šæ‰§è¡Œè¿™äº›å­—èŠ‚ç &lt;/p&gt;
&lt;p&gt;ä¸ºäº†æå‡æ€§èƒ½ï¼ŒJVMè¿˜å¼•å…¥äº†JITï¼ˆJust-In-Time Compilationï¼Œå³æ—¶ç¼–è¯‘ï¼‰æŠ€æœ¯ï¼Œå®ƒä¼šå°†é¢‘ç¹æ‰§è¡Œçš„â€œçƒ­ç‚¹ä»£ç â€ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œä»è€Œå®ç°æ¥è¿‘ç¼–è¯‘å‹è¯­è¨€çš„è¿è¡Œæ•ˆç‡ï¼ŒçœŸæ˜¯å¾ˆæœ‰åˆ›æ–°äº†&lt;/p&gt;
&lt;h2 id=&#34;cç¨‹åºçš„æ„å»º&#34;&gt;Cç¨‹åºçš„æ„å»º
&lt;/h2&gt;&lt;p&gt;ä½œä¸ºç¼–è¯‘å‹è¯­è¨€çš„å…¸èŒƒï¼ŒC/C++ç¨‹åºçš„ç”Ÿæˆè¿‡ç¨‹æ˜¯ç†è§£å¯æ‰§è¡Œæ–‡ä»¶ç»“æ„çš„åŸºç¡€&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹çš„æœ€ç»ˆäº§ç‰©ï¼Œä¾¿æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®ƒä¸»è¦ç»å†&lt;strong&gt;ç¼–è¯‘&lt;/strong&gt;å’Œ&lt;strong&gt;é“¾æ¥&lt;/strong&gt;ä¸¤å¤§é˜¶æ®µ&lt;/p&gt;
&lt;h3 id=&#34;ç¼–è¯‘&#34;&gt;ç¼–è¯‘
&lt;/h3&gt;&lt;p&gt;æ­¤é˜¶æ®µç”±ç¼–è¯‘å™¨è´Ÿè´£ï¼Œå°†æºä»£ç æ–‡ä»¶ï¼ˆ&lt;code&gt;.c&lt;/code&gt;ï¼‰è½¬æ¢ä¸ºåŒ…å«æœºå™¨ç çš„ç›®æ ‡æ–‡ä»¶ï¼ˆ&lt;code&gt;.o&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„&lt;code&gt;hello.c&lt;/code&gt;ç¨‹åºä¸ºä¾‹&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;æºç helloc&#34;&gt;æºç ï¼ˆhello.cï¼‰
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#7f848e&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#c678dd&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010133610168&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010133610168.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010133610168.png&#34; alt=&#34;image-20251010133610168&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;é¢„å¤„ç†ç¼–è¯‘ä¸ºæ±‡ç¼–-hellos&#34;&gt;é¢„å¤„ç†ã€ç¼–è¯‘ä¸ºæ±‡ç¼– (hello.s)
&lt;/h4&gt;&lt;p&gt;ç¼–è¯‘å™¨é¦–å…ˆè¿›è¡Œé¢„å¤„ç†ï¼ˆæ¯”å¦‚åŒ…å«å¤´æ–‡ä»¶ï¼‰ï¼Œç„¶åå°†Cä»£ç ç¿»è¯‘æˆæ±‡ç¼–ä»£ç &lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# -S é€‰é¡¹: ä»…ç¼–è¯‘ï¼Œä¸è¿›è¡Œåç»­çš„æ±‡ç¼–å’Œé“¾æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -S -o hello.s hello.c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010133737711&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010133737711.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010133737711.png&#34; alt=&#34;image-20251010133737711&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;æ±‡ç¼–ä¸ºç›®æ ‡æ–‡ä»¶helloo&#34;&gt;æ±‡ç¼–ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆhello.oï¼‰
&lt;/h4&gt;&lt;p&gt;æ±‡ç¼–å™¨å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶çš„ç›®æ ‡æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æœºå™¨ç ï¼Œä½†è¿˜ä¸èƒ½ç‹¬ç«‹è¿è¡Œï¼Œå› ä¸ºå®ƒå¯èƒ½å¼•ç”¨äº†å…¶ä»–å¤–éƒ¨å‡½æ•°ï¼ˆæ¯”å¦‚&lt;code&gt;printf&lt;/code&gt;å°±æ˜¯å¤–éƒ¨å‡½æ•°ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# -c é€‰é¡¹: ç¼–è¯‘å¹¶æ±‡ç¼–ï¼Œä½†ä¸é“¾æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -c -o hello.o hello.s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010133908624&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010133908624.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010133908624.png&#34; alt=&#34;image-20251010133908624&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;çœ‹ä¸æ‡‚å‘¢&amp;hellip;&amp;hellip;å› ä¸ºè¿™æ˜¯äºŒè¿›åˆ¶ï¼Œæ²¡åŠæ³•å®Œå…¨è½¬æˆæ­£å¸¸çš„unicodeï¼Œä½¿ç”¨odæŸ¥çœ‹åŸå§‹çš„æ•°æ®ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010134108713&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010134108713.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010134108713.png&#34; alt=&#34;image-20251010134108713&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯çœ‹ä¸æ‡‚å“ˆå“ˆï¼Œå…¶å®è¿˜å¯ä»¥ä½¿ç”¨&lt;code&gt;objdump&lt;/code&gt;å‘½ä»¤æŸ¥çœ‹ï¼Œæœ¬è´¨å°±æ˜¯&lt;code&gt;.s&lt;/code&gt;æ–‡ä»¶ç¿»è¯‘çš„æœºå™¨ç è€Œå·²&lt;/p&gt;
&lt;p&gt;ç”¨&lt;code&gt;-d&lt;/code&gt;é€‰é¡¹åæ±‡ç¼–æ‰€æœ‰å¯æ‰§è¡ŒèŠ‚ï¼Œ&lt;code&gt;-M intel&lt;/code&gt;æŒ‡å®šä½¿ç”¨intelæ±‡ç¼–è¯­æ³•ï¼ˆæ¦‚å¿µçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œåé¢éƒ½ä¼šæœ‰çš„ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010134453910&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010134453910.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010134453910.png&#34; alt=&#34;image-20251010134453910&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;é“¾æ¥&#34;&gt;é“¾æ¥
&lt;/h3&gt;&lt;p&gt;é“¾æ¥å™¨çš„ä»»åŠ¡æ˜¯å°†ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æ–‡ä»¶ä»¥åŠå®ƒä»¬æ‰€éœ€çš„ç³»ç»Ÿåº“â€œé“¾æ¥â€åœ¨ä¸€èµ·ï¼Œç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;å…¶æ ¸å¿ƒå·¥ä½œæ˜¯&lt;strong&gt;ç¬¦å·è§£æ&lt;/strong&gt;å’Œ&lt;strong&gt;é‡å®šä½&lt;/strong&gt;ï¼ˆä¸‹æ–‡ä¼šè¯´è¿™æ˜¯å•¥ï¼‰&lt;/p&gt;
&lt;p&gt;é“¾æ¥åˆ†ä¸ºä¸¤ç§ä¸»è¦æ–¹å¼ï¼š&lt;/p&gt;
&lt;h4 id=&#34;åŠ¨æ€é“¾æ¥&#34;&gt;åŠ¨æ€é“¾æ¥
&lt;/h4&gt;&lt;p&gt;ç°åœ¨æœ€ä¸ºå¸¸ç”¨çš„é“¾æ¥æ–¹å¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åªåœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­è®°å½•æ‰€éœ€åº“çš„å¼•ç”¨ä¿¡æ¯ï¼Œç¨‹åºè¿è¡Œæ—¶ï¼Œç”±æ“ä½œç³»ç»ŸåŠ è½½å…±äº«çš„åº“æ–‡ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;èŠ‚çº¦èµ„æºã€æ˜“äºæ›´æ–°ï¼Œä½†æ˜¯ä¾èµ–å¤–éƒ¨ç¯å¢ƒ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# é»˜è®¤è¿›è¡ŒåŠ¨æ€é“¾æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ hello&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -o hello hello.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010135257589&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010135257589.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010135257589.png&#34; alt=&#34;image-20251010135257589&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;é™æ€é“¾æ¥&#34;&gt;é™æ€é“¾æ¥
&lt;/h4&gt;&lt;p&gt;å°†æ‰€æœ‰ä¾èµ–çš„åº“ä»£ç å®Œæ•´åœ°å¤åˆ¶å¹¶åˆå¹¶åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­&lt;/p&gt;
&lt;p&gt;å¯ç‹¬ç«‹è¿è¡Œï¼Œä½†ä½“ç§¯å¤§ä¸”æ›´æ–°å›°éš¾&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;# ä½¿ç”¨ -static é€‰é¡¹è¿›è¡Œé™æ€é“¾æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;gcc -static -o hello_static hello.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010140156961&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010140156961.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010140156961.png&#34; alt=&#34;image-20251010140156961&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;å¯¹æ¯”ä¸€ä¸‹å°±èƒ½çœ‹å‡ºå®ƒæœ‰å¤šå¤§ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010140247990&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010140247990.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010140247990.png&#34; alt=&#34;image-20251010140247990&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;åŠ¨æ€é“¾æ¥çš„åªè¦ä¸€ä¸‡å¤šå­—èŠ‚ï¼Œè€Œé™æ€çš„è¦å…«åä¸‡å­—èŠ‚ï¼&lt;del&gt;æ—å†²&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æˆ‘ä»¬åœ¨ä¹‹åä¼šè¯¦ç»†è¯´æ˜è¿™ä¸¤ç§é“¾æ¥æ–¹å¼çš„å®ç°&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶
&lt;/h1&gt;&lt;h2 id=&#34;ä½•ä¸ºå¯æ‰§è¡Œæ–‡ä»¶&#34;&gt;ä½•ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Ÿ
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸Šæ–‡ï¼Œç¼–è¯‘åé“¾æ¥ç”Ÿæˆçš„è¿™ä¸ªæ–‡ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œä»–æ˜¯èƒ½ç›´æ¥è¢«ç”¨æˆ·æ‰§è¡Œçš„æ–‡ä»¶ï¼Œè¿™ä¸ªåç§°ä¹Ÿæ˜¯ä¸€ç±»æ–‡ä»¶çš„è§„èŒƒï¼Œå®ƒå®šä¹‰äº†é“¾æ¥å™¨å’ŒåŠ è½½å™¨å¦‚ä½•å¤„ç†å’Œæ‰§è¡ŒäºŒè¿›åˆ¶ä»£ç ï¼Œè§„å®šäº†ä»£ç ã€æ•°æ®ã€å…ƒä¿¡æ¯ç­‰å†…å®¹å¦‚ä½•ç»„ç»‡åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­&lt;/p&gt;
&lt;p&gt;ç›®å‰ï¼Œä¸»æµæ“ä½œç³»ç»Ÿä¸»è¦ä½¿ç”¨ä¸¤ç§æ ¼å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Unix/Linux ç³»ç»Ÿï¼š ELF ï¼ˆExecutable and Linkable Formatï¼Œå¯æ‰§è¡Œå’Œå¯é“¾æ¥æ ¼å¼ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Windows ç³»ç»Ÿï¼šPE ï¼ˆPortable Executableï¼Œä¾¿æºå¯æ‰§è¡Œæ–‡ä»¶ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¹‹åæˆ‘ä»¬ä¼šè¯¦ç»†è®²å®ƒä»¬ä¿©ï¼Œä¸è¿‡ä¸æ˜¯è¿™ä¸€ç¯‡&lt;/p&gt;
&lt;h2 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶çš„å…ƒä¿¡æ¯&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶çš„å…ƒä¿¡æ¯
&lt;/h2&gt;&lt;p&gt;å¯æ‰§è¡Œæ–‡ä»¶ä¸æ˜¯çº¯ç²¹çš„æœºå™¨ç é›†åˆï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆç›®æ ‡æ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€‰æ‹©æ€§åœ°åµŒå…¥ä¸°å¯Œçš„å…ƒä¿¡æ¯&lt;/p&gt;
&lt;p&gt;è¿™äº›ä¿¡æ¯å¯¹äºé“¾æ¥ã€è°ƒè¯•å’Œç¨‹åºåˆ†æè‡³å…³é‡è¦ã€‚å…ƒä¿¡æ¯çš„å­˜åœ¨ä¸å¦ï¼Œç›´æ¥å†³å®šäº†é€†å‘åˆ†æå’Œè°ƒè¯•çš„éš¾æ˜“ç¨‹åº¦&lt;/p&gt;
&lt;p&gt;ä¸»è¦çš„å…ƒä¿¡æ¯åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç±»ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ç¬¦å·è¡¨&#34;&gt;ç¬¦å·è¡¨
&lt;/h3&gt;&lt;p&gt;ç¬¦å·è¡¨è®°å½•äº†æºä»£ç ä¸­çš„ç¬¦å·ä¿¡æ¯ï¼Œä¾‹å¦‚å‡½æ•°åã€å…¨å±€å˜é‡åç­‰&lt;/p&gt;
&lt;p&gt;è¡¨ä¸­æ¯ä¸€ä¸ªè¡¨é¡¹éƒ½åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¬¦å·å&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç»‘å®šåœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¬¦å·ç±»å‹&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å…¶ä»–ä¿¡æ¯&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é“¾æ¥å™¨ï¼ˆç”¨äºè§£æä¸åŒæ–‡ä»¶é—´çš„ç¬¦å·å¼•ç”¨ï¼‰å’Œè°ƒè¯•å™¨ï¼ˆç”¨äºå°†åœ°å€æ˜ å°„å›äººç±»å¯è¯»çš„åç§°ï¼‰éƒ½ä¼šä½¿ç”¨å®ƒ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨objdumpæŸ¥çœ‹ç¬¦å·è¡¨ï¼ˆ&lt;code&gt;-t&lt;/code&gt;ï¼‰å’ŒåŠ¨æ€ç¬¦å·è¡¨ï¼ˆ&lt;code&gt;-T&lt;/code&gt;ï¼‰ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;objdump -tT hello
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010141137496&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010141137496.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010141137496.png&#34; alt=&#34;image-20251010141137496&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨readelfæŸ¥çœ‹ç¬¦å·ä¿¡æ¯ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;readelf -s hello
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010141213960&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010141213960.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010141213960.png&#34; alt=&#34;image-20251010141213960&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;é‡å®šä½ä¿¡æ¯&#34;&gt;é‡å®šä½ä¿¡æ¯
&lt;/h3&gt;&lt;p&gt;åœ¨ç¼–è¯‘å•ä¸ªæ–‡ä»¶æ—¶ï¼Œç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“å‡½æ•°å’Œå…¨å±€æ•°æ®æœ€ç»ˆä¼šè¢«åŠ è½½åˆ°å†…å­˜çš„å“ªä¸ªç¡®åˆ‡åœ°å€ï¼Œå› æ­¤ï¼Œå®ƒä¼šåœ¨ä»£ç ä¸­ç•™ä¸‹æ ‡è®°ï¼Œå¹¶ç”Ÿæˆä¸€ç³»åˆ—çš„é‡å®šä½å…¥å£&lt;/p&gt;
&lt;p&gt;å½“é“¾æ¥å™¨å°†æ‰€æœ‰ç›®æ ‡æ–‡ä»¶ç»„åˆæ—¶ï¼Œå®ƒä¼šæ ¹æ®è¿™äº›å…¥å£ä¿¡æ¯ï¼Œç”¨æœ€ç»ˆçš„ç»å¯¹åœ°å€æˆ–ç›¸å¯¹åœ°å€æ¥â€œä¿®è¡¥â€è¿™äº›ä»£ç ï¼Œç¡®ä¿ç¨‹åºèƒ½å¤Ÿæ­£ç¡®è·³è½¬å’Œè®¿é—®æ•°æ®&lt;/p&gt;
&lt;h3 id=&#34;è°ƒè¯•ä¿¡æ¯&#34;&gt;è°ƒè¯•ä¿¡æ¯
&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œç¼–è¯‘å™¨å¯ä»¥ç”Ÿæˆè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼Œå¹¶å°†å…¶åµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­&lt;/p&gt;
&lt;p&gt;è°ƒè¯•ä¿¡æ¯åŒ…å«æºä»£ç æ–‡ä»¶åã€è¡Œå·ä¿¡æ¯ã€å˜é‡çš„ç±»å‹ä¸ä½œç”¨åŸŸç­‰ï¼Œè¿™å°†äºŒè¿›åˆ¶ä»£ç ä¸åŸå§‹çš„æºä»£ç å…³è”èµ·æ¥&lt;/p&gt;
&lt;p&gt;è°ƒè¯•å™¨å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨æºä»£ç çº§åˆ«è®¾ç½®æ–­ç‚¹ã€æŸ¥çœ‹å˜é‡å€¼ï¼Œæå¤§åœ°æé«˜äº†è°ƒè¯•æ•ˆç‡&lt;/p&gt;
&lt;h2 id=&#34;ç²¾ç®€ä¸éç²¾ç®€äºŒè¿›åˆ¶&#34;&gt;ç²¾ç®€ä¸éç²¾ç®€äºŒè¿›åˆ¶
&lt;/h2&gt;&lt;p&gt;æ ¹æ®æ˜¯å¦åŒ…å«ä¸Šè¿°å…ƒä¿¡æ¯ï¼Œå¯æ‰§è¡Œæ–‡ä»¶å¯åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éç²¾ç®€äºŒè¿›åˆ¶ï¼ˆUnstrippedï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŒ…å«å®Œæ•´çš„å…ƒä¿¡æ¯ï¼Œä½“ç§¯è¾ƒå¤§ï¼Œä½†æ˜“äºè°ƒè¯•å’Œåæ±‡ç¼–&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç²¾ç®€äºŒè¿›åˆ¶ï¼ˆStrippedï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åªä¿ç•™è¿è¡Œå¿…éœ€çš„çº¯ä»£ç ï¼Œå‡ ä¹æ‰€æœ‰å…ƒä¿¡æ¯éƒ½è¢«ç§»é™¤&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿›è¡Œç²¾ç®€å¯ä»¥æ˜¾è‘—å‡å°æ–‡ä»¶ä½“ç§¯ï¼Œå¹¶ä¸”ç”±äºç¼ºå°‘ç¬¦å·ä¿¡æ¯ï¼Œå¤§å¤§å¢åŠ äº†é€†å‘å·¥ç¨‹çš„éš¾åº¦&lt;/p&gt;
&lt;p&gt;åœ¨Linuxç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;strip&lt;/code&gt;å‘½ä»¤æ¥å®Œæˆè¿™ä¸ªç²¾ç®€è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;strip hello
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251010142239669&#34; href=&#34;http://picture.928330.xyz/typora/image-20251010142239669.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251010142239669.png&#34; alt=&#34;image-20251010142239669&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
</description>
        </item>
        <item>
        <title>é€†å‘åŸºç¡€1ï¼šå†…å­˜ä¸æ±‡ç¼–</title>
        <link>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%801%E5%86%85%E5%AD%98%E4%B8%8E%E6%B1%87%E7%BC%96/</link>
        <pubDate>Tue, 07 Oct 2025 14:46:52 +0800</pubDate>
        
        <guid>https://blog.928330.xyz/p/%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%801%E5%86%85%E5%AD%98%E4%B8%8E%E6%B1%87%E7%BC%96/</guid>
        <description>&lt;img src="http://picture.928330.xyz/typora/b0cd314b8588e4e7b43938004c890c48.png" alt="Featured image of post é€†å‘åŸºç¡€1ï¼šå†…å­˜ä¸æ±‡ç¼–" /&gt;&lt;p&gt;æ—©å°±æƒ³å­¦äº†ï¼Œæ­£å¥½å­¦æ ¡é€‰ä¿®äº†è¿™é—¨è¯¾ï¼Œè·Ÿç€è€å¸ˆçš„è¿›åº¦è®°å½•ä¸€ä¸‹&lt;/p&gt;
&lt;h1 id=&#34;ä½“ç³»ç»“æ„&#34;&gt;ä½“ç³»ç»“æ„
&lt;/h1&gt;&lt;h2 id=&#34;x86-ä¸-x64&#34;&gt;x86 ä¸ x64
&lt;/h2&gt;&lt;h3 id=&#34;x86focusia-32&#34;&gt;x86ï¼ˆfocusï¼šIA-32ï¼‰
&lt;/h3&gt;&lt;p&gt;ä¸€ä¸ªåŸºäºIntel8086å¤„ç†å™¨ï¼Œå‘åå…¼å®¹çš„æŒ‡ä»¤é›†ä½“ç³»ç»“æ„ï¼ˆISAï¼ŒInstruction Set Architectureï¼‰çš„æ€»ç§°&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„x86é€†å‘ï¼Œä¸»è¦æŒ‡çš„æ˜¯å…¶32ä½ç‰ˆæœ¬ï¼Œå³&lt;strong&gt;IA-32&lt;/strong&gt;ï¼ˆIntel Architecture, 32-bitï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IA-32æ¶æ„æœ‰ä¸‰ç§ä¸»è¦æ“ä½œæ¨¡å¼ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®æ¨¡å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;16ä½è¿è¡Œç¯å¢ƒï¼Œæ˜¯æ—©æœŸMS-DOSç­‰æ“ä½œç³»ç»Ÿä½¿ç”¨çš„æ¨¡å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¿æŠ¤æ¨¡å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç°ä»£æ“ä½œç³»ç»Ÿæ‰€é‡‡ç”¨çš„æ¨¡å¼ï¼Œæ”¯æŒè™šæ‹Ÿå†…å­˜ã€åˆ†é¡µç­‰é«˜çº§ç‰¹æ€§ï¼Œä¸ºç¨‹åºæä¾›äº†ç‹¬ç«‹çš„ã€å—ä¿æŠ¤çš„å†…å­˜ç©ºé—´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç³»ç»Ÿç®¡ç†æ¨¡å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”¨äºæ‰§è¡Œå›ºä»¶ä¸­çš„ç‰¹æ®Šç³»ç»Ÿç®¡ç†ä»£ç &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;x64&#34;&gt;x64
&lt;/h3&gt;&lt;p&gt;ä¹Ÿç§°ä¸ºx86-64ï¼Œæ˜¯x86ä½“ç³»ç»“æ„çš„64ä½æ‰©å±•ï¼Œå®ƒå®Œå…¨å…¼å®¹IA-32ï¼Œæ„å‘³ç€32ä½ç¨‹åºå¯ä»¥åœ¨64ä½ç³»ç»Ÿä¸Šè¿è¡Œ&lt;/p&gt;
&lt;h2 id=&#34;å­—èŠ‚åº&#34;&gt;å­—èŠ‚åº
&lt;/h2&gt;&lt;p&gt;å­—èŠ‚åºå®šä¹‰äº†å¤šå­—èŠ‚æ•°æ®ï¼ˆå¦‚ä¸€ä¸ª4å­—èŠ‚çš„æ•´æ•°ï¼‰åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•æ’åˆ—çš„&lt;/p&gt;
&lt;h3 id=&#34;å°ç«¯åº&#34;&gt;å°ç«¯åº
&lt;/h3&gt;&lt;p&gt;æ•°æ®çš„ä½ä½å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜çš„ä½åœ°å€å¤„&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯Intel x86/x64æ¶æ„ä½¿ç”¨çš„æ¨¡å¼ï¼Œå› å…¶ç”µè·¯è®¾è®¡å’Œæ•°æ®å¤„ç†æ•ˆç‡è¾ƒé«˜&lt;/p&gt;
&lt;h3 id=&#34;å¤§ç«¯åº&#34;&gt;å¤§ç«¯åº
&lt;/h3&gt;&lt;p&gt;æ•°æ®çš„é«˜ä½å­—èŠ‚å­˜å‚¨åœ¨å†…å­˜çš„ä½åœ°å€å¤„&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼æ›´ç¬¦åˆäººç±»çš„é˜…è¯»ä¹ æƒ¯ï¼Œå¸¸è§äºä¸€äº›RISCæ¶æ„çš„å¤„ç†å™¨&lt;/p&gt;
&lt;h3 id=&#34;ä¸€ä¸ªä¾‹å­&#34;&gt;ä¸€ä¸ªä¾‹å­
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç°åœ¨éœ€è¦å­˜å‚¨ä¸€ä¸ª4å­—èŠ‚çš„æ•´æ•°&lt;code&gt;0x12345678&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å†…å­˜åœ°å€&lt;/th&gt;
          &lt;th&gt;å¤§ç«¯åºå­˜å‚¨&lt;/th&gt;
          &lt;th&gt;å°ç«¯åºå­˜å‚¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ä½åœ°å€&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;12&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;78&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;â†“&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;34&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;56&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;â†“&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;56&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;34&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;é«˜åœ°å€&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;78&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;12&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;åœ¨é€†å‘åˆ†æä¸­ï¼Œå†…å­˜äºŒè¿›åˆ¶åœ°å€æ–¹å‘æ˜¯ä»ä¸Šè‡³ä¸‹ï¼Œä»å·¦è‡³å³å¢å¤§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å› æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨å†…å­˜çª—å£çœ‹åˆ°&lt;code&gt;78 56 34 12&lt;/code&gt;æ—¶ï¼Œé¡»å°†å…¶ç†è§£ä¸º&lt;code&gt;0x12345678&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;ia-32-å†…å­˜&#34;&gt;IA-32 å†…å­˜
&lt;/h1&gt;&lt;h2 id=&#34;å†…å­˜æ¨¡å‹&#34;&gt;å†…å­˜æ¨¡å‹
&lt;/h2&gt;&lt;h3 id=&#34;å¹³é¢å†…å­˜æ¨¡å‹&#34;&gt;å¹³é¢å†…å­˜æ¨¡å‹
&lt;/h3&gt;&lt;p&gt;ç°ä»£æ“ä½œç³»ç»Ÿæ™®éé‡‡ç”¨çš„æ¨¡å‹&lt;/p&gt;
&lt;p&gt;ç¨‹åºçš„æ‰€æœ‰éƒ¨åˆ†ï¼ˆä»£ç ã€æ•°æ®ã€æ ˆï¼‰éƒ½ä½äºä¸€ä¸ªè¿ç»­ç»Ÿä¸€çš„çº¿æ€§åœ°å€ç©ºé—´ä¸­&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005111551905&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005111551905.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005111551905.png&#34; alt=&#34;image-20251005111551905&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;åˆ†æ®µå†…å­˜æ¨¡å‹&#34;&gt;åˆ†æ®µå†…å­˜æ¨¡å‹
&lt;/h3&gt;&lt;p&gt;ç¨‹åºè¢«åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„æ®µï¼Œæ¯”å¦‚æœ‰ä»£ç æ®µã€æ•°æ®æ®µã€æ ˆæ®µç­‰&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªé€»è¾‘åœ°å€ç”±&lt;strong&gt;æ®µé€‰æ‹©å™¨&lt;/strong&gt;å’Œ&lt;strong&gt;æ®µå†…åç§»&lt;/strong&gt;ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é€»è¾‘åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;æ®µå¯„å­˜å™¨ä¸­çš„æ®µé€‰æ‹©å™¨&lt;/span&gt;/&lt;span style=&#34;color:#e06c75&#34;&gt;æ®µé€‰æ‹©å­&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;æ®µå†…åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ®µé€‰æ‹©å­æ˜¯ä¸€ä¸ª16ä½çš„å€¼ï¼Œå®ƒå­˜æ”¾åœ¨æ®µå¯„å­˜å™¨é‡Œï¼ŒäºŒè¿›åˆ¶ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;ä¿æŠ¤æ¨¡å¼ç¯‡â€”â€”æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­- å¯‚é™çš„ç¾½å¤- åšå®¢å›­&#34; href=&#34;http://picture.928330.xyz/typora/o_2109200226344-2.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/o_2109200226344-2.png&#34; alt=&#34;ä¿æŠ¤æ¨¡å¼ç¯‡â€”â€”æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­- å¯‚é™çš„ç¾½å¤- åšå®¢å›­&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä½æ®µ&lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;Index&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æè¿°ç¬¦ç´¢å¼•&lt;/td&gt;
          &lt;td&gt;è¡¨ç¤ºè¯¥æ®µæè¿°ç¬¦åœ¨æè¿°ç¬¦è¡¨ä¸­çš„åºå·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;TI&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;è¡¨æ ‡å¿—&lt;/td&gt;
          &lt;td&gt;æŒ‡ç¤ºå»å“ªä¸ªæè¿°ç¬¦è¡¨æŸ¥æ®µæè¿°ç¬¦ï¼ˆ0æ˜¯GDTï¼Œ1æ˜¯LDTï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;RPL&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;è¯·æ±‚ç‰¹æƒçº§&lt;/td&gt;
          &lt;td&gt;ç”¨äºè®¿é—®æƒé™æ§åˆ¶ï¼ˆ0æœ€é«˜ï¼Œ3æœ€ä½ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;è€Œæ±‡ç¼–ä»£ç é‡Œä¸€èˆ¬åªå†™åç§»é‡ï¼Œæ®µé€‰æ‹©å™¨æ˜¯éšå«çš„ï¼ŒCPUè‡ªåŠ¨çŸ¥é“ç”¨å“ªä¸ªæ®µå¯„å­˜å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¯”å¦‚&lt;code&gt;mov EAX, [0x0010]&lt;/code&gt;ï¼Œå°±ç›¸å½“äºæ˜¯&lt;code&gt;mov EAX, DS:[0x0010]&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ±‡ç¼–è¯­å¥ç±»å‹&lt;/th&gt;
          &lt;th&gt;é»˜è®¤æ®µå¯„å­˜å™¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;mov eax, [offset]&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DS&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;mov [offset], eax&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DS&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ ˆæ“ä½œï¼ˆ&lt;code&gt;push&lt;/code&gt; / &lt;code&gt;pop&lt;/code&gt;ï¼‰&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SS&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ä»£ç å–æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CS&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005111539852&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005111539852.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005111539852.png&#34; alt=&#34;image-20251005111539852&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h2 id=&#34;åˆ†æ®µå†…å­˜æ¨¡å‹çš„å†…å­˜ç®¡ç†&#34;&gt;åˆ†æ®µå†…å­˜æ¨¡å‹çš„å†…å­˜ç®¡ç†
&lt;/h2&gt;&lt;p&gt;å¯¹äºåˆ†æ®µå†…å­˜æ¨¡å‹ï¼Œä¸åŒæ“ä½œæ¨¡å¼ï¼ˆå®æ¨¡å¼/ä¿æŠ¤æ¨¡å¼ï¼‰ä¸‹ï¼Œå†…å­˜ç®¡ç†æ–¹å¼å’Œå¯»å€æ¨¡å¼å­˜åœ¨å·®å¼‚&lt;/p&gt;
&lt;h3 id=&#34;å®æ¨¡å¼ä¸‹çš„å†…å­˜ç®¡ç†&#34;&gt;å®æ¨¡å¼ä¸‹çš„å†…å­˜ç®¡ç†
&lt;/h3&gt;&lt;h4 id=&#34;ç®¡ç†æ–¹å¼&#34;&gt;ç®¡ç†æ–¹å¼
&lt;/h4&gt;&lt;p&gt;å®æ¨¡å¼çš„å†…å­˜ç®¡ç†æ–¹å¼éå¸¸ç®€å•ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆ†æ®µæ¨¡å‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ‰20ä½åœ°å€æ€»çº¿ï¼ŒCPUèƒ½å¤Ÿè®¿é—®çš„ç‰©ç†å†…å­˜ä¸Šé™ä¸º1MBçš„åœ°å€ç©ºé—´&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å†…å­˜è¢«åˆ’åˆ†ä¸ºä¸€ç³»åˆ—64KBå¤§å°çš„æ®µ&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¨‹åºä½¿ç”¨çš„åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª16ä½çš„&lt;strong&gt;æ®µé€‰æ‹©å™¨&lt;/strong&gt;å’Œä¸€ä¸ª16ä½çš„&lt;strong&gt;åç§»åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡å°†æ®µé€‰æ‹©å™¨çš„å€¼å·¦ç§»4ä½ï¼Œç›¸å½“äºä¹˜ä»¥16ï¼ˆå› ä¸ºåœ°å€çº¿æ˜¯20ä½ï¼‰ï¼ŒåŠ ä¸Š16ä½çš„åç§»åœ°å€å¾—åˆ°ç‰©ç†åœ°å€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ç‰©ç†åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;-&lt;span style=&#34;color:#e06c75&#34;&gt;bit&lt;/span&gt;) = &lt;span style=&#34;color:#e06c75&#34;&gt;æ®µé€‰æ‹©å™¨&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;-&lt;span style=&#34;color:#e06c75&#34;&gt;bit&lt;/span&gt;)*&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;åç§»é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;-&lt;span style=&#34;color:#e06c75&#34;&gt;bit&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005111518978&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005111518978.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005111518978.png&#34; alt=&#34;image-20251005111518978&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹
&lt;/h4&gt;&lt;p&gt;å‡è®¾æ®µå¯„å­˜å™¨&lt;code&gt;DS&lt;/code&gt;çš„å€¼ä¸º&lt;code&gt;0x1000&lt;/code&gt;ï¼ŒæŒ‡ä»¤è¦è®¿é—®çš„åç§»åœ°å€æ˜¯&lt;code&gt;0x0123&lt;/code&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CPUå–å‡ºæ®µé€‰æ‹©å™¨çš„å€¼ï¼š&lt;code&gt;0x1000&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å°†å…¶å·¦ç§»4ä½ï¼š&lt;code&gt;0x10000&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åŠ ä¸Šåç§»åœ°å€ï¼š&lt;code&gt;0x10000 + 0x0123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆå¾—åˆ°çš„ç‰©ç†åœ°å€æ˜¯&lt;code&gt;0x10123&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®æ¨¡å¼æ²¡æœ‰å†…å­˜ä¿æŠ¤æœºåˆ¶ï¼Œä»»ä½•ç¨‹åºéƒ½å¯ä»¥è®¿é—®å…¨éƒ¨1MBçš„å†…å­˜ç©ºé—´ï¼Œä¸€ä¸ªç¨‹åºçš„é”™è¯¯å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œä¹Ÿä¸æ”¯æŒè™šæ‹Ÿå†…å­˜ç­‰ç°ä»£æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½&lt;/p&gt;
&lt;h3 id=&#34;ä¿æŠ¤æ¨¡å¼ä¸‹çš„å†…å­˜ç®¡ç†&#34;&gt;ä¿æŠ¤æ¨¡å¼ä¸‹çš„å†…å­˜ç®¡ç†
&lt;/h3&gt;&lt;h4 id=&#34;æ€»ä½“æµç¨‹&#34;&gt;æ€»ä½“æµç¨‹
&lt;/h4&gt;&lt;p&gt;åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬ä»£ç ä¸­ä½¿ç”¨çš„åœ°å€ï¼ˆé€»è¾‘åœ°å€ï¼‰éœ€è¦ç»è¿‡CPUçš„è½¬æ¢æ‰èƒ½è®¿é—®åˆ°çœŸæ­£çš„ç‰©ç†å†…å­˜&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹å¯¹ç¨‹åºæ˜¯é€æ˜çš„&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¿æŠ¤æ¨¡å¼çš„åœ°å€ç®¡ç†å¿…é¡»ä½¿ç”¨åˆ†æ®µï¼Œå¦å¤–ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨åˆ†é¡µ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯å®Œæ•´çš„åœ°å€è®¿é—®æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005111658646&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005111658646.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005111658646.png&#34; alt=&#34;image-20251005111658646&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;é€»è¾‘åœ°å€--çº¿æ€§åœ°å€&#34;&gt;é€»è¾‘åœ°å€ â†’ çº¿æ€§åœ°å€
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;é€»è¾‘åœ°å€çš„æ®µé€‰æ‹©å™¨å‘Šè¯‰CPUè¯¥å»å“ªä¸€ä¸ªæè¿°ç¬¦è¡¨ï¼ˆGDT/LDTï¼‰æŸ¥è¯¢å¾—åˆ°æ®µæè¿°ç¬¦&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ®µæè¿°ç¬¦&lt;/strong&gt;é‡Œå­˜æœ‰&lt;strong&gt;æ®µåŸºå€&lt;/strong&gt;ã€æ®µç•Œé™ã€è®¿é—®æƒé™ç­‰å†…å®¹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;çº¿æ€§åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;æ®µåŸºå€&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;çº¿æ€§åœ°å€--ç‰©ç†åœ°å€&#34;&gt;çº¿æ€§åœ°å€ â†’ ç‰©ç†åœ°å€
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å¦‚æœæ²¡æœ‰å¼€å¯åˆ†é¡µæœºåˆ¶&lt;/strong&gt;**ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ç‰©ç†åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;çº¿æ€§åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ç°ä»£æ“ä½œç³»ç»Ÿä¸€èˆ¬éƒ½å¯ç”¨äº†åˆ†é¡µï¼ŒCPUçš„&lt;strong&gt;å†…å­˜ç®¡ç†å•å…ƒ (MMU)&lt;/strong&gt; ä¼šè¿›è¡Œä¸‹ä¸€æ­¥è½¬æ¢&lt;/p&gt;
&lt;p&gt;MMUå°†32ä½çš„çº¿æ€§åœ°å€æ‹†åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š&lt;strong&gt;é¡µç›®å½•ç´¢å¼•&lt;/strong&gt; (10ä½) + &lt;strong&gt;é¡µè¡¨ç´¢å¼•&lt;/strong&gt; (10ä½) + &lt;strong&gt;é¡µå†…åç§»&lt;/strong&gt; (12ä½)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¡µç›®å½•è¡¨&lt;/strong&gt;ï¼šæœ‰1024ä¸ªè¡¨é¡¹ï¼Œæ¯é¡¹4Bï¼Œå…±4KBï¼Œæ¯é¡¹æŒ‡å‘ä¸€ä¸ªé¡µè¡¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µè¡¨&lt;/strong&gt;ï¼šä¹Ÿæœ‰1024ä¸ªè¡¨é¡¹ï¼Œæ¯é¡¹4Bï¼Œå…±4KBï¼Œæ¯é¡¹æŒ‡å‘ä¸€ä¸ªç‰©ç†é¡µæ¡†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡µæ¡†&lt;/strong&gt;ï¼šå¤§å°å›ºå®šä¸º4KB&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…ˆæŸ¥é¡µç›®å½•ï¼Œå†æŸ¥é¡µè¡¨ï¼Œæœ€ç»ˆæ‰¾åˆ°æ•°æ®æ‰€åœ¨çš„ç‰©ç†å†…å­˜é¡µï¼ŒåŠ ä¸Šé¡µå†…åç§»ï¼Œå°±å¾—åˆ°äº†æœ€ç»ˆçš„ç‰©ç†åœ°å€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ç‰©ç†åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;ç‰©ç†é¡µæ¡†åŸºå€&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;é¡µå†…åç§»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;é€»è¾‘åœ°å€ã€çº¿æ€§åœ°å€å’Œç‰©ç†åœ°å€| vosamo&#34; href=&#34;http://picture.928330.xyz/typora/fenye.jpg&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/fenye.jpg&#34; alt=&#34;é€»è¾‘åœ°å€ã€çº¿æ€§åœ°å€å’Œç‰©ç†åœ°å€| vosamo&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h4 id=&#34;ç¤ºä¾‹-1&#34;&gt;ç¤ºä¾‹
&lt;/h4&gt;&lt;p&gt;æˆ‘ä»¬ç°åœ¨è¿è¡Œåœ¨ä¸€ä¸ª 32ä½ä¿æŠ¤æ¨¡å¼çš„ç³»ç»Ÿä¸­ï¼Œåˆ†é¡µåŠŸèƒ½å·²ç»å¼€å¯ï¼Œç¨‹åºä¸­æœ‰è¿™æ ·ä¸€æ¡æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;eax&lt;/span&gt;, [&lt;span style=&#34;color:#d19a66&#34;&gt;0x1234&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ¡æŒ‡ä»¤çš„æ„æ€æ˜¯æŠŠå†…å­˜ä¸­åœ°å€&lt;code&gt;DS:0x1234&lt;/code&gt;å¤„çš„æ•°æ®è¯»åˆ°EAXå¯„å­˜å™¨ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œè®¿é—®çš„é€»è¾‘åœ°å€æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é€»è¾‘åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;DS&lt;/span&gt; : &lt;span style=&#34;color:#d19a66&#34;&gt;0x1234&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡è®¾æ®µå¯„å­˜å™¨DSçš„å†…å®¹æ˜¯&lt;code&gt;0x0008&lt;/code&gt;ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1000&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;ä½&lt;/th&gt;
          &lt;th&gt;å€¼&lt;/th&gt;
          &lt;th&gt;å«ä¹‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Index&lt;/td&gt;
          &lt;td&gt;15:3&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;ç¬¬1ä¸ªæè¿°ç¬¦&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;TI&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;ä»GDTä¸­æŸ¥&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RPL&lt;/td&gt;
          &lt;td&gt;1â€“0&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;å½“å‰è®¿é—®ç‰¹æƒçº§ 0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å‡è®¾GDT[1]è¿™ä¸ªæè¿°ç¬¦é‡Œå­˜çš„æ®µä¿¡æ¯æ˜¯ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å­—æ®µ&lt;/th&gt;
          &lt;th&gt;å€¼&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æ®µåŸºå€&lt;/td&gt;
          &lt;td&gt;0x00400000&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ®µç•Œé™&lt;/td&gt;
          &lt;td&gt;0x000FFFFF&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;è®¿é—®å±æ€§&lt;/td&gt;
          &lt;td&gt;å¯è¯»å¯å†™æ•°æ®æ®µ&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;äºæ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;æ®µåŸºå€&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00400000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;çº¿æ€§åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;æ®µåŸºå€&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;åç§»é‡&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00400000&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;0x00001234&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00401234&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ç³»ç»Ÿå¼€å¯äº†åˆ†é¡µï¼Œå‡è®¾é¡µç›®å½•åŸºå€å¯„å­˜å™¨CR3çš„å€¼æ˜¯&lt;code&gt;0x00100000&lt;/code&gt;ï¼Œå³é¡µç›®å½•è¡¨åœ¨ç‰©ç†å†…å­˜&lt;code&gt;0x00100000&lt;/code&gt;å¤„&lt;/p&gt;
&lt;p&gt;æŠŠçº¿æ€§åœ°å€&lt;code&gt;0x00401234&lt;/code&gt;æ‹†æˆä¸‰æ®µï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0100&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0001&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0010&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0011&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0100&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;éƒ¨åˆ†&lt;/th&gt;
          &lt;th&gt;ä½æ•°&lt;/th&gt;
          &lt;th&gt;å€¼ï¼ˆäºŒè¿›åˆ¶ï¼‰&lt;/th&gt;
          &lt;th&gt;åè¿›åˆ¶&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;é¡µç›®å½•ç´¢å¼•&lt;/td&gt;
          &lt;td&gt;10 ä½&lt;/td&gt;
          &lt;td&gt;0000000001&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;é¡µè¡¨ç´¢å¼•&lt;/td&gt;
          &lt;td&gt;10 ä½&lt;/td&gt;
          &lt;td&gt;0000000010&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;é¡µå†…åç§»&lt;/td&gt;
          &lt;td&gt;12 ä½&lt;/td&gt;
          &lt;td&gt;001101000100&lt;/td&gt;
          &lt;td&gt;0x234&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;é¡µç›®å½•è¡¨èµ·å§‹äº&lt;code&gt;0x00100000&lt;/code&gt;ï¼Œæ¯ä¸ªè¡¨é¡¹å 4å­—èŠ‚ï¼Œé¡µç›®å½•ç´¢å¼•æ˜¯&lt;code&gt;1&lt;/code&gt;ï¼Œæ‰€ä»¥è¦è¯»çš„è¡¨é¡¹åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x00100000&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt; * &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00100004&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡è®¾è¿™ä¸ªé¡µç›®å½•é¡¹å†…å®¹æ˜¯&lt;code&gt;0x00200003&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é«˜20ä½ï¼šé¡µè¡¨çš„ç‰©ç†åŸºå€ï¼Œæ˜¯&lt;code&gt;0x00200000&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä½12ä½ï¼šæ ‡å¿—ä½ï¼ˆPresent=1, RW=1, US=0ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é¡µè¡¨åŸºå€&lt;code&gt;0x00200000&lt;/code&gt;ï¼Œé¡µè¡¨ç´¢å¼•æ˜¯&lt;code&gt;2&lt;/code&gt;ï¼Œæ‰€ä»¥è¦è¯»çš„è¡¨é¡¹åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0x00200000&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; * &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00200008&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡è®¾è¿™ä¸ªé¡µè¡¨é¡¹å†…å®¹æ˜¯&lt;code&gt;0x00A00003&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é«˜20ä½ï¼šç‰©ç†é¡µæ¡†åŸºå€ï¼Œæ˜¯&lt;code&gt;0x00A00000&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ç»ˆå¾—åˆ°ç‰©ç†åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ç‰©ç†åœ°å€&lt;/span&gt; = &lt;span style=&#34;color:#e06c75&#34;&gt;é¡µæ¡†åŸºå€&lt;/span&gt; + &lt;span style=&#34;color:#e06c75&#34;&gt;é¡µå†…åç§»&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00A00000&lt;/span&gt; + &lt;span style=&#34;color:#d19a66&#34;&gt;0x00000234&lt;/span&gt; = &lt;span style=&#34;color:#d19a66&#34;&gt;0x00A00234&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;ia-32æ ¸å¿ƒå¯„å­˜å™¨&#34;&gt;IA-32æ ¸å¿ƒå¯„å­˜å™¨
&lt;/h1&gt;&lt;h2 id=&#34;é€šç”¨å¯„å­˜å™¨-gpr&#34;&gt;é€šç”¨å¯„å­˜å™¨ (GPR)
&lt;/h2&gt;&lt;p&gt;IA-32æ¶æ„æœ‰8ä¸ª32ä½é€šç”¨å¯„å­˜å™¨&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;32ä½&lt;/th&gt;
          &lt;th&gt;16ä½&lt;/th&gt;
          &lt;th&gt;8ä½é«˜/ä½&lt;/th&gt;
          &lt;th&gt;ä¸»è¦åŠŸèƒ½&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;EAX&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;AX&lt;/td&gt;
          &lt;td&gt;AH / AL&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ç´¯åŠ å™¨ï¼ˆAccumulatorï¼‰&lt;/strong&gt;&lt;br /&gt;ç”¨äºç®—æœ¯è¿ç®—å’Œå‡½æ•°è¿”å›å€¼&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;EBX&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;BX&lt;/td&gt;
          &lt;td&gt;BH / BL&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;åŸºå€å¯„å­˜å™¨ï¼ˆBaseï¼‰&lt;/strong&gt;&lt;br /&gt;ç”¨äºåœ¨å†…å­˜ä¸­å¯»å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ECX&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;CX&lt;/td&gt;
          &lt;td&gt;CH / CL&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è®¡æ•°å™¨ï¼ˆCounterï¼‰&lt;/strong&gt;&lt;br /&gt;ç”¨äºå¾ªç¯å’Œå­—ç¬¦ä¸²æ“ä½œçš„è®¡æ•°ï¼Œæ˜¯&lt;strong&gt;æ— ç¬¦å·è®¡æ•°å™¨&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;EDX&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;DX&lt;/td&gt;
          &lt;td&gt;DH / DL&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ•°æ®å¯„å­˜å™¨ï¼ˆDataï¼‰&lt;/strong&gt;&lt;br /&gt;é…åˆEAXè¿›è¡Œä¹˜é™¤æ³•è¿ç®—æˆ–å­˜æ”¾I/OæŒ‡é’ˆ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ESI&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;SI&lt;/td&gt;
          &lt;td&gt;-&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æºå˜å€å¯„å­˜å™¨ï¼ˆSource Indexï¼‰&lt;/strong&gt;&lt;br /&gt;å­—ç¬¦ä¸²å’Œå†…å­˜æ“ä½œçš„æºåœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;EDI&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;DI&lt;/td&gt;
          &lt;td&gt;-&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ç›®çš„å˜å€å¯„å­˜å™¨ï¼ˆDestination Indexï¼‰&lt;/strong&gt;&lt;br /&gt;å­—ç¬¦ä¸²å’Œå†…å­˜æ“ä½œçš„ç›®çš„åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ESP&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;SP&lt;/td&gt;
          &lt;td&gt;-&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ ˆæŒ‡é’ˆï¼ˆStack Pointer)&lt;/strong&gt;&lt;br /&gt;æ°¸è¿œæŒ‡å‘å½“å‰æ ˆçš„æ ˆé¡¶&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;EBP&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;BP&lt;/td&gt;
          &lt;td&gt;-&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;åŸºå€æŒ‡é’ˆï¼ˆBase Pointerï¼‰&lt;/strong&gt;&lt;br /&gt;ç”¨ä½œå½“å‰å‡½æ•°æ ˆå¸§çš„åŸºå€ï¼Œç”¨äºè®¿é—®å±€éƒ¨å˜é‡å’Œå‚æ•°&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ç¨‹åºçŠ¶æ€ä¸æ§åˆ¶å¯„å­˜å™¨-eflags&#34;&gt;ç¨‹åºçŠ¶æ€ä¸æ§åˆ¶å¯„å­˜å™¨ (EFLAGS)
&lt;/h2&gt;&lt;p&gt;EFLAGSå¯„å­˜å™¨æ˜¯ä¸€ä¸ª32ä½çš„å¯„å­˜å™¨&lt;/p&gt;
&lt;p&gt;å®ƒçš„æ¯ä¸€ä½ï¼ˆæ ‡å¿—ä½ï¼‰éƒ½è®°å½•äº†ç¨‹åºè¿è¡Œä¸­çš„ç‰¹å®šçŠ¶æ€ï¼Œä¸»è¦ç”¨äºæ¡ä»¶åˆ¤æ–­å’Œæµç¨‹æ§åˆ¶&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;Basic Execution Environment of Intel Processor 32-bit Architecture | Tachyon&#34; href=&#34;http://picture.928330.xyz/typora/eflags.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/eflags.png&#34; alt=&#34;Basic Execution Environment of Intel Processor 32-bit Architecture | Tachyon&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„æ ‡å¿—ä½ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ ‡å¿—ä½&lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;æè¿°å’ŒåŠŸèƒ½&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ZF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;é›¶æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Zero Flag)&lt;/td&gt;
          &lt;td&gt;è‹¥ç®—æœ¯è¿ç®—ç»“æœä¸º0ï¼Œåˆ™ZFç½®ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼Œå¸¸ç”¨äºåˆ¤æ–­ç›¸ç­‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;OF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æº¢å‡ºæ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Overflow Flag)&lt;/td&gt;
          &lt;td&gt;å½“æœ‰ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœè¶…å‡ºå¯„å­˜å™¨èƒ½è¡¨ç¤ºçš„èŒƒå›´æ—¶ï¼ŒOFç½®ä¸º1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;CF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è¿›ä½æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Carry Flag)&lt;/td&gt;
          &lt;td&gt;å½“æ— ç¬¦å·æ•´æ•°è¿ç®—çš„ç»“æœæº¢å‡ºï¼ˆäº§ç”Ÿè¿›ä½æˆ–å€Ÿä½ï¼‰æ—¶ï¼ŒCFç½®ä¸º1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;SF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ç¬¦å·æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Sign Flag)&lt;/td&gt;
          &lt;td&gt;ç­‰äºè¿ç®—ç»“æœçš„æœ€é«˜ä½ï¼ˆä¹Ÿå°±æ˜¯ç¬¦å·ä½ï¼‰&lt;br /&gt;å¯¹äºæœ‰ç¬¦å·æ•°ï¼Œ0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;DF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ–¹å‘æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Direction Flag)&lt;/td&gt;
          &lt;td&gt;æ§åˆ¶å­—ç¬¦ä¸²æ“ä½œæŒ‡ä»¤ï¼ˆå¦‚MOVS, SCASï¼‰çš„å¤„ç†æ–¹å‘&lt;br /&gt;è‹¥DF=0ï¼Œå˜å€å¯„å­˜å™¨ï¼ˆESI, EDIï¼‰åœ°å€é€’å¢&lt;br /&gt;è‹¥DF=1ï¼Œåˆ™åœ°å€é€’å‡&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;TF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;é™·é˜±æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Trap Flag)&lt;/td&gt;
          &lt;td&gt;è‹¥ç½®ä¸º1ï¼ŒCPUåœ¨æ‰§è¡Œæ¯æ¡æŒ‡ä»¤åä¼šäº§ç”Ÿä¸€ä¸ªå•æ­¥ä¸­æ–­&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;IF&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ä¸­æ–­å…è®¸æ ‡å¿—&lt;/strong&gt;&lt;br /&gt;(Interrupt Enable Flag)&lt;/td&gt;
          &lt;td&gt;è‹¥ç½®ä¸º1ï¼ŒCPUå¯ä»¥å“åº”å¤–éƒ¨è®¾å¤‡çš„ä¸­æ–­è¯·æ±‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨-eip&#34;&gt;æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ (EIP)
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;EIPï¼ˆExtended Instruction Pointerï¼‰æ˜¯ä¸€ä¸ª32ä½çš„å¯„å­˜å™¨ï¼Œå­˜æ”¾ç€ä¸‹ä¸€æ¡å°†è¦è¢«CPUæ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;CPUæ€»æ˜¯æ ¹æ®CSæ®µå¯„å­˜å™¨å’ŒEIPå¯„å­˜å™¨ä¸­çš„åœ°å€æ¥è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œ&lt;strong&gt;æ¯å½“ä¸€æ¡æŒ‡ä»¤è¢«è¯»å–åï¼ŒEIPçš„å€¼ä¼šè‡ªåŠ¨å¢åŠ ï¼Œå¢åŠ çš„å¤§å°ç­‰äºåˆšåˆšè¢«è¯»å–æŒ‡ä»¤çš„å­—èŠ‚æ•°&lt;/strong&gt;ï¼Œä»è€ŒæŒ‡å‘ç´§éšå…¶åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤&lt;/p&gt;
&lt;p&gt;EIPå¯„å­˜å™¨çš„å€¼ä¸èƒ½è¢«ç›´æ¥ä¿®æ”¹ï¼Œ&lt;strong&gt;å®ƒçš„æ”¹å˜åªèƒ½é€šè¿‡ç‰¹å®šçš„æ§åˆ¶æµæŒ‡ä»¤ï¼ˆå¦‚ &lt;code&gt;JMP&lt;/code&gt;, &lt;code&gt;CALL&lt;/code&gt;, &lt;code&gt;RET&lt;/code&gt;ï¼‰æˆ–è€…ç”±ä¸­æ–­ã€å¼‚å¸¸æ¥å®Œæˆ&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ®µå¯„å­˜å™¨&#34;&gt;æ®µå¯„å­˜å™¨
&lt;/h2&gt;&lt;p&gt;æ®µå¯„å­˜å™¨æ˜¯6ä¸ª16ä½çš„å¯„å­˜å™¨ï¼Œåœ¨ä¿æŠ¤æ¨¡å¼çš„å†…å­˜åˆ†æ®µç®¡ç†ä¸­ï¼Œå®ƒä»¬å­˜æ”¾ç€æŒ‡å‘å„ä¸ªå†…å­˜æ®µçš„â€œæ®µé€‰æ‹©å™¨â€ï¼ŒCPUé€šè¿‡è¿™äº›æ®µé€‰æ‹©å™¨åœ¨ç³»ç»Ÿæè¿°ç¬¦è¡¨ï¼ˆGDT/LDTï¼‰ä¸­æ‰¾åˆ°æ®µçš„å®é™…åŸºåœ°å€ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å¯„å­˜å™¨&lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ä¸»è¦åŠŸèƒ½&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;CS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ä»£ç æ®µå¯„å­˜å™¨&lt;/strong&gt;&lt;br /&gt;(Code Segment)&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾åº”ç”¨ç¨‹åºä»£ç æ‰€åœ¨æ®µçš„æ®µé€‰æ‹©å™¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;SS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ ˆæ®µå¯„å­˜å™¨&lt;/strong&gt;&lt;br /&gt;(Stack Segment)&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾å½“å‰ç¨‹åºæ ˆæ‰€åœ¨æ®µçš„æ®µé€‰æ‹©å™¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;DS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;æ•°æ®æ®µå¯„å­˜å™¨&lt;/strong&gt;&lt;br /&gt;(Data Segment)&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾ç¨‹åºä¸»è¦æ•°æ®æ‰€åœ¨æ®µçš„æ®µé€‰æ‹©å™¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;ES/FS/GS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;é™„åŠ æ•°æ®æ®µå¯„å­˜å™¨&lt;/strong&gt;&lt;br /&gt;(Extra Segment)&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾ç¨‹åºä½¿ç”¨çš„é™„åŠ æ•°æ®æ®µçš„æ®µé€‰æ‹©å™¨&lt;br /&gt;å¯ç”¨äºç‰¹æ®Šç›®çš„ï¼Œæ¯”å¦‚é€šè¿‡FSå®šä½çº¿ç¨‹ç¯å¢ƒå—ï¼ˆTEBï¼‰ç­‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;ia-32æ•°æ®ç±»å‹&#34;&gt;IA-32æ•°æ®ç±»å‹
&lt;/h1&gt;&lt;h2 id=&#34;åŸºæœ¬æ•°æ®ç±»å‹&#34;&gt;åŸºæœ¬æ•°æ®ç±»å‹
&lt;/h2&gt;&lt;p&gt;è¿™äº›æ˜¯æ„æˆæ›´å¤æ‚æ•°æ®ç»“æ„çš„åŸºç¡€æ•´æ•°ç±»å‹&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005155825457&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005155825457.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005155825457.png&#34; alt=&#34;image-20251005155825457&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Byte&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1å­—èŠ‚ï¼ˆ8ä½ï¼‰çš„æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Word&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;2å­—èŠ‚ï¼ˆ16ä½ï¼‰çš„æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Doubleword&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;4å­—èŠ‚ï¼ˆ32ä½ï¼‰çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯IA-32æ¶æ„ä¸­æœ€å¸¸ç”¨çš„æ•°æ®å¤§å°ï¼Œä¸é€šç”¨å¯„å­˜å™¨ï¼ˆå¦‚EAXï¼‰çš„å¤§å°ä¸€è‡´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Quadword&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;8å­—èŠ‚ï¼ˆ64ä½ï¼‰çš„æ•°æ®&lt;/p&gt;
&lt;p&gt;è™½ç„¶IA-32æ²¡æœ‰64ä½çš„é€šç”¨å¯„å­˜å™¨ï¼Œä½†åœ¨æŸäº›ç‰¹å®šæŒ‡ä»¤ï¼ˆå¦‚&lt;code&gt;RDTSC&lt;/code&gt;ï¼‰æˆ–é€šè¿‡ç»„åˆEDXå’ŒEAXå¯„å­˜å™¨ï¼Œå¯ä»¥å¤„ç†64ä½æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Double Quadword&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;16å­—èŠ‚ï¼ˆ128ä½ï¼‰çš„æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æµ®ç‚¹æ•°æ®ç±»å‹&#34;&gt;æµ®ç‚¹æ•°æ®ç±»å‹
&lt;/h2&gt;&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005160136310&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005160136310.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005160136310.png&#34; alt=&#34;image-20251005160136310&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠç²¾åº¦ï¼ˆHalf Precisionï¼‰&lt;/strong&gt;ï¼š16ä½æµ®ç‚¹æ•°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ç²¾åº¦ï¼ˆSingle Precisionï¼‰&lt;/strong&gt;ï¼š32ä½æµ®ç‚¹æ•°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŒç²¾åº¦ï¼ˆDouble Precisionï¼‰&lt;/strong&gt;ï¼š64ä½æµ®ç‚¹æ•°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•åŒç²¾åº¦ï¼ˆDouble Extended Precisionï¼‰&lt;/strong&gt;ï¼š80ä½æµ®ç‚¹æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æŒ‡é’ˆç±»å‹&#34;&gt;æŒ‡é’ˆç±»å‹
&lt;/h2&gt;&lt;p&gt;æŒ‡é’ˆåœ¨IA-32ä¸­ç”¨äºå­˜å‚¨å†…å­˜åœ°å€ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;image-20251005160342658&#34; href=&#34;http://picture.928330.xyz/typora/image-20251005160342658.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/image-20251005160342658.png&#34; alt=&#34;image-20251005160342658&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Near Pointerï¼ˆè¿‘æŒ‡é’ˆï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª32ä½çš„åç§»é‡&lt;/p&gt;
&lt;p&gt;å®ƒæŒ‡å‘å½“å‰æ®µå†…çš„æŸä¸ªåœ°å€ï¼Œåœ¨ç°ä»£æ“ä½œç³»ç»Ÿçš„å¹³é¢å†…å­˜æ¨¡å‹ä¸‹ï¼Œè¿™å®é™…ä¸Šå°±æ˜¯ç¨‹åºçš„è™šæ‹Ÿåœ°å€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Far Pointerï¼ˆè¿œæŒ‡é’ˆï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª48ä½çš„æŒ‡é’ˆï¼Œç”±ä¸€ä¸ª16ä½çš„æ®µé€‰æ‹©å™¨å’Œä¸€ä¸ª32ä½çš„åç§»é‡ç»„æˆ&lt;/p&gt;
&lt;p&gt;å®ƒç”¨äºåœ¨åˆ†æ®µå†…å­˜æ¨¡å‹ä¸‹ï¼Œè·¨æ®µè®¿é—®æ•°æ®&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ia-32æ±‡ç¼–æŒ‡ä»¤&#34;&gt;IA-32æ±‡ç¼–æŒ‡ä»¤
&lt;/h1&gt;&lt;h2 id=&#34;intelä¸attæ±‡ç¼–è¯­æ³•&#34;&gt;Intelä¸AT&amp;amp;Tæ±‡ç¼–è¯­æ³•
&lt;/h2&gt;&lt;h3 id=&#34;intelè¯­æ³•&#34;&gt;Intelè¯­æ³•
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¿™æ˜¯Windowsç¯å¢ƒä¸‹çš„ä¸»æµè¯­æ³•ï¼Œæ˜“äºé˜…è¯»&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;[æŒ‡ä»¤]&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ç›®æ ‡æ“ä½œæ•°&lt;/span&gt;], [&lt;span style=&#34;color:#e06c75&#34;&gt;æºæ“ä½œæ•°&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;é€—å·åé¢ç©ºæ ¼ä¸æ˜¯è¯­æ³•å¿…é¡»çš„&lt;/strong&gt;ï¼Œä½†æ˜¯åŠ ç©ºæ ¼æ˜¯ä¸€ä¸ªéå¸¸æ¨èçš„ä¹ æƒ¯ï¼Œå¤§å¤šæ•°é€†å‘è½¯ä»¶ä¹Ÿéµä»è¿™ä¸ªä¹ æƒ¯&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:red;font-size:20px&#34;&gt;&lt;strong&gt;æœ¬æ–‡æ¡£åç»­å°†ç»Ÿä¸€ä½¿ç”¨Intelè¯­æ³•&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;attè¯­æ³•&#34;&gt;AT&amp;amp;Tè¯­æ³•
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;å¸¸ç”¨äºLinuxå’ŒGNUå·¥å…·é“¾&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;[æŒ‡ä»¤]&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;æºæ“ä½œæ•°&lt;/span&gt;], [&lt;span style=&#34;color:#e06c75&#34;&gt;ç›®æ ‡æ“ä½œæ•°&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç¤ºä¾‹-2&#34;&gt;ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;å°†ç«‹å³æ•°4ç§»åŠ¨åˆ°EAXå¯„å­˜å™¨&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;è¯­æ³•&lt;/th&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Intel&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;mov eax, 4&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;AT&amp;amp;T&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;mov $4, %eax&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;æ•°æ®ç§»åŠ¨æŒ‡ä»¤&#34;&gt;æ•°æ®ç§»åŠ¨æŒ‡ä»¤
&lt;/h2&gt;&lt;p&gt;è¿™ç±»æŒ‡ä»¤ç”¨äºåœ¨å¯„å­˜å™¨ã€å†…å­˜å’Œç«‹å³æ•°ä¹‹é—´ä¼ é€’æ•°æ®&lt;/p&gt;
&lt;h3 id=&#34;movæ•°æ®ä¼ é€&#34;&gt;MOVï¼šæ•°æ®ä¼ é€
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;MOV&lt;/code&gt;(move)æ˜¯æ•°æ®ä¼ é€æŒ‡ä»¤ï¼Œå°†å³è¾¹æ“ä½œæ•°çš„å€¼å¤åˆ¶åˆ°å·¦è¾¹æ“ä½œæ•°ä¸­&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™ä¸¤ä¸ªæ“ä½œæ•°ä¸­æœ€å¤šåªèƒ½æœ‰&lt;strong&gt;ä¸€ä¸ªæ˜¯å†…å­˜æ“ä½œæ•°ï¼ˆå¸¦æ–¹æ‹¬å·çš„é‚£ç§ï¼‰&lt;/strong&gt;ï¼Œå¦ä¸€ä¸ªå¿…é¡»æ˜¯å¯„å­˜å™¨æˆ–ç«‹å³æ•°&lt;/p&gt;
&lt;h4 id=&#34;ç«‹å³æ•°---å¯„å­˜å™¨&#34;&gt;ç«‹å³æ•° -&amp;gt; å¯„å­˜å™¨
&lt;/h4&gt;&lt;p&gt;å°†å¸¸é‡&lt;code&gt;0x12345678&lt;/code&gt;æ”¾å…¥&lt;code&gt;ESI&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x12345678&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å¯„å­˜å™¨---å¯„å­˜å™¨&#34;&gt;å¯„å­˜å™¨ -&amp;gt; å¯„å­˜å™¨
&lt;/h4&gt;&lt;p&gt;å°†&lt;code&gt;ECX&lt;/code&gt;çš„å†…å®¹å¤åˆ¶åˆ°&lt;code&gt;EAX&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;ç«‹å³æ•°---å†…å­˜&#34;&gt;ç«‹å³æ•° -&amp;gt; å†…å­˜
&lt;/h4&gt;&lt;p&gt;å°†åœ°å€ä¸º&lt;code&gt;EAX&lt;/code&gt;çš„4å­—èŠ‚å†…å­˜è®¾ä¸º1&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;[EAX]&lt;/code&gt;è¡¨ç¤ºå–&lt;code&gt;EAX&lt;/code&gt;å¯„å­˜å™¨ä¸­çš„å€¼ä½œä¸ºå†…å­˜åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;DWORD PTR&lt;/code&gt;è¡¨ç¤ºæ“ä½œçš„å†…å­˜æ•°æ®å¤§å°æ˜¯4å­—èŠ‚ï¼ˆ32 ä½ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“æ±‡ç¼–å™¨ä¸æ¸…æ¥šè¦æ“ä½œå†…å­˜çš„å¤§å°æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨ä¿®é¥°ç¬¦æ¥ç¡®å®šï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ä¿®é¥°ç¬¦ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä¿®é¥°ç¬¦&lt;/th&gt;
          &lt;th&gt;å¤§å°&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;BYTE PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;1 å­—èŠ‚ï¼ˆ8 ä½ï¼‰&lt;/td&gt;
          &lt;td&gt;è®¿é—® 8 ä½æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;WORD PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;2 å­—èŠ‚ï¼ˆ16 ä½ï¼‰&lt;/td&gt;
          &lt;td&gt;è®¿é—® 16 ä½æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;DWORD PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰&lt;/td&gt;
          &lt;td&gt;è®¿é—® 32 ä½æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;QWORD PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;8 å­—èŠ‚ï¼ˆ64 ä½ï¼‰&lt;/td&gt;
          &lt;td&gt;è®¿é—® 64 ä½æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;NEAR PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;2/4 å­—èŠ‚åç§»&lt;/td&gt;
          &lt;td&gt;è¿‘æŒ‡é’ˆï¼ŒåªåŒ…å«åç§»ï¼Œæ®µå¯„å­˜å™¨ä¸å˜ï¼Œå¸¸ç”¨äºè¿‘è°ƒç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;FAR PTR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æ®µ + åç§»&lt;/td&gt;
          &lt;td&gt;è¿œæŒ‡é’ˆï¼ŒåŒ…å«æ®µé€‰æ‹©ç¬¦å’Œåç§»ï¼Œå¸¸ç”¨äºè·¨æ®µè°ƒç”¨&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;å¯„å­˜å™¨---å†…å­˜&#34;&gt;å¯„å­˜å™¨ -&amp;gt; å†…å­˜
&lt;/h4&gt;&lt;p&gt;å°†&lt;code&gt;EBX&lt;/code&gt;çš„å€¼å†™å…¥åœ°å€ä¸º&lt;code&gt;EAX&lt;/code&gt;çš„å†…å­˜ä¸­&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;], &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†&lt;code&gt;EAX&lt;/code&gt;çš„å€¼å†™å…¥åœ°å€ä¸º&lt;code&gt;ESI+0x34&lt;/code&gt;çš„å†…å­˜ä¸­&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;34&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt;], &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„è¿™é‡Œçš„&lt;code&gt;[]&lt;/code&gt;ä¸èƒ½æ‹†å¼€å†™ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;å†…å­˜---å¯„å­˜å™¨&#34;&gt;å†…å­˜ -&amp;gt; å¯„å­˜å™¨
&lt;/h4&gt;&lt;p&gt;å°†åœ°å€ä¸º&lt;code&gt;ECX&lt;/code&gt;çš„å†…å­˜ä¸­çš„å€¼è¯»å…¥&lt;code&gt;EAX&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†åœ°å€ä¸º&lt;code&gt;ECX+EAX&lt;/code&gt;çš„å†…å­˜ä¸­çš„å€¼è¯»å…¥&lt;code&gt;EDX&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;]  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°†å†…å­˜ä¸­åœ°å€&lt;code&gt;0x50&lt;/code&gt;å¤„çš„æ•°æ®è¯»å…¥å¯„å­˜å™¨&lt;code&gt;EAX&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, [&lt;span style=&#34;color:#d19a66&#34;&gt;0x50&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;leaåŠ è½½æœ‰æ•ˆåœ°å€&#34;&gt;LEAï¼šåŠ è½½æœ‰æ•ˆåœ°å€
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;LEA&lt;/code&gt; (Load Effective Address) ç”¨äºè®¡ç®—æºæ“ä½œæ•°æŒ‡å®šçš„å†…å­˜åœ°å€ï¼Œå¹¶å°†åœ°å€åŠ è½½åˆ°ç›®æ ‡å¯„å­˜å™¨ä¸­&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒä¸&lt;code&gt;MOV&lt;/code&gt;çš„å…³é”®åŒºåˆ«åœ¨äºï¼Œ&lt;code&gt;MOV&lt;/code&gt;ä¼šè®¿é—®è¯¥åœ°å€å¹¶å–å‡ºå…¶ä¸­çš„æ•°æ®ï¼Œ&lt;strong&gt;è€Œ&lt;code&gt;LEA&lt;/code&gt;åªè®¡ç®—åœ°å€ï¼Œä¸è®¿é—®å†…å­˜&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œä½¿ç”¨&lt;code&gt;LEA&lt;/code&gt;è®¡ç®—æ—¶ï¼Œå¯„å­˜å™¨å¿…é¡»åŠ ä¸Š&lt;code&gt;[]&lt;/code&gt;è¡¨ç¤ºå–åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;è®¡ç®—å†…å­˜åœ°å€&#34;&gt;è®¡ç®—å†…å­˜åœ°å€
&lt;/h4&gt;&lt;p&gt;å‡è®¾&lt;code&gt;EAX = 0x1000&lt;/code&gt;, å†…å­˜åœ°å€&lt;code&gt;0x1000&lt;/code&gt;å¤„çš„å€¼ä¸º&lt;code&gt;0xABCD&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨MOVï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;MOV&lt;/code&gt;å°†åœ°å€&lt;code&gt;EAX&lt;/code&gt;ï¼ˆ&lt;code&gt;0x1000&lt;/code&gt;ï¼‰æŒ‡å‘çš„æ•°æ®&lt;code&gt;0xABCD&lt;/code&gt;æ”¾å…¥&lt;code&gt;EBX&lt;/code&gt;ï¼Œç»“æœæ˜¯&lt;code&gt;EBX = 0xABCD&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨LEAï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LEA&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;]  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;LEA&lt;/code&gt;å°†åœ°å€è¡¨è¾¾å¼&lt;code&gt;[EAX]&lt;/code&gt;æœ¬èº«çš„å€¼&lt;code&gt;0x1000&lt;/code&gt;æ”¾å…¥&lt;code&gt;EBX&lt;/code&gt;ï¼Œç»“æœæ˜¯&lt;code&gt;EBX = 0x1000&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ‰§è¡Œå¿«é€Ÿæ•°å­¦è¿ç®—&#34;&gt;æ‰§è¡Œå¿«é€Ÿæ•°å­¦è¿ç®—
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;LEA&lt;/code&gt;å¯ä»¥æ‰§è¡Œä¸€äº›åŸºç¡€çš„æ•°å­¦è¿ç®—ï¼Œä¸”æ¯”ä½¿ç”¨&lt;code&gt;ADD&lt;/code&gt;æˆ–&lt;code&gt;MUL&lt;/code&gt;ç­‰æŒ‡ä»¤æ›´é«˜æ•ˆï¼Œå› ä¸ºå®ƒä¸å½±å“CPUçš„æ ‡å¿—ä½&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è®¡ç®—&lt;code&gt;EAX = EBX + ECX * 4 + 100H&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LEA&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„è¿™é‡Œçš„&lt;code&gt;[]&lt;/code&gt;ä¸èƒ½æ‹†å¼€å†™ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸²æ“ä½œ&#34;&gt;ä¸²æ“ä½œ
&lt;/h3&gt;&lt;p&gt;è¿™ç±»æŒ‡ä»¤ä¸“é—¨ç”¨äºé«˜æ•ˆå¤„ç†å†…å­˜ä¸­çš„è¿ç»­æ•°æ®å—ï¼ˆå­—ç¬¦ä¸²ï¼‰&lt;/p&gt;
&lt;p&gt;å®ƒä»¬é€šå¸¸ä¸ &lt;code&gt;REP&lt;/code&gt; ç³»åˆ—å‰ç¼€ç»“åˆä½¿ç”¨ï¼Œä»¥é‡å¤æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œé‡å¤æ¬¡æ•°ç”± &lt;code&gt;ECX&lt;/code&gt; å¯„å­˜å™¨æ§åˆ¶&lt;/p&gt;
&lt;h4 id=&#34;repç³»åˆ—å‰ç¼€&#34;&gt;REPç³»åˆ—å‰ç¼€
&lt;/h4&gt;&lt;p&gt;&lt;mark&gt;&lt;strong&gt;REP&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¨ç§°REPeatï¼Œåœ¨æ‰§è¡ŒæŒ‡ä»¤å‰ä¼šæ£€æŸ¥&lt;code&gt;ECX&lt;/code&gt;ï¼ŒæŒ‡ä»¤ä¼šé‡å¤æ‰§è¡Œ&lt;code&gt;ECX&lt;/code&gt;æ¬¡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;egï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;        ; é‡å¤æ¬¡æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MOVSB&lt;/span&gt;         ; å°†[&lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;]çš„å­—èŠ‚ç§»åŠ¨åˆ°[&lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;]ï¼Œé‡å¤&lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;mark&gt;&lt;strong&gt;REPE / REPZ&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¨ç§°REPeat While Equal / REPeat While Zeroï¼Œå½“&lt;code&gt;ZF=1&lt;/code&gt;ä¸”&lt;code&gt;ECX&lt;/code&gt;ä¸ä¸º0æ—¶ç»§ç»­é‡å¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;egï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;CMPSB&lt;/span&gt;        ; æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œ&lt;span style=&#34;color:#e06c75&#34;&gt;ZF&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;æ—¶ç»§ç»­ï¼Œæœ€å¤š&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;mark&gt;&lt;strong&gt;REPNE / REPNZ&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¨ç§°REPeat while Not Equal / REPeat while Not Zeroï¼Œå½“&lt;code&gt;ZF=0&lt;/code&gt;ä¸”&lt;code&gt;ECX&lt;/code&gt;ä¸ä¸º0æ—¶ç»§ç»­é‡å¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;egï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REPNE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SCASB&lt;/span&gt;       ; æ‰«æå­—ç¬¦ä¸²ï¼Œ&lt;span style=&#34;color:#e06c75&#34;&gt;ZF&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;æ—¶ç»§ç»­ï¼Œæœ€å¤š&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;ç´¢å¼•å¢å‡æ§åˆ¶æŒ‡ä»¤cldstd&#34;&gt;ç´¢å¼•å¢å‡æ§åˆ¶æŒ‡ä»¤CLD/STD
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;EFLAGS&lt;/code&gt;å¯„å­˜å™¨ä¸­çš„&lt;code&gt;DF&lt;/code&gt;æ ‡å¿—ä½å†³å®šäº†æ¯æ¬¡æ“ä½œå&lt;code&gt;ESI&lt;/code&gt;å’Œ&lt;code&gt;EDI&lt;/code&gt;çš„å˜åŒ–æ–¹å‘ï¼Œè€Œ&lt;code&gt;CLD&lt;/code&gt;å’Œ&lt;code&gt;SLD&lt;/code&gt;æŒ‡ä»¤æ§åˆ¶ç€&lt;code&gt;DF&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;strong&gt;CLDæŒ‡ä»¤&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;å…¨ç§°Clear Direction Flagï¼Œ&lt;strong&gt;&lt;code&gt;DF = 0&lt;/code&gt;ï¼Œ&lt;code&gt;ESI&lt;/code&gt;å’Œ&lt;code&gt;EDI&lt;/code&gt;åœ¨æ¯æ¬¡æ“ä½œåé€’å¢&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;strong&gt;STDæŒ‡ä»¤&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;å…¨ç§°Set Direction Flagï¼Œ&lt;strong&gt;&lt;code&gt;DF = 1&lt;/code&gt;ï¼Œ&lt;code&gt;ESI&lt;/code&gt;å’Œ&lt;code&gt;EDI&lt;/code&gt;åœ¨æ¯æ¬¡æ“ä½œåé€’å‡&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;å–åœ°å€è¿ç®—ç¬¦offset&#34;&gt;å–åœ°å€è¿ç®—ç¬¦OFFSET
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;OFFSET&lt;/code&gt;æ˜¯æ±‡ç¼–è¯­è¨€ä¸­çš„ä¸€ä¸ªç¼–è¯‘æ—¶è¿ç®—ç¬¦ï¼Œä½œç”¨æ˜¯å–å¾—ä¸€ä¸ªæ ‡å·ï¼ˆå˜é‡ã€æ•°ç»„ç­‰ï¼‰çš„å†…å­˜åœ°å€ï¼ˆåç§»é‡ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚æˆ‘åœ¨æ•°æ®æ®µï¼ˆ.dataï¼‰å®šä¹‰ä¸€ä¸ªå˜é‡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.&lt;span style=&#34;color:#e06c75&#34;&gt;data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SourceAddress&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DB&lt;/span&gt; &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;C&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;å‡è®¾ç¼–è¯‘å™¨æŠŠè¿™æ®µæ•°æ®æ”¾åœ¨å†…å­˜åœ°å€&lt;code&gt;0x00405000&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆ&lt;code&gt;OFFSET SourceAddress&lt;/code&gt;åœ¨æ±‡ç¼–æ—¶å°±ä¼šè¢«è®¡ç®—ä¸º&lt;code&gt;0x00405000&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;alert alert-tip&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ’¡
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Tip
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;è¿™é‡Œçš„DBè¢«ç§°ä½œ&lt;strong&gt;ä¼ªæŒ‡ä»¤&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®ƒä¸æ˜¯CPUæ‰§è¡Œçš„æŒ‡ä»¤ï¼Œæ˜¯ç»™æ±‡ç¼–å™¨ç”¨çš„å‘½ä»¤ï¼Œå‘Šè¯‰æ±‡ç¼–å™¨åœ¨ç¨‹åºä¸­ç”Ÿæˆæ•°æ®ã€å®šä¹‰å¸¸é‡æˆ–åˆ†é…ç©ºé—´&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼ä¼ªæŒ‡ä»¤è¿˜æœ‰ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
          &lt;th&gt;å…¨ç§°&lt;/th&gt;
          &lt;th&gt;å®šä¹‰å•ä½&lt;/th&gt;
          &lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DB&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Define Byte&lt;/td&gt;
          &lt;td&gt;1 å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DB 1, 2, 3&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DW&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Define Word&lt;/td&gt;
          &lt;td&gt;2 å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DW 1234h&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DD&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Define Doubleword&lt;/td&gt;
          &lt;td&gt;4 å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DD 0x12345678&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;DQ&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;Define Quadword&lt;/td&gt;
          &lt;td&gt;8 å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;DQ 0x1122334455667788&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h4 id=&#34;movsb--movsw--movsdç§»åŠ¨å­—ç¬¦ä¸²&#34;&gt;MOVSB / MOVSW / MOVSDï¼šç§»åŠ¨å­—ç¬¦ä¸²
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;MOVS&lt;/code&gt;ï¼ˆMove Stringï¼‰æŒ‡ä»¤ç”¨äºå°†æ•°æ®ä»æºåœ°å€&lt;code&gt;DS:ESI&lt;/code&gt;å¤åˆ¶åˆ°ç›®æ ‡åœ°å€&lt;code&gt;ES:EDI&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®æŒ‡ä»¤åç¼€ï¼Œå®ƒæ¯æ¬¡å¯ä»¥å¤åˆ¶1ã€2æˆ–4ä¸ªå­—èŠ‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;MOVSB&lt;/code&gt;ï¼šç§»åŠ¨1å­—èŠ‚ï¼ˆByteï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;MOVSW&lt;/code&gt;ï¼šç§»åŠ¨2å­—èŠ‚ï¼ˆWordï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;MOVSD&lt;/code&gt;ï¼šç§»åŠ¨4å­—èŠ‚ï¼ˆDouble Wordï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç æ˜¯ä½¿ç”¨&lt;code&gt;REP MOVSD&lt;/code&gt;å°†æºåœ°å€çš„32å­—èŠ‚æ•°æ®å¤åˆ¶åˆ°ç›®æ ‡åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;è®¾ç½®å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;OFFSET&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SourceAddress&lt;/span&gt;      ; å°†æºåœ°å€åŠ è½½åˆ°&lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;OFFSET&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;DestAddress&lt;/span&gt;         ; å°†ç›®æ ‡åœ°å€åŠ è½½åˆ°&lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;                                       ; è®¾ç½®é‡å¤æ¬¡æ•° (&lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;æ¬¡&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;å­—èŠ‚&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;æ¬¡&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt;å­—èŠ‚)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;æ‰§è¡Œå¤åˆ¶
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CLD&lt;/span&gt;                                                     ; æ¸…é™¤æ–¹å‘æ ‡å¿—ä½ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;DF&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;ï¼‰ï¼Œç¡®ä¿&lt;span style=&#34;color:#e06c75&#34;&gt;ESIå’ŒEDIé€’å¢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;MOVSD&lt;/span&gt;                                        ; é‡å¤æ‰§è¡Œ&lt;span style=&#34;color:#e06c75&#34;&gt;MOVSDæŒ‡ä»¤ECXæ¬¡&lt;/span&gt;ï¼Œå³&lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;æ¬¡
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;stosb--stosw--stosdå­˜å‚¨å­—ç¬¦ä¸²&#34;&gt;STOSB / STOSW / STOSDï¼šå­˜å‚¨å­—ç¬¦ä¸²
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;STOS&lt;/code&gt;ï¼ˆStore Stringï¼‰æŒ‡ä»¤ç”¨äºå°†&lt;code&gt;AL&lt;/code&gt;/&lt;code&gt;AX&lt;/code&gt;/&lt;code&gt;EAX&lt;/code&gt;å¯„å­˜å™¨ä¸­çš„å€¼å­˜å‚¨åˆ°&lt;code&gt;ES:EDI&lt;/code&gt;æŒ‡å‘çš„å†…å­˜åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒå¸¸ç”¨äºåˆå§‹åŒ–ä¸€å—å†…å­˜åŒºåŸŸ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;STOSB&lt;/code&gt;ï¼šå°†&lt;code&gt;AL&lt;/code&gt;çš„å†…å®¹å­˜å…¥&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;STOSW&lt;/code&gt;ï¼šå°†&lt;code&gt;AX&lt;/code&gt;çš„å†…å®¹å­˜å…¥&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;STOSD&lt;/code&gt;ï¼šå°†&lt;code&gt;EAX&lt;/code&gt;çš„å†…å®¹å­˜å…¥&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å°†&lt;code&gt;EDI&lt;/code&gt;æŒ‡å‘çš„ 36 å­—èŠ‚å†…å­˜å—å…¨éƒ¨è®¾ç½®ä¸º 0&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;è®¾ç½®å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;                   ; è®¾ç½®ç›®æ ‡å†…å­˜åœ°å€ (å‡è®¾åœ°å€å·²åœ¨&lt;span style=&#34;color:#e06c75&#34;&gt;ESIä¸­&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;                  ; å°†&lt;span style=&#34;color:#e06c75&#34;&gt;EAXæ¸…é›¶&lt;/span&gt;ï¼Œè¿™æ˜¯æˆ‘ä»¬è¦å†™å…¥çš„å€¼
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;                     ; è®¾ç½®é‡å¤æ¬¡æ•° (&lt;span style=&#34;color:#d19a66&#34;&gt;9&lt;/span&gt;æ¬¡&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;å­—èŠ‚&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;æ¬¡&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;36&lt;/span&gt;å­—èŠ‚)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;æ‰§è¡Œå†™å…¥
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CLD&lt;/span&gt;                                  ; ç¡®ä¿&lt;span style=&#34;color:#e06c75&#34;&gt;EDIé€’å¢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;STOSD&lt;/span&gt;                      ; é‡å¤æ‰§è¡Œ&lt;span style=&#34;color:#e06c75&#34;&gt;STOSDæŒ‡ä»¤ECXæ¬¡&lt;/span&gt;ï¼Œå°†&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;(&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;)è¿ç»­å†™å…¥ç›®æ ‡å†…å­˜
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;&lt;code&gt;XOR EAX, EAX&lt;/code&gt;æ•ˆæœå’Œ&lt;code&gt;MOV EAX, 0&lt;/code&gt;ä¸€æ ·ï¼Œéƒ½æ˜¯å°†å¯„å­˜å™¨å€¼ç½®é›¶ï¼Œä½†æ˜¯ä¼šæ›´åŠ é«˜æ•ˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™æ˜¯å› ä¸ºCPUçœ‹åˆ°&lt;code&gt;XOR reg, reg&lt;/code&gt;è¿™ç§ç‰¹æ®Šæ¨¡å¼ï¼Œä¼šè‡ªåŠ¨è¯†åˆ«ä¸ºæ¸…é›¶ä¼˜åŒ–ï¼Œä¸ä¼šä¾èµ–æ—§å€¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Intelå®˜æ–¹ä¼˜åŒ–æ‰‹å†Œæ˜ç¡®æŒ‡å‡ºï¼š&lt;/p&gt;
&lt;p&gt;â€œZero idioms such as&lt;code&gt;XOR reg, reg&lt;/code&gt;or&lt;code&gt;SUB reg, reg&lt;/code&gt;are recognized by the processor and are handled specially â€” they do not create a dependency on the old register value.â€&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h4 id=&#34;scasb--scasw--scasdæ‰«æå­—ç¬¦ä¸²&#34;&gt;SCASB / SCASW / SCASDï¼šæ‰«æå­—ç¬¦ä¸²
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;SCAS&lt;/code&gt;ï¼ˆScan Stringï¼‰æŒ‡ä»¤ç”¨äºå°†&lt;code&gt;AL&lt;/code&gt;/&lt;code&gt;AX&lt;/code&gt;/&lt;code&gt;EAX&lt;/code&gt;å¯„å­˜å™¨ä¸­çš„å€¼ä¸&lt;code&gt;ES:EDI&lt;/code&gt;æŒ‡å‘çš„å†…å­˜å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶æ ¹æ®æ¯”è¾ƒç»“æœè®¾ç½®&lt;code&gt;EFLAGS&lt;/code&gt;å¯„å­˜å™¨çš„æ ‡å¿—ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯„å­˜å™¨å€¼ç­‰äºå†…å­˜å€¼ï¼š&lt;code&gt;ZF = 1&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯„å­˜å™¨å€¼ä¸ç­‰äºå†…å­˜å€¼ï¼š&lt;code&gt;ZF = 0&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®ƒå¸¸ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­æœç´¢ç‰¹å®šå­—ç¬¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SCASB&lt;/code&gt;ï¼šæ¯”è¾ƒ&lt;code&gt;AL&lt;/code&gt;å’Œ&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SCASW&lt;/code&gt;ï¼šæ¯”è¾ƒ&lt;code&gt;AX&lt;/code&gt;å’Œ&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SCASD&lt;/code&gt;ï¼šæ¯”è¾ƒ&lt;code&gt;EAX&lt;/code&gt;å’Œ&lt;code&gt;[EDI]&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•è®¡ç®—ä¸€ä¸ªä»¥&lt;code&gt;\0&lt;/code&gt;ï¼ˆNULLï¼‰ç»“å°¾çš„å­—ç¬¦ä¸²çš„é•¿åº¦&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;è®¾ç½®å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;                   ; å‡è®¾å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€åœ¨&lt;span style=&#34;color:#e06c75&#34;&gt;EBXä¸­&lt;/span&gt;ï¼Œå°†å…¶åŠ è½½åˆ°&lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;                        ; å°†&lt;span style=&#34;color:#e06c75&#34;&gt;ALè®¾ç½®ä¸º0&lt;/span&gt;ï¼Œå³æˆ‘å€‘è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ç»“æŸç¬¦&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;                     ; å°†&lt;span style=&#34;color:#e06c75&#34;&gt;ECXè®¾ä¸ºæœ€å¤§å€¼&lt;/span&gt;ï¼Œä»¥æ‰«æä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;æ‰§è¡Œæ‰«æ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CLD&lt;/span&gt;                                    ; ç¡®ä¿&lt;span style=&#34;color:#e06c75&#34;&gt;EDIé€’å¢&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;REPNE&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SCASB&lt;/span&gt;                    ; å½“&lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;EDI&lt;/span&gt;]æ—¶é‡å¤æ‰«æï¼Œæ¯æ¬¡æ‰«æ&lt;span style=&#34;color:#e06c75&#34;&gt;EDIéƒ½ä¼šé€’å¢&lt;/span&gt;ï¼Œç›´åˆ°æ‰¾åˆ°&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;æˆ–æ‰«æå®Œ&lt;span style=&#34;color:#e06c75&#34;&gt;ECXæ¬¡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                           ; æ‰¾åˆ°&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;åï¼Œ&lt;span style=&#34;color:#e06c75&#34;&gt;EDIæŒ‡å‘&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;å­—ç¬¦çš„ä¸‹ä¸€ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;è®¡ç®—é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;NOT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;                            ; å¯¹&lt;span style=&#34;color:#e06c75&#34;&gt;ECXæŒ‰ä½å–å&lt;/span&gt;ï¼Œå¾—åˆ°æ‰«æè¿‡çš„å­—ç¬¦æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DEC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;                             ; è®©&lt;span style=&#34;color:#e06c75&#34;&gt;ECXå‡ä¸€&lt;/span&gt;ï¼Œå³å‡å»æœ€åçš„&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;å­—ç¬¦ï¼Œå¾—åˆ°å­—ç¬¦ä¸²çš„å®é™…é•¿åº¦
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                                           ; æœ€ç»ˆé•¿åº¦å­˜å‚¨åœ¨&lt;span style=&#34;color:#e06c75&#34;&gt;ECXä¸­&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;div class=&#34;alert-header&#34;&gt;
        &lt;span class=&#34;alert-icon&#34;&gt;
            ğŸ“
        &lt;/span&gt;
        &lt;span class=&#34;alert-title&#34;&gt;
            Note
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&#34;alert-content&#34;&gt;
        &lt;p&gt;&lt;strong&gt;&lt;code&gt;MOV ECX, -1&lt;/code&gt;è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨åº•å±‚æœºå™¨ç ä¸­ï¼Œ&lt;code&gt;-1&lt;/code&gt;å¹¶ä¸ä¼šä»¥è´Ÿå·å½¢å¼å­˜å‚¨ï¼Œè€Œæ˜¯ä½¿ç”¨è¡¥ç è¡¨ç¤ºï¼Œè€Œ32ä½è¡¥ç ä¸­&lt;code&gt;-1 = 0xFFFFFFFF&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿™æ¡æŒ‡ä»¤æœ¬è´¨ä¸Šç­‰ä»·äºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;è¿™æ ·å°±æŠŠ&lt;code&gt;ECX&lt;/code&gt;è®¾ä¸ºäº†æœ€å¤§å€¼&lt;code&gt;0xFFFFFFFF&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;ECX&lt;/code&gt;æ˜¯æ— ç¬¦å·è®¡æ•°å™¨ï¼Œé€’å‡å°±ä»è¿™ä¸ªæå¤§æ•°å¼€å§‹ï¼Œè€Œä¸æ˜¯&lt;code&gt;-1&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SCASB&lt;/code&gt;æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œä¼šè‡ªåŠ¨è®©&lt;code&gt;ECX&lt;/code&gt;å‡1ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘ï¼Œæ‰€ä»¥å¹²è„†ä»æœ€å¤§å€¼å¼€å§‹æ‰«&lt;/p&gt;
&lt;p&gt;çœ‹çœ‹ç±»ä¼¼çš„ç”¨æ³•ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ±‡ç¼–å†™æ³•&lt;/th&gt;
          &lt;th&gt;å®é™…æ•°å€¼&lt;/th&gt;
          &lt;th&gt;å¯„å­˜å™¨å€¼&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV ECX, 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;0x00000000&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV ECX, 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;0x00000001&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV ECX, -1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;-1&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;0xFFFFFFFF&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MOV ECX, -2&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;-2&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;0xFFFFFFFE&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&#34;ç®—æœ¯ä¸ä½è¿ç®—æŒ‡ä»¤&#34;&gt;ç®—æœ¯ä¸ä½è¿ç®—æŒ‡ä»¤
&lt;/h2&gt;&lt;p&gt;è¿™ç±»æŒ‡ä»¤ç”¨äºæ‰§è¡ŒåŸºæœ¬çš„æ•°å­¦è®¡ç®—å’Œä½çº§æ“ä½œ&lt;/p&gt;
&lt;h3 id=&#34;add--subåŠ æ³•--å‡æ³•&#34;&gt;ADD / SUBï¼šåŠ æ³• / å‡æ³•
&lt;/h3&gt;&lt;p&gt;æ‰§è¡ŒåŠ æ³•æˆ–å‡æ³•è¿ç®—ï¼Œå¹¶å°†ç»“æœå­˜å›ç›®æ ‡æ“ä½œæ•°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;src&lt;/span&gt;              ; ç»“æœæ˜¯&lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;src&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;src&lt;/span&gt;               ; ç»“æœæ˜¯&lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;dest&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;src&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;inc--decåŠ ä¸€--å‡ä¸€&#34;&gt;INC / DECï¼šåŠ ä¸€ / å‡ä¸€
&lt;/h3&gt;&lt;p&gt;å°†æ“ä½œæ•°çš„å€¼å¢åŠ 1æˆ–å‡å°‘1ï¼Œæ¯”ç­‰æ•ˆçš„ &lt;code&gt;ADD/SUB&lt;/code&gt; æŒ‡ä»¤æ›´çŸ­ã€æ›´å¿«&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;INC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;                       ; ç»“æœæ˜¯&lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DEC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;                      ; ç»“æœæ˜¯&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;negå–è¡¥&#34;&gt;NEGï¼šå–è¡¥
&lt;/h3&gt;&lt;p&gt;é€šè¿‡æ‰§è¡ŒæŒ‰ä½å–åååŠ ä¸€çš„æ“ä½œæ¥è·å¾—æ“ä½œæ•°çš„ç®—æœ¯ç›¸åæ•°ï¼ˆè¡¥ç ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;NEG&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;                     ; ç»“æœæ˜¯&lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;imul--mulæœ‰ç¬¦å·--æ— ç¬¦å·ä¹˜æ³•&#34;&gt;IMUL / MULï¼šæœ‰ç¬¦å· / æ— ç¬¦å·ä¹˜æ³•
&lt;/h3&gt;&lt;p&gt;æ‰§è¡Œä¹˜æ³•è¿ç®—ï¼Œæ ¹æ®æ“ä½œæ•°çš„æ•°é‡ï¼Œç”¨æ³•æœ‰æ‰€ä¸åŒ&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
          &lt;th&gt;æ“ä½œæ•°å½¢å¼&lt;/th&gt;
          &lt;th&gt;ç»“æœå¯„å­˜å™¨&lt;/th&gt;
          &lt;th&gt;æ˜¯å¦å ç”¨EDX&lt;/th&gt;
          &lt;th&gt;ç‰¹ç‚¹&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;MUL SRC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å•æ“ä½œæ•°&lt;/td&gt;
          &lt;td&gt;EDX:EAX&lt;/td&gt;
          &lt;td&gt;æ˜¯&lt;/td&gt;
          &lt;td&gt;å®Œæ•´64ä½ç»“æœï¼Œæ— ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;IMUL SRC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å•æ“ä½œæ•°&lt;/td&gt;
          &lt;td&gt;EDX:EAX&lt;/td&gt;
          &lt;td&gt;æ˜¯&lt;/td&gt;
          &lt;td&gt;å®Œæ•´64ä½ç»“æœï¼Œæœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;IMUL DEC, SRC&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åŒæ“ä½œæ•°&lt;/td&gt;
          &lt;td&gt;ECX&lt;/td&gt;
          &lt;td&gt;å¦&lt;/td&gt;
          &lt;td&gt;åªä¿ç•™ä½32ä½ï¼Œæœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;IMUL DEC, SRC, ç«‹å³æ•°&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ä¸‰æ“ä½œæ•°&lt;/td&gt;
          &lt;td&gt;ECX&lt;/td&gt;
          &lt;td&gt;å¦&lt;/td&gt;
          &lt;td&gt;å¯ç«‹å³æ•°ä¹˜ï¼Œæœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;å•æ“ä½œæ•°imulå’Œmuléƒ½æ”¯æŒ&#34;&gt;å•æ“ä½œæ•°ï¼ˆIMULå’ŒMULéƒ½æ”¯æŒï¼‰
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å°†&lt;code&gt;EAX&lt;/code&gt;ä¸æŒ‡å®šæ“ä½œæ•°ç›¸ä¹˜ï¼Œç»“æœæ˜¯ä¸€ä¸ª64ä½æ•°ï¼Œé«˜32ä½å­˜å…¥&lt;code&gt;EDX&lt;/code&gt;ï¼Œä½32ä½å­˜å…¥&lt;code&gt;EAX&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;       ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IMUL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;           ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt;                        &lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;:&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFF&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MUL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;            ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4294967290&lt;/span&gt;        &lt;span style=&#34;color:#56b6c2&#34;&gt;-&amp;gt;&lt;/span&gt;           &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;:&lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x00000002&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å¤šæ“ä½œæ•°åªæœ‰imulæ”¯æŒ&#34;&gt;å¤šæ“ä½œæ•°ï¼ˆåªæœ‰IMULæ”¯æŒï¼‰
&lt;/h4&gt;&lt;p&gt;æä¾›æ›´é«˜çš„çµæ´»æ€§ï¼Œ&lt;strong&gt;ï¼Œå¯æŒ‡å®šç›®æ ‡å¯„å­˜å™¨ï¼Œç»“æœç›´æ¥å­˜å…¥ç›®æ ‡å¯„å­˜å™¨ï¼Œä¸åˆ†é«˜ä½ä½ï¼Œä¸å ç”¨EDX&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IMUL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IMUL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;    ; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; ä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šå†…å­˜ï¼Œå‡è®¾ [&lt;span style=&#34;color:#d19a66&#34;&gt;0x123&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IMUL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, [&lt;span style=&#34;color:#d19a66&#34;&gt;0x123&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;   ; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;15&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;idiv--divæœ‰ç¬¦å·--æ— ç¬¦å·é™¤æ³•&#34;&gt;IDIV / DIVï¼šæœ‰ç¬¦å· / æ— ç¬¦å·é™¤æ³•
&lt;/h3&gt;&lt;p&gt;æ‰§è¡Œé™¤æ³•è¿ç®—&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä½å®½&lt;/th&gt;
          &lt;th&gt;è¢«é™¤æ•°å¯„å­˜å™¨&lt;/th&gt;
          &lt;th&gt;å•†å¯„å­˜å™¨&lt;/th&gt;
          &lt;th&gt;ä½™æ•°å¯„å­˜å™¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;8ä½&lt;/td&gt;
          &lt;td&gt;AX&lt;/td&gt;
          &lt;td&gt;AL&lt;/td&gt;
          &lt;td&gt;AH&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;16ä½&lt;/td&gt;
          &lt;td&gt;DX:AX&lt;/td&gt;
          &lt;td&gt;AX&lt;/td&gt;
          &lt;td&gt;DX&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;32ä½&lt;/td&gt;
          &lt;td&gt;EDX:EAX&lt;/td&gt;
          &lt;td&gt;EAX&lt;/td&gt;
          &lt;td&gt;EDX&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;æ— ç¬¦å·çš„div&#34;&gt;æ— ç¬¦å·çš„DIV
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;       ; ä½ &lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt; ä½è¢«é™¤æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;        ; é«˜ &lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt; ä½è¢«é™¤æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt;        ; é™¤æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;DIV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; (å•†)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; (ä½™æ•°)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;æœ‰ç¬¦å·çš„idiv&#34;&gt;æœ‰ç¬¦å·çš„IDIV
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt;        ; é™¤æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;IDIV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; (å•†)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;6&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; (ä½™æ•°)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;and--or--xoræŒ‰ä½ä¸--æˆ–--å¼‚æˆ–&#34;&gt;AND / OR / XORï¼šæŒ‰ä½ä¸ / æˆ– / å¼‚æˆ–
&lt;/h3&gt;&lt;p&gt;å¯¹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½é€»è¾‘è¿ç®—ï¼Œ&lt;strong&gt;ç»“æœå­˜å›ç¬¬ä¸€ä¸ªæ“ä½œæ•°&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
          &lt;th&gt;è¿ç®—ç±»å‹&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;AND&lt;/td&gt;
          &lt;td&gt;æŒ‰ä½ä¸&lt;/td&gt;
          &lt;td&gt;ä¸¤ä½éƒ½ä¸º1æ—¶ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;OR&lt;/td&gt;
          &lt;td&gt;æŒ‰ä½æˆ–&lt;/td&gt;
          &lt;td&gt;ä¸¤ä½æœ‰1æ—¶ç»“æœä¸º1ï¼Œå¦åˆ™ä¸º0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;XOR&lt;/td&gt;
          &lt;td&gt;æŒ‰ä½å¼‚æˆ–&lt;/td&gt;
          &lt;td&gt;ä¸¤ä½ä¸åŒæ—¶ç»“æœä¸º1ï¼Œç›¸åŒä¸º0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x0F&lt;/span&gt;                        ; å–ä½&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;ä½ï¼Œæ¸…é™¤é«˜&lt;span style=&#34;color:#d19a66&#34;&gt;28&lt;/span&gt;ä½
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;OR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;                            ; å°†&lt;span style=&#34;color:#e06c75&#34;&gt;EBXä¸­ä¸º1çš„ä½åˆå¹¶åˆ°EAX&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFFF&lt;/span&gt;              ; æŒ‰ä½å–å
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹å‰æåˆ°è¿‡çš„&lt;code&gt;XOR EAX, EAX&lt;/code&gt;æ˜¯å°†&lt;code&gt;EAX&lt;/code&gt;å¯„å­˜å™¨æ¸…é›¶çš„æœ€å¿«æ–¹å¼ï¼ŒCPUèƒ½è¯†åˆ«è¿™ç§ç‰¹æ®Šå½¢å¼å¹¶è¿›è¡Œä¼˜åŒ–ï¼Œä¸äº§ç”Ÿå¯¹æ—§å€¼çš„ä¾èµ–ï¼Œå› æ­¤æ¯”&lt;code&gt;MOV EAX, 0&lt;/code&gt;æ›´é«˜æ•ˆ&lt;/p&gt;
&lt;h3 id=&#34;notæŒ‰ä½å–å&#34;&gt;NOTï¼šæŒ‰ä½å–å
&lt;/h3&gt;&lt;p&gt;å°†æ“ä½œæ•°çš„æ¯ä¸€ä½åè½¬ï¼ˆ0å˜1ï¼Œ1å˜0ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x0F&lt;/span&gt;                         ; äºŒè¿›åˆ¶&lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1111&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;NOT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;                                    ; å˜æˆ&lt;span style=&#34;color:#d19a66&#34;&gt;1111&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1111&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1111&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0000&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFF0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;shl--sal--shr--saré€»è¾‘--ç®—æ•°-çš„-å·¦ç§»--å³ç§»&#34;&gt;SHL / SAL / SHR / SARï¼šé€»è¾‘ / ç®—æ•° çš„ å·¦ç§» / å³ç§»
&lt;/h3&gt;&lt;p&gt;å°†æ“ä½œæ•°çš„ä½å‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç©ºå‡ºçš„ä½ç”¨0å¡«å……&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
          &lt;th&gt;è¿ç®—&lt;/th&gt;
          &lt;th&gt;å¡«å……ä½&lt;/th&gt;
          &lt;th&gt;è¿ç®—ç»“æœ&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;SHL / SAL&lt;/td&gt;
          &lt;td&gt;å·¦ç§»&lt;/td&gt;
          &lt;td&gt;ä½ä½è¡¥ 0&lt;/td&gt;
          &lt;td&gt;å·¦ç§»Nä½=ä¹˜ä»¥$2^N$&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SHR&lt;/td&gt;
          &lt;td&gt;é€»è¾‘å³ç§»&lt;/td&gt;
          &lt;td&gt;é«˜ä½è¡¥ 0&lt;/td&gt;
          &lt;td&gt;å³ç§»Nä½=æ— ç¬¦å·é™¤ä»¥$2^N$&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SAR&lt;/td&gt;
          &lt;td&gt;ç®—æœ¯å³ç§»&lt;/td&gt;
          &lt;td&gt;é«˜ä½è¡¥ç¬¦å·ä½&lt;/td&gt;
          &lt;td&gt;å³ç§»Nä½=æœ‰ç¬¦å·é™¤ä»¥$2^N$ï¼ˆä¿ç•™ç¬¦å·ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SHL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;12&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;^&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SAL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;        ; å’Œ&lt;span style=&#34;color:#e06c75&#34;&gt;SHLå®Œå…¨ä¸€æ ·&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;    ; &lt;span style=&#34;color:#d19a66&#34;&gt;0x00000010&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SHR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; (æ— ç¬¦å·é™¤ä»¥ &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt;   ; &lt;span style=&#34;color:#d19a66&#34;&gt;0xFFFFFFF0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SAR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;        ; &lt;span style=&#34;color:#e06c75&#34;&gt;ECX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; (ä¿ç•™ç¬¦å·)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;rol--rorå¾ªç¯å·¦ç§»--å³ç§»&#34;&gt;ROL / RORï¼šå¾ªç¯å·¦ç§» / å³ç§»
&lt;/h3&gt;&lt;p&gt;å°†æ“ä½œæ•°çš„ä½å‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç§»å‡ºçš„ä½ä¼šä»å¦ä¸€ç«¯å¾ªç¯å›æ¥å¡«å……ç©ºä½&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;10010011&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;       ; äºŒè¿›åˆ¶æ•° &lt;span style=&#34;color:#d19a66&#34;&gt;10010011&lt;/span&gt;ï¼Œ&lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x93&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ROL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;                         ; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;01001110&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;, åŸé«˜&lt;span style=&#34;color:#d19a66&#34;&gt;2&lt;/span&gt;ä½â€œ&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;â€å¾ªç¯åˆ°ä½ä½
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ROR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;                        ; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;11001001&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;b&lt;/span&gt;, ä½&lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;ä½â€œ&lt;span style=&#34;color:#d19a66&#34;&gt;110&lt;/span&gt;â€å¾ªç¯åˆ°é«˜ä½
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ§åˆ¶æµæŒ‡ä»¤&#34;&gt;æ§åˆ¶æµæŒ‡ä»¤
&lt;/h2&gt;&lt;p&gt;è¿™ç±»æŒ‡ä»¤é€šè¿‡ä¿®æ”¹&lt;code&gt;EIP&lt;/code&gt;ï¼ˆæŒ‡ä»¤æŒ‡é’ˆï¼‰å¯„å­˜å™¨çš„å€¼æ¥æ”¹å˜ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œä»è€Œå®ç°åˆ†æ”¯ã€å¾ªç¯ç­‰ç»“æ„&lt;/p&gt;
&lt;h3 id=&#34;æ¯”è¾ƒæŒ‡ä»¤&#34;&gt;æ¯”è¾ƒæŒ‡ä»¤
&lt;/h3&gt;&lt;p&gt;è¿™ä¸¤ä¸ªæŒ‡ä»¤é€šè¿‡æ‰§è¡Œå†…éƒ¨è¿ç®—æ¥æ”¹å˜&lt;code&gt;EFLAGS&lt;/code&gt;å¯„å­˜å™¨ä¸­çš„çŠ¶æ€æ ‡å¿—ä½ï¼Œ&lt;strong&gt;ä½†ä¸ä¼šä¿®æ”¹æ“ä½œæ•°æœ¬èº«&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒä»¬ä¸ºåç»­çš„æ¡ä»¶è·³è½¬æŒ‡ä»¤æä¾›åˆ¤æ–­ä¾æ®&lt;/p&gt;
&lt;h4 id=&#34;cmpå‡æ³•æ¯”è¾ƒ&#34;&gt;CMPï¼šå‡æ³•æ¯”è¾ƒ
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å†…éƒ¨æ‰§è¡Œ&lt;code&gt;A - B&lt;/code&gt;çš„å‡æ³•è¿ç®—&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;       ; å®é™…æ‰§è¡Œ &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;JG&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;greater&lt;/span&gt;          ; å¦‚æœ &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;3&lt;/span&gt;, è·³è½¬
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;testandæ¯”è¾ƒ&#34;&gt;TESTï¼šANDæ¯”è¾ƒ
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;å†…éƒ¨æ‰§è¡Œ&lt;code&gt;A AND B&lt;/code&gt;çš„æŒ‰ä½ä¸è¿ç®—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;eg1ï¼šæ£€æµ‹å¯„å­˜å™¨æ˜¯å¦ä¸º0&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TEST&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;         ; &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;JZ&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;is_zero&lt;/span&gt;                ; å¦‚æœç»“æœä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ZF&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;)ï¼Œè·³è½¬
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;eg2ï¼šæ£€æµ‹æŸä¸€ä½æ˜¯å¦ä¸º1&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;TEST&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;AL&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;                 ; æ£€æŸ¥æœ€ä½ä½æ˜¯å¦ä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;JNZ&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;odd_number&lt;/span&gt;      ; è‹¥æœ€ä½ä½ä¸º&lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;ï¼ˆå¥‡æ•°ï¼‰ï¼Œè·³è½¬
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;jmpæ— æ¡ä»¶è·³è½¬&#34;&gt;JMPï¼šæ— æ¡ä»¶è·³è½¬
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;JMP&lt;/code&gt;ï¼ˆJumpï¼‰æŒ‡ä»¤ä¼šç«‹å³æ— æ¡ä»¶åœ°å°†ç¨‹åºçš„æ‰§è¡Œç‚¹è½¬ç§»åˆ°æŒ‡å®šçš„ç›®æ ‡åœ°å€&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸºæœ¬è¯­æ³•ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;JMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;label&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;label&lt;/code&gt;å¯ä»¥æ˜¯åŒä¸€æ®µä»£ç å†…çš„æ ‡ç­¾ï¼ˆçŸ­è·³è½¬æˆ–è¿‘è·³è½¬ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æ®µçš„åœ°å€ï¼ˆè¿œè·³è½¬ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;      ; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;skip&lt;/span&gt;            ; æ— æ¡ä»¶è·³è½¬åˆ° &lt;span style=&#34;color:#e06c75&#34;&gt;skip&lt;/span&gt; æ ‡ç­¾
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;5&lt;/span&gt;      ; è¿™ä¸€è¡Œæ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;skip&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;      ; æ‰§è¡Œåˆ°è¿™é‡Œ
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;jccæ¡ä»¶è·³è½¬&#34;&gt;Jccï¼šæ¡ä»¶è·³è½¬
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Jcc&lt;/code&gt; (Jump on Condition) æ˜¯ä¸€ç³»åˆ—æŒ‡ä»¤çš„ç»Ÿç§°&lt;/p&gt;
&lt;p&gt;å®ƒä»¬åœ¨&lt;code&gt;CMP&lt;/code&gt;æˆ–&lt;code&gt;TEST&lt;/code&gt;æŒ‡ä»¤ä¹‹åï¼Œæ ¹æ®&lt;code&gt;EFLAGS&lt;/code&gt;å¯„å­˜å™¨çš„çŠ¶æ€æ¥å†³å®šæ˜¯å¦è¿›è¡Œè·³è½¬&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤&lt;/th&gt;
          &lt;th&gt;è·³è½¬æ¡ä»¶ï¼ˆåŸºäº EFLAGSï¼‰&lt;/th&gt;
          &lt;th&gt;å«ä¹‰ï¼ˆä¸­æ–‡æè¿°ï¼‰&lt;/th&gt;
          &lt;th&gt;æ¯”è¾ƒç±»å‹&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JE / JZ&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ZF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç›¸ç­‰ / ç»“æœä¸ºé›¶&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JNE / JNZ&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ZF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ä¸ç›¸ç­‰ / ç»“æœéé›¶&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JG / JNLE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ZF = 0 AND SF = OF&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¤§äºï¼ˆæœ‰ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JGE / JNL&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SF = OF&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¤§äºç­‰äºï¼ˆæœ‰ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JL / JNGE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SF â‰  OF&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°äºï¼ˆæœ‰ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JLE / JNG&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;ZF = 1 OR SF â‰  OF&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°äºç­‰äºï¼ˆæœ‰ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æœ‰ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JA / JNBE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 0 AND ZF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¤§äºï¼ˆæ— ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æ— ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JAE / JNB&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¤§äºç­‰äºï¼ˆæ— ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æ— ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JB / JNAE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°äºï¼ˆæ— ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æ— ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JBE / JNA&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 1 OR ZF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å°äºç­‰äºï¼ˆæ— ç¬¦å·æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;æ— ç¬¦å·&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç»“æœä¸ºè´Ÿ&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JNS&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;SF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç»“æœä¸ºæ­£æˆ–é›¶&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JO&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;OF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æº¢å‡ºå‘ç”Ÿ&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JNO&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;OF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æ— æº¢å‡º&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JC&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;è¿›ä½ï¼ˆæˆ–å€Ÿä½ï¼‰å‘ç”Ÿ&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JNC&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æ— è¿›ä½ / æ— å€Ÿä½&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JP / JPE&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PF = 1&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¥‡å¶æ ‡å¿—ä¸ºå¶ï¼ˆç»“æœ1ä¸ªæ•°ä¸ºå¶æ•°ï¼‰&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;JNP / JPO&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;PF = 0&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å¥‡å¶æ ‡å¿—ä¸ºå¥‡&lt;/td&gt;
          &lt;td&gt;é€šç”¨&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;è·³è½¬æŒ‡ä»¤å‰ç¼€&#34;&gt;è·³è½¬æŒ‡ä»¤å‰ç¼€
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è·³è½¬æŒ‡ä»¤å‰ç¼€æ˜¯æ±‡ç¼–å™¨ç”¨æ¥æŒ‡ç¤ºè·³è½¬ç±»å‹æˆ–èŒƒå›´çš„å…³é”®å­—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ƒä¸æ”¹å˜è·³è½¬çš„æ¡ä»¶æœ¬èº«ï¼Œåªå½±å“æŒ‡ä»¤ç¼–ç å’Œåç§»é‡å¤§å°ï¼Œä¹Ÿå°±æ˜¯CPUè®¡ç®—è·³è½¬åœ°å€æ—¶ç”¨å¤šå°‘å­—èŠ‚è¡¨ç¤ºåç§»&lt;/p&gt;
&lt;p&gt;è¿™æœ¬è´¨ä¸Šæ˜¯å‘Šè¯‰CPUè·³è½¬ç›®æ ‡ç¦»å®ƒæœ‰å¤šè¿œï¼ŒCPUä¼šé€‰æ‹©åˆé€‚çš„æŒ‡ä»¤é•¿åº¦ï¼ˆ1-6å­—èŠ‚ï¼‰å­˜å‚¨åç§»&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å‰ç¼€&lt;/th&gt;
          &lt;th&gt;åç§»é‡å¤§å°&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;SHORT&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;8ä½æœ‰ç¬¦å·åç§»é‡ (-128 ~ +127)&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è¿‘è·ç¦»è·³è½¬&lt;/strong&gt;ï¼Œå°èŒƒå›´å¾ªç¯æˆ–if/else&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;NEAR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;16ä½æˆ–32ä½åç§»é‡ï¼ˆåŒæ®µè·³è½¬ï¼‰&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ç›®æ ‡åœ¨å½“å‰ä»£ç æ®µå†…ï¼Œè·ç¦»è¾ƒè¿œ&lt;/strong&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;FAR&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;16/32ä½æ®µå†…åç§» + 16ä½æ®µé€‰æ‹©å­&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;è·¨æ®µè·³è½¬&lt;/strong&gt;ï¼Œæ”¹å˜CSå¯„å­˜å™¨&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;æ¡ä»¶è·³è½¬ï¼ˆJccï¼‰é»˜è®¤ä½¿ç”¨SHORTï¼Œå¦‚æœç›®æ ‡å¤ªè¿œï¼Œæ±‡ç¼–å™¨ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºNEAR&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;æµç¨‹æ§åˆ¶ç»“æ„ç¤ºä¾‹&#34;&gt;æµç¨‹æ§åˆ¶ç»“æ„ç¤ºä¾‹
&lt;/h3&gt;&lt;h4 id=&#34;if-elseç»“æ„&#34;&gt;if-elseç»“æ„
&lt;/h4&gt;&lt;p&gt;Cè¯­è¨€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C&#34; data-lang=&#34;C&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;esi&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#7f848e&#34;&gt;// block A
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7f848e&#34;&gt;// block B
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ±‡ç¼–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;, [&lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;]      ; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;esi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;TEST&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt;       ; æ¯”è¾ƒ &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt; å’Œ &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JZ&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SHORT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;block_B&lt;/span&gt;    ; å¦‚æœ &lt;span style=&#34;color:#e06c75&#34;&gt;EDX&lt;/span&gt; ä¸º &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;, åˆ™è·³è½¬åˆ° &lt;span style=&#34;color:#e06c75&#34;&gt;block_B&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ;&lt;span style=&#34;color:#e06c75&#34;&gt;block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;A&lt;/span&gt; çš„ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;block_B&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ;&lt;span style=&#34;color:#e06c75&#34;&gt;block&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;B&lt;/span&gt; çš„ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;forå¾ªç¯ç»“æ„&#34;&gt;forå¾ªç¯ç»“æ„
&lt;/h4&gt;&lt;p&gt;Cè¯­è¨€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#c678dd&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#e5c07b&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;; &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#61afef;font-weight:bold&#34;&gt;printf&lt;/span&gt;(&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;%d&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#98c379&#34;&gt;&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ±‡ç¼–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;XOR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;                                              ; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0&lt;/span&gt; (ä½œä¸ºè®¡æ•°å™¨ &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LOOP_START&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ;è°ƒç”¨ &lt;span style=&#34;color:#e06c75&#34;&gt;printf&lt;/span&gt; çš„ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;OFFSET&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FORMAT_STRING&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;printf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ADD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;                    						      ; å¹³è¡¡å †æ ˆ
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    	
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;INC&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;            											  ; &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;++&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;CMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESI&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;         									  ; æ¯”è¾ƒ &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt; å’Œ &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;JL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;SHORT&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;LOOP_START&lt;/span&gt;  						    ; å¦‚æœ &lt;span style=&#34;color:#e06c75&#34;&gt;i&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;10&lt;/span&gt;, ç»§ç»­å¾ªç¯
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ ˆä¸å‡½æ•°è°ƒç”¨æŒ‡ä»¤&#34;&gt;æ ˆä¸å‡½æ•°è°ƒç”¨æŒ‡ä»¤
&lt;/h2&gt;&lt;h3 id=&#34;æ ˆ&#34;&gt;æ ˆ
&lt;/h3&gt;&lt;p&gt;åœ¨IA-32æ¶æ„ä¸‹ï¼Œæ ˆæ˜¯è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨ä¸´æ—¶æ•°æ®ã€å‡½æ•°å‚æ•°å’Œè¿”å›åœ°å€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ˆå­˜åœ¨äºä¸€ä¸ªæ ˆæ®µå†…ï¼Œç”±æ®µå¯„å­˜å™¨SSæŒ‡å‘æ®µæè¿°ç¬¦&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ESPå¯„å­˜å™¨æ‰€åŒ…å«çš„æ ˆæŒ‡é’ˆæ°¸è¿œæŒ‡å‘æ ˆé¡¶ä½ç½®ï¼Œæ‰€æœ‰é’ˆå¯¹æ ˆçš„æ“ä½œéƒ½æ˜¯åŸºäº&lt;code&gt;SS:ESP&lt;/code&gt;çš„åœ°å€å¼•ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;IA-32 çš„æ ˆé€šå¸¸æ˜¯&lt;strong&gt;é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ ˆå¸§&#34;&gt;æ ˆå¸§
&lt;/h3&gt;&lt;h4 id=&#34;ä»€ä¹ˆæ˜¯æ ˆå¸§&#34;&gt;ä»€ä¹ˆæ˜¯æ ˆå¸§
&lt;/h4&gt;&lt;p&gt;æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œéƒ½ä¼šåœ¨æ ˆä¸Šä¸ºå…¶åˆ†é…ä¸€å—ä¸“å±ç©ºé—´ï¼Œç§°ä¸ºè¯¥å‡½æ•°çš„&lt;strong&gt;æ ˆå¸§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ ˆå¸§ç”¨äºå­˜æ”¾å‡½æ•°çš„å±€éƒ¨å˜é‡ã€ä¼ é€’ç»™å…¶ä»–å‡½æ•°çš„å‚æ•°ä»¥åŠä¿å­˜è°ƒç”¨è€…çš„ä¸Šä¸‹æ–‡ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;æ ˆå¸§çš„ç»„æˆå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å†…å®¹&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;å±€éƒ¨å˜é‡&lt;/td&gt;
          &lt;td&gt;å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡ï¼Œå­˜æ”¾åœ¨æ ˆå¸§ä¸­&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å‚æ•°&lt;/td&gt;
          &lt;td&gt;è°ƒç”¨è¢«è°ƒç”¨å‡½æ•°æ—¶å‹å…¥æ ˆçš„å‚æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ ˆå¸§ç›¸å…³æŒ‡é’ˆ&lt;/td&gt;
          &lt;td&gt;ç”¨äºç®¡ç†å‡½æ•°è¿”å›ä¸æ ˆå¸§åˆ‡æ¢&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;è¿”å›æŒ‡ä»¤æŒ‡é’ˆ&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;CALL&lt;/code&gt;æŒ‡ä»¤å°†EIPï¼ˆä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼‰å‹æ ˆï¼Œå‡½æ•°è¿”å›åè·³è½¬åˆ°è¿™é‡Œæ‰§è¡Œ&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;æ ˆå¸§åŸºæŒ‡é’ˆebp&#34;&gt;æ ˆå¸§åŸºæŒ‡é’ˆï¼ˆEBPï¼‰
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;EBP&lt;/code&gt;åœ¨å‡½æ•°è°ƒç”¨æ—¶ç”¨ä½œæ ˆå¸§çš„å›ºå®šå‚è€ƒç‚¹ï¼Œæ–¹ä¾¿è®¿é—®å±€éƒ¨å˜é‡å’Œå‡½æ•°å‚æ•°&lt;/p&gt;
&lt;h3 id=&#34;åŸºæœ¬æ ˆæ“ä½œpush--pop&#34;&gt;åŸºæœ¬æ ˆæ“ä½œï¼šPUSH / POP
&lt;/h3&gt;&lt;h4 id=&#34;pushå‹æ ˆ&#34;&gt;PUSHï¼šå‹æ ˆ
&lt;/h4&gt;&lt;p&gt;å°†ä¸€ä¸ªå¯„å­˜å™¨ã€å†…å­˜æˆ–ç«‹å³æ•°çš„å€¼å‹å…¥æ ˆé¡¶&lt;/p&gt;
&lt;p&gt;å…ˆå°†æ ˆé¡¶æŒ‡é’ˆ&lt;code&gt;ESP&lt;/code&gt;å‡å»ä¸€ä¸ªå•ä½ï¼Œç„¶åå°†æ“ä½œæ•°å­˜å…¥&lt;code&gt;ESP&lt;/code&gt;æŒ‡å‘çš„æ–°åœ°å€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ ˆå‘ä½åœ°å€æ‰©å±•ï¼ŒIA-32ä¸‹ï¼Œä¸€ä¸ªå•ä½4å­—èŠ‚ï¼ˆ32bitï¼‰ï¼š&lt;code&gt;ESP = ESP - 4&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å°†æ•°æ®å†™å…¥æ ˆé¡¶ï¼š&lt;code&gt;[ESP] = æ“ä½œæ•°&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;0x1234&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EAX&lt;/span&gt;   ; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt; , [&lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;] &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x1234&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;mark&gt;&lt;strong&gt;PUSHå…ˆå‡å†å­˜å€¼&lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;h4 id=&#34;popå‡ºæ ˆ&#34;&gt;POPï¼šå‡ºæ ˆ
&lt;/h4&gt;&lt;p&gt;ä»æ ˆé¡¶å–å‡ºæ•°æ®åˆ°å¯„å­˜å™¨æˆ–å†…å­˜ï¼Œå¹¶æ¢å¤æ ˆæŒ‡é’ˆ&lt;/p&gt;
&lt;p&gt;å…ˆå°†&lt;code&gt;ESP&lt;/code&gt;æŒ‡å‘åœ°å€çš„å€¼å–å‡ºåˆ°ç›®æ ‡æ“ä½œæ•°ï¼Œç„¶åå°†&lt;code&gt;ESP&lt;/code&gt;å¢åŠ ä¸€ä¸ªå•ä½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å–å‡º&lt;code&gt;[ESP]&lt;/code&gt;çš„å€¼åˆ°ç›®æ ‡æ“ä½œæ•°&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ˆæŒ‡é’ˆä¸Šç§»ï¼Œæ¢å¤åŸä½ç½®ï¼š&lt;code&gt;ESP = ESP + 4&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt;    ; &lt;span style=&#34;color:#e06c75&#34;&gt;EBX&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; æ ˆé¡¶å€¼ , &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;mark&gt;&lt;strong&gt;POPå…ˆå–å€¼å†åŠ &lt;/strong&gt;&lt;/mark&gt;&lt;/p&gt;
&lt;h3 id=&#34;è°ƒç”¨ä¸è¿”å›çš„åˆ†ç±»&#34;&gt;è°ƒç”¨ä¸è¿”å›çš„åˆ†ç±»
&lt;/h3&gt;&lt;p&gt;æ ¹æ®ç›®æ ‡å‡½æ•°ä¸è°ƒç”¨è€…æ˜¯å¦åœ¨åŒä¸€ä¸ªä»£ç æ®µï¼Œè°ƒç”¨å’Œè¿”å›å¯ä»¥åˆ†ä¸ºä¸¤ç±»&lt;/p&gt;
&lt;h4 id=&#34;è¿‘è°ƒç”¨-near-call--è¿‘è¿”å›-near-return&#34;&gt;è¿‘è°ƒç”¨ (Near Call) / è¿‘è¿”å› (Near Return)
&lt;/h4&gt;&lt;p&gt;æ§åˆ¶æµè½¬ç§»åˆ°&lt;strong&gt;å½“å‰ä»£ç æ®µ&lt;/strong&gt;ä¸­çš„å‡½æ•°ï¼Œæˆ–ä»å½“å‰ä»£ç æ®µçš„å‡½æ•°è¿”å›&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æœ€å¸¸è§çš„è°ƒç”¨æ–¹å¼ï¼Œç”¨äºè®¿é—®ç¨‹åºå†…éƒ¨çš„æœ¬åœ°å‡½æ•°&lt;/p&gt;
&lt;h4 id=&#34;è¿œè°ƒç”¨-far-call--è¿œè¿”å›-far-return&#34;&gt;è¿œè°ƒç”¨ (Far Call) / è¿œè¿”å› (Far Return)
&lt;/h4&gt;&lt;p&gt;æ§åˆ¶æµè½¬ç§»åˆ°&lt;strong&gt;å…¶ä»–ä»£ç æ®µ&lt;/strong&gt;ä¸­çš„å‡½æ•°ï¼Œæˆ–ä»å…¶ä»–ä»£ç æ®µè¿”å›&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼é€šå¸¸ç”¨äºè®¿é—®æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ï¼ˆAPIï¼‰æˆ–å…¶ä»–è¿›ç¨‹çš„å‡½æ•°&lt;/p&gt;
&lt;h3 id=&#34;callè°ƒç”¨å‡½æ•°&#34;&gt;CALLï¼šè°ƒç”¨å‡½æ•°
&lt;/h3&gt;&lt;p&gt;è·³è½¬åˆ°è¢«è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä¿å­˜è¿”å›åœ°å€ä»¥ä¾¿å‡½æ•°æ‰§è¡Œå®Œæ¯•åå›åˆ°è°ƒç”¨ç‚¹&lt;/p&gt;
&lt;h4 id=&#34;è¿‘è°ƒç”¨&#34;&gt;è¿‘è°ƒç”¨
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‹æ ˆè¿”å›åœ°å€&lt;/strong&gt;ï¼š&lt;code&gt;CALL&lt;/code&gt;æŒ‡ä»¤ä¼šå°†ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼ˆEIPï¼‰ å‹å…¥æ ˆé¡¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·³è½¬åˆ°å‡½æ•°å…¥å£&lt;/strong&gt;ï¼šCPUå°†EIPè®¾ç½®ä¸ºè¢«è°ƒç”¨å‡½æ•°çš„èµ·å§‹åœ°å€&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;; å‡è®¾å½“å‰ &lt;span style=&#34;color:#e06c75&#34;&gt;EIP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x00401000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;my_function&lt;/span&gt;  ; &lt;span style=&#34;color:#d19a66&#34;&gt;1.&lt;/span&gt; ä¿å­˜è¿”å›åœ°å€ï¼š&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;0x00401005&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;CALLæŒ‡ä»¤é•¿åº¦ä¸º5å­—èŠ‚&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                               ; &lt;span style=&#34;color:#d19a66&#34;&gt;2.&lt;/span&gt; è·³è½¬åˆ°&lt;span style=&#34;color:#e06c75&#34;&gt;my_function&lt;/span&gt;ï¼š&lt;span style=&#34;color:#e06c75&#34;&gt;JMP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;my_function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;è¿œè°ƒç”¨&#34;&gt;è¿œè°ƒç”¨
&lt;/h4&gt;&lt;p&gt;å¯¹äºè¿œè°ƒç”¨ï¼Œç”±äºè·¨è¶Šäº†ä»£ç æ®µï¼ŒCPUä¸ä»…éœ€è¦ä¿å­˜è¿”å›çš„åœ°å€åç§»ï¼ˆEIPï¼‰ï¼Œè¿˜å¿…é¡»ä¿å­˜è¿”å›çš„æ®µï¼ˆCSï¼‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ­£ç¡®è¿”å›åˆ°è°ƒç”¨è€…æ‰€åœ¨çš„åŸå§‹ä»£ç æ®µ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‹æ ˆæ®µå¯„å­˜å™¨CS&lt;/strong&gt;ï¼šå°†å½“å‰ä»£ç æ®µå¯„å­˜å™¨CSçš„å€¼å‹å…¥æ ˆé¡¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‹æ ˆè¿”å›åœ°å€EIP&lt;/strong&gt;ï¼šå°†EIPçš„å½“å‰å€¼å‹å…¥æ ˆé¡¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·³è½¬åˆ°å‡½æ•°å…¥å£&lt;/strong&gt;ï¼šå°†ç›®æ ‡å‡½æ•°çš„æ®µé€‰æ‹©å™¨å’Œåç§»åœ°å€åˆ†åˆ«è½½å…¥CSå’ŒEIPå¯„å­˜å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;CALL&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;FAR&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;2000&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;h&lt;/span&gt;:&lt;span style=&#34;color:#d19a66&#34;&gt;0100&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;h&lt;/span&gt;  ; è¿œè°ƒç”¨åˆ° &lt;span style=&#34;color:#d19a66&#34;&gt;2000&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;0100&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;è¿™é‡Œå¿…é¡»ä½¿ç”¨&lt;code&gt;FAR PTR&lt;/code&gt;è¡¨ç¤ºæ˜¯è¿œè°ƒç”¨ï¼Œå¦åˆ™ä¼šè¢«å½“æˆè¿‘è°ƒç”¨å¤„ç†&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;retä»å‡½æ•°è¿”å›&#34;&gt;RETï¼šä»å‡½æ•°è¿”å›
&lt;/h3&gt;&lt;p&gt;ä»æ ˆé¡¶å–å‡ºè¿”å›åœ°å€ï¼Œæ¢å¤æ‰§è¡Œæµåˆ°è°ƒç”¨è€…&lt;/p&gt;
&lt;h4 id=&#34;è¿‘è¿”å›retretn&#34;&gt;è¿‘è¿”å›ï¼ˆRET/RETNï¼‰
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼¹å‡ºè¿”å›åœ°å€&lt;/strong&gt;ï¼šä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ª32ä½çš„å€¼åˆ°EIPå¯„å­˜å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…ç†å‚æ•° (å¯é€‰)&lt;/strong&gt;ï¼š&lt;code&gt;RET n&lt;/code&gt;ä¼šåœ¨å¼¹å‡ºè¿”å›åœ°å€åï¼Œé¢å¤–å°†ESPå¢åŠ nå­—èŠ‚ï¼Œç”¨äºæ¸…ç†è°ƒç”¨è€…å‹å…¥æ ˆçš„å‚æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;       ; æ ‡å‡†è¿”å›
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RETN&lt;/span&gt;     ; è¿‘è¿”å›
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;     ; è¿”å›å¹¶æ¸…ç†æ ˆä¸Š &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt; å­—èŠ‚å‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤æ—¶å°±å¯ä»¥æŠŠRETç†è§£ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EIP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;è¿œè¿”å›retf&#34;&gt;è¿œè¿”å›ï¼ˆRETFï¼‰
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¼¹å‡ºè¿”å›åœ°å€EIP&lt;/strong&gt;ï¼šä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ª32ä½çš„å€¼åˆ°EIPå¯„å­˜å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼¹å‡ºæ®µå¯„å­˜å™¨CS&lt;/strong&gt;ï¼šä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ª16ä½çš„å€¼åˆ°CSå¯„å­˜å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RETF&lt;/span&gt; ; è¿œè¿”å›
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;CPUä¸è·Ÿè¸ªè¿”å›æŒ‡ä»¤æŒ‡é’ˆåœ¨æ ˆä¸Šçš„ä½ç½®ï¼Œç¨‹åºå‘˜å¿…é¡»ç¡®ä¿åœ¨æ‰§è¡Œ&lt;code&gt;RET&lt;/code&gt;æŒ‡ä»¤æ—¶ï¼Œæ ˆé¡¶å†…å®¹æ°å¥½æ˜¯æ­£ç¡®çš„è¿”å›åœ°å€&lt;/p&gt;
&lt;p&gt;å¦‚æœæ ˆä¸Šçš„è¿”å›åœ°å€åœ¨&lt;code&gt;RET&lt;/code&gt;æ‰§è¡Œå‰è¢«ä¿®æ”¹ï¼ˆä¾‹å¦‚é€šè¿‡ç¼“å†²åŒºæº¢å‡ºï¼‰ï¼Œç¨‹åºçš„æ‰§è¡Œæµå°±å¯èƒ½è¢«åŠ«æŒï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„å®‰å…¨æ¼æ´&lt;/p&gt;
&lt;h3 id=&#34;è°ƒç”¨çº¦å®š&#34;&gt;è°ƒç”¨çº¦å®š
&lt;/h3&gt;&lt;p&gt;è¿™æ˜¯å‡½æ•°è°ƒç”¨åŒæ–¹å¿…é¡»éµå®ˆçš„ä¸€å¥—è§„åˆ™ï¼Œå®ƒè§„å®šäº†å‚æ•°å¦‚ä½•ä¼ é€’ã€è¿”å›å€¼å¦‚ä½•è¿”å›ã€ä»¥åŠå“ªä¸€æ–¹ï¼ˆè°ƒç”¨è€…æˆ–è¢«è°ƒç”¨è€…ï¼‰è´Ÿè´£æ¸…ç†æ ˆä¸Šçš„å‚æ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;cdecl&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cè¯­è¨€çš„é»˜è®¤çº¦å®šï¼Œå‚æ•°ä»å³åˆ°å·¦å‹æ ˆï¼Œ&lt;strong&gt;è°ƒç”¨è€…&lt;/strong&gt;è´Ÿè´£æ¸…ç†æ ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;stdcall&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Win32APIå¸¸ç”¨ï¼Œå‚æ•°ä»å³åˆ°å·¦å‹æ ˆï¼Œ&lt;strong&gt;è¢«è°ƒç”¨è€…&lt;/strong&gt;è´Ÿè´£æ¸…ç†æ ˆï¼ˆé€šè¿‡ &lt;code&gt;RET n&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;fastcall&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;stdcall&lt;/code&gt;çš„å˜ç§ï¼Œå‰ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰å‚æ•°é€šè¿‡&lt;code&gt;ECX&lt;/code&gt;å’Œ&lt;code&gt;EDX&lt;/code&gt;ç­‰å¯„å­˜å™¨ä¼ é€’ï¼Œä»¥æé«˜é€Ÿåº¦ï¼Œå‰©ä½™å‚æ•°å‹æ ˆï¼Œè¢«è°ƒç”¨è€…è´Ÿè´£æ¸…ç†&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ˆå¸§çš„åˆ›å»ºä¸é”€æ¯å‡½æ•°æŒ‡ä»¤æ¡†æ¶&#34;&gt;æ ˆå¸§çš„åˆ›å»ºä¸é”€æ¯ï¼ˆå‡½æ•°æŒ‡ä»¤æ¡†æ¶ï¼‰
&lt;/h3&gt;&lt;h4 id=&#34;å‡½æ•°åºè¨€-prologue&#34;&gt;å‡½æ•°åºè¨€ (Prologue)
&lt;/h4&gt;&lt;p&gt;å½“æ‰§è¡Œ&lt;code&gt;CALL&lt;/code&gt;è¯­å¥ä¹‹åï¼Œå‡½æ•°å¼€å§‹æ—¶å»ºç«‹è‡ªå·±çš„æ ˆå¸§&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;              ; ä¿å­˜è°ƒç”¨è€…çš„æ ˆå¸§åŸºå€ (æ—§&lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;        ; å°†å½“å‰æ ˆé¡¶è®¾ä¸ºæ–°çš„æ ˆå¸§åŸºå€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;SUB&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;20&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;H&lt;/span&gt;         ; è®©æ ˆé¡¶å‘ä½åœ°å€å¤„å»¶ä¼¸ï¼Œä»¥æ­¤ä¸ºå±€éƒ¨å˜é‡åˆ†é…&lt;span style=&#34;color:#d19a66&#34;&gt;32&lt;/span&gt;å­—èŠ‚ç©ºé—´
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å±€éƒ¨å˜é‡ä¼šæ”¾åœ¨&lt;code&gt;EBP&lt;/code&gt;ä¸‹é¢ï¼ˆåœ°å€æ›´å°ï¼‰ï¼Œå‚æ•°ä¼šæ”¾åœ¨&lt;code&gt;EBP&lt;/code&gt;ä¸Šé¢ï¼ˆåœ°å€æ›´å¤§ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¿™æ ·è®¿é—®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;]     	   	    ; ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆè¿”å›åœ°å€å ç”¨äº†&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;å­—èŠ‚ï¼Œæ‰€ä»¥ä»ç¬¬&lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;å­—èŠ‚å¼€å§‹ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;12&lt;/span&gt;]     		   ; ç¬¬äºŒä¸ªå‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;]     		     ; ç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;8&lt;/span&gt;]     		      ; ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;å‡½æ•°ç»“å°¾-epilogue&#34;&gt;å‡½æ•°ç»“å°¾ (Epilogue)
&lt;/h4&gt;&lt;p&gt;å‡½æ•°è¿”å›å‰æ¢å¤è°ƒç”¨è€…æ ˆå¸§çš„æ ‡å‡†æ“ä½œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;         ; é‡Šæ”¾å±€éƒ¨å˜é‡ç©ºé—´
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                  ; æ¢å¤è°ƒç”¨è€…çš„æ ˆå¸§åŸºå€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;                          ; è¿”å›
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;enter--leave&#34;&gt;ENTER / LEAVE
&lt;/h4&gt;&lt;p&gt;é«˜çº§æŒ‡ä»¤ï¼Œç”¨äºç®€åŒ–æ ˆå¸§çš„åˆ›å»ºå’Œé”€æ¯&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ENTER&lt;/code&gt;ç­‰ä»·äºå‡½æ•°åºè¨€ï¼Œ&lt;code&gt;LEAVE&lt;/code&gt;ç­‰ä»·äº&lt;code&gt;MOV ESP, EBP; POP EBP&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå‡½æ•°åº”è¯¥ï¼ˆä¸æ˜¯å¿…é¡»ï¼‰å†™åœ¨è¿™æ ·çš„æ¡†æ¶é‡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;PUSH&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;ï¼ˆå‡½æ•°ä¸»ä½“ï¼Œå±€éƒ¨å˜é‡&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;æ“ä½œï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;MOV&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;POP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ENTER&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;;ï¼ˆå‡½æ•°ä¸»ä½“ï¼Œå±€éƒ¨å˜é‡&lt;span style=&#34;color:#56b6c2&#34;&gt;/&lt;/span&gt;æ“ä½œï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;LEAVE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;RET&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;è°ƒç”¨æµç¨‹æ€»ç»“&#34;&gt;è°ƒç”¨æµç¨‹æ€»ç»“
&lt;/h3&gt;&lt;p&gt;ç»“åˆä¹‹å‰æ‰€è¯´çš„ä¸€åˆ‡ï¼Œæˆ‘ä»¬å°±æ€»ç»“å‡ºæ¥ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶è§¦å‘çš„æ“ä½œé¡ºåºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è°ƒç”¨è€…å‡†å¤‡è°ƒç”¨      ï¼ˆå‹å…¥å‚æ•°ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰§è¡ŒCALLæŒ‡ä»¤        ï¼ˆå‹å…¥è¿”å›åœ°å€ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡½æ•°åºè¨€                ï¼ˆå‹å…¥è°ƒç”¨è€…çš„EBPï¼Œä¸ºå±€éƒ¨å˜é‡å¼€è¾Ÿç©ºé—´ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡½æ•°ä¸»ä½“                ï¼ˆå‹å…¥å±€éƒ¨å˜é‡ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‚£ä¹ˆå½“ä¸€ä¸ªæ ˆå¸§åˆ›å»ºå®Œæ¯•ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;å‚æ•°&lt;/span&gt;                                        â† &lt;span style=&#34;color:#e06c75&#34;&gt;å‡½æ•°è°ƒç”¨è€…å‹å…¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;è¿”å›åœ°å€&lt;/span&gt;                                 â† &lt;span style=&#34;color:#e06c75&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;è‡ªåŠ¨å‹å…¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;æ—§&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;ä¸Šä¸€ä¸ªEBP&lt;/span&gt;ï¼‰             â† &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ä¿å­˜è°ƒç”¨è€…åŸºå€&lt;/span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;å±€éƒ¨å˜é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è€Œåœ¨&lt;code&gt;PUSH EBP&lt;/code&gt;ä¹‹åï¼Œå½“å‰æ ˆé¡¶å˜æˆäº†æ ˆå¸§çš„åŸºå€ï¼Œä¹Ÿå°±æ˜¯è¯´å¸§åˆ›å»ºå®Œæ¯•åï¼ŒEBPå’ŒESPä½ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;å‚æ•°&lt;/span&gt;                                       
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;è¿”å›åœ°å€&lt;/span&gt;                                 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;æ—§&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;ä¸Šä¸€ä¸ªEBP&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;   [EBPä½ç½®]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;å±€éƒ¨å˜é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;   [ESPä½ç½®]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤æ—¶[EBP]å­˜æ”¾ç€è°ƒç”¨è€…çš„EBPï¼Œ[ESP]å­˜æ”¾ç€æœ€åä¸€ä¸ªå±€éƒ¨å˜é‡ï¼ˆå¦‚æœç”³è¯·çš„ç©ºé—´ç”¨æ»¡äº†çš„è¯ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„å›¾å°±å¾ˆå¥½å±•ç¤ºäº†è°ƒç”¨å‡½æ•°æ ˆå¸§å˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;æ ˆå¸§ä¸è°ƒç”¨æƒ¯ä¾‹| nullwy&amp;rsquo;s blog&#34; href=&#34;http://picture.928330.xyz/typora/stack-frame-layout-zh.png&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/stack-frame-layout-zh.png&#34; alt=&#34;æ ˆå¸§ä¸è°ƒç”¨æƒ¯ä¾‹| nullwy&amp;rsquo;s blog&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;h3 id=&#34;è°ƒç”¨æµç¨‹ç¤ºä¾‹&#34;&gt;è°ƒç”¨æµç¨‹ç¤ºä¾‹
&lt;/h3&gt;&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªç¨‹åºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;sub&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt; ;å±€éƒ¨å˜é‡
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt; ;ä¼ å…¥&lt;span style=&#34;color:#e06c75&#34;&gt;barçš„å‚æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pop&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;sub&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;pop&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;è¿›å…¥main&#34;&gt;è¿›å…¥main
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;EBP&lt;/code&gt;ï¼šmainçš„æ—§EBP&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ESP&lt;/code&gt;ï¼šmainæ ˆé¡¶ï¼ˆå±€éƒ¨å˜é‡åŒºåº•ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;ä¹Ÿè®¸æœ‰ä¹Ÿè®¸æ²¡æœ‰&lt;/span&gt;ï¼‰				   â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt;                          â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;è°ƒç”¨è€…æ˜¯CRT&lt;/span&gt;ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;Cè¿è¡Œæ—¶&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;è°ƒç”¨&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„æ ˆå¸§çš„EBP&lt;/span&gt;                â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;æŒ‡å‘è¿™é‡Œ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt;                          â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;call-foo&#34;&gt;call foo
&lt;/h4&gt;&lt;p&gt;mainå‡½æ•°å…ˆæŠŠfooéœ€è¦çš„å‚æ•°å‹æ ˆï¼Œä¹‹å&lt;code&gt;call foo&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;call foo&lt;/code&gt;åšäº†ä¸¤ä»¶äº‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1.æŠŠ&lt;code&gt;call&lt;/code&gt;ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œå³å½“å‰EIPï¼ˆæŒ‡å‘callæŒ‡ä»¤ï¼‰+callæŒ‡ä»¤é•¿åº¦ï¼Œä¹Ÿå³fooçš„è¿”å›åœ°å€ï¼Œå‹å…¥æ ˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.è®©EIPè·³è½¬åˆ°fooçš„å¼€å§‹åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt;                          â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;è°ƒç”¨&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„æ ˆå¸§çš„EBP&lt;/span&gt;                â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt;                          â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ â†’ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ â†’ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)     â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;è¿›å…¥foo&#34;&gt;è¿›å…¥foo
&lt;/h4&gt;&lt;p&gt;è¿›å…¥fooåï¼Œæ‰§è¡Œåºè¨€ï¼Œä¸ºfooåˆ›å»ºå¸§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;         ; ä¿å­˜ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; çš„ &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;, &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;    ; å»ºç«‹ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; çš„åŸºå€
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;sub&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;esp&lt;/span&gt;, &lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;      ; ä¸º &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; çš„å±€éƒ¨å˜é‡åˆ†é…ç©ºé—´
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;EBP&lt;/code&gt;ï¼šå½“å‰æ ˆå¸§çš„å›ºå®šåŸºå€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;[EBP]&lt;/code&gt;ï¼šmainçš„æ—§EBP&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;[EBP+4]&lt;/code&gt;ï¼šè¿”å›åœ°å€ï¼ˆè¿”å› mainï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;[EBP-4]&lt;/code&gt;ã€&lt;code&gt;[EBP-8]&lt;/code&gt;ï¼šfooçš„å±€éƒ¨å˜é‡&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                               â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt;                                        â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;è°ƒç”¨&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„æ ˆå¸§çš„EBP&lt;/span&gt;                              â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt;                                         â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                  â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚   &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)                      â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚  â†’ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                            â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚  â†’ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                           â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;æŒ‡å‘è¿™é‡Œ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹‹åæ‰§è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;mov&lt;/span&gt;  &lt;span style=&#34;color:#e06c75&#34;&gt;DWORD&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;PTR&lt;/span&gt; [&lt;span style=&#34;color:#e06c75&#34;&gt;ebp&lt;/span&gt;&lt;span style=&#34;color:#56b6c2&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;], &lt;span style=&#34;color:#d19a66&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»™fooçš„å±€éƒ¨å˜é‡ç©ºé—´å†™å…¥å€¼&lt;/p&gt;
&lt;h4 id=&#34;fooè°ƒç”¨bar&#34;&gt;fooè°ƒç”¨bar
&lt;/h4&gt;&lt;p&gt;åŒæ ·çš„æµç¨‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;..&lt;/span&gt;.                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)                        â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;)                           â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                   â”‚  â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;è¿”å›è¿‡ç¨‹&#34;&gt;è¿”å›è¿‡ç¨‹
&lt;/h4&gt;&lt;p&gt;é¦–å…ˆbaræ‰§è¡Œ&lt;code&gt;MOV ESP, EBP&lt;/code&gt;ï¼Œé‡Šæ”¾baræ ˆå¸§ä¸­å­˜æ”¾äº†barå±€éƒ¨å˜é‡çš„åœ°æ–¹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;..&lt;/span&gt;.                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)                        â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;)                           â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                   â”‚   â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;  â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚ ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åæ‰§è¡Œ&lt;code&gt;POP EBP&lt;/code&gt;ï¼Œå°†ESPæŒ‡å‘çš„å†…å®¹ï¼ˆfooçš„EBPï¼‰ç»™EBPï¼Œç„¶åé‡Šæ”¾è¿™éƒ¨åˆ†ç©ºé—´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;..&lt;/span&gt;.                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)                        â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                 â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;)                           â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                   â”‚ ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰   
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚ ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åæ‰§è¡Œ&lt;code&gt;RET&lt;/code&gt;ï¼Œå¼¹å‡ºè¿”å›åœ°å€ï¼Œ&lt;code&gt;EIP&lt;/code&gt;è·³è½¬åˆ°fooçš„è¿”å›ä½ç½®ï¼ˆmainå‡½æ•°ï¼‰&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰å‚æ•°åˆ™é¢å¤–&lt;code&gt;RET N&lt;/code&gt;é‡Šæ”¾å‚æ•°ç©ºé—´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-kotlin&#34; data-lang=&#34;kotlin&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;é«˜åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#56b6c2&#34;&gt;..&lt;/span&gt;.                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt;)                        â”‚
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;main&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                 â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚ â† &lt;span style=&#34;color:#e06c75&#34;&gt;ESP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å‚æ•°&lt;/span&gt;                                                    â”‚ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„è¿”å›åœ°å€&lt;/span&gt; (&lt;span style=&#34;color:#e06c75&#34;&gt;ret&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;to&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt;)                           â”‚ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;foo&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;EBP&lt;/span&gt;                                                   â”‚ ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰   
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â”‚ &lt;span style=&#34;color:#e06c75&#34;&gt;bar&lt;/span&gt; &lt;span style=&#34;color:#e06c75&#34;&gt;çš„å±€éƒ¨å˜é‡&lt;/span&gt; (&lt;span style=&#34;color:#d19a66&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;å­—èŠ‚&lt;/span&gt;)                                 â”‚ ï¼ˆ&lt;span style=&#34;color:#e06c75&#34;&gt;è¢«é‡Šæ”¾&lt;/span&gt;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e06c75&#34;&gt;ä½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ä¸€æ¥ï¼Œbarçš„æ•´ä¸ªæ ˆå¸§è¢«é”€æ¯ï¼ŒESPå’ŒEBPè¿˜åŸè‡³fooæ ˆå¸§&lt;/p&gt;
&lt;p&gt;fooè¿”å›ä¹Ÿæ˜¯ä¸€æ ·&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å…³äºå‚æ•°åˆ’åˆ†çš„æ ˆå¸§ä½ç½®æœ‰äº›ä¸åŒï¼Œä¸è¿‡ä¹Ÿèƒ½è¾…åŠ©ç†è§£åµŒå¥—è°ƒç”¨ï¼š&lt;/p&gt;
&lt;p&gt;
&lt;div class=&#34;post-img-view&#34;&gt;
&lt;a data-fancybox=&#34;gallery&#34; data-caption=&#34;å‡½æ•°è°ƒç”¨å®ç°è¿‡ç¨‹è¯¦è§£ï¼ˆæ ˆç©ºé—´è§£æï¼‰_å‡½æ•°è°ƒç”¨æ ˆè¿‡ç¨‹-CSDNåšå®¢&#34; href=&#34;http://picture.928330.xyz/typora/f44cf3dc1d84b6bc6cd299fb572340a6.gif&#34;&gt;
&lt;img src=&#34;http://picture.928330.xyz/typora/f44cf3dc1d84b6bc6cd299fb572340a6.gif&#34; alt=&#34;å‡½æ•°è°ƒç”¨å®ç°è¿‡ç¨‹è¯¦è§£ï¼ˆæ ˆç©ºé—´è§£æï¼‰_å‡½æ•°è°ƒç”¨æ ˆè¿‡ç¨‹-CSDNåšå®¢&#34;  /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
